self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ForgottenAttachments.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[572],{1249:function(e,t,n){"use strict";var r=n(469),i=n(701),o=n(0),a=n(12),c=n(382),s={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"};n.d(t,"a",(function(){return u}));var u=Object(r.a)(i.a,(function(e){var t,n,r,i,u,d,l,f,h,p,g,b,v,m,_,k,y,S,O=e.className,E=e.theme,C=e.reversed,w=e.checked,I=e.disabled,D=e.isUsingCustomLabelRender,j=e.indeterminate,T=E.semanticColors,P=E.effects,x=E.palette,F=E.fonts,A=Object(a.getGlobalClassNames)(s,E),R=T.inputForegroundChecked,L=x.neutralSecondary,M=x.neutralPrimary,B=T.inputBackgroundChecked,N=T.inputBackgroundChecked,K=T.disabledBodySubtext,H=T.inputBorderHovered,V=T.inputBackgroundCheckedHovered,q=T.inputBackgroundChecked,U=T.inputBackgroundCheckedHovered,W=T.inputBackgroundCheckedHovered,Y=T.inputTextHovered,G=T.disabledBodySubtext,z=T.bodyText,X=T.disabledText,$=[(t={content:'""',borderRadius:P.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:I?K:B,transitionProperty:"border-width, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)"},t[a.HighContrastSelector]={borderColor:"WindowText"},t)];return{root:[A.root,{position:"relative",display:"flex"},C&&"reversed",w&&"is-checked",!I&&"is-enabled",I&&"is-disabled",!I&&[!w&&(n={},n[":hover ."+A.checkbox]=(r={borderColor:H},r[a.HighContrastSelector]={borderColor:"Highlight"},r),n[":focus ."+A.checkbox]={borderColor:H},n[":hover ."+A.checkmark]=(i={color:L,opacity:"1"},i[a.HighContrastSelector]={color:"Highlight"},i),n),w&&!j&&(u={},u[":hover ."+A.checkbox]={background:U,borderColor:W},u[":focus ."+A.checkbox]={background:U,borderColor:W},u[a.HighContrastSelector]=(d={},d[":hover ."+A.checkbox]={background:"Highlight",borderColor:"Highlight"},d[":focus ."+A.checkbox]={background:"Highlight"},d[":focus:hover ."+A.checkbox]={background:"Highlight"},d[":focus:hover ."+A.checkmark]={color:"Window"},d[":hover ."+A.checkmark]={color:"Window"},d),u),j&&(l={},l[":hover ."+A.checkbox+", :hover ."+A.checkbox+":after"]=(f={borderColor:V},f[a.HighContrastSelector]={borderColor:"WindowText"},f),l[":focus ."+A.checkbox]={borderColor:V},l[":hover ."+A.checkmark]={opacity:"0"},l),(h={},h[":hover ."+A.text+", :focus ."+A.text]=(p={color:Y},p[a.HighContrastSelector]={color:I?"GrayText":"WindowText"},p),h)],O],input:(g={position:"absolute",background:"none",opacity:0},g["."+c.a+" &:focus + label::before"]=(b={outline:"1px solid "+E.palette.neutralSecondary,outlineOffset:"2px"},b[a.HighContrastSelector]={outline:"1px solid ActiveBorder"},b),g),label:[A.label,E.fonts.medium,{display:"flex",alignItems:D?"center":"flex-start",cursor:I?"default":"pointer",position:"relative",userSelect:"none"},C&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[A.checkbox,Object(o.__assign)((v={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:"20px",width:"20px",border:"1px solid "+M,borderRadius:P.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)",overflow:"hidden",":after":j?$:null},v[a.HighContrastSelector]={borderColor:"WindowText"},v),Object(a.getEdgeChromiumNoHighContrastAdjustSelector)()),j&&{borderColor:B},C?{marginLeft:4}:{marginRight:4},!I&&!j&&w&&(m={background:q,borderColor:N},m[a.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},m),I&&(_={borderColor:K},_[a.HighContrastSelector]={borderColor:"GrayText"},_),w&&I&&(k={background:G,borderColor:K},k[a.HighContrastSelector]={background:"Window"},k)],checkmark:[A.checkmark,(y={opacity:w?"1":"0",color:R},y[a.HighContrastSelector]={color:I?"GrayText":"Window",MsHighContrastAdjust:"none"},y)],text:[A.text,Object(o.__assign)((S={color:I?X:z,fontSize:F.medium.fontSize,lineHeight:"20px"},S[a.HighContrastSelector]={color:I?"GrayText":"WindowText"},S),Object(a.getEdgeChromiumNoHighContrastAdjustSelector)()),C?{marginRight:4}:{marginLeft:4}]}}),void 0,{scope:"Checkbox"})},143:function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"i",(function(){return r}));var r,i="ktp",o="-",a=i+o,c="data-ktp-target",s="data-ktp-execute-target",u="data-ktp-aria-target",d="ktp-layer-id",l=", ";!function(e){e.KEYTIP_ADDED="keytipAdded",e.KEYTIP_REMOVED="keytipRemoved",e.KEYTIP_UPDATED="keytipUpdated",e.PERSISTED_KEYTIP_ADDED="persistedKeytipAdded",e.PERSISTED_KEYTIP_REMOVED="persistedKeytipRemoved",e.PERSISTED_KEYTIP_EXECUTE="persistedKeytipExecute",e.ENTER_KEYTIP_MODE="enterKeytipMode",e.EXIT_KEYTIP_MODE="exitKeytipMode"}(r||(r={}))},14542:function(e){e.exports=JSON.parse('{"a":"z$a"}')},17183:function(e,t,n){"use strict";n.r(t);var r,i=n(0),o=n(2811),a=n(3),c=Object(a.action)("COMPOSE_VALIDATION_FAILED_FOR_MESSAGE",(function(e,t,n){return{composeId:e,forceSend:t,validatedAttachmentType:n}})),s=Object(a.action)("COMPOSE_VALIDATION_FAILED_FOR_MESSAGE_FORCE_SEND",(function(e,t){return{composeId:e,forceSend:t}})),u=Object(a.action)("COMPOSE_VALIDATION_FAILED_FOR_MESSAGE_TIME_DIALOG_OPEN",(function(e,t){return{composeId:e,timeDialogOpen:t}})),d=Object(a.action)("MESSAGE_SUCCESSFULLY_SENT",(function(e){return{composeId:e}}));!function(e){e[e.ForgottenAttachments=0]="ForgottenAttachments",e[e.PendingPermissions=1]="PendingPermissions",e[e.SharingIssue=2]="SharingIssue"}(r||(r={}));var l={telemetryDataForFailedValidation:new(n(16).ObservableMap)},f=Object(a.createStore)("blockOnSendAttachmentsTelemetryStore",l);function h(e){var t=f().telemetryDataForFailedValidation.get(e);return t&&t[r.SharingIssue]||function(e){var t,n=f().telemetryDataForFailedValidation.get(e);f().telemetryDataForFailedValidation.set(e,Object(i.__assign)(Object(i.__assign)({},n),((t={})[r.SharingIssue]={forceSend:null,timeBlockingDialogOpen:null,sharingTipId:null,errorSource:null,totalLinkCount:0,newLinkCount:0},t)))}(e),f().telemetryDataForFailedValidation.get(e)}Object(a.mutator)(c,(function(e){var t,n=e.composeId,r=e.forceSend,o=e.validatedAttachmentType,a=f().telemetryDataForFailedValidation.get(n);f().telemetryDataForFailedValidation.set(n,Object(i.__assign)(Object(i.__assign)({},a),((t={})[o]={forceSend:r},t)))})),Object(a.mutator)(o.i,(function(e){var t=e.composeId,n=e.sharingTipId,i=e.errorSource,o=e.totalLinkCount,a=e.newLinkCount,c=h(t);c[r.SharingIssue].sharingTipId=n,c[r.SharingIssue].errorSource=i,c[r.SharingIssue].totalLinkCount=o,c[r.SharingIssue].newLinkCount=a,f().telemetryDataForFailedValidation.set(t,c)})),Object(a.mutator)(s,(function(e){var t=e.composeId,n=e.forceSend,i=f().telemetryDataForFailedValidation.get(t);i&&(i[r.SharingIssue].forceSend=n,f().telemetryDataForFailedValidation.set(t,i))})),Object(a.mutator)(u,(function(e){var t=e.composeId,n=e.timeDialogOpen,i=h(t);i[r.SharingIssue].timeBlockingDialogOpen=n,f().telemetryDataForFailedValidation.set(t,i)})),Object(a.mutator)(d,(function(e){var t=e.composeId;f().telemetryDataForFailedValidation.delete(t)}));var p=n(134),g=n(3930),b=n(1762),v=n(25),m=n(34);function _(e,t){var n;return null===(n=f().telemetryDataForFailedValidation.get(e)[t])||void 0===n?void 0:n.forceSend}function k(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,o.e.import()];case 1:return t=n.sent(),[2,Promise.resolve(t(e))]}}))}))}var y=n(2553),S=n(2808),O=23;function E(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,a,c,s,u,d,l,f;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t=Object(b.b)(),n=t.viewStates.get(e),a=_(e,r.PendingPermissions),[4,o.g.import()];case 1:return u=i.sent(),d=u(null==n?void 0:n.attachmentWell),l=d.linkInBodyCount,f=d.newLinkCount,n?[4,k(e)]:[3,5];case 2:return s=i.sent(),[4,o.c.import()];case 3:return[4,i.sent()(n.infoBarIds,n.attachmentWell,Object(S.a)(n.toRecipientWell),Object(y.c)(n),!1,!1)];case 4:c=i.sent(),i.label=5;case 5:return Object(p.r)("PendingPermissionTriggered",{forceSend:a,anyLinkIssues:c,checkPermissionStatus:s,linkInBodyCount:Math.min(l,O),newLinkCount:Math.min(f,O)}),[2]}}))}))}Object(a.orchestrator)(g.a,(function(e){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o,a,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(t=e.composeId,n=Object(b.b)(),o=function(e){var t=f().telemetryDataForFailedValidation.get(e);return t?Object.keys(t).map((function(e){return parseInt(e)})):null}(t),a=n.viewStates.get(t),!o)return[3,10];c=0,i.label=1;case 1:if(!(c<o.length))return[3,9];if(void 0===o[c])return[3,8];if(!a)return[3,7];switch(o[c]){case r.ForgottenAttachments:return[3,2];case r.PendingPermissions:return[3,3];case r.SharingIssue:return[3,5]}return[3,6];case 2:return Object(p.r)("ForgottenAttachmentsTriggered",{userAddedAttachments:(s=a.attachmentWell,s.docViewAttachments.length>0||s.imageViewAttachments.length>0||s.inlineAttachments.length>0),docAttachments:Math.min(23,a.attachmentWell.docViewAttachments.length),imageAttachments:Math.min(23,a.attachmentWell.imageViewAttachments.length),inlineAttachments:Math.min(23,a.attachmentWell.inlineAttachments.length),forceSend:_(t,r.ForgottenAttachments),doNotShowAgain:!Object(v.a)().UserOptions.CheckForForgottenAttachments}),[3,6];case 3:return[4,E(t)];case 4:return i.sent(),[3,6];case 5:return function(e){var t=f().telemetryDataForFailedValidation.get(e);if(t){var n=t[r.SharingIssue];if(n){var i=n.forceSend,o=n.sharingTipId,a=n.errorSource,c=n.totalLinkCount,s=n.newLinkCount;Object(p.r)("SharingIssueTriggered",{forceSend:i,sharingTipId:o,errorSource:a,totalLinkCount:c,newLinkCount:s})}}}(t),[3,6];case 6:return[3,8];case 7:m.d('[AttachmentsTelemetry] No compose view state found for "'+t+'"'),i.label=8;case 8:return c++,[3,1];case 9:d(t),i.label=10;case 10:return[2]}var s}))}))}));var C=n(5250);Object(a.orchestrator)(C.b,(function(e){var t=e.composeId,n=e.errorCode,r=e.dialogOpenTime;switch(n){case"SharingIssue":u(t,r)}}));var w=n(4871);var I=n(1780);Object(a.orchestrator)(C.a,(function(e){var t=e.composeId,n=e.errorCode,o=e.forceContinue,a=e.isSend;switch(n){case w.a:c(t,o,r.ForgottenAttachments);break;case w.c:c(t,o,r.PendingPermissions);break;case w.b:!function(e,t){Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,I.e.import()];case 1:return n=i.sent(),r=n(),Object(p.r)("InsertLinksBlockDialogDismiss",{isSend:t,forceContinue:e,status:r}),[2]}}))}))}(o,a);break;case w.d:!function(e,t){var n,i=f().telemetryDataForFailedValidation.get(e),o=null===(n=null==i?void 0:i[r.SharingIssue])||void 0===n?void 0:n.timeBlockingDialogOpen;if(o){var a=(new Date).getTime()-o;Object(p.r)("SharingIssueBlockingDialog",{userAction:t?"SendClickOnFailedValidation":"DoNotSendClickOnFailedValidation"},{cosmosOnlyData:JSON.stringify({timeSpan:a})})}}(t,o),s(t,o)}}))},17388:function(e,t,n){"use strict";n.r(t);var r=n(3),i=Object(r.action)("SET_HAS_ATTACHMENT_TRIGGER_WORDs",(function(e,t){return{pluginViewState:e,hasTriggerWords:t}})),o=Object(r.action)("SET_ATTACHMENT_KEYWORDS_DETECTED_BEFORE_USER_INPUT",(function(e,t){return{pluginViewState:e,count:t}}));Object(r.mutator)(i,(function(e){var t=e.pluginViewState,n=e.hasTriggerWords;t.hasAttachmentTriggerWords=n})),Object(r.mutator)(o,(function(e){var t=e.pluginViewState,n=e.count;t.attachmentKeywordsDetectedBeforeUserInput=n}));var a=n(4675),c=function(){function e(e,t){this.adapter=e,this.editorAdapter=t,this.newTriggerWordsFound=0,this.wasDisposed=!1}return e.prototype.getName=function(){return"ForgottenAttachments"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.wasDisposed=!0},e.prototype.onPluginEvent=function(e){if(11===e.eventType&&(null===this.adapter().attachmentKeywordsDetectedBeforeUserInput||this.wasDisposed)||7===e.eventType&&"UpgradeCompose"===e.source){var t=this.adapter(),n=Object(a.a)(this.editor.getContent(3))-this.newTriggerWordsFound;o(t,n),this.wasDisposed=!1}else if(8===e.eventType){t=this.adapter();var r=Object(a.a)(this.editor.getContent(3));this.newTriggerWordsFound=r-t.attachmentKeywordsDetectedBeforeUserInput;var c=this.newTriggerWordsFound>0;i(t,c)}},e}();n.d(t,"ForgottenAttachmentsPlugin",(function(){return c}))},17524:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(85),o=n(7),a=n(14542),c=n(1),s=n(32),u=n(1249);function d(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return e=!t,[4,Object(i.z)((function(t){t.UserOptions.CheckForForgottenAttachments=e}),[{key:"CheckForForgottenAttachments",valuetype:"Boolean",value:[""+e]}]).catch((function(){Object(i.y)((function(t){t.UserOptions.CheckForForgottenAttachments=!e}))}))];case 1:return n.sent(),[2]}}))}))}var l=Object(s.a)((function(){var e=Object(i.h)().UserOptions;return c.createElement(u.a,{label:Object(o.b)(a.a),defaultChecked:!e.CheckForForgottenAttachments,onChange:d})}));n.d(t,"ForgottenAttachmentsDialogToggle",(function(){return l}))},1780:function(e,t,n){"use strict";n.d(t,"o",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"m",(function(){return f})),n.d(t,"r",(function(){return h})),n.d(t,"k",(function(){return p})),n.d(t,"q",(function(){return g})),n.d(t,"n",(function(){return b})),n.d(t,"l",(function(){return v})),n.d(t,"d",(function(){return m})),n.d(t,"i",(function(){return _})),n.d(t,"p",(function(){return k})),n.d(t,"c",(function(){return y})),n.d(t,"g",(function(){return S})),n.d(t,"e",(function(){return O})),n.d(t,"s",(function(){return E}));var r=n(44),i=n(1937);n.d(t,"a",(function(){return i.a}));var o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(15),n.e(17),n.e(20),n.e(22),n.e(24),n.e(33),n.e(34),n.e(36),n.e(39),n.e(40),n.e(43),n.e(45),n.e(48),n.e(825)]).then(n.bind(null,3063))})),a={captureBundleTime:!0},c=new r.a(o,(function(e){return e.replyToMessage}),a),s=new r.a(o,(function(e){return e.forwardMessage}),a),u=new r.a(o,(function(e){return e.closeCompose})),d=new r.a(o,(function(e){return e.discardCompose})),l=new r.a(o,(function(e){return e.loadDraftToCompose})),f=new r.a(o,(function(e){return e.openCompose})),h=new r.a(o,(function(e){return e.trySaveAndCloseCompose})),p=new r.a(o,(function(e){return e.moveComposeToTab})),g=new r.a(o,(function(e){return e.tryCreateResendDraft})),b=new r.a(o,(function(e){return e.replyToApprovalMessage})),v=new r.a(o,(function(e){return e.onEditDraftButtonClicked})),m=new r.b(o,(function(e){return e.createReply})),_=new r.b(o,(function(e){return e.getToCcRecipientsForReply})),k=new r.b(o,(function(e){return e.replyToMessageAndCreateViewState})),y=new r.b(o,(function(e){return e.createAttachments})),S=new r.b(o,(function(e){return e.extractComposePopoutData})),O=new r.b(o,(function(e){return e.didInsertLinksHaveIssuesOnBlockDialogDismiss})),E=new r.b(o,(function(e){return e.insertSignature}))},1937:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("conversationSendStateChanged",(function(e,t){return{viewState:e,isSendPending:t}}))},262:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n(60),i=n(167),o="__currentId__",a="id__",c=Object(r.a)()||{};void 0===c[o]&&(c[o]=0);var s=!1;function u(e){if(!s){var t=i.b.getInstance();t&&t.onReset&&t.onReset(d),s=!0}var n=c[o]++;return(void 0===e?a:e)+n}function d(e){void 0===e&&(e=0),c[o]=e}},270:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(306),i=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,n,i,o){var a;if(e._isElement(t)){if("undefined"!=typeof document&&document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(n,o||!1,!0),Object(r.a)(c,i),a=t.dispatchEvent(c)}else if("undefined"!=typeof document&&document.createEventObject){var s=document.createEventObject(i);t.fireEvent("on"+n,s)}}else for(;t&&!1!==a;){var u=t.__events__,d=u?u[n]:null;if(d)for(var l in d)if(d.hasOwnProperty(l))for(var f=d[l],h=0;!1!==a&&h<f.length;h++){var p=f[h];p.objectCallback&&(a=p.objectCallback.call(p.parent,i))}t=o?t.parent:null}return a},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var r in t)t.hasOwnProperty(r)&&this.on(e,r,t[r],n)},e.prototype.on=function(t,n,r,i){var o=this;if(n.indexOf(",")>-1)for(var a=n.split(/[ ,]+/),c=0;c<a.length;c++)this.on(t,a[c],r,i);else{var s=this._parent,u={target:t,eventName:n,parent:s,callback:r,options:i};if((a=t.__events__=t.__events__||{})[n]=a[n]||{count:0},a[n][this._id]=a[n][this._id]||[],a[n][this._id].push(u),a[n].count++,e._isElement(t)){var d=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!o._isDisposed){var n;try{if(!1===(n=r.apply(s,e))&&e[0]){var i=e[0];i.preventDefault&&i.preventDefault(),i.stopPropagation&&i.stopPropagation(),i.cancelBubble=!0}}catch(i){}return n}};u.elementCallback=d,t.addEventListener?t.addEventListener(n,d,i):t.attachEvent&&t.attachEvent("on"+n,d)}else{u.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!o._isDisposed)return r.apply(s,e)}}this._eventRecords.push(u)}},e.prototype.off=function(e,t,n,r){for(var i=0;i<this._eventRecords.length;i++){var o=this._eventRecords[i];if(!(e&&e!==o.target||t&&t!==o.eventName||n&&n!==o.callback||"boolean"==typeof r&&r!==o.options)){var a=o.target.__events__,c=a[o.eventName],s=c?c[this._id]:null;s&&(1!==s.length&&n?(c.count--,s.splice(s.indexOf(o),1)):(c.count-=s.length,delete a[o.eventName][this._id]),c.count||delete a[o.eventName]),o.elementCallback&&(o.target.removeEventListener?o.target.removeEventListener(o.eventName,o.elementCallback,o.options):o.target.detachEvent&&o.target.detachEvent("on"+o.eventName,o.elementCallback)),this._eventRecords.splice(i--,1)}}},e.prototype.raise=function(t,n,r){return e.raise(this._parent,t,n,r)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}()},2811:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return o}));var r=n(44),i=n(2697);n.d(t,"i",(function(){return i.a}));var o=new r.c((function(){return Promise.all([n.e(205),n.e(204),n.e(482)]).then(n.bind(null,5554))})),a=new r.b(o,(function(e){return e.getHasSharingIssues})),c=new r.b(o,(function(e){return e.getSharingLinkCountInBody})),s=new r.b(o,(function(e){return e.getPendingAttachmentString})),u=new r.b(o,(function(e){return e.getSharingIssuesString})),d=new r.b(o,(function(e){return e.getPendingPermissionErrorCode})),l=Object(r.d)(o,(function(e){return e.PendingPermissionsDialog})),f=Object(r.d)(o,(function(e){return e.SharingIssueBlockDialog}))},3930:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_SEND_MESSAGE_SUCCEEDED",(function(e,t,n,r,i,o){return{operation:e,referenceItemId:t,composeId:n,conversationId:r,isGroupViewState:i,clpViewState:o}}))},408:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){var t=r.useRef();return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}},462:function(e,t,n){"use strict";function r(e,t,n){void 0===n&&(n=0);for(var r=-1,i=n;e&&i<e.length;i++)if(t(e[i],i)){r=i;break}return r}function i(e,t){var n=r(e,t);if(!(n<0))return e[n]}function o(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n}function a(e,t){return e.reduce((function(e,n,r){return r%t==0?e.push([n]):e[e.length-1].push(n),e}),[])}function c(e,t){return e.filter((function(e,n){return t!==n}))}function s(e,t,n){var r=e.slice();return r[n]=t,r}function u(e,t,n){var r=e.slice();return r.splice(t,0,n),r}function d(e){var t=[];return e.forEach((function(e){return t=t.concat(e)})),t}function l(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return l}))},463:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n(0),i=n(143),o=n(462);function a(e){return e.reduce((function(e,t){return e+i.h+t.split("").join(i.h)}),i.g)}function c(e,t){var n=t.length,i=Object(r.__spreadArrays)(t).pop(),a=Object(r.__spreadArrays)(e);return Object(o.a)(a,n-1,i)}function s(e){return"["+i.c+'="'+a(e)+'"]'}function u(e){return"["+i.b+'="'+e+'"]'}function d(e){var t=" "+i.f;return e.length?t+" "+a(e):t}},465:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(143),o=n(561),a=function(e){var t,n=e.children,a=Object(r.__rest)(e,["children"]),c=Object(o.a)(a),s=c.keytipId,u=c.ariaDescribedBy;return n(((t={})[i.c]=s,t[i.b]=s,t["aria-describedby"]=u,t))}},502:function(e,t,n){"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter((function(e){return e})).join(" ").trim();return""===n?void 0:n}n.d(t,"a",(function(){return r}))},507:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n(1),i=n(60),o=n(567),a=n(382),c=new WeakMap;function s(e,t){var n,r=c.get(e);return n=r?r+t:1,c.set(e,n),n}function u(e){r.useEffect((function(){var t,n,r=Object(i.a)(null===(t=e)||void 0===t?void 0:t.current);if(r&&!0!==(null===(n=r.FabricConfig)||void 0===n?void 0:n.disableFocusRects)){var o=s(r,1);return o<=1&&(r.addEventListener("mousedown",l,!0),r.addEventListener("pointerdown",f,!0),r.addEventListener("keydown",h,!0)),function(){var e;r&&!0!==(null===(e=r.FabricConfig)||void 0===e?void 0:e.disableFocusRects)&&0===(o=s(r,-1))&&(r.removeEventListener("mousedown",l,!0),r.removeEventListener("pointerdown",f,!0),r.removeEventListener("keydown",h,!0))}}}),[e])}var d=function(e){return u(e.rootRef),null};function l(e){Object(a.b)(!1,e.target)}function f(e){"mouse"!==e.pointerType&&Object(a.b)(!1,e.target)}function h(e){Object(o.b)(e.which)&&Object(a.b)(!0,e.target)}},561:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),i=n(1),o=n(408),a=n(711),c=n(502),s=n(702),u=n(463);function d(e){var t,n,d=i.useRef(),l=e.keytipProps?Object(r.__assign)({disabled:e.disabled},e.keytipProps):void 0,f=Object(o.a)(s.a.getInstance());i.useEffect((function(){return l&&(d.current=f.register(l)),function(){l&&f.unregister(l,d.current)}}),[]);var h=Object(a.a)(e);d.current&&l&&((null===(t=h)||void 0===t?void 0:t.keytipProps)!==e.keytipProps||(null===(n=h)||void 0===n?void 0:n.disabled)!==e.disabled)&&f.update(l,d.current);var p={ariaDescribedBy:void 0,keytipId:void 0};return l&&(p=function(e,t,n){var i=e.addParentOverflow(t),o=Object(c.a)(n,Object(u.a)(i.keySequences)),a=Object(r.__spreadArrays)(i.keySequences);i.overflowSetSequence&&(a=Object(u.d)(a,i.overflowSetSequence));var s=Object(u.e)(a);return{ariaDescribedBy:o,keytipId:s}}(f,l,e.ariaDescribedBy)),p}},567:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r,i=n(63),o=((r={})[i.a.up]=1,r[i.a.down]=1,r[i.a.left]=1,r[i.a.right]=1,r[i.a.home]=1,r[i.a.end]=1,r[i.a.tab]=1,r[i.a.pageUp]=1,r[i.a.pageDown]=1,r);function a(e){return!!o[e]}function c(e){o[e]=1}},701:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),i=n(1),o=n(209),a=n(507),c=n(502),s=n(310),u=n(262),d=n(348),l=n(465),f=Object(o.a)(),h=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o._checkBox=i.createRef(),o._renderContent=function(e,t,n){void 0===n&&(n={});var s=o.props,u=s.disabled,l=s.inputProps,f=s.name,h=s.ariaLabel,p=s.ariaLabelledBy,g=s.ariaDescribedBy,b=s.onRenderLabel,v=void 0===b?o._onRenderLabel:b,m=s.checkmarkIconProps,_=s.ariaPositionInSet,k=s.ariaSetSize,y=s.title,S=s.label;return i.createElement("div",{className:o._classNames.root,title:y},i.createElement(a.a,null),i.createElement("input",Object(r.__assign)({type:"checkbox"},l,{"data-ktp-execute-target":n["data-ktp-execute-target"],checked:e,disabled:u,className:o._classNames.input,ref:o._checkBox,name:f,id:o._id,title:y,onChange:o._onChange,onFocus:o._onFocus,onBlur:o._onBlur,"aria-disabled":u,"aria-label":h||S,"aria-labelledby":p,"aria-describedby":Object(c.a)(g,n["aria-describedby"]),"aria-posinset":_,"aria-setsize":k,"aria-checked":t?"mixed":e?"true":"false"})),i.createElement("label",{className:o._classNames.label,htmlFor:o._id},i.createElement("div",{className:o._classNames.checkbox,"data-ktp-target":n["data-ktp-target"]},i.createElement(d.a,Object(r.__assign)({iconName:"CheckMark"},m,{className:o._classNames.checkmark}))),v(o.props,o._onRenderLabel)))},o._onFocus=function(e){var t=o.props.inputProps;t&&t.onFocus&&t.onFocus(e)},o._onBlur=function(e){var t=o.props.inputProps;t&&t.onBlur&&t.onBlur(e)},o._onChange=function(e){var t=o.props.onChange,n=o.state,r=n.isChecked;n.isIndeterminate?(t&&t(e,r),void 0===o.props.indeterminate&&o.setState({isIndeterminate:!1})):(t&&t(e,!r),void 0===o.props.checked&&o.setState({isChecked:!r}))},o._onRenderLabel=function(e){var t=e.label,n=e.title;return t?i.createElement("span",{"aria-hidden":"true",className:o._classNames.text,title:n},t):null},Object(s.a)(o),o._id=o.props.id||Object(u.a)("checkbox-"),o.state={isChecked:!!(void 0!==t.checked?t.checked:t.defaultChecked),isIndeterminate:!!(void 0!==t.indeterminate?t.indeterminate:t.defaultIndeterminate)},o}return Object(r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n={};return void 0!==e.indeterminate&&(n.isIndeterminate=!!e.indeterminate),void 0!==e.checked&&(n.isChecked=!!e.checked),Object.keys(n).length?n:null},t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.disabled,o=t.boxSide,a=t.theme,c=t.styles,s=t.onRenderLabel,u=void 0===s?this._onRenderLabel:s,d=t.keytipProps,h=this.state,p=h.isChecked,g=h.isIndeterminate;return this._classNames=f(c,{theme:a,className:n,disabled:r,indeterminate:g,checked:p,reversed:"start"!==o,isUsingCustomLabelRender:u!==this._onRenderLabel}),d?i.createElement(l.a,{keytipProps:d,disabled:r},(function(t){return e._renderContent(p,g,t)})):this._renderContent(p,g)},Object.defineProperty(t.prototype,"indeterminate",{get:function(){return!!this.state.isIndeterminate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checked",{get:function(){return!!this.state.isChecked},enumerable:!0,configurable:!0}),t.prototype.focus=function(){this._checkBox.current&&this._checkBox.current.focus()},t.defaultProps={boxSide:"start"},t}(i.Component)},702:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(270),o=n(262),a=n(143),c=function(){function e(){this.keytips={},this.persistedKeytips={},this.sequenceMapping={},this.inKeytipMode=!1,this.shouldEnterKeytipMode=!0,this.delayUpdatingKeytipChange=!1}return e.getInstance=function(){return this._instance},e.prototype.init=function(e){this.delayUpdatingKeytipChange=e},e.prototype.register=function(e,t){void 0===t&&(t=!1);var n=e;t||(n=this.addParentOverflow(e),this.sequenceMapping[n.keySequences.toString()]=n);var r=this._getUniqueKtp(n);if(t?this.persistedKeytips[r.uniqueID]=r:this.keytips[r.uniqueID]=r,this.inKeytipMode||!this.delayUpdatingKeytipChange){var o=t?a.i.PERSISTED_KEYTIP_ADDED:a.i.KEYTIP_ADDED;i.a.raise(this,o,{keytip:n,uniqueID:r.uniqueID})}return r.uniqueID},e.prototype.update=function(e,t){var n=this.addParentOverflow(e),r=this._getUniqueKtp(n,t),o=this.keytips[t];o&&(r.keytip.visible=o.keytip.visible,this.keytips[t]=r,delete this.sequenceMapping[o.keytip.keySequences.toString()],this.sequenceMapping[r.keytip.keySequences.toString()]=r.keytip,!this.inKeytipMode&&this.delayUpdatingKeytipChange||i.a.raise(this,a.i.KEYTIP_UPDATED,{keytip:r.keytip,uniqueID:r.uniqueID}))},e.prototype.unregister=function(e,t,n){void 0===n&&(n=!1),n?delete this.persistedKeytips[t]:delete this.keytips[t],!n&&delete this.sequenceMapping[e.keySequences.toString()];var r=n?a.i.PERSISTED_KEYTIP_REMOVED:a.i.KEYTIP_REMOVED;!this.inKeytipMode&&this.delayUpdatingKeytipChange||i.a.raise(this,r,{keytip:e,uniqueID:t})},e.prototype.enterKeytipMode=function(){i.a.raise(this,a.i.ENTER_KEYTIP_MODE)},e.prototype.exitKeytipMode=function(){i.a.raise(this,a.i.EXIT_KEYTIP_MODE)},e.prototype.getKeytips=function(){var e=this;return Object.keys(this.keytips).map((function(t){return e.keytips[t].keytip}))},e.prototype.addParentOverflow=function(e){var t=Object(r.__spreadArrays)(e.keySequences);if(t.pop(),0!==t.length){var n=this.sequenceMapping[t.toString()];if(n&&n.overflowSetSequence)return Object(r.__assign)(Object(r.__assign)({},e),{overflowSetSequence:n.overflowSetSequence})}return e},e.prototype.menuExecute=function(e,t){i.a.raise(this,a.i.PERSISTED_KEYTIP_EXECUTE,{overflowButtonSequences:e,keytipSequences:t})},e.prototype._getUniqueKtp=function(e,t){return void 0===t&&(t=Object(o.a)()),{keytip:Object(r.__assign)({},e),uniqueID:t}},e._instance=new e,e}()},711:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e})),t.current}}}]);
//# sourceMappingURL=owa.MailBoot~ForgottenAttachments.js.map
self.scriptsLoaded['owa.MailBoot~ForgottenAttachments.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ForgottenAttachments.js'] = (new Date()).getTime();