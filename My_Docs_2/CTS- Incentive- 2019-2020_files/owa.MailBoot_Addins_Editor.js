self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Addins~Editor.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[200],{1006:function(e,t,n){"use strict";var r=n(660),i=n(658),a=n(795),o=n(350);t.a=function(e,t,n){if(!Object(o.a)(n))return!1;var c=typeof t;return!!("number"==c?Object(i.a)(n)&&Object(a.a)(t,n.length):"string"==c&&t in n)&&Object(r.a)(n[t],e)}},1029:function(e,t,n){"use strict";var r=n(995),i=n(1006);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,a=n.length,o=a>1?n[a-1]:void 0,c=a>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(a--,o):void 0,c&&Object(i.a)(n[0],n[1],c)&&(o=a<3?void 0:o,a=1),t=Object(t);++r<a;){var s=n[r];s&&e(t,s,r,o)}return t}))}},1654:function(e,t,n){"use strict";function r(){return{isDragOver:!1,draggableItemType:null}}n.d(t,"a",(function(){return r}))},1658:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(1670),i=n(3),a={tabs:[{id:"primaryTab",type:r.a.Primary,state:2,blink:!1,sxsId:"primaryTab"}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(i.createStore)("tab",a),c=(o(),o().tabs[0])},1670:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat",e[e.SxS=5]="SxS"}(r||(r={}))},1714:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(i||(i={}))},1720:function(e,t,n){"use strict";var r=n(44),i=n(1658),a=n(1896),o=n(0),c=n(1670);function s(e){var t,n,r=Object(i.a)();try{for(var a=Object(o.__values)(r.tabs),s=a.next();!s.done;s=a.next()){var u=s.value;if(u.type!==c.a.Primary&&u.type!==c.a.SxS&&u.data==e)return u}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}function u(e){var t,n,r=Object(i.a)();try{for(var a=Object(o.__values)(r.tabs),c=a.next();!c.done;c=a.next()){var s=c.value;if(s.sxsId===e)return s.id}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}var d=n(2026);function l(e){var t,n,r=function(e){var t=Object(d.a)(e);return t?t.tabId:null}(e);if(r){var a=Object(i.a)();try{for(var c=Object(o.__values)(a.tabs),s=c.next();!s.done;s=c.next()){var u=s.value;if(u.id===r)return u.sxsId}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}}return null}function f(e){var t,n,r,a,s=Object(i.a)();try{for(var u=Object(o.__values)(s.tabs),d=u.next();!d.done;d=u.next()){var l=d.value;if(l.type!==c.a.Primary&&l.type!==c.a.SxS&&(null===(a=null===(r=l.data)||void 0===r?void 0:r.id)||void 0===a?void 0:a.Id)==e)return!0}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return!1}var p=n(1905);n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return g})),n.d(t,"k",(function(){return y})),n.d(t,"j",(function(){return O})),n.d(t,"e",(function(){return i.a})),n.d(t,"l",(function(){return i.b})),n.d(t,"d",(function(){return a.a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"n",(function(){return f})),n.d(t,"a",(function(){return c.a})),n.d(t,"m",(function(){return p.b}));var m=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(36),n.e(55),n.e(168),n.e(174),n.e(271),n.e(757)]).then(n.bind(null,17419))})),b=new r.a(m,(function(e){return e.activateTab})),v=new r.a(m,(function(e){return e.addTab})),g=new r.a(m,(function(e){return e.closeTab})),y=new r.a(m,(function(e){return e.setTabIsShown})),O=new r.b(m,(function(e){return e.getTabById}))},1721:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(0),i=n(1795);function a(e){var t=Object(i.b)(e.EmailAddress,e.DisplayName);return Object(r.__assign)(Object(r.__assign)({},t),{isPendingResolution:!1,persona:e})}t.a=a},1762:function(e,t,n){"use strict";var r=n(16),i=n(3),a={viewStates:new r.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1},o=Object(i.createStore)("compose",a),c=o();n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}))},1768:function(e,t,n){"use strict";var r=n(16),i=n(3),a={folderTable:new r.ObservableMap,rootFolder:null},o=Object(i.createStore)("publicFolderFavoriteStore",a)();t.a=o},1771:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2153),i=n(1817);function a(e){var t=Object(r.a)(),n=Object(i.b)(e);return t.sharingLinks.get(n)}},1781:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(214),i={};function a(e){var t=e.toLocaleLowerCase();if(!i[t]){var n={type:"GroupMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e};i[t]=n}return i[t]}},1794:function(e,t,n){"use strict";function r(e){var t;if("SMTP"===e.RoutingType||void 0===e.RoutingType)return e.EmailAddress;var n="MAPIPDL"===e.RoutingType&&(null===(t=e.ItemId)||void 0===t?void 0:t.Id)||e.EmailAddress;return e.RoutingType+":"+n}n.d(t,"a",(function(){return r}))},1795:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(0),i=n(1915),a=n(1909),o={isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:i.a.None,members:[]};function c(e,t){return Object(r.__assign)(Object(r.__assign)({},o),{isValid:!0,displayText:Object(a.a)(e,t)})}},1817:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(40),i="_ODSPPSL";function a(e){return Object(r.i)("doc-link-savePermission")&&e&&-1!==e.indexOf(i)?e.substring(0,e.length-i.length):e}function o(e){return!!Object(r.i)("doc-link-savePermission")&&e.lastIndexOf(i)===e.length-i.length}function c(e,t){return!Object(r.i)("doc-link-savePermission")||2!==t&&1!==t?e:e+i}},1826:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(44),a=n(2085);function o(e,t,n,o,c){return function(){function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.onImportedCallbacks=[],this.args=e,this.pluginName=n}return s.prototype.initialize=function(e){this.editor=e,this.pendingEvents=[],this.pluginInstance?this.initializeAndCallback():o||this.internalImport()},s.prototype.dispose=function(){this.pluginInstance&&(this.pluginInstance.dispose(),c||(this.pluginInstance=null)),this.editor=null,this.importPluginPromise=null,this.onImportedCallbacks=[]},s.prototype.getName=function(){return this.isImported()?this.pluginInstance.getName():this.pluginName},s.prototype.setPluginUtils=function(e){this.pluginUtils=e,Object(a.a)(this.pluginInstance)&&this.pluginInstance.setPluginUtils(this.pluginUtils)},s.prototype.getContextMenuItems=function(e){var t,n;return this.isImported()?null===(n=(t=this.pluginInstance).getContextMenuItems)||void 0===n?void 0:n.call(t,e):null},s.prototype.onPluginEvent=function(e){this.pluginInstance?this.pluginInstance.onPluginEvent&&this.pluginInstance.onPluginEvent(e):(null==o?void 0:o(e,this.editor))&&this.internalImport(e)},s.prototype.willHandleEventExclusively=function(e){return!(!this.pluginInstance||!this.pluginInstance.willHandleEventExclusively)&&this.pluginInstance.willHandleEventExclusively(e)},s.prototype.getPlugin=function(){return this.pluginInstance?Promise.resolve(this.pluginInstance):this.internalImport()},s.prototype.isImported=function(){return!!this.pluginInstance},s.prototype.addOnImportedCallback=function(e){this.isImported()&&this.editor?e(this.pluginInstance):this.onImportedCallbacks&&this.onImportedCallbacks.push(e)},s.prototype.initializeAndCallback=function(){var e=this;this.pluginInstance.initialize(this.editor),this.onImportedCallbacks.forEach((function(t){return t(e.pluginInstance)}))},s.prototype.internalImport=function(n){var a=this;return this.importPluginPromise||(this.importPluginPromise=new i.b(e,t).import().then((function(e){return a.pluginInstance=new(e.bind.apply(e,Object(r.__spread)([void 0],a.args))),a.setPluginUtils(a.pluginUtils),a.editor&&(a.initializeAndCallback(),a.pendingEvents.length>0&&a.pluginInstance.onPluginEvent&&a.pendingEvents.forEach((function(e){a.pluginInstance.onPluginEvent(e)})),a.pendingEvents=[]),a.pluginInstance})),this.importPluginPromise.catch((function(){a.pendingEvents=[]}))),n&&this.pendingEvents.push(n),this.importPluginPromise},s}()}},1835:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=["\t","\n","\v","\f","\r"," ",""," "," "," "," "," "," "," "," "," "," "," "," "," ","\u2028","\u2029"," "," ","　","؜","​","‌","‍","‎","‏","\u2028","\u2029","‪","‫","‬","‭","‮"," ","⁠","⁦","⁧","⁨","⁩"],i=null,a=function(e){return null===i&&(i=new Set,r.forEach((function(e){return i.add(e)}))),e.split("").every((function(e){return i.has(e)}))}},1837:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(214);function i(e){return{type:"PublicMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e}}},1842:function(e,t,n){"use strict";var r=n(3),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1})();t.a=i},1859:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return p}));var r="SwitchGroup",i="NavigateFromMeToWe",a="GroupHeader_SendEmail_Button_Clicked",o="GroupHeader_Email_Button_Clicked",c="GroupHeader_Files_Button_Clicked",s="GroupHeader_Calendar_Button_Clicked",u="GroupHeader_Notebook_Button_Clicked",d="GroupHeader_Planner_Button_Clicked",l="GroupHeader_Site_Button_Clicked",f="GroupHeader_CustomLeaveGroup_Button_Clicked",p="GroupHeader_Settings_Button_Clicked"},1878:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1883:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"BodyContentType:#Exchange"},e)}},1886:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(0),i=n(1842),a=n(1901);function o(e,t,n,r){return u(l(e),t,n,r)}function c(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a.d.import().then((function(r){return r(e,t,(function(e){return d(n,e,i)}))}))];case 1:return[2,r.sent()]}}))}))}function s(e,t,n,r){return u(e,t,n,r)}function u(e,t,n,r){for(var a=[],o=0;a.length<t&&i.a.recipientCache&&o<i.a.recipientCache.length;){var c=i.a.recipientCache[o];if(e(c))d(n,c.EmailAddress,r)||a.push(c);o++}return a}function d(e,t,n){var r=!1;return e&&function(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}(t,e)&&(r=!0),n&&n.indexOf(t.MailboxType)>=0&&(r=!0),r}var l=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),i=0;i<r.length;i++)if(0==r[i].indexOf(e))return!0}return!1}}},1896:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1670),a=n(1658),o=n(34);function c(){var e,t,n=Object(a.a)();try{for(var c=Object(r.__values)(n.tabs),s=c.next();!s.done;s=c.next()){var u=s.value;if(2==u.state&&u.type!=i.a.FloatingChat)return u}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}return o.d("There is no active tab. Something went very wrong."),null}},1901:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(9),n.e(468)]).then(n.bind(null,2506))})),a=new r.b(i,(function(e){return e.searchCacheTrie})),o=new r.b(i,(function(e){return e.compareFeatureData})),c=new r.a(i,(function(e){return e.initializeSuggestionTrie})),s=new r.a(i,(function(e){return e.isSuggestionTrieEmpty}))},1905:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(1670),i={};function a(e,t){i[r.a[e]]=t}function o(e){return i[r.a[e]]}},1908:function(e,t,n){"use strict";var r=n(40),i=n(1721),a=n(1886),o=function(e){var t=Object(a.c)((function(t){return"SMTP"===t.EmailAddress.RoutingType&&t.EmailAddress.EmailAddress&&t.EmailAddress.EmailAddress.toLowerCase()===e.toLowerCase()}),1);return t.length?t[0]:null},c=n(34),s=function(e){var t=void 0!==e.EmailAddress;return t||c.g.warn("Recipient cache contained a persona that had no EmailAddress"),t};function u(e){if(Object(r.i)("cmp-resolveRecipsFromCache")&&"SMTP"===e.RoutingType&&e.EmailAddress){var t=o(e.EmailAddress);if(t&&s(t))return Object(i.b)(t)}return null}n.d(t,"a",(function(){return u}))},1909:function(e,t,n){"use strict";var r=n(1835),i=n(1794),a=n(296);var o=function(e,t){var n=t||e.Name;if(!n)return!0;var i,o,c=Object(r.a)(n),s=(i=n,o=e.EmailAddress,i==o||i&&o&&i.toLowerCase()==o.toLowerCase()),u=-1!==n.indexOf("@"),d=!Object(a.a)()&&("ExternalMailbox"===e.MailboxType||"LinkedIn"===e.MailboxType),l="OneOff"===e.MailboxType||"Unknown"===e.MailboxType;return e.EmailAddress&&!("SMTP"===e.RoutingType&&s)&&(c||u||d||l)};t.a=function(e,t){var n=t||e.Name,a=!n||Object(r.a)(n);return o(e,t)?a?Object(i.a)(e):n+" <"+Object(i.a)(e)+">":n}},1915:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),t.b=r},1919:function(e,t,n){"use strict";n(1871);var r=n(1781),i=n(3),a=Object(i.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),o=Object(i.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),c=Object(i.action)("MEMBER_MANAGEMENT_SUCCESS",(function(e){return{groupSmtp:e}})),s=Object(i.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),u=Object(i.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),d=Object(i.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),l=n(1859);n.d(t,"m",(function(){return r.a})),n.d(t,"l",(function(){return a})),n.d(t,"j",(function(){return o})),n.d(t,"n",(function(){return c})),n.d(t,"p",(function(){return s})),n.d(t,"o",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return l.g})),n.d(t,"c",(function(){return l.c})),n.d(t,"d",(function(){return l.d})),n.d(t,"a",(function(){return l.a})),n.d(t,"e",(function(){return l.e})),n.d(t,"f",(function(){return l.f})),n.d(t,"i",(function(){return l.i})),n.d(t,"b",(function(){return l.b})),n.d(t,"h",(function(){return l.h}))},2015:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},2026:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(998);function i(e){var t;return null===(t=r.a.projections)||void 0===t?void 0:t.filter((function(t){return t.tabId==e||t.window==e}))[0]}},2049:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},2054:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1641);function i(e){var t=(Object(r.a)(e)||"").toLowerCase();return!!e&&".fluid"===t}},2081:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1654),i=n(1714),a=0;function o(e,t){return{userIdentity:t,recipientWellId:"rw-"+ ++a,queryString:"",recipients:[],isDirty:!1,shouldShowContactPicker:!1,findResultSet:[],findResultType:i.b.None,isSearching:!1,directorySearchType:i.a.None,dropViewState:Object(r.a)(),findPeopleFeedbackManager:e,numberOfCacheResults:0}}},2085:function(e,t,n){"use strict";function r(e){return e&&!!e.setPluginUtils}n.d(t,"a",(function(){return r}))},2094:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o}));var r={};function i(e,t,n){r[e.editorId]={htmlEditor:t,plainTextEditor:n}}function a(e,t,n){var i=r[e.editorId];i&&(i.htmlEditor==t&&(i.htmlEditor=null),i.plainTextEditor==n&&(i.plainTextEditor=null),i.htmlEditor||i.plainTextEditor||delete r[e.editorId])}function o(e,t,n,i){if(e){var a=e.bodyType,o=void 0===a||"HTML"===a,c="Text"===a,s=r[e.editorId]||{},u=s.htmlEditor,d=s.plainTextEditor;o&&t&&(u&&!u.isDisposed()||i)?t(u):c&&n&&(d||i)&&n(d)}}},2153:function(e,t,n){"use strict";var r=n(16),i=n(3),a={sharingLinks:new r.ObservableMap({})},o=Object(i.createStore)("sharingLinkStore",a);t.a=o},2159:function(e,t,n){"use strict";var r=n(28),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return a}))},2168:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},2185:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},2188:function(e,t,n){"use strict";n.d(t,"m",(function(){return a})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return s})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return b})),n.d(t,"r",(function(){return v})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return y})),n.d(t,"j",(function(){return O})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return j})),n.d(t,"a",(function(){return I}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(3),n.e(20),n.e(32),n.e(34),n.e(39),n.e(63),n.e(64),n.e(68),n.e(144),n.e(148),n.e(211),n.e(818)]).then(n.bind(null,3865))})),a=new r.a(i,(function(e){return e.onSmimeItemAttachmentOpened})),o=new r.a(i,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(i,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(i,(function(e){return e.setSmimePropertiesInDraftMessage}))),s=new r.b(i,(function(e){return e.trySetSmimeProperties})),u=new r.b(i,(function(e){return e.tryAddSmimeProperties})),d=new r.b(i,(function(e){return e.createMailResponseBodyContent})),l=new r.b(i,(function(e){return e.downloadSmimeAttachment})),f=new r.b(i,(function(e){return e.getMergedSmimeViewState})),p=new r.b(i,(function(e){return e.getMergedSmimeViewStateForDraft})),m=new r.b(i,(function(e){return e.isSmimeItemDecoding})),b=new r.b(i,(function(e){return e.previewSmimeAttachment})),v=new r.b(i,(function(e){return e.updateSmimeAttachmentIds})),g=new r.b(i,(function(e){return e.createSmimeAttachmentsFromFiles})),y=new r.b(i,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),O=new r.b(i,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),h=new r.b(i,(function(e){return e.getAttachmentsForSmimeResponse})),j=new r.b(i,(function(e){return e.getSmimeAttachmentsForRequest})),I=Object(r.d)(i,(function(e){return e.SignatureDetails}))},2194:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(2280),a=n(2081),o=n(16);function c(e,t,n,c){var s,u,d=Object(a.a)(e,n);if(c&&(d.recipients=Object(o.toJS)(c)),t)try{for(var l=Object(r.__values)(t),f=l.next();!f.done;f=l.next()){var p=f.value;d.recipients.push(Object(i.a)(p))}}catch(e){s={error:e}}finally{try{f&&!f.done&&(u=l.return)&&u.call(l)}finally{if(s)throw s.error}}return d}},2213:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(16),i=n(3),a={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},o=Object(i.createStore)("protection",a),c=o()},2244:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1),i=n(269),a=n(509),o=0;function c(e,t){var n=(t||window).document,c=n.createElement("div");c.id="owa-modal-"+o++,n.body.appendChild(c);var s,u=!1,d=function(){u||(u=!0,i.unmountComponentAtNode(c),n.body.removeChild(c))};return[new Promise((function(t,n){s=n,i.render(r.createElement(a.a,{type:a.b.None,onError:function(){d(),n()}},r.createElement(e,{onDismiss:function(e){d(),t(e)}})),c)})),function(){d(),s()}]}},2268:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateInternetMessageId",(function(e,t,n){return{conversationId:e,itemId:t,internetMessageId:n}}))},2280:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(1795),a=n(1908);function o(e){var t=Object(a.a)(e);if(t)return t;var n=Object(i.b)(e);return Object(r.__assign)(Object(r.__assign)({},n),{isPendingResolution:!0,persona:{EmailAddress:e}})}},2339:function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return I})),n.d(t,"f",(function(){return S})),n.d(t,"d",(function(){return E})),n.d(t,"a",(function(){return P}));var r=n(0),i=n(1864),a=n(1860),o=n(3724),c=n(3128),s=n(4504),u=n(5244),d=n(5525),l=n(2959),f=n(3796),p=n(25),m=n(52),b=n(3209),v=n(3031),g=n(40),y={};function O(e){var t=y[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},y[e.composeId]=t),t}function h(e){var t=y[e.composeId];return t&&!!t.activeSaveAction}function j(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=O(e)).activeSaveAction?[3,1]:[2,Promise.resolve(!0)];case 1:return t.hasPendingSaveAction?[4,t.activeSaveAction]:[3,3];case 2:return n.sent(),[2,Promise.resolve(!1)];case 3:return t.hasPendingSaveAction=!0,[4,t.activeSaveAction];case 4:return n.sent(),t.hasPendingSaveAction=!1,[2,Promise.resolve(!0)]}}))}))}function I(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=O(e)).activeSaveAction=t,[4,t.then((function(e){return n.activeSaveAction=null,Promise.resolve(e)})).catch((function(e){return n.activeSaveAction=null,Promise.reject(e)}))];case 1:return r.sent(),[2]}}))}))}function S(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(null==(t=y[e.composeId])?void 0:t.activeSaveAction)?[4,t.activeSaveAction]:[3,2];case 1:return n.sent(),[2,Promise.resolve(!0)];case 2:return[2,Promise.resolve(!1)]}}))}))}function E(e){var t=y[e.composeId];return t&&!!t.activeSaveAction}function P(e){y[e.composeId]&&delete y[e.composeId]}t.b=Object(m.d)("trySaveMessage",c.b.MailComposeSave)((function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,j(e)];case 1:return r.sent()?e?e.isSending||E(e)?[2,Promise.resolve()]:(t||(Object(a.a)(e,s.a),e.isManuallySaved=!0),Object(a.a)(e,"warningMessageMaxRecipientsExceed"),function(e){return Object(l.a)(e)<=Object(p.a)().MaxRecipientsPerMessage}(e)?[2,I(e,Object(d.b)(e).then((function(n){return e.isSending||(Object(d.a)(n,e),Object(f.a)()&&Object(o.a)(e,t?2:4),Object(b.a)()&&Object(g.i)("cmp-clp-auto-labeling")&&v.g.import().then((function(t){t(e,e.protectionViewState.clpViewState,e.itemId,e.content)}))),Promise.resolve()})).catch((function(r){if(!t&&!e.isSending){var a=Object(u.a)(r?r.message:null,!1);Object(i.a)(e,a)}return n&&!e.isSending?Promise.reject(r):Promise.resolve()})))]:(Object(i.a)(e,"warningMessageMaxRecipientsExceed"),[2,Promise.resolve()])):[2,Promise.reject("could not save message if view state does not exist")]:[2,Promise.resolve()]}}))}))}))},2351:function(e,t,n){"use strict";var r=n(2244);n.d(t,"a",(function(){return r.a}))},2364:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CreateItemRequest:#Exchange"},e)}},2370:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(16),i=n(3),a={legacySignature:{html:null,txt:null},roamingSignatureMap:new r.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""},o=Object(i.createStore)("signature",a),c=o()},2406:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CreateItemJsonRequest:#Exchange"},e)}},2419:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2094),i=n(2499);function a(e){Object(r.b)(e,(function(t){Object(i.a)(e,t.getContent())}),(function(t){Object(i.a)(e,t.value)}))}},2486:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(25),i=n(40);function a(){var e;return(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(i.i)("cmp-proxy-address")}},2499:function(e,t,n){"use strict";var r=n(188),i=n(2963);t.a=Object(r.action)("updateContent")((function(e,t,n){e.content!=t&&(e.content=t,n||Object(i.a)(e,!0))}))},2500:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return s}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(116),n.e(307)]).then(n.bind(null,4295))})),a=new r.a(i,(function(e){return e.getTypeOfAttachment})),o=new r.a(i,(function(e){return e.getAllAttachments})),c=new r.a(i,(function(e){return e.getAttachmentContentHelper})),s=new r.a(i,(function(e){return e.prepareAddinCommunicationInPopout}))},2553:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(5243),i=function(e){return[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]},a=function(e){var t=i(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress.EmailAddress}))},o=function(e){var t=i(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress}))}},2680:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28),i=n(2406);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("CreateItem",e,t)}},2779:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},2959:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(5247);function i(e){var t,n,r;return e.isDirty||(null===(t=e.toRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(n=e.ccRecipientWell)||void 0===n?void 0:n.isDirty)||(null===(r=e.bccRecipientWell)||void 0===r?void 0:r.isDirty)}function a(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}},2963:function(e,t,n){"use strict";var r=n(188);t.a=Object(r.action)("setIsDirty")((function(e,t){e.isDirty=t}))},3031:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(7),n.e(10),n.e(20),n.e(699)]).then(n.bind(null,5910))})),a=new r.a(i,(function(e){return e.loadCLPUserLabels})),o=(new r.a(i,(function(e){return e.addAuditActionToViewState})),new r.b(i,(function(e){return e.showJustificationModal}))),c=new r.a(i,(function(e){return e.loadItemCLPInfo})),s=new r.b(i,(function(e){return e.updateItemCLPInfo})),u=new r.b(i,(function(e){return e.logReadCLPLabel})),d=new r.b(i,(function(e){return e.triggerCLPAutoLabeling})),l=(new r.b(i,(function(e){return e.constructCLPAuditAction})),Object(r.d)(i,(function(e){return e.CLPSubjectHeaderLabel}))),f=Object(r.d)(i,(function(e){return e.CLPMandatoryLabelModal}))},3043:function(e,t,n){"use strict";function r(e){return void 0!==e.publicFolderId}n.d(t,"a",(function(){return r}))},3128:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4503),i=n(3208),a="MailComposeSend";t.b={MailComposeReply:{name:"MailComposeReply",options:{},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeReplyAll:{name:"MailComposeReplyAll",options:{},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeForward:{name:"MailComposeForward",options:{},customData:function(e,t,n,r){return[t]},actionSource:function(e,t,n,r){return t},cosmosOnlyData:function(e,t,n,r){return e&&e.toString()}},MailComposeSendE2E:{name:"MailComposeSendE2E",customData:function(e){return{composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:Object(i.b)(e)}}},MailComposeSave:{name:"MailComposeSave"},MailComposeUpConvert:{name:"MailComposeUpConvert"},ComposeCommandDiscardCompose:{name:"ComposeCommandDiscardCompose",customData:function(e){return{composeTraceId:e.logTraceId}},options:{isCore:!0},cosmosOnlyData:function(e){return JSON.stringify({smartReplyExtractionId:Object(r.a)(e,"smartReply"),smartDocExtractionId:Object(r.a)(e,"smartDoc")})}},ComposeCommandShowFrom:{name:"ComposeCommandShowFrom"},ComposeCommandSetImportance:{name:"ComposeCommmandSetImportance",customData:function(e,t){return[t]}}}},3208:function(e,t,n){"use strict";function r(e){return i(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some((function(e){return e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase()})));var t}function i(e){return!!e.groupId}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},3209:function(e,t,n){"use strict";var r=n(40),i=n(2213),a=n(296);t.a=function(){var e=i.b.clpLabels;return Object(r.i)("cmp-clp")&&e.length>0&&e.some((function(e){return e.isLabelEnabled}))&&!Object(a.a)()}},3333:function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return g}));var r=n(0),i=n(134),a=n(5),o=n(25);function c(e,t){var n=y(e.selectedCLPLabel,"Change"),a=e.originalCLPLabel,o=e.selectedCLPLabel,c=Object(r.__assign)(Object(r.__assign)({},n),{IsLabelChanged:!0,LabelIdBefore:a?a.id:null,IsProtectionChanged:!(!a||!o)&&a.isEncryptingLabel!=o.isEncryptingLabel,ProtectedBefore:null==a?void 0:a.isEncryptingLabel,UserJustification:t});i.m.importAndExecute(c)}function s(e){var t=y(e,"Discover");i.m.importAndExecute(t)}function u(e){(null==e?void 0:e.value)&&e.value.length>0&&Object(i.r)("LoadCLPLabelOnBoot",{labelCount:e.value.length})}function d(e){e&&Object(i.r)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function l(e,t){t&&e?Object(i.r)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(i.r)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function f(e){401!=e.status&&Object(i.r)("CLPAutoLabelEnabled")}function p(){Object(i.r)("CLPMandatoryLabelDialogShown")}function m(){Object(i.r)("CLPAutoLabelAutomaticApplied")}function b(){Object(i.r)("CLPAutoLabelRecommendedShown")}function v(){Object(i.r)("CLPAutoLabelRecommendedApplied")}function g(){Object(i.r)("CLPAutoLabelRecommendedDismissed")}function y(e,t){var n=Object(o.a)().SessionSettings,r=n.ExternalDirectoryTenantGuid,i=n.UserEmailAddress;return{CreationTime:Object(a.tb)(Object(a.Pb)()),Version:"1.1",Operation:t,OrganizationId:r,UserId:i,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},3492:function(e,t,n){"use strict";function r(e){return e.policyMatchDetails.slice().sort((function(e,t){var n=i(t.Action)-i(e.Action);return 0==n?null==e.MatchPriority?null==t.MatchPriority?n:1:null==t.MatchPriority?-1:e.MatchPriority-t.MatchPriority:n}))[0]}function i(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}n.d(t,"a",(function(){return r}))},3493:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1878),i=n(785),a=n(2049);function o(e,t){var n;return Object(a.a)({Path:Object(i.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},3644:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25);function i(){return Object(r.a)().SessionSettings.UserEmailAddress}},3645:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){var t,n,i=[];if(null==e?void 0:e.recipients)try{for(var a=Object(r.__values)(e.recipients),o=a.next();!o.done;o=a.next()){var c=o.value,s=c.persona.EmailAddress;(null==s?void 0:s.ItemId)&&"PrivateDL"==s.MailboxType?i.push({Name:s.Name,RoutingType:s.RoutingType,MailboxType:s.MailboxType,ItemId:{Id:s.ItemId.Id,ChangeKey:null},EmailAddressIndex:s.EmailAddressIndex,RelevanceScore:s.RelevanceScore||0}):i.push(c.persona.EmailAddress)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}},3646:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1771),i=n(2054),a=n(40);function o(e){var t=[];return null==e||e.forEach((function(e){var n=Object(r.a)(e),o=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(n.permissionLevel),c=Object(a.i)("cmp-prague")&&function(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}(o)&&Object(i.a)(n.fileName);if(1===o||2===o||c){var s={ProviderType:"OneDrivePro",Url:n.url,PermissionType:o};t.push(s)}})),t}},3647:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Manual="manual",e.Automatic="automatic",e.Default="default"}(r||(r={}))},3648:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25);function i(e){return e===Object(r.a)().SessionSettings.UserEmailAddress}},3724:function(e,t,n){"use strict";var r=n(7),i=n(5242),a=n(1864),o=n(916),c=n(28),s=n(0);function u(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(s.__assign)({__type:"GetDlpPolicyTipsRequest:#Exchange"},n)),Object(c.a)("GetDlpPolicyTips",e,t)}var d=n(296),l=n(1860),f=n(188),p=n(2553),m=n(3492),b=n(34);n.d(t,"b",(function(){return O}));var v=Object(f.action)("triggerPolicyTips")((function(e,t,n,r,a){var o,c=e.policyTipsViewState;if(!(c.handlerDisabled||(null===(o=e.protectionViewState)||void 0===o?void 0:o.IRMData))){var s,d=c.inProgressPolicyMatch,f=c.succeededPolicyMatch,m=c.pendingPolicyMatch;if(n||(n=h(e.subject)),r||(r=h(e.content)),a||(a=Object(i.a)(e)),c.isRequestInProgress)c.pendingRequests=!0,m.itemId=e.itemId,m.subjectChecksum=n,m.contentChecksum=r,m.eventTrigger=t,m.attachmentIds=a;else{if(c.pendingRequests=!1,d.itemId=e.itemId,d.subjectChecksum=n,d.contentChecksum=r,d.eventTrigger=t,d.attachmentIds=a,0==(s=d).subjectChecksum&&0==s.contentChecksum&&0==s.attachmentIds.length)return f.policyMatchDetails=[],f.subjectChecksum=0,f.contentChecksum=0,f.attachmentIds=[],void Object(l.a)(e,"dlpPolicyTips");(j(d,f)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(var n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(d,f)||1==t)&&function(e){var t=e.policyTipsViewState,n=t.succeededPolicyMatch,r=t.inProgressPolicyMatch,i=e.itemId;if(null==i?void 0:i.Id){var a={ItemId:i,ClientSupportsScanResultData:!0,ScanResultData:n.scanResultData,ScanResultMetadata:n.scanResultMetaData,BodyOrSubjectChanged:j(r,n),NeedToReclassify:!n.itemId,CustomizedStringsNeeded:!0,Recipients:Object(p.a)(e),EventTrigger:r.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,u(a).then((function(t){!function(e,t,n,r){var i=t.policyTipsViewState,a=i.pendingPolicyMatch;i.isRequestInProgress=!1,i.pendingRequests&&a&&v(t,a.eventTrigger,a.subjectChecksum,a.contentChecksum,a.attachmentIds);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,g,y)}))}}(e)}}}));t.a=v;function g(e,t){var n=e.policyTipsViewState,r=n.succeededPolicyMatch,i=n.inProgressPolicyMatch;r.itemId=i.itemId,r.attachmentIds=i.attachmentIds,r.subjectChecksum=i.subjectChecksum,r.contentChecksum=i.contentChecksum,r.policyMatchDetails=t.Matches,t.ScanResultData&&(r.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(r.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(n.handlerDisabled=!0),function(e,t){if(t){var n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString};Object(o.a)(n,r,(function(e,t){return t||e}))}}(e,t.CustomizedStrings),O(e)}function y(e,t){var n=e.policyTipsViewState;t?(b.g.warn(Object(r.c)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(b.g.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(b.g.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(l.a)(e,"dlpPolicyTips")}function O(e){Object(l.a)(e,["consumerDlpPolicyTips","enterpriseDlpPolicyTips"]),Object(m.a)(e.policyTipsViewState.succeededPolicyMatch)&&(Object(d.a)()?Object(a.a)(e,"consumerDlpPolicyTips"):Object(a.a)(e,"enterpriseDlpPolicyTips"))}function h(e){var t=0;if(e)for(var n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function j(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}},3795:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(790),i=n(890),a=n(785),o=n(994),c=n(900),s=n(40),u=n(4507);function d(e){var t=Object(r.a)({BaseShape:"IdOnly",ClientSupportsIrm:!0,FilterHtmlContent:!0,InlineImageCustomDataTemplate:i.e,InlineImageUrlOnLoadTemplate:"",InlineImageUrlTemplate:i.f,AdditionalProperties:[Object(a.a)({FieldURI:"ItemLastModifiedTime"})]});return Object(u.a)(t),e&&(t.BodyType=e),t.ImageProxyCapability=Object(s.i)("rp-replyImageProxy")&&Object(o.a)()?c.a.OwaConnectorsProxyAndCompose:c.a.None,t}},3796:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25);function i(){return Object(r.a)().PolicyTipsEnabled}},3886:function(e,t,n){"use strict";var r=n(4505),i=n(3644),a=n(989),o=n(25),c=n(296);var s=n(4861);function u(){var e,t,n=(e=Object(o.a)(),t=Object(c.a)()?e.SessionSettings.DefaultFromAddress:e.UserOptions.SendAddressDefault,Object(a.c)(t)?t:Object(i.a)()),u=Object(i.a)();if(u===n&&Object(s.a)(n)){var d=Object(r.b)(u,!0);if(d&&d.length>0)return d[0]}return n}var d=n(5694),l=n(1640);function f(e){var t;if(e){var n=Object(l.g)(),r=null==n?void 0:n.items,i=r&&r.has(e.Id)&&r.get(e.Id);t=i&&Object(d.a)(i.ToRecipients,i.CcRecipients)}return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t||u(),Name:Object(o.a)().SessionSettings.UserDisplayName}}n.d(t,"a",(function(){return f}))},4200:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(25);function i(e,t){return e===t||e&&t&&e.toLowerCase()==t.toLowerCase()}function a(e){return e&&i(e.EmailAddress,Object(r.a)().SessionSettings.UserEmailAddress)}},4201:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r="<div id=appendonsend></div>";function i(e){var t="";return"HTML"==e&&(t+=r),t}},4202:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return c}));var r="msip_labels",i="X-MS-Exchange-Organization-ModifySensitivityLabel",a="00000000-0000-0000-0000-000000000000",o="Standard",c="Privileged"},4203:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r={Name:{id:34230,propertyType:"String"},Description:{id:34231,propertyType:"String"},Id:{id:34232,propertyType:"String"},IsClassified:{id:34229,propertyType:"Boolean"}},i="messageClassification"},4210:function(e,t,n){"use strict";var r=n(188);t.a=Object(r.action)("setIsDirty")((function(e,t){void 0===t&&(t=!0),e.isDirty=t}))},4503:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1640);function i(e,t){var n,i,a,o="";if(e){var c=r.u.items.get(null===(n=e.referenceItemId)||void 0===n?void 0:n.Id);switch(t){case"smartReply":(null===(i=null==c?void 0:c.SmartReplyData)||void 0===i?void 0:i.ExtractionID)&&(o=c.SmartReplyData.ExtractionID);break;case"smartDoc":(null===(a=null==c?void 0:c.SmartDocData)||void 0===a?void 0:a.EntityId)&&(o=c.SmartDocData.EntityId)}}return o}},4504:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","errorMessageInvalidSenderMailCanNotBeSend","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail","smimeEncodeError","smimeBccForkingFailedError"]},4505:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(3644),i=n(4861),a=n(25),o=n(296);function c(e){var t=[],n=Object(r.a)();Object(i.a)(n)||t.push(n);var o=s(n,e);return t=function(e){var t=Object(a.a)().SessionSettings.ConnectedAccountInfos;t&&t.length>0&&t.forEach((function(t){-1==e.lastIndexOf(t.EmailAddress)&&e.push(t.EmailAddress)}));return e}(t=t.concat(o))}function s(e,t){var n=[];if(Object(o.a)()||t){var r=function(e){return u(e,Object(a.a)().SessionSettings.UserProxyAddresses)}(e);n=n.concat(r)}if(Object(o.a)()){var i=function(e){return u(e,Object(a.a)().SessionSettings.NotManagedEmailAddresses)}(e);n=n.concat(i)}return n}function u(e,t){var n=[];return t&&t.length>0&&t.forEach((function(t){e==t||Object(i.a)(t)||n.push(t)})),n}},4507:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(40),i=n(454);function a(e){var t;Object(r.i)("cmp-clp")&&(null===(t=e.AdditionalProperties)||void 0===t||t.push(Object(i.a)({PropertyName:"msip_labels",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})))}},4508:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(826),i=n(454),a=n(1878),o=n(2049);function c(e){return Object(o.a)({Path:Object(i.a)(e.ExtendedFieldURI),Item:Object(a.a)({ExtendedProperty:[Object(r.a)(e)]})})}},4861:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(25),i=n(296);function a(e){var t=!1;if(Object(i.a)()){var n=Object(r.a)();t=0==(e=e.toLowerCase()).indexOf("outlook_"+n.HexCID)||-1!=e.indexOf("@shadow.outlook.com")}return t}},4862:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(1826),i=n(44),a=new i.c((function(){return Promise.all([n.e(0),n.e(6),n.e(34),n.e(39),n.e(40),n.e(245),n.e(603)]).then(n.bind(null,7684))})),o=Object(r.a)(a,(function(e){return e.AtMentionPickerPlugin}),"AtMentionsPicker",(function(e){return 11==e.eventType})),c=new i.b(a,(function(e){return e.loadAtMentionsData}))},506:function(e,t,n){"use strict";var r=n(809),i=n(796);t.a=function(e,t,n,a){var o=!n;n||(n={});for(var c=-1,s=t.length;++c<s;){var u=t[c],d=a?a(n[u],e[u],u,n,e):void 0;void 0===d&&(d=e[u]),o?Object(i.a)(n,u,d):Object(r.a)(n,u,d)}return n}},5060:function(e,t,n){"use strict";var r=n(0),i=n(3795),a=n(40),o=n(1837),c=n(1768),s=n(25),u=n(2364),d=n(559),l=n(790),f=n(785),p=n(793),m=n(2680),b=n(197),v=n(2185),g=n(347);function y(e,t,n,y,O,h,j,I,S){var E,P,M=function(e,t,n,o,c,s,m,b,g){var y="PostItem:#Exchange"==e.__type?"newPost":"newMail",O=m?Object(p.a)({BaseFolderId:Object(d.a)({Id:m})}):null,h=Object(u.a)(Object(r.__assign)({ClientSupportsIrm:!0,ComposeOperation:y,MessageDisposition:n?"SendAndSaveCopy":"SaveOnly",Items:[e],TimeFormat:o,SendOnNotFoundError:!0,RemoteExecute:b,ItemShape:Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(f.a)({FieldURI:"ItemLastModifiedTime"})]}),SavedItemFolderId:null!=O?O:void 0,SuppressMarkAsReadOnReplyOrForward:Object(a.i)("tri-suppressMarkReadBehaviorOnRF")&&g},Object(v.a)()));return(null==s?void 0:s.IsOwner)&&(h.ComplianceId=s.RmsTemplateId?s.RmsTemplateId.toUpperCase():"0"),n?c&&h.ItemShape&&(h.ItemShape.ReturnOnlyInternetMessageId=!0):(h.ItemShape=Object(i.a)(t),h.ShapeName="MailCompose"),h}(e,t,n,y,O,h,j,I,S);if("PostItem:#Exchange"==e.__type&&j){var C=c.a.folderTable.get(j);if(C){var R=C.ReplicaList?C.ReplicaList[0]:null===(E=Object(s.a)().SessionSettings)||void 0===E?void 0:E.DefaultPublicFolderMailbox;if(R){var x=Object(o.a)(R);P=Object(g.a)(x)}}}return Object(m.a)({Header:Object(b.b)(),Body:M},P).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}n.d(t,"a",(function(){return y}))},509:function(e,t,n){"use strict";var r,i=n(0),a=n(1),o=n(692),c=n(34);!function(e){e[e.Full=0]="Full",e[e.Simple=1]="Simple",e[e.None=2]="None"}(r||(r={}));var s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return Object(i.__extends)(t,e),t.prototype.componentDidCatch=function(e,t){var n,r;null===(r=(n=this.props).onError)||void 0===r||r.call(n,e,t),this.props.suppressErrorReport||(e.component=!0,e.diagnosticInfo=(e.diagnosticInfo||"")+t.componentStack,Object(c.d)(e)),this.setState({error:e})},t.prototype.render=function(){var e=this.state.error,t=this.props,n=t.children,o=t.type,c=t.windowIcons;if(e){if(o==r.None)return null;if(o==r.Simple||!this.props.fullErrorComponent)return a.createElement("div",null,e);var s=this.props.fullErrorComponent;return a.createElement(s,Object(i.__assign)({error:e,windowIcons:c},this.props.fullErrorComponentProps))}return n},t=Object(i.__decorate)([o.observer],t)}(a.Component);n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}))},5242:function(e,t,n){"use strict";function r(e){var t=[],n=e.attachmentWell;return n&&(n.docViewAttachments.forEach((function(e){t.push(e.attachmentId)})),n.inlineAttachments.forEach((function(e){t.push(e.attachmentId)})),n.imageViewAttachments.forEach((function(e){t.push(e.attachmentId)}))),t}n.d(t,"a",(function(){return r}))},5243:function(e,t,n){"use strict";var r=n(0);t.a=function(e){return e&&0!==e.length?e.filter((function(e){return!!e})).reduce((function(e,t){return Object(r.__spread)(e,(null==(n=t)?void 0:n.recipients)?n.recipients.slice():[]);var n}),[]):[]}},5244:function(e,t,n){"use strict";function r(e,t){if(e){if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch"}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"SmimeEncodeError":return"smimeEncodeError";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}n.d(t,"a",(function(){return r}))},5245:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(374);function i(e){return e?Object(r.a)({Id:e.Id,ChangeKey:e.ChangeKey}):null}},5246:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(678)]).then(n.bind(null,9590))})),a=Object(r.d)(i,(function(e){return e.HipCheckModal}))},5247:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.recipients)?e.recipients.length:0}n.d(t,"a",(function(){return r}))},5252:function(e,t,n){"use strict";var r=n(2194),i=n(3);t.a=Object(i.mutatorAction)("showCcWell",(function(e){e.ccRecipientWell||(e.ccRecipientWell=Object(r.a)(e.toRecipientWell.findPeopleFeedbackManager,[]))}))},528:function(e,t,n){"use strict";(function(e){var r=n(612),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=a&&a.exports===i&&r.a.process,c=function(){try{var e=a&&a.require&&a.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();t.a=c}).call(this,n(878)(e))},5525:function(e,t,n){"use strict";var r=n(0),i=n(5245),a=n(2486),o=n(3886),c=n(3645),s=n(4506),u=n(5695);var d=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,\\s*[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");function l(e){var t=0;if(e){var n=e.match(d);t=n?n.length:0}return t}var f=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),p=new RegExp('\\sSRC\\s*=\\s*"DATA:[\\s\\S]+?"',"im"),m=new RegExp('\\sORIGINALSRC\\s*=\\s*"',"im");function b(e,t){return e?e.replace(f,(function(e){return e=e.replace(p,""),t&&(e=e.replace(m,' src="')),e})):e}var v=n(25),g=n(2935),y=n(826),O=n(454),h=35356;var j=n(5),I="0x3FEF";function S(e,t){if(t.ExtendedProperty)for(var n=e.length;n--&&t.ExtendedProperty.length>0;)for(var r=t.ExtendedProperty.length;r--;)if(e[n]===t.ExtendedProperty[r].ExtendedFieldURI.PropertyName){t.ExtendedProperty.splice(r,1);break}}function E(e,t,n){var r,i;n?S(["AppendOnSend"],t):e.appendOnSend&&e.appendOnSend.length>0&&(r=e.appendOnSend,(i=t).ExtendedProperty||(i.ExtendedProperty=[]),i.ExtendedProperty.push(Object(y.a)({Value:JSON.stringify(r),ExtendedFieldURI:Object(O.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})})))}function P(e,t){e.internetHeaders.size>0&&function(e,t){var n,i;t.ExtendedProperty||(t.ExtendedProperty=[]);try{for(var a=Object(r.__values)(e.keys()),o=a.next();!o.done;o=a.next()){var c=o.value;t.ExtendedProperty.push(Object(y.a)({Value:e.get(c),ExtendedFieldURI:Object(O.a)({DistinguishedPropertySetId:"InternetHeaders",PropertyName:c,PropertyType:"String"})}))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(e.internetHeaders,t),e.keysOfInternetHeadersToBeRemoved.length>0&&S(e.keysOfInternetHeadersToBeRemoved,t)}function M(e,t,n){n?S(["ComposeType"],t):null!==e.draftComposeType&&function(e,t){t.ExtendedProperty||(t.ExtendedProperty=[]);t.ExtendedProperty.push(Object(y.a)({Value:e,ExtendedFieldURI:Object(O.a)({DistinguishedPropertySetId:"Common",PropertyName:"ComposeType",PropertyType:"String"})}))}(e.draftComposeType,t)}var C=n(3208),R=n(5696),x=n(3),_=Object(x.mutatorAction)("clearKeysOfInternetHeadersToBeRemoved",(function(e){e.keysOfInternetHeadersToBeRemoved=[]})),w=n(374),T=n(188);function A(e){e&&(e.isDirty=!1)}var k=Object(T.action)("updateComposeItemId")((function(e,t,n,r){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=Object(w.a)({Id:t,ChangeKey:n}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,A(e.toRecipientWell),A(e.ccRecipientWell),A(e.bccRecipientWell)))})),D=n(2268),L=n(4201),N=n(1760),F=n(40),U=n(1644),B=n(1919),V=n(3646),G=n(7),H=n(3647),W=n(4202),q=function(e){switch(e.labelApplyMethod){case H.a.Manual:return W.d;case H.a.Default:case H.a.Automatic:default:return W.e}},z=n(3333),J="MSIP_Label";function Q(e){var t=e.selectedCLPLabel,n=e.nonTenantLabelString,r=Object(v.a)().SessionSettings.ExternalDirectoryTenantGuid,i="";t&&(i=function(e,t){return Object.keys(e).map((function(n){return J+"_"+t.id+"_"+n+"="+e[n]+";"})).join("")}({Enabled:"True",SiteId:r,SetDate:Object(j.tb)(Object(j.Pb)()),Name:t.displayName,ContentBits:0,Method:q(e)},t));return n?n+i:i}function K(e){var t=e.selectedCLPLabel,n=e.originalCLPLabel;if(t||n){var r=t&&!n&&t.isDefault;if(!t||!n||t.id!=n.id||n.isDefault)return(n&&!r?n.id:W.a)+";"+(t?t.id:W.a)}}function $(e,t,n){var r=Object(y.a)({ExtendedFieldURI:Object(O.a)({PropertyName:e,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:t});n.ExtendedProperty?n.ExtendedProperty.push(r):n.ExtendedProperty=[r]}var X=n(3043),Z=n(1686),Y=n(4203);var ee=n(5060),te=n(5937),ne=n(1701),re=n(790);var ie=n(785),ae=n(28);function oe(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"PostGroupItemJsonRequest:#Exchange"},n)),Object(ae.a)("PostGroupItem",e,t)}var ce=n(197),se=n(2185);function ue(e,t,n,i,a,o){var c,s=(c=Object(r.__assign)({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",Items:[t],TimeFormat:i,ItemShape:Object(re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ie.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(se.a)()),Object(r.__assign)({__type:"PostGroupItemRequest:#Exchange"},c));return o&&(s.ItemShape.ReturnOnlyInternetMessageId=!0),(null==a?void 0:a.IsOwner)&&(s.ComplianceId=a.RmsTemplateId?a.RmsTemplateId.toUpperCase():"0"),s}function de(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"PostUnifiedGroupItemJsonRequest:#Exchange"},n)),Object(ae.a)("PostUnifiedGroupItem",e,t)}function le(e,t,n,i,a){var o,c=(o={ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},SkipGroupSyncDelivery:!0,ClientSupportsIrm:!0,Item:t,ItemShape:Object(re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ie.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(r.__assign)({__type:"PostUnifiedGroupItemRequest:#Exchange"},o));return a&&(c.ItemShape.ReturnOnlyInternetMessageId=!0),c}var fe=n(4508),pe=n(3493),me=n(2779);function be(e,t){return Object(me.a)({Path:Object(O.a)({DistinguishedPropertySetId:e,PropertyName:t,PropertyType:"String"})})}var ve=n(2015),ge=n(2168),ye=n(2159);function Oe(e,t,n,i){var a=function(e,t,n,i){var a,o=[];e.MimeContent&&o.push(Object(pe.a)("MimeContent",e.MimeContent));var c=[Object(pe.a)("ToRecipients",e.ToRecipients),Object(pe.a)("CcRecipients",e.CcRecipients),Object(pe.a)("BccRecipients",e.BccRecipients),Object(pe.a)("Subject",e.Subject),Object(pe.a)("Body",e.Body),Object(pe.a)("Importance",e.Importance),Object(pe.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(pe.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];(null===(a=e.Attachments)||void 0===a?void 0:a.length)&&c.push(Object(pe.a)("Attachments",e.Attachments)),e.ItemClass&&c.push(Object(pe.a)("ItemClass",e.ItemClass)),e.From&&c.push(Object(pe.a)("From",e.From)),i.length>0&&i.map((function(e){c.push(be("InternetHeaders",e))})),t&&c.push(be("Common","AppendOnSend")),e.MentionsEx&&c.push(Object(pe.a)("MentionsEx",e.MentionsEx)),e.Sensitivity&&c.push(Object(pe.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map((function(e){c.push(Object(fe.a)(e))})),t&&e.DocLinks&&e.DocLinks.length>0&&c.push(Object(pe.a)("DocLinks",e.DocLinks));var s=Object(ve.a)({Updates:Object(r.__spread)(o,c),ItemId:Object(w.a)({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),u=Object(ge.a)(Object(r.__assign)({ItemChanges:[s],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:Object(re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ie.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(se.a)()));return(null==n?void 0:n.IsOwner)&&(u.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),u}(e,t,n,i);return Object(ye.a)({Header:Object(ce.b)(),Body:a}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}var he=n(1693),je=n(1638),Ie="InternetHeaders",Se="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification",Ee="X-Ms-Exchange-Organization-Dlp-FalsePositive";var Pe=n(2213);function Me(e){if(!e)return null;var t=e.IRMData;return!t||t.RmsTemplateId&&!Pe.b.rmsTemplates.get(t.RmsTemplateId)?null:t}function Ce(e){return Object(r.__assign)({__type:"ApproveRequestItem:#Exchange"},e)}var Re=n(1883),xe=n(1878);function _e(e){return Object(r.__assign)({__type:"RejectRequestItem:#Exchange"},e)}var we=n(5697),Te=n(5698),Ae=n(296),ke=n(2876),De=n(2807),Le=n(2025),Ne=n(4862),Fe=n(3648),Ue="X-MS-Exchange-Organization-ClientSubmitSmtp-OriginalFrom";var Be=n(2188),Ve={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timeFormat"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"timeFormat"},value:{kind:"Variable",name:{kind:"Name",value:"timeFormat"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"Body"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"},arguments:[],directives:[]}]}}]}}]}}]},Ge=n(380),He=n(105);function We(e,t){return{ToRecipients:e.ToRecipients,CcRecipients:e.CcRecipients,BccRecipients:e.BccRecipients,Subject:e.Subject,Body:{Value:e.Body.Value,DataUriCount:e.Body.DataUriCount,BodyType:e.Body.BodyType},Importance:e.Importance,IsReadReceiptRequested:e.IsReadReceiptRequested,IsDeliveryReceiptRequested:e.IsDeliveryReceiptRequested,UpdateResponseItemId:e.UpdateResponseItemId,ReferenceItemId:e.ReferenceItemId,ReferenceItemDocumentId:e.ReferenceItemDocumentId,atMentionedRecipients:ze(t),recipientsAddedViaAtMention:t.mentionsPicker.mentionsAddedRecipients,connectedAccountSharingGuid:Je(t),deferredSendTime:t.deferredSendTime?Object(j.tb)(t.deferredSendTime):void 0,clpLabelModifificationHeader:K(t.protectionViewState.clpViewState),clpLabelProperty:Q(t.protectionViewState.clpViewState),messageClassification:Qe(t),originalSmtpFromAddress:Ke(t),operation:qe(t.operation)}}function qe(e){switch(e){case 0:return"New";case 1:return"Reply";case 2:return"ReplyAll";case 3:return"Forward";case 4:case 5:case 6:return Object(He.a)(e)}}function ze(e){var t=e.mentionsPicker.atMentionTuples;return t?Object.keys(t).map((function(e){return{key:e,emailAddress:t[e].EmailAddress}})):[]}function Je(e){var t=e.fromViewState.from,n=Object(v.a)().SessionSettings.ConnectedAccountInfos;if(n)for(var r=0;r<n.length;r++){var i=n[r];if(i.EmailAddress==t.email.EmailAddress)return i.SubscriptionGuid}}function Qe(e){var t=e.protectionViewState.classificationViewState;return t.messageClassification?Object(r.__assign)(Object(r.__assign)({},t.messageClassification),{isClassified:!0}):void 0}function Ke(e){var t,n,r,i=null===(r=null===(n=null===(t=e.fromViewState)||void 0===t?void 0:t.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(i&&!Object(Fe.a)(i))return i}var $e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SaveDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"Body"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"},arguments:[],directives:[]}]}}]}}]}}]},Xe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SendDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"Body"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"},arguments:[],directives:[]}]}}]}}]}}]};var Ze=n(347);n.d(t,"c",(function(){return ot})),n.d(t,"b",(function(){return ct})),n.d(t,"a",(function(){return st}));var Ye='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',et="IPM.Note";function tt(e){var t=e.content,n=0;if("HTML"==e.bodyType){var i=ut(e);n=l(t=b(t)),t=Object(G.c)(Ye,i,t)}var a,o=Object(Re.a)({BodyType:e.bodyType,Value:t});o.DataUriCount=n;var c,s={Subject:e.subject||"",Importance:e.importance,Sensitivity:e.sensitivity};return c=Object(r.__assign)(Object(r.__assign)({},s),{Body:o}),a=Object(r.__assign)({__type:"PostItem:#Exchange"},c),e.itemId&&(a.ItemId=e.itemId),e.fromViewState&&function(e,t){var n=e.from;t.From=Object(g.a)({Mailbox:n.email})}(e.fromViewState,a),a}var nt=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(De.a)(e.smimeViewState)?[2,null]:[4,N.h.import()];case 1:return(null==(t=r.sent()(e.attachmentWell,e.content,e.bodyType,!0))?void 0:t.length)?[4,Be.i.import()]:[3,3];case 2:return n=r.sent()(t),[3,4];case 3:n=null,r.label=4;case 4:return[2,n]}}))}))};function rt(e){var t=e.content,n=0,a=Object(De.a)(e.smimeViewState);if(e.useSmartResponse&&(t+=Object(L.a)(e.bodyType)),"HTML"==e.bodyType){var o=ut(e);n=l(t=b(t,a)),t=Object(G.c)(Ye,o,t)}var s=Object(Re.a)({BodyType:e.bodyType,Value:t});s.DataUriCount=n;var u,d=Object(i.a)(e.itemId),f=Object(i.a)(e.referenceItemId),p=[],m=[],S=[];if(e.smimeViewState&&0!=e.smimeViewState.smimeBccForkingMode)switch(e.smimeViewState.smimeBccForkingMode){case 1:p=Object(c.a)(e.toRecipientWell),m=Object(c.a)(e.ccRecipientWell);break;case 2:if(e.bccRecipientWell){var E=e.smimeViewState.currentBccRecipientIndex;S=[Object(c.a)(e.bccRecipientWell)[E]]}break;case 3:e.bccRecipientWell&&(S=Object(c.a)(e.bccRecipientWell))}else p=Object(c.a)(e.toRecipientWell),m=Object(c.a)(e.ccRecipientWell),S=Object(c.a)(e.bccRecipientWell);var P={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:p,CcRecipients:m,BccRecipients:S,Sensitivity:e.sensitivity};return e.useSmartResponse?u=(2==e.operation?we.a:Te.a)(Object(r.__assign)(Object(r.__assign)({},P),{UpdateResponseItemId:d,ReferenceItemId:f,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:s})):5==e.operation||6==e.operation?u=(5==e.operation?Ce:_e)(Object(r.__assign)(Object(r.__assign)({},P),{ReferenceItemId:f,ItemId:d,Body:s})):(u=Object(xe.a)(Object(r.__assign)(Object(r.__assign)({},P),{Body:s})),e.itemId&&(u.ItemId=e.itemId)),e.fromViewState&&function(e,t){var n=e.from;if(n){var r=!1,i=Object(v.a)().SessionSettings.ConnectedAccountInfos;if(i)for(var a=0;a<i.length;a++){var o=i[a];if(o.EmailAddress==n.email.EmailAddress){r=!0;var c=Object(y.a)({Value:o.SubscriptionGuid,ExtendedFieldURI:Object(O.a)({PropertyId:h,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(c):t.ExtendedProperty=[c],t.From=Object(g.a)({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:o.DisplayName}});break}}r||(t.From=Object(g.a)({Mailbox:n.email}))}}(e.fromViewState,u),e.deferredSendTime&&function(e,t){if(e){var n=Object(y.a)({Value:Object(j.tb)(e),ExtendedFieldURI:Object(O.a)({PropertyTag:I,PropertyType:"SystemTime"})});t.ExtendedProperty?t.ExtendedProperty.push(n):t.ExtendedProperty=[n]}}(e.deferredSendTime,u),u}function it(e,t){var n,i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l,f,p,m,b,g,h,j,I,S,x,w;return Object(r.__generator)(this,(function(T){switch(T.label){case 0:return f=Object(v.a)().UserOptions.TimeFormat,Object(X.a)(e)?(p=e,d=tt(e),[4,Object(ee.a)(d,e.bodyType,t,f,e.isInlineCompose,Me(e.protectionViewState),p.publicFolderId)]):[3,2];case 1:return l=T.sent(),[3,14];case 2:return d=rt(e),m=d,[4,nt(e)];case 3:return m.Attachments=T.sent(),P(e.addin,d),E(e.addin,d,t),M(e.addin,d,t),b=e.protectionViewState,Object(F.i)("cmp-clp")&&!Object(C.a)(e)&&function(e,t){var n=e.selectedCLPLabel,r=e.nonTenantLabelString,i=K(e);if(i&&$(W.b,i,t),n||r){var a=Q(e);$(W.c,a,t),Object(z.c)(n)}}(b.clpViewState,d),(null==b?void 0:b.classificationViewState)&&function(e,t){var n=e.messageClassification;if(n){t.ExtendedProperty||(t.ExtendedProperty=[]),Object.keys(n).forEach((function(e){var r=Y.b[e];r&&t.ExtendedProperty.push(Object(y.a)({ExtendedFieldURI:Object(O.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:n[e]}))}));var r=Y.b.IsClassified;t.ExtendedProperty.push(Object(y.a)({ExtendedFieldURI:Object(O.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:"true"}))}}(b.classificationViewState,d),Object(a.a)()&&function(e,t){var n,r,i=null===(r=null===(n=null==e?void 0:e.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(i&&!Object(Fe.a)(i)){var a=Object(y.a)({ExtendedFieldURI:Object(O.a)({PropertyName:Ue,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:i});t.ExtendedProperty?t.ExtendedProperty.push(a):t.ExtendedProperty=[a]}}(e.fromViewState,d),(null===(n=e.mentionsPicker)||void 0===n?void 0:n.atMentionTuples)&&Object.keys(e.mentionsPicker.atMentionTuples).length>0?[4,Ne.b.import()]:[3,5];case 4:return h=T.sent(),[3,6];case 5:h=null,T.label=6;case 6:if(null==(g=h)||g(e.mentionsPicker,t,d),!Object(De.a)(e.smimeViewState))return[3,11];T.label=7;case 7:return T.trys.push([7,9,,10]),j=function(e,t,n){var i,a=e.smimeViewState||Object(s.a)(),d=e.attachmentWell,l=d.docViewAttachments,f=d.inlineAttachments,p=Object(u.a)(a);return(i=l.slice(0)).push.apply(i,Object(r.__spread)(f)),{smimeViewState:a,message:t,fromAddress:Object(o.a)(),isSend:n,composeId:e.composeId,toRecipients:p?Object(c.a)(e.toRecipientWell):[],ccRecipients:p?Object(c.a)(e.ccRecipientWell):[],attachments:i}}(e,d,t),[4,Be.p.import().then((function(e){return e(j)}))];case 8:return T.sent(),[3,10];case 9:return I=T.sent(),(w=new Error).message=I.message==ke.a?ke.a:"SmimeEncodeError",[2,Promise.reject(w)];case 10:return[3,12];case 11:e.itemId&&(S=Object(je.b)().items.get(e.itemId.Id))&&Object(Le.b)(S.ItemClass)&&(d.ItemClass=et),T.label=12;case 12:return t&&function(e){var t=[];if(e.isReportedFalsePositive){var n={ExtendedFieldURI:{PropertyName:Ee,PropertyType:"String",DistinguishedPropertySetId:Ie},Value:""};t.push(n)}if(e.isOverridden){n={ExtendedFieldURI:{PropertyName:Se,PropertyType:"String",DistinguishedPropertySetId:Ie},Value:e.overrideJustification};t.push(n)}return t}(e.policyTipsViewState).map((function(e){return function(e,t){null==e.ExtendedProperty?e.ExtendedProperty=[t]:e.ExtendedProperty.push(t)}(d,e)})),[4,at(e,d,f,t)];case 13:l=T.sent(),T.label=14;case 14:return _(e.addin),(x=(null===(i=null==l?void 0:l.ResponseMessages)||void 0===i?void 0:i.Items)?l.ResponseMessages.Items[0]:l&&!l.ResponseMessages?l:null)&&"Success"==x.ResponseClass?[2,Promise.resolve(x)]:(Object(R.d)(l,e),w=void 0,x?(w=new Error(x.ResponseCode)).messageText=x.MessageText:w=new Error("Unrecognized response"),[2,Promise.reject(w)])}}))}))}function at(e,t,n,i){var a,o,c,s,u,d,l;if(Object(C.a)(e)){if(i&&3!=e.operation){if(Object(Ae.a)()||e.itemId||t.RightsManagementLicenseData||(null===(a=e.protectionViewState)||void 0===a?void 0:a.IRMData))return function(e,t,n,r,i,a){var o=ue(e,t,0,r,i,a),c={headers:Object(ne.e)(null,"GroupMailbox")};return oe({Header:Object(ce.b)(),Body:o},c).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}(e.groupId,t,e.bodyType,n,Me(e.protectionViewState),e.isInlineCompose);var f=Object(B.m)(e.groupId);return c=e.groupId,s=t,e.bodyType,u=Object(Ze.a)(f),d=e.isInlineCompose,l=le(c,s,0,0,d),de({Header:Object(ce.b)(),Body:l},u).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}var p=1==e.operation||2==e.operation;if(!e.itemId&&p||e.useSmartResponse)return Object(te.a)(e.groupId,t,e.bodyType,!1,n,e.isInlineCompose)}var m=Object(Z.c)(),b=!(!m||m.treeType!==U.k&&m.treeType!==U.c);if(i){var v=Object(V.a)(null===(o=e.attachmentWell)||void 0===o?void 0:o.sharingLinkIds);v&&v.length>0&&(t.DocLinks=v)}return e.useSmartResponse||!e.itemId?Object(F.i)("mon-cmp-experimentalGraphQLCompose")&&!i&&function(e){switch(e){case 0:case 1:case 2:case 3:return!0;case 4:case 5:case 6:return!1}}(e.operation)?function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(Ge.a)()];case 1:return[4,a.sent().mutate({variables:{draft:We(e,n),timeFormat:t},mutation:Ve})];case 2:return i=a.sent(),[2,{ResponseMessages:{Items:[{Items:[Object(r.__assign)({},i.data.createDraft.draft)],ResponseClass:"Success"}]}}]}}))}))}(t,n,e):Object(ee.a)(t,e.bodyType,i,n,e.isInlineCompose,Me(e.protectionViewState),null,b):Object(F.i)("mon-cmp-experimentalGraphQLCompose")?function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,o;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return[4,Object(Ge.a)()];case 1:return[4,c.sent().mutate({variables:{draft:We(e,n),itemId:e.ItemId},mutation:t?Xe:$e})];case 2:return i=c.sent(),a=i.data,o=t?a.sendDraft:a.saveDraft,[2,{ResponseMessages:{Items:[{Items:o.draft?[Object(r.__assign)({},o.draft)]:null,ResponseClass:"Success"}]}}]}}))}))}(t,i,e):Oe(t,i,Me(e.protectionViewState),e.addin.keysOfInternetHeadersToBeRemoved)}function ot(e){return it(e,!0)}function ct(e){return it(e,!1)}function st(e,t){if(Object(he.a)(e)){var n=function(e){var t;if(null==e?void 0:e.Items)return e.Items[0];if(null===(t=e)||void 0===t?void 0:t.Item)return e.Item;return null}(e);return n&&(Object(De.a)(t.smimeViewState)||N.h.import().then((function(e){var r=e(t.attachmentWell,t.content,t.bodyType,!0);r.length&&Be.r.import().then((function(e){return e(r,n.Attachments,Object(w.a)({Id:t.composeId}))}))})),n.ItemId&&(k(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.Body&&Object(C.a)(t)&&(t.lastSavedMessageBody=n.Body.Value)),n.InternetMessageId&&Object(D.a)(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId)),!0}return!1}function ut(e){return e.textDirection||(Object(v.a)().SessionSettings.IsUserCultureRightToLeft?"rtl":"ltr")}},558:function(e,t,n){"use strict";var r=Array.isArray;t.a=r},5694:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(4505),a=n(4200);function o(e,t){return function(e,t){for(var n=0;n<t.length;n++)if(c(t[n],e))return t[n];return null}((e||[]).concat(t||[]),Object(i.a)(!0))}function c(e,t){var n,i;if(t&&t.length>0)try{for(var o=Object(r.__values)(t),c=o.next();!c.done;c=o.next()){var s=c.value;if(s&&Object(a.a)(e,s.EmailAddress))return!0}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1}},5696:function(e,t,n){"use strict";n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return v}));var r=n(0),i=n(6406),a=n(7),o=n(1860),c=n(2339),s=n(5246),u=n(2351),d="",l="";function f(e,t){var n;if(e){e.WasclUpgradeToPremiumUrl&&(d=e.WasclUpgradeToPremiumUrl),e.AccountRecoveryFlowUrl&&(l=e.AccountRecoveryFlowUrl);var r=(null===(n=e.ResponseMessages)||void 0===n?void 0:n.Items)?e.ResponseMessages.Items[0]:null;!r||"ErrorExceededMessageLimit"!=r.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=r.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=r.ResponseCode||Object(c.b)(t,!0)}}function p(e){return{text:Object(a.b)(i.a),action:function(){Object(o.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(d)}}}var m=null;function b(e,t){return{text:Object(a.b)(i.b),action:function(){var n;null===m&&(n=Object(r.__read)(Object(u.a)(s.a,t),1),(m=n[0]).then((function(t){var n=t.success;m=null,n&&function(e){Object(o.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"])}(e)}),(function(e){m=null})))}}}function v(e){return{text:Object(a.b)(i.b),action:function(){Object(o.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(l)}}}},5697:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ReplyAllToItem:#Exchange"},e)}},5698:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ReplyToItem:#Exchange"},e)}},572:function(e,t,n){"use strict";var r=n(798),i=n(991),a=n(658);t.a=function(e){return Object(a.a)(e)?Object(r.a)(e):Object(i.a)(e)}},5937:function(e,t,n){"use strict";var r=n(0),i=n(3795);var a=n(790),o=n(785),c=n(28);function s(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"CreateResponseFromModernGroupJsonRequest:#Exchange"},n)),Object(c.a)("CreateResponseFromModernGroup",e,t)}var u=n(197),d=n(2185);function l(e,t,n,c,s,u){var l,f=(l=Object(r.__assign)({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:c?"SendAndSaveCopy":"SaveOnly",Items:[t],TimeFormat:s,ItemShape:Object(a.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(o.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(d.a)()),Object(r.__assign)({__type:"CreateResponseFromModernGroupRequest:#Exchange"},l));return c?u&&(f.ItemShape.ReturnOnlyInternetMessageId=!0):(f.ItemShape=Object(i.a)(n),f.ShapeName="MailCompose"),f.GroupSmtpAddress=e,f}function f(e,t,n,r,i,a){var o=l(e,t,n,r,i,a);return s({Header:Object(u.b)(),Body:o}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}n.d(t,"a",(function(){return f}))},6406:function(e){e.exports=JSON.parse('{"a":"q9a","b":"r9a"}')},661:function(e,t,n){"use strict";var r=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},665:function(e,t,n){"use strict";t.a=function(e){return function(t){return e(t)}}},795:function(e,t,n){"use strict";var r=9007199254740991,i=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){var n=typeof e;return!!(t=null==t?r:t)&&("number"==n||"symbol"!=n&&i.test(e))&&e>-1&&e%1==0&&e<t}},796:function(e,t,n){"use strict";var r=n(663);t.a=function(e,t,n){"__proto__"==t&&r.a?Object(r.a)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},798:function(e,t,n){"use strict";var r=n(988),i=n(984),a=n(558),o=n(800),c=n(795),s=n(983),u=Object.prototype.hasOwnProperty;t.a=function(e,t){var n=Object(a.a)(e),d=!n&&Object(i.a)(e),l=!n&&!d&&Object(o.a)(e),f=!n&&!d&&!l&&Object(s.a)(e),p=n||d||l||f,m=p?Object(r.a)(e.length,String):[],b=m.length;for(var v in e)!t&&!u.call(e,v)||p&&("length"==v||l&&("offset"==v||"parent"==v)||f&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||Object(c.a)(v,b))||m.push(v);return m}},799:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return e(t(n))}}},800:function(e,t,n){"use strict";(function(e){var r=n(325),i=n(993),a="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,c=o&&o.exports===a?r.a.Buffer:void 0,s=(c?c.isBuffer:void 0)||i.a;t.a=s}).call(this,n(878)(e))},809:function(e,t,n){"use strict";var r=n(796),i=n(660),a=Object.prototype.hasOwnProperty;t.a=function(e,t,n){var o=e[t];a.call(e,t)&&Object(i.a)(o,n)&&(void 0!==n||t in e)||Object(r.a)(e,t,n)}},826:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ExtendedPropertyType:#Exchange"},e)}},890:function(e,t,n){"use strict";n.d(t,"e",(function(){return"{id}"})),n.d(t,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(t,"a",(function(){return"data-custom"})),n.d(t,"c",(function(){return"originalsrc"})),n.d(t,"b",(function(){return"data-loadstatus"})),n.d(t,"d",(function(){return"pending"}))},900:function(e,t,n){"use strict";var r;!function(e){e.None="None",e.OwaProxy="OwaProxy",e.ConnectorsProxy="ConnectorsProxy",e.Compose="Compose",e.OwaAndConnectorsProxy="OwaAndConnectorsProxy",e.OwaConnectorsProxyAndCompose="OwaConnectorsProxyAndCompose"}(r||(r={})),t.a=r},916:function(e,t,n){"use strict";var r=n(506),i=n(1029),a=n(572),o=Object(i.a)((function(e,t,n,i){Object(r.a)(t,Object(a.a)(t),e,i)}));t.a=o},983:function(e,t,n){"use strict";var r=n(419),i=n(794),a=n(403),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var c=function(e){return Object(a.a)(e)&&Object(i.a)(e.length)&&!!o[Object(r.a)(e)]},s=n(665),u=n(528),d=u.a&&u.a.isTypedArray,l=d?Object(s.a)(d):c;t.a=l},984:function(e,t,n){"use strict";var r=n(419),i=n(403),a="[object Arguments]";var o=function(e){return Object(i.a)(e)&&Object(r.a)(e)==a},c=Object.prototype,s=c.hasOwnProperty,u=c.propertyIsEnumerable,d=o(function(){return arguments}())?o:function(e){return Object(i.a)(e)&&s.call(e,"callee")&&!u.call(e,"callee")};t.a=d},989:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r="A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऀ-५ॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",i=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),a=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),o=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),c=/[^\\]"/,s=/^[A-Za-z0-9_-]+:.*$/,u=function(e){var t=e.match(i);if(t)return-1!==t[0].indexOf("..")?null:t[0];var n=e.match(a);if(n){var r=c.exec(n[0]);return r&&r.index!==n[0].length-2?null:n[0]}return null};function d(e){if(!e)return!1;var t=u(e);return!!t&&!!e.substring(t.length+1).match(o)}function l(e){return s.test(e)}function f(e){return d(e)||l(e)}},991:function(e,t,n){"use strict";var r=n(661),i=n(799),a=Object(i.a)(Object.keys,Object),o=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return a(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},993:function(e,t,n){"use strict";t.a=function(){return!1}},994:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(876),i=n(85);function a(){var e=!0;if(Object(i.s)()){var t=Object(r.e)(r.b.ExternalImages);e=null===t.externalImagesSelectedOption||0===t.externalImagesSelectedOption}else{var n=Object(i.h)().PolicySettings;e=void 0===n.ExternalImageProxyEnabled||n.ExternalImageProxyEnabled}return e}},998:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(3),i=Object(r.createStore)("popoutParent",{projections:[],isAvailable:!1}),a=i();t.a=a}}]);
//# sourceMappingURL=owa.MailBoot~Addins~Editor.js.map
self.scriptsLoaded['owa.MailBoot~Addins~Editor.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Addins~Editor.js'] = (new Date()).getTime();