self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~HtmlEditorMentionsPlugin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[603],{10510:function(e,t,i){var n=i(14468),r=i(107);"string"==typeof n&&(n=[[e.i,n]]);for(var a=0;a<n.length;a++)r.loadStyles(n[a][1],!1);n.locals&&(e.exports=n.locals)},1242:function(e,t,i){var n=i(1243),r=i(107);"string"==typeof n&&(n=[[e.i,n]]);for(var a=0;a<n.length;a++)r.loadStyles(n[a][1],!1);n.locals&&(e.exports=n.locals)},1243:function(e,t,i){(t=e.exports=i(106)(!1)).push([e.i,"._3fxSw_KFta16t28JP70e_s .ms-Persona-initials{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage)}html[dir] ._3fxSw_KFta16t28JP70e_s .ms-Persona-initials{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground)}",""]),t.locals={persona:"_3fxSw_KFta16t28JP70e_s"}},1248:function(e,t,i){"use strict";var n=i(469),r=i(970),a=i(12),o=i(146),s={root:"ms-Persona",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"};i.d(t,"a",(function(){return l}));var l=Object(n.a)(r.a,(function(e){var t=e.className,i=e.showSecondaryText,n=e.theme,r=n.semanticColors,l=n.fonts,c=Object(a.getGlobalClassNames)(s,n),d=Object(o.d)(e.size),u=Object(o.c)(e.presence),h={color:r.bodySubtext,fontWeight:a.FontWeights.regular,fontSize:l.small.fontSize};return{root:[c.root,n.fonts.medium,a.normalize,{color:r.bodyText,position:"relative",height:o.b.size48,minWidth:o.b.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"}}},d.isSize8&&[c.size8,{height:o.b.size8,minWidth:o.b.size8}],d.isSize10&&[c.size10,{height:o.b.size10,minWidth:o.b.size10}],d.isSize16&&[c.size16,{height:o.b.size16,minWidth:o.b.size16}],d.isSize24&&[c.size24,{height:o.b.size24,minWidth:o.b.size24}],d.isSize24&&i&&{height:"36px"},d.isSize28&&[c.size28,{height:o.b.size28,minWidth:o.b.size28}],d.isSize28&&i&&{height:"32px"},d.isSize32&&[c.size32,{height:o.b.size32,minWidth:o.b.size32}],d.isSize40&&[c.size40,{height:o.b.size40,minWidth:o.b.size40}],d.isSize48&&c.size48,d.isSize56&&[c.size56,{height:o.b.size56,minWidth:o.b.size56}],d.isSize72&&[c.size72,{height:o.b.size72,minWidth:o.b.size72}],d.isSize100&&[c.size100,{height:o.b.size100,minWidth:o.b.size100}],d.isSize120&&[c.size120,{height:o.b.size120,minWidth:o.b.size120}],u.isAvailable&&c.available,u.isAway&&c.away,u.isBlocked&&c.blocked,u.isBusy&&c.busy,u.isDoNotDisturb&&c.doNotDisturb,u.isOffline&&c.offline,t],details:[c.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},(d.isSize8||d.isSize10)&&{paddingLeft:17},(d.isSize24||d.isSize28||d.isSize32)&&{padding:"0 8px"},(d.isSize40||d.isSize48)&&{padding:"0 12px"}],primaryText:[c.primaryText,a.noWrap,{color:r.bodyText,fontWeight:a.FontWeights.regular,fontSize:l.medium.fontSize,selectors:{":hover":{color:r.inputTextHovered}}},i&&{height:"16px",lineHeight:"16px",overflowX:"hidden"},(d.isSize8||d.isSize10)&&{fontSize:l.small.fontSize,lineHeight:o.b.size8},d.isSize16&&{lineHeight:o.b.size28},(d.isSize24||d.isSize28||d.isSize32||d.isSize40||d.isSize48)&&i&&{height:18},(d.isSize56||d.isSize72||d.isSize100||d.isSize120)&&{fontSize:l.xLarge.fontSize},(d.isSize56||d.isSize72||d.isSize100||d.isSize120)&&i&&{height:22}],secondaryText:[c.secondaryText,a.noWrap,h,(d.isSize8||d.isSize10||d.isSize16||d.isSize24||d.isSize28||d.isSize32)&&{display:"none"},i&&{display:"block",height:"16px",lineHeight:"16px",overflowX:"hidden"},d.isSize24&&i&&{height:18},(d.isSize56||d.isSize72||d.isSize100||d.isSize120)&&{fontSize:l.medium.fontSize},(d.isSize56||d.isSize72||d.isSize100||d.isSize120)&&i&&{height:18}],tertiaryText:[c.tertiaryText,a.noWrap,h,{display:"none",fontSize:l.medium.fontSize},(d.isSize72||d.isSize100||d.isSize120)&&{display:"block"}],optionalText:[c.optionalText,a.noWrap,h,{display:"none",fontSize:l.medium.fontSize},(d.isSize100||d.isSize120)&&{display:"block"}],textContent:[c.textContent,a.noWrap]}}),void 0,{scope:"Persona"})},14468:function(e,t,i){(t=e.exports=i(106)(!1)).push([e.i,'._1OtrSZdhKXVv3UhaivrdJ4{text-decoration:inherit;color:"[theme:black, default:#000000]"}html[dir] ._1OtrSZdhKXVv3UhaivrdJ4{border-radius:2px;padding:0 1px;background-color:"[theme:neutralLighter, default:#f3f2f1]"}html[dir] ._1OtrSZdhKXVv3UhaivrdJ4:hover{background-color:"[theme:neutralLight, default:#edebe9]"}',""]),t.locals={mentionsCompose:"_1OtrSZdhKXVv3UhaivrdJ4"}},14469:function(e,t,i){var n=i(14470),r=i(107);"string"==typeof n&&(n=[[e.i,n]]);for(var a=0;a<n.length;a++)r.loadStyles(n[a][1],!1);n.locals&&(e.exports=n.locals)},14470:function(e,t,i){(t=e.exports=i(106)(!1)).push([e.i,'.HyBZfr2RFL7OVXifbvzJV{width:300px}html[dir] .HyBZfr2RFL7OVXifbvzJV{background-color:"[theme:white, default:#ffffff]"}._2Q4dKdxSizYaUL2S93J9jc{max-height:470px;overflow-x:hidden}._2tarRb2T3ruY31bYx2guV{overflow:hidden}',""]),t.locals={callout:"HyBZfr2RFL7OVXifbvzJV",scrollContainer:"_2Q4dKdxSizYaUL2S93J9jc",recipientCollection:"_2tarRb2T3ruY31bYx2guV"}},215:function(e,t,i){"use strict";var n=i(461),r=i(458),a=i(3),o=i(16),s={viewStates:new o.ObservableMap,livePersonaCardInitializationStatus:{state:n.a.NotInitialized,timestamp:Date.now()},isLivePersonaCardInitialized:!1,isPersonaCardDisabled:!1,brandList:null,brandListLoadState:r.a.unloaded,dynamicBrandSets:{unverifiedBrands:new o.ObservableMap,verifiedBrands:new o.ObservableMap}},l=Object(a.createStore)("personacontrol",s)();t.a=l},2253:function(e,t,i){"use strict";t.a=function(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}},2335:function(e){e.exports=JSON.parse('{"a":"hia"}')},2336:function(e){e.exports=JSON.parse('{"a":"gia"}')},2382:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n,r=i(2696),a=i(2692),o=i(2694),s=i(2335),l=i(2336),c=i(2695),d=i(2693),u=i(7),h=i(348),p=i(1252),g=i(296),f=i(1),m=i(3325),v=i(402).bind(m);!function(e){e[e.Default=0]="Default",e[e.Searching=1]="Searching",e[e.TypeToSearch=2]="TypeToSearch",e[e.SearchDirectory=3]="SearchDirectory",e[e.TopNResults=4]="TopNResults",e[e.UseAddress=5]="UseAddress",e[e.SuggestedContacts=6]="SuggestedContacts",e[e.FindPeopleFeedback=7]="FindPeopleFeedback"}(n||(n={}));var b=function(e){switch(e.infoType){case n.Searching:return f.createElement("div",{className:m.container},f.createElement("div",{className:m.iconContainer},f.createElement(p.a,{className:m.loadingSpinner})),f.createElement("div",{className:m.textContainer},Object(u.c)(Object(u.b)(d.a),e.queryString)));case n.TypeToSearch:return f.createElement("div",{className:m.container},f.createElement("div",{className:v(m.textContainer,m.centered)},Object(u.b)(c.a)));case n.SearchDirectory:return e.searchDirectoryAction&&f.createElement("div",{className:v(m.container,m.hoverable,{isHighlighted:e.highlighted}),onClick:e.searchDirectoryAction},f.createElement("div",{className:m.iconContainer},f.createElement(h.a,{className:m.searchIcon,iconName:"Search"})),f.createElement("div",{className:m.textContainer},Object(g.a)()?Object(u.b)(l.a):Object(u.b)(s.a)));case n.TopNResults:return f.createElement("div",{className:m.container},f.createElement("div",{className:v(m.textContainer,m.centered)},e.numberOfResults?Object(u.c)(Object(u.b)(o.a),e.numberOfResults):Object(u.b)(a.a)));case n.UseAddress:return e.useTypedAddressAction&&f.createElement("div",null,f.createElement("div",{className:v(m.hoverable,{isHighlighted:e.highlighted})},f.createElement("div",{className:v(m.textContainer,m.useAddressContainer),onClick:e.useTypedAddressAction},Object(u.c)(Object(u.b)(r.a),e.queryString))),f.createElement(b,{infoType:n.TopNResults,highlighted:!1,queryString:e.queryString,numberOfResults:e.numberOfResults}));default:return null}};t.b=b},2408:function(e,t,i){"use strict";t.a=function(e,t){return e.has(t)}},2430:function(e,t,i){"use strict";var n=i(990),r="__lodash_hash_undefined__";var a=function(e){return this.__data__.set(e,r),this};var o=function(e){return this.__data__.has(e)};function s(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new n.a;++t<i;)this.add(e[t])}s.prototype.add=s.prototype.push=a,s.prototype.has=o;t.a=s},2650:function(e,t,i){"use strict";var n=i(2852);var r=function(e){return e!=e};var a=function(e,t,i){for(var n=i-1,r=e.length;++n<r;)if(e[n]===t)return n;return-1};t.a=function(e,t,i){return t==t?a(e,t,i):Object(n.a)(e,r,i)}},2692:function(e){e.exports=JSON.parse('{"a":"nia"}')},2693:function(e){e.exports=JSON.parse('{"a":"lia"}')},2694:function(e){e.exports=JSON.parse('{"a":"mia"}')},2695:function(e){e.exports=JSON.parse('{"a":"jia"}')},2696:function(e){e.exports=JSON.parse('{"a":"kia"}')},2852:function(e,t,i){"use strict";t.a=function(e,t,i,n){for(var r=e.length,a=i+(n?1:-1);n?a--:++a<r;)if(t(e[a],a,e))return a;return-1}},3177:function(e,t,i){"use strict";var n=i(2430),r=i(3201),a=i(3202),o=i(2408),s=i(814),l=i(3203),c=i(2253),d=s.a&&1/Object(c.a)(new s.a([,-0]))[1]==1/0?function(e){return new s.a(e)}:l.a,u=200;t.a=function(e,t,i){var s=-1,l=r.a,h=e.length,p=!0,g=[],f=g;if(i)p=!1,l=a.a;else if(h>=u){var m=t?null:d(e);if(m)return Object(c.a)(m);p=!1,l=o.a,f=new n.a}else f=t?[]:g;e:for(;++s<h;){var v=e[s],b=t?t(v):v;if(v=i||0!==v?v:0,p&&b==b){for(var y=f.length;y--;)if(f[y]===b)continue e;t&&f.push(b),g.push(v)}else l(f,b,i)||(f!==g&&f.push(b),g.push(v))}return g}},3201:function(e,t,i){"use strict";var n=i(2650);t.a=function(e,t){return!!(null==e?0:e.length)&&Object(n.a)(e,t,0)>-1}},3202:function(e,t,i){"use strict";t.a=function(e,t,i){for(var n=-1,r=null==e?0:e.length;++n<r;)if(i(t,e[n]))return!0;return!1}},3203:function(e,t,i){"use strict";t.a=function(){}},3325:function(e,t,i){var n=i(3326),r=i(107);"string"==typeof n&&(n=[[e.i,n]]);for(var a=0;a<n.length;a++)r.loadStyles(n[a][1],!1);n.locals&&(e.exports=n.locals)},3326:function(e,t,i){(t=e.exports=i(106)(!1)).push([e.i,'._3XTe71uhdRChCr1dRUw5Ps{height:48px;width:300px;overflow:hidden;display:table}html[dir] ._3XTe71uhdRChCr1dRUw5Ps{border-top:1px solid "[theme:neutralLight, default:#edebe9]"}._32gFw3jblWwvQfeLgBwada{font-size:12px;font-weight:400;width:calc(100% - 46px);display:table-cell;vertical-align:middle}html[dir=ltr] ._32gFw3jblWwvQfeLgBwada{text-align:left;padding-left:12px}html[dir=rtl] ._32gFw3jblWwvQfeLgBwada{text-align:right;padding-right:12px}._32gFw3jblWwvQfeLgBwada.dv3CIcvVMXpT21T9XHete{width:100%}html[dir] ._32gFw3jblWwvQfeLgBwada.dv3CIcvVMXpT21T9XHete{text-align:center;padding:0}._2q8XY7ndqTvhZ5CDlgQw--{width:32px;display:table-cell}html[dir] ._2q8XY7ndqTvhZ5CDlgQw--{padding-top:14px;text-align:center}html[dir=ltr] ._2q8XY7ndqTvhZ5CDlgQw--{padding-left:12px}html[dir=rtl] ._2q8XY7ndqTvhZ5CDlgQw--{padding-right:12px}html[dir] ._3_7F1stjskPxVf1n1R8EY1:hover{background-color:"[theme:neutralLighter, default:#f3f2f1]"}html[dir] ._3_7F1stjskPxVf1n1R8EY1:hover._3cIj55rShf02QTJNXT1qty{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] ._3_7F1stjskPxVf1n1R8EY1._3cIj55rShf02QTJNXT1qty{background-color:"[theme:themeLighter, default:#DEECF9]"}._1wm3wZ7g_2DyeIpcFB_UpA{font-size:21px;font-weight:100;color:"[theme:themePrimary, default:#0078D4]"}._38lQWUuwztVEGkiWX0-V-u{height:36px}',""]),t.locals={container:"_3XTe71uhdRChCr1dRUw5Ps",textContainer:"_32gFw3jblWwvQfeLgBwada",centered:"dv3CIcvVMXpT21T9XHete",iconContainer:"_2q8XY7ndqTvhZ5CDlgQw--",hoverable:"_3_7F1stjskPxVf1n1R8EY1",isHighlighted:"_3cIj55rShf02QTJNXT1qty",searchIcon:"_1wm3wZ7g_2DyeIpcFB_UpA",useAddressContainer:"_38lQWUuwztVEGkiWX0-V-u"}},405:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(25),r=i(296),a=i(40);function o(){return Object(r.a)()&&Object(a.i)("rp-imageApiConsumer")&&!Object(n.a)().SessionSettings.IsShadowMailbox}},458:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.unloaded=0]="unloaded",e[e.loading=1]="loading",e[e.loadSucceeded=2]="loadSucceeded",e[e.loadFailed=3]="loadFailed"}(n||(n={}))},459:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(n||(n={}))},461:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.NotInitialized="NotInitialized",e.Initializing="Initializing",e.Initialized="Initialized",e.Failed="Failed"}(n||(n={}))},4845:function(e,t,i){"use strict";function n(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}i.d(t,"a",(function(){return n}))},5477:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i(5478))},5478:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5479);t.PickerPlugin=n.default},5479:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2420),r=i(1678),a=r.Browser.isIE?"Esc":"Escape",o=r.Browser.isIE?"Left":"ArrowLeft",s=r.Browser.isIE?"Up":"ArrowUp",l=r.Browser.isIE?"Right":"ArrowRight",c=r.Browser.isIE?"Down":"ArrowDown",d=r.Browser.isIE?"Del":"Delete",u=[0,229],h=function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize((function(e){t.editor.focus();var i=t.getWord(null);i&&0!=i.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),i=t.getWord(null));t.editor.addUndoSnapshot((function(){i?n.replaceWithNode(t.editor,i,e,!0):t.editor.insertNode(e),t.setIsSuggesting(!1)}),t.pickerOptions.changeSource,t.pickerOptions.handleAutoComplete)}),(function(e){t.setIsSuggesting(e)}),e)},e.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 7:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var t=[];this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(function(e){e.id&&t.push(e.id)})),this.dataProvider.onContentChanged(t)}break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.getWordBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e);return t?t.getWordBefore():null},e.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},e.prototype.getRangeUntilAt=function(e){var t,i,n=this;return this.editor.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){for(var r=!1,a=e.getTextContent(),o=a?a.length:-1;o>=0;){if(a[o]==n.pickerOptions.triggerCharacter){t=e.getStartPosition().move(o),r=!0;break}o--}return r&&(i=e.getEndPosition()),r})),r.createRange(t,i)||this.editor.getDocument().createRange()},e.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||r.isCharacterValue(e.rawEvent)||this.isSuggesting&&!r.isModifierKey(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){if(this.isSuggesting){var t=(n=(i=this.getWord(e)).substring(1)).trim();i==this.pickerOptions.triggerCharacter||t&&t.length>0&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,n==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)}else{var i=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=i&&i[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=i&&i.split(" ").length<=4&&i[0]==this.pickerOptions.triggerCharacter){this.setIsSuggesting(!0);var n;t=(n=i.substring(1)).trim();if(this.dataProvider.queryStringUpdated(t,n==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint){var r=this.editor.getContentSearcherOfCursor(e),a=this.editor.getDocument().createRange(),o=r.getInlineElementBefore().getContainerNode();if(!this.setRangeStart(a,o,i)){var s=o.previousSibling;this.setRangeStart(a,s,this.pickerOptions.triggerCharacter)}var l=a.getBoundingClientRect();if(0==l.left&&0==l.bottom&&0==l.top&&(l=a.getClientRects()[0]),l){a.detach();var c={x:l.left,y:(l.bottom+l.top)/2},d=(l.bottom-l.top)/2;this.dataProvider.setCursorPoint(c,d)}}}}},e.prototype.onKeyDownEvent=function(e){var t=e.rawEvent;if(this.isSuggesting)if(t.key==a)this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e);else if("Backspace"==t.key){this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1)}else this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?t.key==o||t.key==l:t.key==s||t.key==c)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?t.key==l:t.key==c),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=t.key&&"Tab"!=t.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if("Backspace"==t.key)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(t.key==d){var i=this.editor.getContentSearcherOfCursor(e),n=i.getInlineElementAfter()?i.getInlineElementAfter().getContainerNode():null,r=n?this.getIdValue(n):null;if(r&&0==r.indexOf(this.pickerOptions.elementIdPrefix)){var u=this.dataProvider.onRemove(n,!1);this.replaceNode(n,u),this.cancelDefaultKeyDownEvent(e)}}},e.prototype.onAndroidInputEvent=function(e){(this.newInputLength=this.calcInputLength(e),this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&(this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0))},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){var t=this.editor.getContentSearcherOfCursor(e),i=t.getInlineElementBefore(),n=i?i.getContainerNode():null,a=n?this.getIdValue(n):null,o=t.getInlineElementAfter();if(a&&0==a.indexOf(this.pickerOptions.elementIdPrefix)&&(null==o||!(o instanceof r.PartialInlineElement))){var s=this.dataProvider.onRemove(n,!0);return s?(this.replaceNode(n,s),this.isPendingInputEventHandling?this.editor.runAsync((function(e){e.select(s,-3)})):this.editor.select(s,-3)):this.editor.deleteNode(n),!0}return!1},e.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),i=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=i?i:t},e.prototype.setRangeStart=function(e,t,i){var n=t?t.textContent.lastIndexOf(i):-1;return n>-1&&(e.setStart(t,n),!0)},e.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e),i=t?t.getInlineElementBefore():null;return i?i.getTextContent():null},e.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&u.indexOf(e.rawEvent.charCode)>-1},e}();t.default=h},563:function(e,t,i){"use strict";var n=function(){this.__data__=[],this.size=0},r=i(660);var a=function(e,t){for(var i=e.length;i--;)if(Object(r.a)(e[i][0],t))return i;return-1},o=Array.prototype.splice;var s=function(e){var t=this.__data__,i=a(t,e);return!(i<0)&&(i==t.length-1?t.pop():o.call(t,i,1),--this.size,!0)};var l=function(e){var t=this.__data__,i=a(t,e);return i<0?void 0:t[i][1]};var c=function(e){return a(this.__data__,e)>-1};var d=function(e,t){var i=this.__data__,n=a(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this};function u(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}u.prototype.clear=n,u.prototype.delete=s,u.prototype.get=l,u.prototype.has=c,u.prototype.set=d;t.a=u},564:function(e,t,i){"use strict";var n=i(420),r=i(325),a=Object(n.a)(r.a,"Map");t.a=a},565:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(n||(n={}))},664:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(25),r=i(296);function a(e){if(Object(r.a)()&&e){var t,i,a=Object(n.a)();if(a&&a.SessionSettings)return t=e,i=a.SessionSettings.UserEmailAddress,t&&i&&t.toLowerCase()==i.toLowerCase()?a.HexCID:void 0}}},6835:function(e,t,i){"use strict";var n=i(3);t.a=Object(n.mutatorAction)("Picker_SetTargetPoint",(function(e,t,i){e.targetPoint=t,e.bufferZone=i}))},698:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i(0),r=i(1),a=i(12),o=i(209),s=i(262),l=i(891),c=i(504),d=i(63),u=i(310),h=i(343),p=i(306),g=i(55),f=i(565),m=i(700),v=i(459),b=Object(o.a)(),y=function(e){function t(i){var n=e.call(this,i)||this;return n._tooltipHost=r.createRef(),n._defaultTooltipId=Object(s.a)("tooltip"),n.show=function(){n._toggleTooltip(!0)},n.dismiss=function(){n._hideTooltip()},n._getTargetElement=function(){if(n._tooltipHost.current){var e=n.props.overflowMode;if(void 0!==e)switch(e){case f.a.Parent:return n._tooltipHost.current.parentElement;case f.a.Self:return n._tooltipHost.current}return n._tooltipHost.current}},n._onTooltipMouseEnter=function(e){var i=n.props,r=i.overflowMode,a=i.delay;if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==n&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=n,void 0!==r){var o=n._getTargetElement();if(o&&!Object(l.b)(o))return}if(!e.target||!Object(c.a)(e.target,n._getTargetElement()))if(n._clearDismissTimer(),n._clearOpenTimer(),a!==v.a.zero){n.setState({isAriaPlaceholderRendered:!0});var s=n._getDelayTime(a);n._openTimerId=n._async.setTimeout((function(){n._toggleTooltip(!0)}),s)}else n._toggleTooltip(!0)},n._onTooltipMouseLeave=function(e){var i=n.props.closeDelay;n._clearDismissTimer(),n._clearOpenTimer(),i?n._dismissTimerId=n._async.setTimeout((function(){n._toggleTooltip(!1)}),i):n._toggleTooltip(!1),t._currentVisibleTooltip===n&&(t._currentVisibleTooltip=void 0)},n._onTooltipKeyDown=function(e){(e.which===d.a.escape||e.ctrlKey)&&n.state.isTooltipVisible&&(n._hideTooltip(),e.stopPropagation())},n._clearDismissTimer=function(){n._async.clearTimeout(n._dismissTimerId)},n._clearOpenTimer=function(){n._async.clearTimeout(n._openTimerId)},n._hideTooltip=function(){n._clearOpenTimer(),n._clearDismissTimer(),n._toggleTooltip(!1)},n._toggleTooltip=function(e){n.state.isTooltipVisible!==e&&n.setState({isAriaPlaceholderRendered:!1,isTooltipVisible:e},(function(){return n.props.onTooltipToggle&&n.props.onTooltipToggle(e)}))},n._getDelayTime=function(e){switch(e){case v.a.medium:return 300;case v.a.long:return 500;default:return 0}},Object(u.a)(n),n.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},n._async=new h.a(n),n}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.calloutProps,i=e.children,o=e.content,s=e.directionalHint,l=e.directionalHintForRTL,c=e.hostClassName,d=e.id,u=e.setAriaDescribedBy,h=void 0===u||u,f=e.tooltipProps,v=e.styles,y=e.theme;this._classNames=b(v,{theme:y,className:c});var S=this.state,_=S.isAriaPlaceholderRendered,T=S.isTooltipVisible,x=d||this._defaultTooltipId,k=!!(o||f&&f.onRenderContent&&f.onRenderContent()),w=T&&k,z=h&&T&&k?x:void 0;return r.createElement("div",Object(n.__assign)({className:this._classNames.root,ref:this._tooltipHost},{onFocusCapture:this._onTooltipMouseEnter},{onBlurCapture:this._hideTooltip},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,"aria-describedby":z}),i,w&&r.createElement(m.a,Object(n.__assign)({id:x,content:o,targetElement:this._getTargetElement(),directionalHint:s,directionalHintForRTL:l,calloutProps:Object(p.a)({},t,{onDismiss:this._hideTooltip,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},Object(g.j)(this.props,g.h),f)),_&&r.createElement("div",{id:x,style:a.hiddenContentStyle},o))},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:v.a.medium},t}(r.Component)},699:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(0),r=i(1),a=i(209),o=i(55),s=i(749),l=i(86),c=Object(a.a)(),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return r.createElement("p",{className:t._classNames.subText},e.content)},t}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,i=e.calloutProps,a=e.directionalHint,l=e.directionalHintForRTL,d=e.styles,u=e.id,h=e.maxWidth,p=e.onRenderContent,g=void 0===p?this._onRenderContent:p,f=e.targetElement,m=e.theme;return this._classNames=c(d,{theme:m,className:t||i&&i.className,beakWidth:i&&i.beakWidth,gapSpace:i&&i.gapSpace,maxWidth:h}),r.createElement(s.a,Object(n.__assign)({target:f,directionalHint:a,directionalHintForRTL:l},i,Object(o.j)(this.props,o.h,["id"]),{className:this._classNames.root}),r.createElement("div",{className:this._classNames.content,id:u,role:"tooltip",onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},g(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:l.DirectionalHint.topCenter,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(r.Component)},700:function(e,t,i){"use strict";var n=i(469),r=i(699),a=i(12);i.d(t,"a",(function(){return o}));var o=Object(n.a)(r.a,(function(e){var t=e.className,i=e.beakWidth,n=void 0===i?16:i,r=e.gapSpace,o=void 0===r?0:r,s=e.maxWidth,l=e.theme,c=l.semanticColors,d=l.fonts,u=l.effects,h=-(Math.sqrt(n*n/2)+o);return{root:["ms-Tooltip",l.fonts.medium,a.AnimationClassNames.fadeIn200,{background:c.menuBackground,boxShadow:u.elevation8,padding:"8px",maxWidth:s,selectors:{":after":{content:"''",position:"absolute",bottom:h,left:h,right:h,top:h,zIndex:0}}},t],content:["ms-Tooltip-content",d.small,{position:"relative",zIndex:1,color:c.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}}),void 0,{scope:"Tooltip"})},7501:function(e,t,i){"use strict";function n(e){return e.EmailAddress.Name||e.DisplayName}i.d(t,"a",(function(){return n}))},7684:function(e,t,i){"use strict";i.r(t);var n=i(0),r="@",a="AtMention",o="OWAAM",s="suggestedRecipients",l="suggestedRecipient-",c=i(3177);var d=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Object(c.a)(e,void 0,t):[]},u=i(4845),h=i(188),p=Object(h.action)("insertRecipientsShownAtFront")((function(e,t,i){var r=t.map((function(e){return e.persona})).concat(e.slice()),a=d(r,u.a);e.splice.apply(e,Object(n.__spread)([0,0],a)),e.length=Math.min(e.length,i)})),g=i(8963),f=Object(h.action)("setIsSearching")((function(e,t,i){e.isSearching=t,null!=i&&(e.queryString=i)})),m=Object(h.action)("setSuggestedContacts")((function(e,t){Object(g.a)(e.findResultSet),t&&p(e.findResultSet,t,5),f(e,!1)})),v=i(134),b=i(52),y=i(10509),S=Object(b.d)("findReadWriteRecipient",{name:"MentionsFindPeople"})((function(e,t,i,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return e.queryString=t,t?[3,1]:(m(e,r),(a=Object(v.t)())&&a.addCustomData({zeroState:(!0).toString()}),[3,3]);case 1:return[4,y.a.importAndExecute(e,t,i,!1,null,r,!0)];case 2:return n.sent(),(o=e.queryString.trim()==t)&&(e.selectedRecipientIndex=0),(a=Object(v.t)())&&a.addCustomData({zeroState:(!1).toString(),sameQueryString:o.toString(),searchDirectory:i.toString()}),[2,Promise.resolve()];case 3:return[2,Promise.resolve()]}}))}))})),_=Object(h.action)("addMentionAddedRecipient")((function(e,t){e.mentionsAddedRecipients.push(t.EmailAddress.EmailAddress)})),T=Object(h.action)("removeMentionTuple")((function(e,t,i){e.atMentionTuples[t]=i})),x=Object(h.action)("removeMentionAddedRecipient")((function(e,t){e.mentionsAddedRecipients.splice(t,1)})),k=Object(h.action)("removeMentionTuple")((function(e,t){delete e.atMentionTuples[t]})),w=i(1714),z=Object(h.action)("setIsSuggesting")((function(e,t,i){void 0===i&&(i=""),e.isSuggesting=t,t||(e.queryString="",e.isSearching=!1,e.directorySearchType=w.a.None)})),E=Object(h.action)("shiftAtMentionsHighlight")((function(e,t){var i=e.findResultSet.length;t?e.selectedRecipientIndex++:e.selectedRecipientIndex--;var n=i+(e.queryString&&e.directorySearchType==w.a.None?1:0);e.selectedRecipientIndex=(e.selectedRecipientIndex+n)%n})),O=i(7501),P=i(6835),C=300,I=i(10510),A=function(){function e(e,t,i,n,r,a){var o=this;this.adapter=e,this.addSelectedPersonaToWell=t,this.removePersonaFromWell=i,this.onRecipientAdded=n,this.canModifyRecipients=r,this.getAllRecipients=a,this.onIsSuggestingChanged=function(e){var t=o.adapter();z(t,e),e?t.queryString||m(t,o.getAllRecipients()):Object(P.a)(o.adapter(),null,0)},this.queryStringUpdated=function(e){var t=o.adapter();o.timer&&(clearTimeout(o.timer),o.timer=null),e?(f(t,!0,e),o.timer=setTimeout((function(){S(t,e,!1,o.getAllRecipients()),o.timer=null}),C)):m(t,o.getAllRecipients())},this.selectOption=function(){var e=o.adapter();e.isSearching||0!=e.findResultSet.length?e.selectedRecipientIndex==e.findResultSet.length?S(e,e.queryString,!0,o.getAllRecipients()):o.addRecipient():o.setIsSuggestingCallback(!1)},this.shiftHighlight=function(e){E(o.adapter(),e)},this.onRemove=function(e,t){return t&&e.textContent.split(" ").length>1?o.deleteLastSegment(e):(o.deleteAtMention(e),null)},this.setCursorPoint=function(e,t){Object(P.a)(o.adapter(),e,t)},this.getSelectedIndex=function(){return o.adapter().selectedRecipientIndex},this.onScroll=function(){o.adapter().isSuggesting&&o.setIsSuggestingCallback(!1)},this.addRecipient=function(e){void 0===e&&(e=null);var t=o.adapter();e||(e=t.findResultSet[t.selectedRecipientIndex]),o.commitMention(o.createInlineFromPersona(e)),!o.doesWellContainRecipient(e)&&o.canModifyRecipients&&(e=null!=e?e:t.findResultSet[t.selectedRecipientIndex],o.addSelectedPersonaToWell(e),e.EmailAddress&&_(t,e)),z(t,!1),o.onRecipientAdded&&o.onRecipientAdded(),Object(v.r)("MentionsAdded")}}return e.prototype.onInitalize=function(e,t){window.addEventListener("resize",this.onScroll),this.commitMention=e,this.setIsSuggestingCallback=t},e.prototype.onDispose=function(){window.removeEventListener("resize",this.onScroll),clearTimeout(this.timer),this.timer=null},e.prototype.doesWellContainRecipient=function(e){var t=this.adapter();e||(e=t.findResultSet[t.selectedRecipientIndex]);return this.getAllRecipients().some((function(t){return Object(u.a)(t.persona,e)}))},e.prototype.createInlineFromPersona=function(e){var t=document.createElement("a"),i=this.generateAtMentionId(),n=Object(O.a)(e);t.id=i,t.innerText="@"+n,t.className=I.mentionsCompose+" mention ms-bgc-nlr ms-fcl-b";var r=e.EmailAddress.EmailAddress;return t.href="mailto:"+r,T(this.adapter(),i,e),t},e.prototype.generateAtMentionId=function(){return o+Math.round(1e6*Math.random()).toString()},e.prototype.deleteLastSegment=function(e){var t=e.textContent.split(" ");return t.pop(),e.textContent=t.join(" ").trim(),e},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.deleteAtMention=function(e){var t=this.getIdValue(e),i=this.adapter(),n=i.atMentionTuples,r=i.mentionsAddedRecipients;if(n[t]){if(n[t].EmailAddress){var a=r.indexOf(n[t].EmailAddress.EmailAddress);if(a>-1)!Object.keys(n).some((function(e){return!(e==t||!n[e])&&(n[e].EmailAddress&&n[e].EmailAddress.EmailAddress==n[t].EmailAddress.EmailAddress)}))&&this.canModifyRecipients&&(this.removePersonaFromWell(n[t]),x(i,a))}k(i,t)}},e}(),R=i(5477),j=i(32),N=i(749),D=i(86),B=i(203),L=i(9726),M=i(1),H=i(2382),W=i(14469),F=i(402).bind(W),U=Object(j.a)((function(e){var t=function(t){e.plugin.dataProvider.addRecipient(t)},i=e.viewState,n=i.targetPoint,r=i.bufferZone;return n?M.createElement(N.a,{className:W.callout,gapSpace:r,target:n,isBeakVisible:!1,setInitialFocus:!1,directionalHint:Object(B.a)()?D.DirectionalHint.bottomRightEdge:D.DirectionalHint.bottomLeftEdge},0!=i.findResultSet.length&&M.createElement("div",{className:F(W.scrollContainer,"customScrollBar")},M.createElement("div",{id:l,className:W.recipientCollection,role:"list"},i.findResultSet.map((function(e,n){return M.createElement("div",{key:e.EmailAddress.EmailAddress,id:s+n.toString(),role:"listitem"},M.createElement(L.a,{findRecipient:e,isHighlighted:i.selectedRecipientIndex==n,addRecipientAction:t,maskRecipientAction:null}))})))),M.createElement(H.b,{infoType:function(e){var t=!!e.queryString;return e.isSearching?H.a.Searching:t||0!=e.findResultSet.length?t?e.directorySearchType==w.a.None?H.a.SearchDirectory:H.a.TopNResults:H.a.Default:H.a.TypeToSearch}(i),queryString:i.queryString,highlighted:i.findResultSet.length==i.selectedRecipientIndex,numberOfResults:i.findResultSet.length,searchDirectoryAction:function(){S(e.viewState,e.viewState.queryString,!0)}})):null})),V=i(10510);var K=function(e){function t(t,i,n,c,d,u,h){var p=this,g=new A(t,n,c,d,u,h),f={elementIdPrefix:o,changeSource:a,triggerCharacter:r,suggestionsLabel:s,suggestionLabelPrefix:l};return(p=e.call(this,g,f)||this).adapter=t,p.editorAdapter=i,p}return Object(n.__extends)(t,e),t.prototype.getUIComponentClass=function(){return U},t.prototype.getName=function(){return"AtMentionsPicker"},t.prototype.onPluginEvent=function(t){var i;10==t.eventType&&t.sanitizingOption.additionalAllowedCssClasses.push(V.mentions),null===(i=e.prototype.onPluginEvent)||void 0===i||i.call(this,t)},t}(R.PickerPlugin),q=i(25),X=23;function J(e,t,i){if(t){var n=Object(q.a)().SessionSettings,r=function(e,t){var i=e.atMentionTuples,n=[];if(Object.keys(i).forEach((function(e){var r=i[e];n.push({Mentioned:r.EmailAddress,CreatedBy:t})})),n.length>0){var r=n.length;Object(v.r)("MentionsTotalSend",{totalMentions:(r>=X?X:r).toString()})}return n}(e,{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:n.UserEmailAddress,Name:n.UserDisplayName});r&&r.length>0&&(i.MentionsEx=r)}else{var a=function(e){var t=[],i=e.atMentionTuples,n=e.mentionsAddedRecipients;Object.keys(i).forEach((function(e){var n=i[e];t.push(JSON.stringify({b:e,a:JSON.stringify({_type:"MentionActionWrapper:#Exchange",Mentioned:n.EmailAddress})}))})),n.length>0&&t.push(JSON.stringify({b:"MentionAddedRecipients",a:JSON.stringify(n)}));if(t.length>0){var r=Object.keys(i).length,a=n.length;Object(v.r)("MentionsTotalSave",{totalMentions:(r>=X?X:r).toString(),numberAddedViaMentions:(a>=X?X:a).toString()})}return t}(e);a.length>0&&(i.PendingSocialActivityTagIds=a)}}i.d(t,"AtMentionPickerPlugin",(function(){return K})),i.d(t,"loadAtMentionsData",(function(){return J}))},814:function(e,t,i){"use strict";var n=i(420),r=i(325),a=Object(n.a)(r.a,"Set");t.a=a},891:function(e,t,i){"use strict";function n(e){return e.clientWidth<e.scrollWidth}function r(e){return e.clientHeight<e.scrollHeight}function a(e){return n(e)||r(e)}i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a}))},8963:function(e,t,i){"use strict";var n=i(0),r=i(1886),a=i(188);t.a=Object(a.action)("getAndPopulateSuggestedContacts")((function(e,t){var i=Object(r.a)("",5,t).map((function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId}}));e.splice.apply(e,Object(n.__spread)([0,e.length],i))}))},962:function(e,t,i){"use strict";var n=i(0),r=i(664),a=i(215),o=i(981),s=i(32),l=i(1),c=i(54),d=i(1248),u=i(894),h=i(44),p=new h.c((function(){return i.e(1383).then(i.bind(null,1571))})),g=new h.a(p,(function(e){return e.getPersonaPhoto})),f=i(1242),m=i(402).bind(f);t.a=Object(s.a)((function(e){var t;e=Object(n.__assign)({emailAddress:"",name:"",size:c.c.regular,secondaryText:"",showPresence:!1,mailboxType:""},e);var i=Object(o.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name);l.useEffect((function(){!function(e){(e.emailAddress||e.name||e.personaId)&&g.importAndExecute(e.name,e.emailAddress,e.personaId,e.size,e.hexConsumerIdForUser||Object(r.a)(e.emailAddress),e.mailboxType,e.skipLoadingPhoto)}(e)}),[i]);var s=a.a.viewStates.get(i);if(!s)return null;var h=e.className,p=e.size,v=e.name,b=e.statusText,y=e.showPersonaDetails,S=e.secondaryText,_=e.showSecondaryText,T=e.presence,x=e.onRenderPrimaryText,k=e.onRenderCoin,w=e.initialsColor,z=e.onRenderInitials,E=e.styleProps,O=e.coinProps,P=e.showUnknownPersonaCoin,C=e.imageInitials,I=(null===(t=s.personaBlob)||void 0===t?void 0:t.blobUrl)?{imageUrl:s.personaBlob.blobUrl,imageShouldFadeIn:!1,imageShouldStartVisible:!0}:{};return y||_||b?l.createElement(d.a,Object(n.__assign)({className:m(h,f.persona),presence:T||c.b.none,hidePersonaDetails:!y,size:p,text:v,secondaryText:S,showSecondaryText:_,tertiaryText:b,onRenderPrimaryText:x,onRenderCoin:k,onRenderInitials:z},I,{initialsColor:w,showUnknownPersonaCoin:P,styles:E,coinProps:O,imageInitials:C})):l.createElement(u.a,Object(n.__assign)({},O,{className:m(h,f.persona),presence:T||c.b.none,size:p,text:v,onRenderCoin:k,onRenderInitials:z},I,{initialsColor:w,showUnknownPersonaCoin:P,showInitialsUntilImageLoads:!0,imageInitials:C}))}))},970:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i(0),r=i(1),a=i(209),o=i(55),s=i(997),l=i(565),c=i(86),d=i(894),u=i(54),h=Object(a.a)(),p=function(e){function t(t){var i=e.call(this,t)||this;return i._onRenderPersonaCoin=function(e){return r.createElement(d.a,Object(n.__assign)({},e))},i}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this._onRenderText(this._getText()),t=this._onRenderText(this.props.secondaryText),i=this._onRenderText(this.props.tertiaryText),a=this._onRenderText(this.props.optionalText),s=this.props,l=s.hidePersonaDetails,c=s.onRenderOptionalText,d=void 0===c?a:c,p=s.onRenderPrimaryText,g=void 0===p?e:p,f=s.onRenderSecondaryText,m=void 0===f?t:f,v=s.onRenderTertiaryText,b=void 0===v?i:v,y=s.onRenderPersonaCoin,S=void 0===y?this._onRenderPersonaCoin:y,_=this.props.size,T=this.props,x=T.allowPhoneInitials,k=T.className,w=T.coinProps,z=T.showUnknownPersonaCoin,E=T.coinSize,O=T.styles,P=T.imageAlt,C=T.imageInitials,I=T.imageShouldFadeIn,A=T.imageShouldStartVisible,R=T.imageUrl,j=T.initialsColor,N=T.isOutOfOffice,D=T.onPhotoLoadingStateChange,B=T.onRenderCoin,L=T.onRenderInitials,M=T.presence,H=T.presenceTitle,W=T.presenceColors,F=T.showInitialsUntilImageLoads,U=T.showSecondaryText,V=T.theme,K=Object(n.__assign)({allowPhoneInitials:x,showUnknownPersonaCoin:z,coinSize:E,imageAlt:P,imageInitials:C,imageShouldFadeIn:I,imageShouldStartVisible:A,imageUrl:R,initialsColor:j,onPhotoLoadingStateChange:D,onRenderCoin:B,onRenderInitials:L,presence:M,presenceTitle:H,showInitialsUntilImageLoads:F,size:_,text:this._getText(),isOutOfOffice:N,presenceColors:W},w),q=h(O,{theme:V,className:k,showSecondaryText:U,presence:M,size:_}),X=Object(o.j)(this.props,o.h),J=r.createElement("div",{className:q.details},this._renderElement(q.primaryText,g,e),this._renderElement(q.secondaryText,m,t),this._renderElement(q.tertiaryText,b,i),this._renderElement(q.optionalText,d,a),this.props.children);return r.createElement("div",Object(n.__assign)({},X,{className:q.root,style:E?{height:E,minWidth:E}:void 0}),S(K,this._onRenderPersonaCoin),(!l||_===u.c.size8||_===u.c.size10||_===u.c.tiny)&&J)},t.prototype._renderElement=function(e,t,i){return r.createElement("div",{dir:"auto",className:e},t&&t(this.props,i))},t.prototype._getText=function(){return this.props.text||this.props.primaryText||""},t.prototype._onRenderText=function(e){return e?function(){return r.createElement(s.a,{content:e,overflowMode:l.a.Parent,directionalHint:c.DirectionalHint.topLeftEdge},e)}:void 0},t.defaultProps={size:u.c.size48,presence:u.b.none,imageAlt:""},t}(r.Component)},9726:function(e,t,i){"use strict";var n=i(32),r=i(7501),a=i(348),o=i(54),s=i(962),l=i(1),c=i(209),d=i(12),u=function(e){var t=e.theme,i=e.isHighlighted,n=t.palette;return{container:[{height:"48px",width:"300px",maxWidth:"100%",overflow:"hidden",position:"relative"},i&&{backgroundColor:n.themeLighter},[{selectors:{":hover":{backgroundColor:n.neutralLighter},":hover .FindRecipient-maskRecipientButton":{opacity:1}}},i&&{selectors:{":hover":{backgroundColor:n.themeLight}}}]],maskRecipientButton:["FindRecipient-maskRecipientButton",{height:"48px",width:"calc(15% - 12px)",position:"absolute",top:0,right:0,opacity:0},[{selectors:{":hover":{backgroundColor:n.neutralLight}}},i&&{selectors:{"hover:":{backgroundColor:n.themeTertiary}}}]],personaContainer:[{marginLeft:"12px",marginTop:"8px",display:"inline-block",tableLayout:"fixed",overflow:"hidden",textOverflow:"ellipsis",width:"85%"}],personaImage:[{position:"relative",display:"inline-block",verticalAlign:"middle",width:"32px"}],personaText:[{paddingLeft:"12px",display:"inline-block",verticalAlign:"middle",width:"80%"}],memberPersonaImage:[{position:"relative",display:"table-cell",verticalAlign:"middle",width:"20px"}],personaTextLine:[{width:"100%",display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}],personaLineOne:[{fontSize:d.FontSizes.medium,fontWeight:d.FontWeights.regular,color:n.neutralPrimary}],personaLineTwo:[{fontSize:d.FontSizes.small,fontWeight:d.FontWeights.regular,color:n.neutralSecondary,textOverflow:"ellipsis",position:"relative",top:"-2px"}],cancelIcon:[{fontSize:d.FontSizes.small,color:n.neutralPrimary,position:"relative",top:"18px",left:"10px"}],linkedInIcon:[{fontSize:d.FontSizes.small,position:"relative",color:"#106ebe",verticalAlign:"bottom",paddingLeft:"5px"}]}},h=i(179),p=i(213),g=Object(c.a)();t.a=Object(n.a)((function(e){var t=e.findRecipient,i=e.maskRecipientAction,n=e.isHighlighted,c=e.theme,d=void 0===c?Object(h.d)():c,f=g(u,{theme:d,isHighlighted:n}),m=Object(r.a)(t),v=t.EmailAddress.EmailAddress,b=!1;t.PersonaTypeString&&"ImplicitGroup"==t.PersonaTypeString&&t.Members&&t.Members.length>0&&(b=!0);var y=t.EmailAddress.MailboxType;return l.createElement("div",{className:f.container,onClick:function(t){t.preventDefault(),e.addRecipientAction(e.findRecipient)}},l.createElement("div",{className:f.personaContainer},l.createElement("div",{className:f.personaImage},function(e,t,i){return e?l.createElement(s.a,{name:"Implicit Group",emailAddress:i,size:o.c.size32,showPersonaDetails:!1,initialsColor:o.a.lightBlue}):l.createElement(s.a,{name:t,emailAddress:i,size:o.c.size32,showPersonaDetails:!1})}(b,m,v)),l.createElement("div",{className:f.personaText},l.createElement("span",{className:p(f.personaLineOne,f.personaTextLine)},m,"LinkedIn"==y&&l.createElement(a.a,{className:f.linkedInIcon,iconName:"LinkedInLogo"})),function(e,t,i,n,r,a){return n?function(e,t){return e.Members.map((function(e){return l.createElement("div",{className:t,key:e.EmailAddress},l.createElement(s.a,{key:e.EmailAddress,name:e.Name,emailAddress:e.EmailAddress,size:o.c.size16,showPersonaDetails:!1,mailboxType:e.MailboxType}))}))}(r,i):l.createElement("span",{className:p(e,t)},a)}(f.personaLineTwo,f.personaTextLine,f.memberPersonaImage,b,t,v))),i&&l.createElement("div",{className:f.maskRecipientButton,onClick:function(t){t.preventDefault(),t.stopPropagation(),e.maskRecipientAction&&e.maskRecipientAction(e.findRecipient)}},l.createElement(a.a,{className:f.cancelIcon,iconName:"Cancel"})))}))},981:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(405);function r(e,t,i,r,a){var o="",s=Object(n.a)();return e?o+=e.toLowerCase():t?o+=t:a&&(o+=a.toLowerCase()),r&&s&&(o+=r),i&&!s&&(o+=i),o}},990:function(e,t,i){"use strict";var n=i(420),r=Object(n.a)(Object,"create");var a=function(){this.__data__=r?r(null):{},this.size=0};var o=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},s="__lodash_hash_undefined__",l=Object.prototype.hasOwnProperty;var c=function(e){var t=this.__data__;if(r){var i=t[e];return i===s?void 0:i}return l.call(t,e)?t[e]:void 0},d=Object.prototype.hasOwnProperty;var u=function(e){var t=this.__data__;return r?void 0!==t[e]:d.call(t,e)},h="__lodash_hash_undefined__";var p=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=r&&void 0===t?h:t,this};function g(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}g.prototype.clear=a,g.prototype.delete=o,g.prototype.get=c,g.prototype.has=u,g.prototype.set=p;var f=g,m=i(563),v=i(564);var b=function(){this.size=0,this.__data__={hash:new f,map:new(v.a||m.a),string:new f}};var y=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var S=function(e,t){var i=e.__data__;return y(t)?i["string"==typeof t?"string":"hash"]:i.map};var _=function(e){var t=S(this,e).delete(e);return this.size-=t?1:0,t};var T=function(e){return S(this,e).get(e)};var x=function(e){return S(this,e).has(e)};var k=function(e,t){var i=S(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this};function w(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}w.prototype.clear=b,w.prototype.delete=_,w.prototype.get=T,w.prototype.has=x,w.prototype.set=k;t.a=w},997:function(e,t,i){"use strict";var n=i(469),r=i(698),a=i(12),o={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"};i.d(t,"a",(function(){return s}));var s=Object(n.a)(r.a,(function(e){var t=e.className,i=e.theme;return{root:[Object(a.getGlobalClassNames)(o,i).root,{display:"inline"},t]}}),void 0,{scope:"TooltipHost"})},999:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return s}));var n=i(54),r=[n.a.lightBlue,n.a.blue,n.a.darkBlue,n.a.teal,n.a.green,n.a.darkGreen,n.a.lightPink,n.a.pink,n.a.magenta,n.a.purple,n.a.orange,n.a.lightRed,n.a.darkRed,n.a.violet,n.a.gold,n.a.burgundy,n.a.warmGray,n.a.cyan,n.a.rust,n.a.coolGray],a=r.length;function o(e){return s(e)}function s(e){var t=e.primaryText,i=e.text,o=e.initialsColor;return"string"==typeof o?o:function(e){switch(e){case n.a.lightBlue:return"#4F6BED";case n.a.blue:return"#0078D4";case n.a.darkBlue:return"#004E8C";case n.a.teal:return"#038387";case n.a.lightGreen:case n.a.green:return"#498205";case n.a.darkGreen:return"#0B6A0B";case n.a.lightPink:return"#C239B3";case n.a.pink:return"#E3008C";case n.a.magenta:return"#881798";case n.a.purple:return"#5C2E91";case n.a.orange:return"#CA5010";case n.a.red:return"#EE1111";case n.a.lightRed:return"#D13438";case n.a.darkRed:return"#A4262C";case n.a.transparent:return"transparent";case n.a.violet:return"#8764B8";case n.a.gold:return"#986F0B";case n.a.burgundy:return"#750B1C";case n.a.warmGray:return"#7A7574";case n.a.cyan:return"#005B70";case n.a.rust:return"#8E562E";case n.a.coolGray:return"#69797E";case n.a.black:return"#1D1D1D";case n.a.gray:return"#393939"}}(o=void 0!==o?o:function(e){var t=n.a.blue;if(!e)return t;for(var i=0,o=e.length-1;o>=0;o--){var s=e.charCodeAt(o),l=o%8;i^=(s<<l)+(s>>8-l)}return t=r[i%a]}(i||t))}}}]);
//# sourceMappingURL=owa.MailBoot~HtmlEditorMentionsPlugin.js.map
self.scriptsLoaded['owa.MailBoot~HtmlEditorMentionsPlugin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~HtmlEditorMentionsPlugin.js'] = (new Date()).getTime();