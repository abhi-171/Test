self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ActionableMessageCardWrapper.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[471],{1249:function(e,t,n){"use strict";var r=n(469),a=n(701),i=n(0),o=n(12),s=n(382),l={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"};n.d(t,"a",(function(){return c}));var c=Object(r.a)(a.a,(function(e){var t,n,r,a,c,d,u,p,h,m,g,f,b,y,v,C,x,A,w=e.className,k=e.theme,E=e.reversed,S=e.checked,M=e.disabled,O=e.isUsingCustomLabelRender,D=e.indeterminate,P=k.semanticColors,T=k.effects,I=k.palette,R=k.fonts,_=Object(o.getGlobalClassNames)(l,k),j=P.inputForegroundChecked,F=I.neutralSecondary,H=I.neutralPrimary,V=P.inputBackgroundChecked,B=P.inputBackgroundChecked,N=P.disabledBodySubtext,q=P.inputBorderHovered,L=P.inputBackgroundCheckedHovered,W=P.inputBackgroundChecked,z=P.inputBackgroundCheckedHovered,U=P.inputBackgroundCheckedHovered,J=P.inputTextHovered,K=P.disabledBodySubtext,G=P.bodyText,Y=P.disabledText,Z=[(t={content:'""',borderRadius:T.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:M?N:V,transitionProperty:"border-width, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)"},t[o.HighContrastSelector]={borderColor:"WindowText"},t)];return{root:[_.root,{position:"relative",display:"flex"},E&&"reversed",S&&"is-checked",!M&&"is-enabled",M&&"is-disabled",!M&&[!S&&(n={},n[":hover ."+_.checkbox]=(r={borderColor:q},r[o.HighContrastSelector]={borderColor:"Highlight"},r),n[":focus ."+_.checkbox]={borderColor:q},n[":hover ."+_.checkmark]=(a={color:F,opacity:"1"},a[o.HighContrastSelector]={color:"Highlight"},a),n),S&&!D&&(c={},c[":hover ."+_.checkbox]={background:z,borderColor:U},c[":focus ."+_.checkbox]={background:z,borderColor:U},c[o.HighContrastSelector]=(d={},d[":hover ."+_.checkbox]={background:"Highlight",borderColor:"Highlight"},d[":focus ."+_.checkbox]={background:"Highlight"},d[":focus:hover ."+_.checkbox]={background:"Highlight"},d[":focus:hover ."+_.checkmark]={color:"Window"},d[":hover ."+_.checkmark]={color:"Window"},d),c),D&&(u={},u[":hover ."+_.checkbox+", :hover ."+_.checkbox+":after"]=(p={borderColor:L},p[o.HighContrastSelector]={borderColor:"WindowText"},p),u[":focus ."+_.checkbox]={borderColor:L},u[":hover ."+_.checkmark]={opacity:"0"},u),(h={},h[":hover ."+_.text+", :focus ."+_.text]=(m={color:J},m[o.HighContrastSelector]={color:M?"GrayText":"WindowText"},m),h)],w],input:(g={position:"absolute",background:"none",opacity:0},g["."+s.a+" &:focus + label::before"]=(f={outline:"1px solid "+k.palette.neutralSecondary,outlineOffset:"2px"},f[o.HighContrastSelector]={outline:"1px solid ActiveBorder"},f),g),label:[_.label,k.fonts.medium,{display:"flex",alignItems:O?"center":"flex-start",cursor:M?"default":"pointer",position:"relative",userSelect:"none"},E&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[_.checkbox,Object(i.__assign)((b={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:"20px",width:"20px",border:"1px solid "+H,borderRadius:T.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)",overflow:"hidden",":after":D?Z:null},b[o.HighContrastSelector]={borderColor:"WindowText"},b),Object(o.getEdgeChromiumNoHighContrastAdjustSelector)()),D&&{borderColor:V},E?{marginLeft:4}:{marginRight:4},!M&&!D&&S&&(y={background:W,borderColor:B},y[o.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},y),M&&(v={borderColor:N},v[o.HighContrastSelector]={borderColor:"GrayText"},v),S&&M&&(C={background:K,borderColor:N},C[o.HighContrastSelector]={background:"Window"},C)],checkmark:[_.checkmark,(x={opacity:S?"1":"0",color:j},x[o.HighContrastSelector]={color:M?"GrayText":"Window",MsHighContrastAdjust:"none"},x)],text:[_.text,Object(i.__assign)((A={color:M?Y:G,fontSize:R.medium.fontSize,lineHeight:"20px"},A[o.HighContrastSelector]={color:M?"GrayText":"WindowText"},A),Object(o.getEdgeChromiumNoHighContrastAdjustSelector)()),E?{marginRight:4}:{marginLeft:4}]}}),void 0,{scope:"Checkbox"})},1262:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),a=n(1);function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=a.useCallback((function(t){n.current=t;for(var r=0,a=e;r<a.length;r++){var i=a[r];"function"==typeof i?i(t):i&&(i.current=t)}}),Object(r.__spreadArrays)(e));return n}},1263:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),a=n(262);function i(e,t){var n=r.useRef(t);return n.current||(n.current=Object(a.a)(e)),n.current}},15480:function(e,t,n){(t=e.exports=n(106)(!1)).push([e.i,'._2R7wx7a9koHooJELbVyEWi{font-size:14px;font-weight:400;color:"[theme:white, default:#ffffff]"}._2p8I-DHLZpnIHT0vkKkDZM{position:fixed;bottom:30px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:1}._2p8I-DHLZpnIHT0vkKkDZM,._1EHVjHBO69jddHdTidAMN8{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._1EHVjHBO69jddHdTidAMN8{max-width:460px;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}html[dir] ._1EHVjHBO69jddHdTidAMN8{padding:8px;-webkit-box-shadow:0 1px 12px 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";box-shadow:0 1px 12px 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";background-color:"[theme:neutralSecondary, default:#605e5c]"}._2jPIBkdCALUVmJh3k1zkvO{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2;min-width:1px}html[dir] ._2jPIBkdCALUVmJh3k1zkvO{margin:0 8px}.iKqe_w_dK46ZPeqa2hzFB{font-size:18px}html[dir] .iKqe_w_dK46ZPeqa2hzFB{margin:8px}._1P08H1CEHzi04RDPSli-Fy{color:"[theme:white, default:#ffffff]";display:-webkit-box;display:-ms-flexbox;display:flex}._3TphKWxxta8paUeuXTArBr{font-size:10px;cursor:pointer}html[dir] ._3TphKWxxta8paUeuXTArBr{margin:8px}._1tED-VlMI_8p7Hayavw3uC{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;height:32px;line-height:32px}.YTDvfyvXnVtwubenDimsi{position:absolute;width:100%;height:100%;top:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:10}html[dir] .YTDvfyvXnVtwubenDimsi{background-color:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .YTDvfyvXnVtwubenDimsi{left:0}html[dir=rtl] .YTDvfyvXnVtwubenDimsi{right:0}._3fMwgRYr-98s_kP5E3Ao3W{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex}._3-Htj7JisEpn8gzJcl29c4{font-size:14px;font-weight:400;color:"[theme:white, default:#ffffff]"}html[dir] ._10ihrqubqPBOeDgvsdd16B{background-color:"[theme:neutralLighter, default:#f3f2f1]"!important}._3Sbt6wl1scVqEHeZKFsDeC{position:relative}html[dir] ._3Sbt6wl1scVqEHeZKFsDeC{border-color:"[theme:neutralLighter, default:#f3f2f1]";border-width:1px;border-style:solid}html[dir] ._3Sbt6wl1scVqEHeZKFsDeC .ms-ChoiceField{margin-top:0!important}html[dir] ._3Sbt6wl1scVqEHeZKFsDeC .ms-Checkbox{margin:8px 0}html[dir] ._3Sbt6wl1scVqEHeZKFsDeC .ms-Checkbox:first-child{margin-top:0}html[dir] ._3Sbt6wl1scVqEHeZKFsDeC .ms-Checkbox:last-child{margin-bottom:0}._1qH63D22WLA3KpkfRF6EAf{width:100%}.ac-pushButton{overflow:hidden;text-overflow:ellipsis;vertical-align:middle;cursor:default;font-family:Segoe UI,sans-serif;font-size:14px;font-weight:600;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;height:31px}html[dir] .ac-pushButton{text-align:center;padding:4px 10px 5px 10px;border:1px solid;margin-top:1px;margin-bottom:1px}[data-ac-theme=none] .ac-pushButton{color:"[theme:themePrimary, default:#0078D4]"}html[dir] [data-ac-theme=none] .ac-pushButton{background-color:"[theme:white, default:#ffffff]";border-color:"[theme:themePrimary, default:#0078D4]"}[data-ac-theme=none] .ac-pushButton:hover{color:"[theme:white, default:#ffffff]"}html[dir] [data-ac-theme=none] .ac-pushButton:hover{background-color:"[theme:themePrimary, default:#0078D4]";border-color:"[theme:themePrimary, default:#0078D4]"}html[dir] .ac-pushButton.primary,html[dir] .ac-pushButton:hover{border:1px solid}[data-ac-theme=none] .ac-pushButton.primary{color:"[theme:white, default:#ffffff]"}html[dir] [data-ac-theme=none] .ac-pushButton.primary{background-color:"[theme:themePrimary, default:#0078D4]";border-color:"[theme:themePrimary, default:#0078D4]"}html[dir] [data-ac-theme=none] .ac-pushButton.primary:hover{background-color:"[theme:themeDark, default:#0D62AA]"}.ac-pushButton:active{cursor:pointer}html[dir] .ac-pushButton.expanded{border:1px solid}[data-ac-theme=none] .ac-pushButton.expanded{color:"[theme:white, default:#ffffff]"}html[dir] [data-ac-theme=none] .ac-pushButton.expanded{background-color:"[theme:themePrimary, default:#0078D4]";border-color:"[theme:themePrimary, default:#0078D4]"}.ac-pushButton.expandable:after{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-block;font-family:controlIcons;font-size:10px;font-style:normal;font-weight:900;content:"\\E70D"}html[dir=ltr] .ac-pushButton.expandable:after{margin:auto 0 auto 6px}html[dir=rtl] .ac-pushButton.expandable:after{margin:auto 6px auto 0}.ac-pushButton.expandable.expanded:after{content:"\\E70E"}.ac-image.ac-selectable{cursor:pointer}.ac-anchor{text-decoration:none;display:inline-block}html[dir] .ac-anchor{margin-top:1px;margin-bottom:1px}.ac-anchor:link,.ac-anchor:visited{color:"[theme:themeDark, default:#0D62AA]"}.ac-anchor:link:active,.ac-anchor:visited:active{color:"[theme:themeDarker, default:#004578]"}html[dir] .ac-container.ac-selectable{padding:0}html[dir] .ac-container.ac-selectable:hover{background-color:"[theme:neutralLight, default:#edebe9]"!important}html[dir] .ac-container.ac-selectable:active{background-color:"[theme:neutralQuaternaryAlt, default:#e1dfdd]"!important}html[dir] .ac-columnSet.ac-selectable:hover{background-color:"[theme:neutralLight, default:#edebe9]"!important}html[dir] .ac-columnSet.ac-selectable:active{background-color:"[theme:neutralQuaternaryAlt, default:#e1dfdd]"!important}html[dir] .ac-input{padding:4px 12px}.ac-hidden{display:none!important}.aaf-progress-overlay{position:absolute;top:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir] .aaf-progress-overlay{background-color:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .aaf-progress-overlay{left:0}html[dir=rtl] .aaf-progress-overlay{right:0}@-webkit-keyframes _3ilbqWY3XudIKC4s2Ymqi7{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(-1turn);transform:rotate(-1turn)}}@-webkit-keyframes _1n_YmmDspFOJzaqxevLZPl{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes _3ilbqWY3XudIKC4s2Ymqi7{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(-1turn);transform:rotate(-1turn)}}@keyframes _1n_YmmDspFOJzaqxevLZPl{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.aaf-spinner{width:100%;height:100%;-webkit-animation-duration:1.5s;animation-duration:1.5s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:cubic-bezier(.53,.21,.29,.67);animation-timing-function:cubic-bezier(.53,.21,.29,.67)}html[dir] .aaf-spinner{border-radius:50%;border-width:1.5px;border-style:solid;border-color:"[theme:themePrimary, default:#0078D4]" "[theme:themeLight, default:#C7E0F4]" "[theme:themeLight, default:#C7E0F4]" "[theme:themeLight, default:#C7E0F4]"}html[dir=ltr] .aaf-spinner{-webkit-animation-name:_1n_YmmDspFOJzaqxevLZPl;animation-name:_1n_YmmDspFOJzaqxevLZPl}html[dir=rtl] .aaf-spinner{-webkit-animation-name:_3ilbqWY3XudIKC4s2Ymqi7;animation-name:_3ilbqWY3XudIKC4s2Ymqi7}html[dir] .aaf-refreshButtonHost{border-top:1px solid "[theme:neutralLighter, default:#f3f2f1]"}.ac-media-poster.empty{height:200px}html[dir] .ac-media-poster.empty{background-color:"[theme:neutralLighter, default:#f3f2f1]"}.ac-media-playButton{width:56px;height:56px;color:"[theme:white, default:#ffffff]";cursor:pointer}html[dir] .ac-media-playButton{border:1px solid "[theme:neutralLighter, default:#f3f2f1]";border-radius:28px;-webkit-box-shadow:0 0 10px "[theme:neutralLighter, default:#f3f2f1]";box-shadow:0 0 10px "[theme:neutralLighter, default:#f3f2f1]";background-color:"[theme:whiteTranslucent40, default:rgba(255, 255, 255, .4)]"}html[dir] .ac-media-playButton:hover{background-color:"[theme:white, default:#ffffff]";border-color:"[theme:neutralLight, default:#edebe9]";-webkit-box-shadow:0 0 10px "[theme:neutralLight, default:#edebe9]";box-shadow:0 0 10px "[theme:neutralLight, default:#edebe9]"}.ac-media-playButton-arrow{width:auto!important;height:auto!important;color:"[theme:themePrimary, default:#0078D4]"}.ac-inlineActionButton{overflow:hidden;text-overflow:ellipsis;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;height:32px}html[dir] .ac-inlineActionButton{text-align:center;background-color:transparent}html[dir] .ac-inlineActionButton:hover{background-color:"[theme:neutralLighter, default:#f3f2f1]"}html[dir] .ac-inlineActionButton:active{background-color:"[theme:neutralLight, default:#edebe9]"}',""]),t.locals={actionResponseMessage:"_2R7wx7a9koHooJELbVyEWi",actionResponseContainer:"_2p8I-DHLZpnIHT0vkKkDZM",actionResponseWrapper:"_1EHVjHBO69jddHdTidAMN8",actionResponseMessageContainer:"_2jPIBkdCALUVmJh3k1zkvO",actionResponseStatusIconContainer:"iKqe_w_dK46ZPeqa2hzFB",actionResponseIcon:"_1P08H1CEHzi04RDPSli-Fy",actionResponseCloseIconContainer:"_3TphKWxxta8paUeuXTArBr",acknowledgeButtonText:"_1tED-VlMI_8p7Hayavw3uC",actionInProgressOverlay:"YTDvfyvXnVtwubenDimsi",actionInProgressSpinner:"_3fMwgRYr-98s_kP5E3Ao3W",actionInProgressLabel:"_3-Htj7JisEpn8gzJcl29c4",compactCard:"_10ihrqubqPBOeDgvsdd16B",container:"_3Sbt6wl1scVqEHeZKFsDeC",inputElementWrapper:"_1qH63D22WLA3KpkfRF6EAf","aaf-spinner-rotate":"_1n_YmmDspFOJzaqxevLZPl","aaf-spinner-rotate-rtl":"_3ilbqWY3XudIKC4s2Ymqi7"}},15487:function(e,t,n){(e.exports=n(106)(!1)).push([e.i,'.compactMessageCard-ac-pushButton{overflow:hidden;text-overflow:ellipsis;vertical-align:middle;cursor:pointer;font-family:Segoe UI,sans-serif;font-size:12px;font-weight:600;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html[dir] .compactMessageCard-ac-pushButton{text-align:center}[data-ac-theme=none] .compactMessageCard-ac-pushButton{color:"[theme:themePrimary, default:#0078D4]"}html[dir] [data-ac-theme=none] .compactMessageCard-ac-pushButton,html[dir] [data-ac-theme=none] .compactMessageCard-ac-pushButton:hover{background-color:transparent}.compactMessageCard-ac-pushButton:active{cursor:pointer}[data-ac-theme=none] .compactMessageCard-ac-pushButton.expanded{color:"[theme:white, default:#ffffff]"}.compactMessageCard-ac-pushButton.expandable:after{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-block;font-family:controlIcons;font-size:10px;font-style:normal;font-weight:900;content:"\\E70D"}html[dir=ltr] .compactMessageCard-ac-pushButton.expandable:after{margin:auto 0 auto 6px}html[dir=rtl] .compactMessageCard-ac-pushButton.expandable:after{margin:auto 6px auto 0}.compactMessageCard-ac-pushButton.expandable.expanded:after{content:"\\E70E"}.compactMessageCard-ac-image.ac-selectable{cursor:pointer}.compactMessageCard-ac-anchor{text-decoration:none}.compactMessageCard-ac-anchor:link,.compactMessageCard-ac-anchor:visited{color:"[theme:themeDark, default:#0D62AA]"}.compactMessageCard-ac-anchor:link:active,.compactMessageCard-ac-anchor:visited:active{color:"[theme:themeDarker, default:#004578]"}html[dir] .compactMessageCard-ac-container.ac-selectable{padding:0}html[dir] .compactMessageCard-ac-container.ac-selectable:hover{background-color:"[theme:neutralLight, default:#edebe9]"!important}html[dir] .compactMessageCard-ac-container.ac-selectable:active{background-color:"[theme:neutralQuaternaryAlt, default:#e1dfdd]"!important}html[dir] .compactMessageCard-ac-columnSet.ac-selectable:hover{background-color:"[theme:neutralLight, default:#edebe9]"!important}html[dir] .compactMessageCard-ac-columnSet.ac-selectable:active{background-color:"[theme:neutralQuaternaryAlt, default:#e1dfdd]"!important}html[dir] .compactMessageCard-ac-input{padding:4px 12px}.compactMessageCard-ac-textBlock{font-size:14px;font-weight:400}',""])},17105:function(e,t,n){"use strict";n.r(t);var r,a,i=n(0),o=n(1),s=n(692),l=n(888),c=n(1252),d=n(352),u=n(2137),p=n(134),h=n(34),m=n(208),g=n(40),f=n(3817),b=n(7326);!function(e){e[e.Success=0]="Success",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(r||(r={})),function(e){e[e.AutoDismiss=0]="AutoDismiss",e[e.Freeze=1]="Freeze"}(a||(a={}));var y=n(32),v=n(348),C=n(883),x="action:",A="default",w="compact",k="amCardContent",E="640px",S="left",M="ActionCardExpanded",O="ActionCardCollapsed",D="MessageCardRendered",P="MessageCardHidden",T="MessageCardRemoved",I="MessageCardViewActionClicked",R="HttpPostActionExecuted",_="actionContext",j=6e5,F=1e3,H=n(198),V=n(1853),B=n(4634),N=Object(y.a)((function(e){var t=o.useRef(null),n=Object(i.__read)(o.useState(640),2),s=n[0],l=n[1],c=null;o.useEffect((function(){if(e.viewType===a.AutoDismiss){var t=e.autoDismissTimeout||8e3;c=setTimeout((function(){return e.onHideActionResponse()}),t)}return u(),function(){c&&clearTimeout(c)}}),[]);var d,u=function(){(null==t?void 0:t.current)&&l(t.current.parentNode.offsetWidth)};Object(V.a)("resize",u),d=e.type===r.Success?"Completed":"Info";var p={root:{backgroundColor:Object(H.h)().neutralLighter,borderColor:Object(H.h)().white,color:Object(H.h)().neutralPrimary,marginLeft:"8px",marginRight:"8px",paddingLeft:"4px",paddingRight:"4px"},rootHovered:{backgroundColor:Object(H.h)().neutralLighterAlt,borderColor:Object(H.h)().white,color:Object(H.h)().neutralPrimary},rootPressed:{backgroundColor:Object(H.h)().white,borderColor:Object(H.h)().white,color:Object(H.h)().neutralPrimary},textContainer:{overflow:"hidden"},label:B.acknowledgeButtonText};return e.message&&o.createElement("div",{style:{width:s},className:B.actionResponseContainer,ref:t},o.createElement("div",{className:B.actionResponseWrapper},o.createElement("div",{className:B.actionResponseStatusIconContainer},o.createElement(v.a,{iconName:d,className:B.actionResponseIcon})),o.createElement("div",{className:B.actionResponseMessageContainer},o.createElement("div",{className:B.actionResponseMessage},e.message)),e.acknowledgeButtonText&&e.onAcknowledgeActionResponse?o.createElement(C.a,{text:e.acknowledgeButtonText,title:e.acknowledgeButtonText,ariaLabel:e.acknowledgeButtonText,styles:p,onClick:e.onAcknowledgeActionResponse}):"",o.createElement("div",{className:B.actionResponseCloseIconContainer,onClick:function(){e.onHideActionResponse()}},o.createElement(v.a,{iconName:"ChromeClose",className:B.actionResponseIcon}))))})),q=n(6547),L=n(7327);function W(e,t){return void 0===t&&(t="default"),Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(a){switch(a.label){case 0:return e?[3,1]:(h.g.info("No download theme callback provided"),Object(L.a)(3),[3,5]);case 1:if(0!==f.a.themeStore.loadStatus)return[3,5];Object(L.a)(1),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,e(t)];case 3:return n=a.sent(),Object.keys(n).forEach((function(e){Object(q.a)(e,n[e])})),Object(L.a)(2),[3,5];case 4:return r=a.sent(),h.g.info("Error downloading theme definitions: "+r),Object(L.a)(3),[3,5];case 5:return[2]}}))}))}var z=function(e){function t(t){var n=e.call(this,t)||this;return n.cardHorizontalAlignment=t.cardHorizontalAlignment,n.cardMaximumWidth=t.cardMaximumWidth,n.cardHostBackgroundColor=t.cardHostBackgroundColor,n}return Object(i.__extends)(t,e),t}(u.HostConfig),U="640px";function J(){var e=new u.HostConfig({choiceSetInputValueSeparator:",",spacing:{small:10,default:12,medium:14,large:16,extraLarge:18,padding:8},separator:{lineThickness:1,lineColor:"#19000000"},supportsInteractivity:!0,fontFamily:"wf_segoe-ui_normal, sans-serif",fontSizes:{small:10,default:12,medium:14,large:16,extraLarge:18},fontWeights:{lighter:200,default:400,bolder:600},containerStyles:{default:{highlightBackgroundColor:"#f0f0f0",highlightForegroundColor:"#000000",backgroundColor:"#EAEAEA",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#FFD800",subtle:"#DDFFD800"},good:{default:"#00FF00",subtle:"#DD00FF00"},warning:{default:"#FF0000",subtle:"#DDFF0000"}}},emphasis:{backgroundColor:"#E0E0E0",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#FFD800",subtle:"#DDFFD800"},good:{default:"#00FF00",subtle:"#DD00FF00"},warning:{default:"#FF0000",subtle:"#DDFF0000"}}}},imageSizes:{small:16,medium:32,large:64},actions:{maxActions:5,spacing:u.Spacing.Default,buttonSpacing:20,showCard:{actionMode:u.ShowCardActionMode.Inline,inlineTopMargin:10},actionsOrientation:u.Orientation.Horizontal,actionAlignment:u.ActionAlignment.Left,preExpandSingleShowCardAction:!0},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:u.Size.Medium,maxImageHeight:100},factSet:{title:{color:u.TextColor.Default,size:u.TextSize.Default,isSubtle:!1,weight:u.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:u.TextColor.Default,size:u.TextSize.Default,isSubtle:!1,weight:u.TextWeight.Default,wrap:!0},spacing:10}});return e.cardHorizontalAlignment="center",e.cardMaximumWidth=U,e.cssClassNamePrefix="compactMessageCard",e}function K(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){var r;return e=e.toLowerCase(),t={hostConfig:(r=new u.HostConfig({choiceSetInputValueSeparator:",",spacing:{small:8,default:16,medium:16,large:24,extraLarge:32,padding:16},separator:{lineThickness:1,lineColor:"#e1e1e1"},supportsInteractivity:!0,fontFamily:"Segoe UI, sans-serif",fontSizes:{small:12,default:14,medium:16,large:18,extraLarge:20},fontWeights:{lighter:200,default:400,bolder:600},containerStyles:{default:{highlightBackgroundColor:"#f0f0f0",highlightForegroundColor:"#000000",backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#212121",subtle:"#8e8e93"},dark:{default:"#1f1f1f",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d4",subtle:"#69AFE5"},attention:{default:"#E4252B",subtle:"#F17a7D"},good:{default:"#0A8533",subtle:"#5BA975"},warning:{default:"#FFA800",subtle:"#F2BE4D"}}},emphasis:{backgroundColor:"#F8F8F8",foregroundColors:{default:{default:"#212121",subtle:"#8e8e93"},dark:{default:"#1f1f1f",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d4",subtle:"#69AFE5"},good:{default:"#0a8031",subtle:"#5BA975"},warning:{default:"#FFA800",subtle:"#F2BE4D"},attention:{default:"#DA1b21",subtle:"#F17a7d"}}},customStyles:[{name:"outlookHeader",style:{foregroundColors:{default:{default:"#ffffff",subtle:"#8e8e93"},dark:{default:"#1f1f1f",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d4",subtle:"#69AFE5"},good:{default:"#0A8533",subtle:"#5BA975"},warning:{default:"#FFA800",subtle:"#F2BE4D"},attention:{default:"#E4252B",subtle:"#F17a7D"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#0078D4"}}]},imageSizes:{small:40,medium:160,large:320},actions:{maxActions:5,spacing:u.Spacing.Default,buttonSpacing:16,showCard:{actionMode:u.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:u.Orientation.Horizontal,actionAlignment:u.ActionAlignment.Left,preExpandSingleShowCardAction:!0},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:u.Size.Medium,maxImageHeight:100},factSet:{title:{color:u.TextColor.Default,size:u.TextSize.Default,isSubtle:!0,weight:u.TextWeight.Lighter,wrap:!0,maxWidth:150},value:{color:u.TextColor.Default,size:u.TextSize.Default,isSubtle:!1,weight:u.TextWeight.Default,wrap:!0},spacing:8}}),r.cardHorizontalAlignment="center",r.cardMaximumWidth=U,r),isResolved:!0,stylesheetUrl:null,themeConfigUrl:null},2!==f.a.themeStore.loadStatus?[2,Promise.resolve(t)]:"default"===e?[2,Promise.resolve(t)]:"compact"===e?[2,Promise.resolve({hostConfig:J(),isResolved:!0,stylesheetUrl:null,themeConfigUrl:null})]:[2,G(e).then((function(e){return Promise.resolve(e)})).catch((function(e){return h.g.info("Error resolving theme: "+e),Promise.resolve(t)}))]}))}))}function G(e){return new Promise((function(t,n){var r=f.a.themeStore.loadStatus;switch(h.g.info("Theme definitions load status: "+r),r){case 2:var a=f.a.themeStore.themeMapping[e];a?a.isResolved?t(a):function(e,t){return new Promise((function(n,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status)try{var i=JSON.parse(a.response),o={themeConfigUrl:t,hostConfig:new z(i.hostConfig),isResolved:!0,stylesheetUrl:i.stylesheet};Object(q.a)(e,o),n(o)}catch(e){r(new Error("downloadTheme: error parsing response json"))}else r(new Error("downloadTheme http error: received "+a.status))},a.ontimeout=function(){r(new Error("downloadTheme timeout"))},a.open("GET",t,!0),a.timeout=2e3,a.send()}))}(e,a.themeConfigUrl).then((function(e){t(e)})).catch((function(e){n(e)})):n("No theme matching name "+e+" found in store");break;case 3:n("Could not resolve theme. Themes were not loaded")}}))}var Y="#eeeeee";var Z=n(269),X=n(962),Q=n(54),$=n(987),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){this.personaElement=document.createElement("div");var e=o.createElement(te,{emailAddress:this.email,name:""});return Z.render(e,this.personaElement),this.personaElement},t.prototype.remove=function(){return this.personaElement&&(Z.unmountComponentAtNode(this.personaElement),this.personaElement=null),e.prototype.remove.call(this)},t.prototype.getJsonTypeName=function(){return"Persona"},t.prototype.renderSpeech=function(){return this.email},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.email=t.email},t}(u.CardElement);function te(e){var t=Object($.a)(e),n=e.emailAddress,r=e.name,a=e.mailBoxType;return o.createElement(t,null,o.createElement(X.a,{emailAddress:n,name:r,size:Q.c.size48,showPersonaDetails:!1,mailboxType:a}))}var ne,re=n(1249),ae=n(7785),ie=n(1602),oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.choices=[],t.isCompact=!1,t.isMultiSelect=!1,t.wrap=!1,t.isRequired=!1,t.onDropdownChanged=function(e,n){t.selectedChoiceIndices=[n]},t.onChoiceGroupChanged=function(e,n){t.selectedChoiceIndices=[n.index]},t}return Object(i.__extends)(t,e),t.prototype.renderCheckboxGroup=function(e){for(var t=this,n=[],r=function(r){n.push(o.createElement(re.a,{defaultChecked:e.filter((function(e){return e===t.choices[r].value})).length>0,label:a.choices[r].title,onChange:a.getOnCheckboxChangedHandler(r)}))},a=this,i=0;i<this.choices.length;i++)r(i);return o.createElement(o.Fragment,null,n)},t.prototype.getOnCheckboxChangedHandler=function(e){var t=this;return function(n,r){r?t.selectedChoiceIndices.push(e):t.selectedChoiceIndices.splice(t.selectedChoiceIndices.indexOf(e),1)}},t.prototype.parseValueString=function(e){return e?e.split(this.hostConfig.choiceSetInputValueSeparator):[]},t.prototype.internalRender=function(){if(this.element=document.createElement("div"),this.element.style.width="100%",!this.initialized)return h.g.warn("[ActionableMessageDebug] CustomChoiceSetInput: Control not initialized before render"),this.element;if(this.isMultiSelect)Z.render(this.renderCheckboxGroup(this.parseValueString(this.defaultValue)),this.element);else if(this.isCompact){var e=this.placeholder||t.strings.placeholder.choiceSetInput;Z.render(o.createElement(o.StrictMode,null,o.createElement(ie.a,{onChanged:this.onDropdownChanged,label:this.title,options:this.mappedChoices,defaultSelectedKey:this.defaultValue,placeHolder:e,required:this.isRequired})),this.element)}else Z.render(o.createElement(o.StrictMode,null,o.createElement(ae.a,{onChange:this.onChoiceGroupChanged,label:this.title,options:this.mappedChoices,defaultSelectedKey:this.defaultValue,required:this.isRequired})),this.element);return this.element},t.prototype.initialize=function(){var e=this;this.mappedChoices=this.choices.map((function(e,t){return{key:e.value,text:e.title,index:t}})),this.selectedChoiceIndices=[];for(var t=this.parseValueString(this.defaultValue),n=function(n){t.filter((function(t){return t===e.choices[n].value})).length>0&&r.selectedChoiceIndices.push(n)},r=this,a=0;a<this.choices.length;a++)n(a);this.initialized=!0},t.prototype.toJSON=function(){var t,n,r=e.prototype.toJSON.call(this);if(this.choices.length>0){var a=[];try{for(var o=Object(i.__values)(this.choices),s=o.next();!s.done;s=o.next()){var l=s.value;a.push(l.toJSON())}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}Object(u.setProperty)(r,"choices",a)}return this.isCompact||Object(u.setProperty)(r,"style","expanded",!1),Object(u.setProperty)(r,"isMultiSelect",this.isMultiSelect,!1),Object(u.setProperty)(r,"wrap",this.wrap,!1),Object(u.setProperty)(r,"placeholder",this.placeholder),Object(u.setProperty)(r,"isRequired",this.isRequired,!1),r},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),this.isCompact=!("expanded"===t.style),this.isMultiSelect=Object(u.getBoolValue)(t.isMultiSelect,this.isMultiSelect),this.placeholder=Object(u.getStringValue)(t.placeholder,this.placeholder),this.choices=[],null!=t.choices)for(var r=t.choices,a=0;a<r.length;a++){var i=new u.Choice;i.parse(r[a]),this.choices.push(i)}this.wrap=Object(u.getBoolValue)(t.wrap,this.wrap),this.isRequired=Object(u.getBoolValue)(t.isRequired,this.isRequired),this.initialize()},t.prototype.remove=function(){return this.element&&(Z.unmountComponentAtNode(this.element),this.element=null),e.prototype.remove.call(this)},t.prototype.internalValidateProperties=function(e){this.isRequired&&!this.value&&e.addFailure(this,{error:u.ValidationError.InvalidPropertyValue,message:t.strings.warning.missingRequiredInput})},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},Object.defineProperty(t.prototype,"value",{get:function(){var e="";if(this.selectedChoiceIndices)for(var t=0;t<this.selectedChoiceIndices.length;t++){""!==e&&(e+=this.hostConfig.choiceSetInputValueSeparator);var n=this.selectedChoiceIndices[t];this.choices[n].value?e+=this.choices[n].value:e+=this.choices[n].title}return e},enumerable:!1,configurable:!0}),t}(u.Input),se=n(5),le=n(1467),ce=n(64),de=n(4634),ue=n.n(de),pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectedDate=null,t.isRequired=!1,t.onSelectDate=function(e){e instanceof Date&&(t.selectedDate=e)},t.dateNotValid=function(){return t.isRequired&&null===t.selectedDate},t}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){this.datePickerElement=document.createElement("div"),this.datePickerElement.className=ue.a.inputElementWrapper;var e=new Date(Object(se.m)(Object(se.lc)()).getTime()),n=this.defaultValue?new Date(Object(se.m)(Object(se.lc)(this.defaultValue)).getTime()):null,r=this.min?new Date(Object(se.m)(Object(se.lc)(this.min)).getTime()):null,a=this.max?new Date(Object(se.m)(Object(se.lc)(this.max)).getTime()):null,i=this.placeholder||t.strings.placeholder.dateInput;return Z.render(o.createElement(o.StrictMode,null,o.createElement(le.a,{strings:t.strings.datePicker,isMonthPickerVisible:!1,showMonthPickerAsOverlay:!0,firstDayOfWeek:ce.c.Sunday,today:e,value:n,minDate:r,maxDate:a,isRequired:this.isRequired,placeholder:i,ariaLabel:i,onSelectDate:this.onSelectDate})),this.datePickerElement),this.datePickerElement},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(u.setProperty)(t,"min",this.min),Object(u.setProperty)(t,"max",this.max),Object(u.setProperty)(t,"isRequired",this.isRequired,!1),Object(u.setProperty)(t,"placeholder",this.placeholder),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.min=Object(u.getStringValue)(t.min),this.max=Object(u.getStringValue)(t.max),this.isRequired=Object(u.getBoolValue)(t.isRequired,this.isRequired),this.placeholder=Object(u.getStringValue)(t.placeholder,this.placeholder),this.defaultValue&&(this.selectedDate=new Date(Object(se.m)(Object(se.lc)(this.defaultValue)).getTime()))},t.prototype.remove=function(){return this.datePickerElement&&(Z.unmountComponentAtNode(this.datePickerElement),this.datePickerElement=null),e.prototype.remove.call(this)},t.prototype.internalValidateProperties=function(e){return this.dateNotValid()&&e.addFailure(this,{error:u.ValidationError.InvalidPropertyValue,message:t.strings.warning.missingRequiredInput}),[]},t.prototype.getJsonTypeName=function(){return"Input.Date"},Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){this._min=this.parseInputValue(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){this._max=this.parseInputValue(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.selectedDate?this.selectedDate.toISOString():null},enumerable:!1,configurable:!0}),t}(u.Input),he=n(1277);function me(e,t,n){if(null!=e){var r=Number(e);if(isNaN(r))return ne.NotNumber;if(""!=e){if(n&&Number(n)<r)return ne.MoreThanMax;if(t&&Number(t)>r)return ne.LessThanMin}}return ne.Ok}!function(e){e[e.Ok=0]="Ok",e[e.NotNumber=1]="NotNumber",e[e.LessThanMin=2]="LessThanMin",e[e.MoreThanMax=3]="MoreThanMax"}(ne||(ne={}));var ge=Object(y.a)((function(e){var t=Object(i.__read)(o.useState(e.value),2),n=t[0],r=t[1],a=e.min,s=e.max;return o.createElement(he.a,{type:"number",value:n,min:a,max:s,onChange:function(t,n){e.onValueChanged(n),r(n)},required:e.required,placeholder:e.placeholder,onGetErrorMessage:function(t){var n=e.strings,r=e.onValueChanged,i=me(t,a,s);switch(r(t),i){case ne.LessThanMin:return n.format(n.warning.inputNumberLessThanMin,a);case ne.MoreThanMax:return n.format(n.warning.inputNumberMoreThanMax,s);case ne.NotNumber:return n.warning.inputNumberNotNumeric;case ne.Ok:default:return""}}})})),fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isRequired=!1,t.getNumberString=function(e){return"number"==typeof e?e.toString():e},t.onTextFieldValueChanged=function(e){t.currentValue=e},t}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){this.numberTextFieldElement=document.createElement("div"),this.numberTextFieldElement.className=ue.a.inputElementWrapper;var e=this.placeholder||t.strings.placeholder.numberInput;return Z.render(o.createElement(o.StrictMode,null,o.createElement(ge,{placeholder:e,onValueChanged:this.onTextFieldValueChanged,min:this.min,max:this.max,required:this.isRequired,value:this.defaultValue,strings:t.strings})),this.numberTextFieldElement),this.numberTextFieldElement},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(u.setProperty)(t,"min",this.min),Object(u.setProperty)(t,"max",this.max),Object(u.setProperty)(t,"placeholder",this.placeholder),Object(u.setProperty)(t,"isRequired",this.isRequired,!1),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.min=this.getNumberString(t.min),this.max=this.getNumberString(t.max),this.placeholder=Object(u.getStringValue)(t.placeholder),this.isRequired=Object(u.getBoolValue)(t.isRequired,this.isRequired)},t.prototype.remove=function(){return this.numberTextFieldElement&&(Z.unmountComponentAtNode(this.numberTextFieldElement),this.numberTextFieldElement=null),e.prototype.remove.call(this)},t.prototype.internalValidateProperties=function(e){this.isRequired&&!this.currentValue?e.addFailure(this,{error:u.ValidationError.InvalidPropertyValue,message:t.strings.warning.missingRequiredInput}):me(this.value,this.min,this.max)!==ne.Ok&&e.addFailure(this,{error:u.ValidationError.InvalidPropertyValue,message:t.strings.warning.invalidInput})},t.prototype.getJsonTypeName=function(){return"Input.Number"},Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){this._min=this.parseInputValue(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){this._max=this.parseInputValue(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.currentValue},enumerable:!1,configurable:!0}),t}(u.Input),be=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.isRequired=!1,n.setTextFieldRef=function(e){n.textField=e},n.textNotValid=function(e){return n.isRequired&&""===e},n.validateText=function(e){return n.textNotValid(e)?t.strings.warning.requiredField:""},n.getMaxLength=function(e){var t;return void 0===e||void 0===n.defaultValue?t:t=Math.max(e,n.defaultValue.length)},n}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){this.textFieldElement=document.createElement("div"),this.textFieldElement.className=ue.a.inputElementWrapper;var e=this.placeholder||t.strings.placeholder.textInput;return Z.render(o.createElement(o.StrictMode,null,o.createElement(he.a,{required:this.isRequired,componentRef:this.setTextFieldRef,maxLength:this.maxLength,placeholder:e,multiline:this.isMultiline,onGetErrorMessage:this.validateText,defaultValue:this.defaultValue,title:e})),this.textFieldElement),this.textFieldElement},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(u.setProperty)(t,"placeholder",this.placeholder),Object(u.setProperty)(t,"maxLength",this.maxLength,0),Object(u.setProperty)(t,"isMultiline",this.isMultiline,!1),Object(u.setProperty)(t,"isRequired",this.isRequired,!1),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.maxLength=this.getMaxLength(t.maxLength),this.isMultiline=Object(u.getBoolValue)(t.isMultiline,this.isMultiline),this.placeholder=Object(u.getStringValue)(t.placeholder),this.isRequired=Object(u.getBoolValue)(t.isRequired,this.isRequired)},t.prototype.remove=function(){return this.textFieldElement&&(Z.unmountComponentAtNode(this.textFieldElement),this.textFieldElement=null),e.prototype.remove.call(this)},t.prototype.internalValidateProperties=function(e){return this.textNotValid(this.value)&&e.addFailure(this,{error:u.ValidationError.InvalidPropertyValue,message:t.strings.warning.missingRequiredInput}),[]},t.prototype.getJsonTypeName=function(){return"Input.Text"},Object.defineProperty(t.prototype,"value",{get:function(){return this.textField?this.textField.value:""},enumerable:!1,configurable:!0}),t}(u.Input),ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checked=!1,t.valueOn="true",t.valueOff="false",t.wrap=!1,t.isRequired=!1,t.onCheckboxChanged=function(e,n){t.checked=n},t}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){return this.checkboxElement=document.createElement("div"),Z.render(o.createElement(o.StrictMode,null,o.createElement(re.a,{defaultChecked:this.checked,onChange:this.onCheckboxChanged,label:this.title})),this.checkboxElement),this.checkboxElement},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(u.setProperty)(t,"valueOn",this.valueOn,"true"),Object(u.setProperty)(t,"valueOff",this.valueOff,"false"),Object(u.setProperty)(t,"wrap",this.wrap),Object(u.setProperty)(t,"isRequired",this.isRequired,!1),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.title=Object(u.getStringValue)(t.title),this.checked=Object(u.getBoolValue)(t.value,this.checked),this.valueOn=Object(u.getStringValue)(t.valueOn,this.valueOn),this.valueOff=Object(u.getStringValue)(t.valueOff,this.valueOff),this.wrap=Object(u.getBoolValue)(t.wrap,this.wrap),this.isRequired=Object(u.getBoolValue)(t.isRequired,this.isRequired)},t.prototype.remove=function(){return this.checkboxElement&&(Z.unmountComponentAtNode(this.checkboxElement),this.checkboxElement=null),e.prototype.remove.call(this)},t.prototype.internalValidateProperties=function(e){return this.isRequired&&!this.checked&&e.addFailure(this,{error:u.ValidationError.InvalidPropertyValue,message:t.strings.warning.missingRequiredInput}),[]},t.prototype.getJsonTypeName=function(){return"Input.Toggle"},Object.defineProperty(t.prototype,"value",{get:function(){return this.checked?this.valueOn:this.valueOff},enumerable:!1,configurable:!0}),t}(u.Input),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){if(!this.smtp||!Object(g.i)("rp-actionableMessages-lpc"))return e.prototype.internalRender.call(this);var t,n=window.LivePersonaCardHoverTargetV2;this.lpcElement=document.createElement("div");var r=o.createElement(n,{cardParameters:{personaInfo:{identifiers:{Smtp:this.smtp,PersonaType:"User"}},behavior:{locationToOpen:"Card"}}},o.createElement("div",{ref:function(e){return t=e}}));return Z.render(r,this.lpcElement),t.appendChild(e.prototype.internalRender.call(this)),this.lpcElement},t.prototype.remove=function(){return this.lpcElement&&(Z.unmountComponentAtNode(this.lpcElement),this.lpcElement=null),e.prototype.remove.call(this)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.smtp=t.smtp},t}(u.Image),Ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderLPC=function(e){var n=window.LivePersonaCardHoverTargetV2,r=o.createElement(n,{cardParameters:{personaInfo:{identifiers:{Smtp:e.smtp,PersonaType:"User"}},behavior:{locationToOpen:"Card"}}},o.createElement("span",{"data-debug":e.name,style:{display:"inline-block"}},e.name)),a=t.lpcElement.querySelector("[data-mention-name='"+e.name+"']");Z.render(r,a)},t}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){var t=this,n=e.prototype.internalRender.call(this),r=null==n?void 0:n.firstElementChild;if(r instanceof HTMLOListElement||r instanceof HTMLUListElement||r instanceof HTMLDListElement){var a=r;a.style.width="",a.style.maxWidth="100%"}return Object(g.i)("rp-actionableMessages-lpc")&&this.mentions&&0!=this.mentions.length?(this.lpcElement=n,this.mentions.forEach((function(e){t.lpcElement.innerHTML=t.lpcElement.innerHTML.replace(new RegExp(e.name,"i"),'<span data-mention-name="'+e.name+'"></span>')})),this.mentions.forEach((function(e){return t.renderLPC(e)})),this.lpcElement):n},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.mentions=t.mentions},t}(u.TextBlock),xe=function(){var e;e=u.ImageSet.prototype.render,u.ImageSet.prototype.render=function(){var t=e.call(this);return t&&(t.style.overflow="auto"),t}},Ae=n(8122),we=!1,ke=function(e,t){var n=Ae().render(e);t.didProcess=!0,t.outputHtml=n},Ee=function(e){h.g.warn("[ActionableMessageDebug] parseError: Error parsing adaptive card. Error: "+e.message)},Se=function(e,t){var n;("boolean"==typeof t.isVisible&&(e.isVisible=t.isVisible),"Column"===e.getJsonTypeName()&&void 0!==t.pixelWidth&&(e.pixelWidth=t.pixelWidth),e instanceof u.Image&&"string"==typeof t.backgroundColor&&(e.backgroundColor=t.backgroundColor),e instanceof u.Container)&&((n=Me(t.padding))&&(e.padding=n));e instanceof u.ColumnSet&&((n=Me(t.padding))&&(e.padding=n))},Me=function(e){if("string"==typeof e){var t=Object(u.getEnumValue)(u.Spacing,e,u.Spacing.None);return new u.PaddingDefinition(t,t,t,t)}return"object"==typeof e?new u.PaddingDefinition(Object(u.getEnumValue)(u.Spacing,e.top,u.Spacing.None),Object(u.getEnumValue)(u.Spacing,e.right,u.Spacing.None),Object(u.getEnumValue)(u.Spacing,e.bottom,u.Spacing.None),Object(u.getEnumValue)(u.Spacing,e.left,u.Spacing.None)):null},Oe=function(e,t){we||(we=!0,u.AdaptiveCard.allowMarkForTextHighlighting=!0,u.AdaptiveCard.onParseError=Ee,u.AdaptiveCard.onProcessMarkdown=ke,u.AdaptiveCard.onParseElement=Se,function(e){pe.strings=e,u.AdaptiveCard.elementTypeRegistry.registerType("Input.Date",(function(){return new pe})),be.strings=e,u.AdaptiveCard.elementTypeRegistry.registerType("Input.Text",(function(){return new be})),fe.strings=e,u.AdaptiveCard.elementTypeRegistry.registerType("Input.Number",(function(){return new fe})),ye.strings=e,u.AdaptiveCard.elementTypeRegistry.registerType("Input.Toggle",(function(){return new ye})),oe.strings=e,u.AdaptiveCard.elementTypeRegistry.registerType("Input.ChoiceSet",(function(){return new oe})),u.AdaptiveCard.elementTypeRegistry.registerType("TextBlock",(function(){return new Ce})),u.AdaptiveCard.elementTypeRegistry.registerType("Image",(function(){return new ve})),u.AdaptiveCard.elementTypeRegistry.registerType("Persona",(function(){return new ee})),u.AdaptiveCard.elementTypeRegistry.registerType("ActionSet",(function(){return new u.ActionSet}))}(t),xe()),function(e){e.forEach((function(e){e&&e.registerActions()}))}(e)},De=n(7569);function Pe(e,t,n,r,a,o){var s,l;try{if("string"==typeof n){s=JSON.parse(n);var c=De.sha256().update(n).digest();l=btoa(String.fromCharCode.apply(null,new Uint8Array(c)))}else s=n}catch(e){throw new Error("[ActionableMessageCard] RenderCard: unable to cardSerialized property"+e.message)}return Object(i.__assign)(Object(i.__assign)({},e),{connectorSenderGuid:t,isAdaptiveCard:void 0===a?"AdaptiveCard"===s.type:a,cardSignature:r,card:s,cardHash:l,cardId:o||Object(m.a)()})}var Te=function(e){function t(t){var n=e.call(this)||this;return n._logTelemetryForAction=t,n}return Object(i.__extends)(t,e),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(u.setProperty)(t,"rtl",this.rtl,!1),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.rtl=Object(u.getBoolValue)(t.rtl,this.rtl)},Object.defineProperty(t.prototype,"logTelemetryForAction",{get:function(){return this._logTelemetryForAction},enumerable:!1,configurable:!0}),t}(u.AdaptiveCard),Ie="article";function Re(e,t,n){void 0===t&&(t=u.Size.Medium),void 0===n&&(n=u.ImageStyle.Default);var r=new u.Image;return r.url=e.image,r.size=e.size?e.size:t,r}function _e(e,t){var n=new u.Container;e.title&&((r=new u.TextBlock).text=e.title,r.size=u.TextSize.Medium,r.wrap=!0,n.addItem(r));if(e.startGroup?(n.separator=!0,n.spacing=u.Spacing.Large):n.spacing=u.Spacing.Medium,e.activityTitle||e.activitySubtitle||e.activityText||e.activityImage){var r,a=new u.ColumnSet,i=void 0;if(e.activityImage)i=new u.Column,(o=new u.Image).size=e.activityImageSize?e.activityImageSize:u.Size.Small,e.activityImageType&&e.activityImageType===Ie?(o.style=u.ImageStyle.Default,o.size=u.Size.Medium,i.width=new u.SizeAndUnit(80,u.SizeUnit.Pixel)):o.style=e.activityImageStyle?e.activityImageStyle:u.ImageStyle.Person,o.url=e.activityImage,i.addItem(o),a.addColumn(i);if(i=new u.Column,e.activityTitle)(r=new u.TextBlock).text=e.activityTitle,r.wrap=!0,r.spacing=u.Spacing.None,i.addItem(r);if(e.activitySubtitle)(r=new u.TextBlock).text=e.activitySubtitle,r.weight=u.TextWeight.Lighter,r.isSubtle=!0,r.wrap=!0,r.spacing=u.Spacing.None,i.addItem(r);if(e.activityText)(r=new u.TextBlock).text=e.activityText,r.wrap=!0,r.spacing=u.Spacing.None,i.addItem(r);a.addColumn(i),n.addItem(a)}var o,s=e.heroImage;s&&((o=Re(s)).size=u.Size.Auto,n.addItem(o));if(e.text){var l=new u.TextBlock;l.text=e.text,l.wrap=!0,n.addItem(l)}if(e.facts){var c=function(e){for(var t=new u.FactSet,n=e,r=0;r<n.length;r++){var a=new u.Fact;a.name=n[r].name,a.value=n[r].value,t.facts.push(a)}return t}(e.facts);n.addItem(c)}if(e.images){var d=function(e){for(var t=new u.ImageSet,n=e,r=0;r<n.length;r++){var a=Re(n[r],u.Size.Large);t.addImage(a)}return t}(e.images);n.addItem(d)}if(e.potentialAction){var p=je(e.potentialAction,t);n.addItem(p)}return n}function je(e,t){var n=new u.ActionSet;n.spacing=u.Spacing.Medium;for(var r=e,a=function(e){var a=r[e];t.forEach((function(e){if(e.parseLegacyMessageCardAction){var r=e.parseLegacyMessageCardAction(a,t);r&&n.addAction(r)}}))},i=0;i<r.length;i++)a(i);return n}var Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.parse=function(t){var n,r;e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.targetElements={};var a=t.targetElements;if(a)try{for(var o=Object(i.__values)(a),s=o.next();!s.done;s=o.next()){var l=s.value;if("string"==typeof l)this.targetElements[l]=void 0;else if("object"==typeof l){var c=l.elementId;c&&"string"==typeof c&&(this.targetElements[c]=Object(u.getBoolValue)(l.isVisible,void 0))}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(u.setProperty)(t,"isPrimary",this.isPrimary,!1),t},t.prototype.execute=function(){var t,n=null===(t=this.parent)||void 0===t?void 0:t.getRootElement();if(null==n?void 0:n.logTelemetryForAction){var r={id:this.id,type:this.getJsonTypeName()};n.logTelemetryForAction("ToggleVisibilityActionClick",r)}e.prototype.execute.call(this)},t}(u.ToggleVisibilityAction),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(u.setProperty)(t,"isPrimary",this.isPrimary,!1),t},t}(u.OpenUrlAction);function Ve(e,t,n,r,a,i){h.g.info("[ActionableMessageDebug] executeAction: cardActionExecuted");var o={id:e.id,type:e.getJsonTypeName()},s={messageContext:a,actionContext:e[_],cardDetails:t,elementDetails:o,eventName:void 0};if(e instanceof He){h.g.info("[ActionableMessageDebug] onExecuteAction: open url: "+e.url),s.eventName=I,i.logTelemetry(s);try{var l=new URL(e.url);if("http:"!==l.protocol.toLowerCase()&&"https:"!==l.protocol.toLowerCase()){var c="mailto:"===l.protocol.toLowerCase()?"Mailto action":"Invalid URL";return h.g.info("[ActionableMessageDebug] onExecuteAction: open url not executed."+c),!1}window.open(l.href,"_blank")}catch(e){h.g.info("[ActionableMessageDebug] onExecuteAction: open url not executed. Malformed URL")}return!0}return e instanceof Fe&&(h.g.info("[ActionableMessageDebug] onExecuteAction: Toggle Visibility"),e.execute(),!0)}var Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(u.setProperty)(t,"isPrimary",this.isPrimary,!1),t},t}(u.ShowCardAction);function Ne(e,t){switch(e["@type"]){case"OpenUri":case"ViewAction":return function(e){var t=new He;if(t.title=e.name,e.target)t.url=e.target;else if(e.targets&&e.targets instanceof Array)for(var n=0;n<e.targets.length;n++)if("default"===e.targets[n].os){t.url=e.targets[n].uri;break}return t}(e);case"ActionCard":return function(e,t){var n=new Be;n.title=e.name;var r=e.inputs;if(r)for(var a=0;a<r.length;a++){var i=r[a],o=null;switch(i["@type"]?i["@type"].toLowerCase():""){case"textinput":o=qe(i);break;case"dateinput":o=Le(i);break;case"multichoiceinput":o=We(i)}o&&n.card.addItem(o)}var s=e.actions;s&&n.card.addItem(je(s,t));return n}(e,t)}return null}function qe(e){var t=new be;return ze(t,e),t.placeholder=e.title,t.isMultiline=e.isMultiline,t}function Le(e){var t=new pe;return ze(t,e),t.placeholder=e.title,t}function We(e){var t=new oe;ze(t,e),t.placeholder=e.title,t.spacing=u.Spacing.Medium;var n=e.choices;if(n)for(var r=0;r<n.length;r++){var a=new u.Choice;a.title=n[r].display,a.value=n[r].value,t.choices.push(a)}return t.isMultiSelect=e.isMultiSelect,t.isCompact=!("expanded"===e.style),t.initialize(),t}function ze(e,t){e.id=t.id,e.defaultValue=t.value}function Ue(e){return[{registerActions:function(){u.AdaptiveCard.actionTypeRegistry.registerType(u.ToggleVisibilityAction.JsonTypeName,(function(){return new Fe})),u.AdaptiveCard.actionTypeRegistry.registerType(u.ShowCardAction.JsonTypeName,(function(){return new Be})),u.AdaptiveCard.actionTypeRegistry.registerType(u.OpenUrlAction.JsonTypeName,(function(){return new He}))},executeAction:Ve,parseLegacyMessageCardAction:Ne,registerHostCapabilities:null}].concat(e)}var Je={ComponentDidMount:"31",CardId:"32",ComponentDidUpdate:"33",ComponentDidUpdateUpdate:"34",ComponentWillUnmount:"35",Render:"36",SetCardContainer:"37",RemoveCardElement:"38",AddCardElement:"39",TryUpdateCardElementException:"310",UpdateCardElementStart:"311",UpdateCardElementSkippingRender:"312",UpdateCardElementThemeError:"313",UpdateCardElementNewCardElementCreated:"314",UpdateCardElementAddNewCardElement:"315",HideCard:"316",ShowCard:"317",SetCardVisibility:"318",CleanupCard:"319",ProcessAutoInvokeActionsNotAllowed:"320",ProcessAutoInvokeActionsHasAutoInvoke:"321",ProcessAutoInvokeActionsHideCardOnInvoke:"322",ProcessAutoInvokeActionsCardIdUndefined:"323",ProcessAutoInvokeActionsExecuting:"324",ProcessAutoInvokeActionsException:"325",ExecuteAutoInvokeActionNoProvider:"326",HandleActionResponseStart:"327",HandleActionResponseStopUpdate:"328",HandleActionSuccessResponseStart:"329",HandleActionSuccessResponseOnCardDetailsUpdated:"330",HandleActionSuccessResponseHideCard:"331",HandleActionSuccessResponseShowCard:"332",HandleActionErrorResponseStart:"333",HandleActionErrorResponseHideCard:"334",HandleActionErrorResponseShowMessage:"335",HandleActionErrorResponseHandleAuth:"336",HandleActionErrorResponseShowErrorMessage:"337"},Ke=function(){var e={width:640,height:520,left:(window.screen.width-640)/2,top:(window.screen.height-520)/2,modal:"yes",alwaysRaised:"yes",menubar:"no",status:"no",scrollbars:"no",titlebar:"no",toolbar:"no",resizable:"yes"};return Object.keys(e).map((function(t){return t+"="+e[t]})).join(",")},Ge=function(e,t){if(!document.querySelector("#ac-"+e+"-styles")){var n=document.createElement("link");n.type="text/css",n.id="#ac-"+e+"-styles",n.rel="stylesheet",n.href=t,document.head.appendChild(n)}},Ye=n(7325);n(9238);var Ze,Xe=n(4634),Qe=function(e){function t(t){var n=e.call(this,t)||this;return n.isRetryHttpActionFlow=!1,n.previousHttpResponse=null,n.authenticationWindow=null,n.authenticationWindowTimeout=null,n.initializeCardProperties=function(){var e=n.props,t=e.actionProviders,i=e.actionableMessageCardStrings;n.actionProviders=Ue(t),n.responseMessage={message:"",type:r.Error,viewType:a.AutoDismiss},n.cardElementId=k+Object(m.a)(),Oe(n.actionProviders,i)},n.logTelemetryForAction=function(e,t){var r=n.props,a=r.telemetryHandler,i=r.cardDetails;a.logTelemetryProvider(i,e,null,t)},n.cancelAuthenticationFlow=function(e,t){var a;if(void 0===e&&(e=!1),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper cancelAuthenticationFlow"),n.closeAuthenticationWindow(),!e){var i=t||(null===(a=n.previousHttpResponse)||void 0===a?void 0:a.displayMessage);i?(h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper cancelAuthenticationFlow: Showing error message"),n.displayActionStatusMessage(i,r.Error)):n.setState({cardState:1})}n.clearActionRetryData()},n.closeAuthenticationWindow=function(){n.authenticationWindow&&(h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper closeAuthenticationWindow"),clearTimeout(n.authenticationWindowTimeout),n.authenticationWindow.close())},n.handlePostMessage=function(e){return Object(i.__awaiter)(n,void 0,void 0,(function(){var t,n,r,a,o,s,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(t=e.origin,!this.props.isTrustedDomain||!this.props.isTrustedDomain(t))return[2];if(!(n=e.data))return[2];r=null;try{r=JSON.parse(n)}catch(e){h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handlePostMessage: Unable to parse message data")}if(!r)return[2];switch(a=r.type,h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handlePostMessage: Received event of type: "+a),a){case"ActionableMessagePreConsentCancelled":return[3,1];case"ActionableMessageListeningForToken":return[3,2];case"ActionableMessagePostAuthenticate":return[3,5]}return[3,6];case 1:return this.cancelAuthenticationFlow(),[3,6];case 2:return this.authenticationWindow&&this.props.getClientAuthToken?[4,this.props.getClientAuthToken()]:[3,4];case 3:(o=i.sent())?(s={type:"ActionableMessageAuthenticateUsingToken",data:{authToken:o}},h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handlePostMessage: Posting auth token to iframe"),this.authenticationWindow.postMessage(JSON.stringify(s),t)):(h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handlePostMessage: token is empty"),this.cancelAuthenticationFlow(!1,this.props.actionableMessageCardStrings.error.generic)),i.label=4;case 4:return[3,6];case 5:return this.closeAuthenticationWindow(),"Success"===(null===(l=null==r?void 0:r.data)||void 0===l?void 0:l.status)?(h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handlePostMessage: Retrying execute action"),this.isRetryHttpActionFlow=!0,this.executeAction(this.previousHttpAction,!1)):this.cancelAuthenticationFlow(),[3,6];case 6:return[2]}}))}))},n.isValidCardDetails=function(){return!!n.cardDetails&&!!n.cardDetails.cardId},n.renderActionResponse=function(){return n.isValidCardDetails()&&o.createElement(N,{message:n.responseMessage.message,type:n.responseMessage.type,viewType:n.responseMessage.viewType,autoDismissTimeout:n.props.snackBarTimeout,onHideActionResponse:n.setShowCard,acknowledgeButtonText:n.responseMessage.acknowledgeButtonText,onAcknowledgeActionResponse:n.responseMessage.onAcknowledgeActionResponse})},n.renderActionSpinner=function(){return n.isValidCardDetails()&&o.createElement("div",{className:Xe.actionInProgressOverlay},o.createElement(c.a,{size:d.a.large,className:Xe.actionInProgressSpinner}),o.createElement(l.a,{className:Xe.actionInProgressLabel},n.props.actionableMessageCardStrings.information.actionInProgress))},n.setCardContainer=function(e){n.cardContainer||(n.props.loggingHandler.log(Je.SetCardContainer),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: setCardContainer"),n.cardContainer=e,n.pendingCardToShow&&n.addCardElementToDOM(n.pendingCardToShow))},n.removeCardElementFromDOM=function(){var e=document.getElementById(n.cardElementId);e&&n.cardContainer&&n.cardContainer.contains(e)&&(n.props.loggingHandler.log(Je.RemoveCardElement),h.g.info("[ActionableMessageDebug] ActionableMessageCard: removing old card from container"),n.cardContainer.removeChild(e),n.currentCardElement=null)},n.addCardElementToDOM=function(e){n.cardContainer?(n.pendingCardToShow=null,n.removeCardElementFromDOM(),n.props.loggingHandler.log(Je.AddCardElement),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: adding card element to DOM"),n.currentCardElement=e,n.applyConstrainWidthToCardContainer(),n.cardContainer.appendChild(n.currentCardElement)):n.pendingCardToShow=e},n.getTheme=function(){return Object(i.__awaiter)(n,void 0,void 0,(function(){var e,t,n,r,a,o,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e=this.props,t=e.telemetryHandler,n=e.downloadThemeCallback,Object(g.i)("rp-actionableMessagesThemeConfig")||0!==f.a.themeStore.loadStatus?[3,2]:(r=new p.b("MCActionableCardLoadThemeDefinitions"),t.stampPerfCheckpoint(b.a.ThemeDefinitionsLoadStart),[4,W(n)]);case 1:i.sent(),r.end(),t.stampPerfCheckpoint(b.a.ThemeDefinitionsLoadEnd),i.label=2;case 2:return a=this.cardDetails.card,o=new p.b("MCActionableCardResolveThemeFile"),t.stampPerfCheckpoint(b.a.ThemeResolveStart),[4,K(a.theme?a.theme:A)];case 3:return s=i.sent(),o.end(),t.stampPerfCheckpoint(b.a.ThemeResolveEnd),[2,s]}}))}))},n.setAdaptiveCardHandlers=function(){var e=n.props,t=e.actionableMessageContentHandler,r=e.telemetryHandler,a=e.cardDetails;n.adaptiveCard.onExecuteAction=function(e){n.executeAction(e,!1)},n.adaptiveCard.onInlineCardExpanded=function(e,n){t&&t.onApply(e.card.renderedElement),e.renderedElement.scrollIntoView(!0);var i={id:e.id,type:e.getJsonTypeName()};r.logTelemetryProvider(a,n?M:O,null,i)}},n.tryUpdateCardElement=function(e,t){void 0===t&&(t=!0);try{n.updateCardElement(e,t)}catch(e){n.props.loggingHandler.log(Je.TryUpdateCardElementException),h.g.warn("[ActionableMessageDebug] ActionableMessageCardWrapper: exception encountered during updateCardElement: "+e.message),n.setHideCard(!0)}},n.updateCardElement=function(e,t){return void 0===t&&(t=!0),Object(i.__awaiter)(n,void 0,void 0,(function(){var n,r,a,o,s,l,c,d,u,m,g,y,v;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n=this.props,r=n.actionableMessageContentHandler,a=n.telemetryHandler,o=n.adjustCardElementBeforeRenderCallback,s=n.cardDetails,this.props.loggingHandler.log(Je.UpdateCardElementStart+":"+(e?null===(v=e.cardId)||void 0===v?void 0:v.slice(0,8):" ")),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper updateCardElement: start. cardId: "+e.cardId),this.cardDetails==e?(this.props.loggingHandler.log(Je.UpdateCardElementSkippingRender),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper updateCardElement: card details unchanged. Skipping re-render. cardId: "+e.cardId),[2]):(this.cardDetails=e,f.a.cards.has(this.cardDetails.cardId)||Object(Ye.a)(this.cardDetails.cardId),a.stampPerfCheckpoint(b.a.LoadStart,a.perfData.loadStartTime),a.setTotalFetchTimeForCard(),a.stampPerfCheckpoint(b.a.CardRenderStart),l=new p.b("MCActionableCardLoadThemeTotal"),a.stampPerfCheckpoint(b.a.ThemeLoadTotalStart),[4,this.getTheme()]);case 1:return(c=i.sent())?(this.currentHostConfig=c.hostConfig,l.end(),a.stampPerfCheckpoint(b.a.ThemeLoadTotalEnd),(d=this.cardDetails.card)?(u=new p.b("MCActionableCardInitializeCardLibrary"),a.stampPerfCheckpoint(b.a.CardCreateStart),this.cardDetails.isAdaptiveCard?this.initializeAdaptiveCard(d,c):this.initializeMessageCard(d),u.end(),a.stampPerfCheckpoint(b.a.CardCreateEnd),this.processAutoInvokeActions(d,t)?this.setHideCard(!1):(this.setAdaptiveCardHandlers(),a.stampPerfCheckpoint(b.a.CardLibraryRenderStart),(m=this.adaptiveCard.render())&&(this.props.loggingHandler.log(Je.UpdateCardElementNewCardElementCreated),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: newCardElement is created. cardId: "+s.cardId),a.stampPerfCheckpoint(b.a.CardLibraryRenderEnd),g=new p.b("MCActionableCardPrepareCard"),a.stampPerfCheckpoint(b.a.PrepareCardStart),m.id=this.cardElementId,this.applySpecialStyling(d,m),o&&(y=d.originator||this.cardDetails.connectorSenderGuid,o(m,y)),this.processInlineActions(m),this.updateParentProperties(d),r&&r.onApply(m),g.end(),a.stampPerfCheckpoint(b.a.PrepareCardEnd),this.props.loggingHandler.log(Je.UpdateCardElementAddNewCardElement),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: adding newCardElement to the DOM. cardId: "+s.cardId),this.addCardElementToDOM(m),this.setShowCard()),a.stampPerfCheckpoint(b.a.CardRenderEnd),this.cardDetails&&a.logTelemetryProvider(s,D))):this.setHideCard(!0),[2]):(l.endWithError("ClientError"),this.props.loggingHandler.log(Je.UpdateCardElementThemeError),h.g.warn("[ActionableMessageDebug] ActionableMessageCardWrapper updateCardElement: Error loading theme for card"),this.setHideCard(!0),[2])}}))}))},n.setHideCard=function(e){n.props.loggingHandler.log(Je.HideCard+":"+(e?1:0)),h.g.info("[ActionableMessageDebug] hideCard. wasError: "+e+". cardId: "+n.cardDetails.cardId),n.props.showMessageBodyCallback&&n.props.showMessageBodyCallback(!0),e?n.setState({cardState:3}):n.setState({cardState:2})},n.setShowCard=function(){n.props.loggingHandler.log(""+Je.ShowCard),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper setCardVisibility: setting card visibility to true "),n.setState({cardState:1}),n.props.onCardRendered&&n.props.onCardRendered(n.currentCardElement)},n.cleanupCard=function(){var e,t=n.props.actionableMessageContentHandler;n.props.loggingHandler.log(Je.CleanupCard+":"+(n.cardDetails?null===(e=n.cardDetails)||void 0===e?void 0:e.cardId.slice(0,8):" ")),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper cleanupCard: cardId: "+n.cardDetails.cardId),n.detachInlineActionAnchorHandlers(n.currentCardElement),n.adaptiveCard&&n.adaptiveCard.getAllInputs().forEach((function(e){e.remove()})),n.currentHostConfig=null,t&&t.onUndo()},n.initializeAdaptiveCard=function(e,t){var r,a,i;n.adaptiveCard=new Te(n.logTelemetryForAction),n.adaptiveCard.hostConfig=t.hostConfig,r=n.adaptiveCard.hostConfig,a=n.actionProviders,i={},a.forEach((function(e){(null==e?void 0:e.registerHostCapabilities)&&e.registerHostCapabilities(i)})),r.hostCapabilities.capabilities=i,n.adaptiveCard.parse(e),t.stylesheetUrl&&Ge(e.theme,t.stylesheetUrl),n.processInlineActionDefinitions(e)},n.initializeMessageCard=function(e){var t;n.adaptiveCard=function(e,t,n){var r,a=new Te(n);if(e.title&&((r=new u.TextBlock).text=e.title,r.size=u.TextSize.Large,r.wrap=!0,a.addItem(r)),e.text&&((r=new u.TextBlock).text=e.text,r.wrap=!0,a.addItem(r)),e.sections)for(var i=e.sections,o=0;o<i.length;o++){var s=_e(i[o],t);a.addItem(s)}if(e.potentialAction){var l=je(e.potentialAction,t);a.addItem(l)}return a}(e,n.actionProviders,n.logTelemetryForAction),e.style===w?n.adaptiveCard.hostConfig=((t=new u.HostConfig({supportsInteractivity:!0,choiceSetInputValueSeparator:";",spacing:{small:5,default:5,medium:5,large:5,extraLarge:5,padding:5},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontFamily:"wf_segoe-ui_normal, sans-serif",fontSizes:{small:10,normal:12,medium:14,large:16,extraLarge:18},fontWeights:{lighter:200,normal:400,bolder:600},containerStyles:{default:{backgroundColor:"#eaeaea",foregroundColors:{default:{default:"#767676",subtle:"#EE767676"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#FFD800",subtle:"#DDFFD800"},good:{default:"#00FF00",subtle:"#00DD00"},warning:{default:"#FF0000",subtle:"#DD0000"}}},emphasis:{backgroundColor:"#F8F8F8",foregroundColors:{default:{default:"#767676",subtle:"#EE767676"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#FFD800",subtle:"#DDFFD800"},good:{default:"#00FF00",subtle:"#00DD00"},warning:{default:"#FF0000",subtle:"#DD0000"}}}},imageSizes:{small:16,medium:32,large:64},actions:{maxActions:5,buttonSpacing:20,spacing:u.Spacing.Default,showCard:{actionMode:u.ShowCardActionMode.Inline,inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!0,actionsOrientation:u.Orientation.Horizontal,actionAlignment:u.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:u.Size.Medium,maxImageHeight:100},factSet:{title:{color:u.TextColor.Default,size:u.TextSize.Default,isSubtle:!1,weight:u.TextWeight.Bolder,wrap:!0},value:{color:u.TextColor.Default,size:u.TextSize.Default,isSubtle:!1,weight:u.TextWeight.Default,wrap:!0},spacing:5}})).cssClassNamePrefix="compactMessageCard",t):n.adaptiveCard.hostConfig=new u.HostConfig({supportsInteractivity:!0,choiceSetInputValueSeparator:";",fontFamily:"Segoe UI, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"},attention:{default:"#cc3300",subtle:"#DDcc3300"}},backgroundColor:"#FFFFFF"},emphasis:{foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"},attention:{default:"#cc3300",subtle:"#DDcc3300"}},backgroundColor:"#08000000"}},spacing:{small:3,default:8,medium:20,large:30,extraLarge:40,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},actions:{maxActions:5,spacing:"Default",buttonSpacing:10,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!0,actionsOrientation:"Horizontal",actionAlignment:"Left"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"Medium",maxImageHeight:"maxImageHeight"},factSet:{title:{size:"Default",color:"Default",isSubtle:!1,weight:"Bolder",warp:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",warp:!0},spacing:10}})},n.applySpecialStyling=function(e,t){n.cardDetails.isAdaptiveCard||function(e,t){e.style.borderWidth="1px 1px 1px 3px",e.style.borderStyle="solid",t.themeColor?e.style.borderLeftColor="#"+t.themeColor.replace(/[^0-9A-F]/gi,""):(e.style.borderLeftColor=Y,e.style.borderLeftWidth="1px"),e.style.borderTopColor=Y,e.style.borderRightColor=Y,e.style.borderBottomColor=Y}(t,e),e.style!==w&&e.theme!==w||(t.className=Xe.compactCard);var r=e.theme&&e.theme!==w?e.theme:"none";t.setAttribute("data-ac-theme",r)},n.processAutoInvokeActions=function(e,t){var r,a=n.props.telemetryHandler,i=!1,o=f.a.cards.get(n.cardDetails.cardId);e.autoInvokeAction&&(n.props.loggingHandler.log(Je.ProcessAutoInvokeActionsHasAutoInvoke+":"+(n.cardDetails?null===(r=n.cardDetails.cardId)||void 0===r?void 0:r.slice(0,8):" ")),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper processAutoInvokeActions: Card does have auto invoke action. cardId: "+n.cardDetails.cardId),t&&(!o||!o.autoInvokeActionAlreadyRan)?(e.autoInvokeAction.hideCardOnInvoke&&(n.props.loggingHandler.log(Je.ProcessAutoInvokeActionsHideCardOnInvoke),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper processAutoInvokeActions: HideCardOnInvoke is true, so card will be hidden cardId: "+n.cardDetails.cardId),i=!0,n.showMessageBody()),e.autoInvokeOptions&&(n.showCardOnFailure=e.autoInvokeOptions.showCardOnFailure),a.stampPerfCheckpoint(b.a.AutoInvokeActionStart),Object(Ye.c)(n.cardDetails.cardId,!0),n.cardDetails.cardId||n.props.loggingHandler.log(Je.ProcessAutoInvokeActionsCardIdUndefined),n.props.loggingHandler.log(Je.ProcessAutoInvokeActionsExecuting),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper processAutoInvokeActions: Executing auto invoke action for cardId: "+n.cardDetails.cardId),n.executeAutoInvokeAction(e.autoInvokeAction)):(n.props.loggingHandler.log(Je.ProcessAutoInvokeActionsException),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper processAutoInvokeActions: Auto invoke actions not allowed for card. cardId: "+n.cardDetails.cardId)));return i},n.showMessageBody=function(){n.props.showMessageBodyCallback&&n.props.showMessageBodyCallback(!0)},n.hideMessageBody=function(){n.props.showMessageBodyCallback&&n.props.showMessageBodyCallback(!1)},n.processInlineActions=function(e){n.inlineActionDefinitions&&n.attachInlineActionAnchorHandlers(e)},n.updateParentProperties=function(e){e.style!==w&&e.hideOriginalBody?e.hideOriginalBody&&n.hideMessageBody():n.showMessageBody()},n.processInlineActionDefinitions=function(e){var t;if(n.inlineActionDefinitions={},null===(t=e.resources)||void 0===t?void 0:t.actions)for(var r=e.resources.actions,a=0;a<r.length;a++)n.inlineActionDefinitions[r[a].id]=r[a]},n.executeAction=function(e,t){if(!e||!n.adaptiveCard)return!1;!t&&e instanceof u.HttpAction&&(n.setState({cardState:4}),n.isRetryHttpActionFlow||(n.previousHttpAction=e));for(var r=!1,a=0;a<n.actionProviders.length;a++){if(r=n.actionProviders[a].executeAction(e,n.cardDetails,$e(e)||[],(function(e){return n.handleActionResponse(e,t)}),n.props.telemetryHandler.messageContext,n.props.telemetryHandler.telemetryProvider,t))break}return r},n.executeAutoInvokeAction=function(e){if(e){for(var t=!1,r=0;r<n.actionProviders.length;r++){var a=n.actionProviders[r];if(a.processAutoInvokeAction){var i=a.processAutoInvokeAction(e,n.cardDetails);if(i){n.props.loggingHandler.logAutoInvokeExecution(),n.executeAction(i,!0),t=!0;break}}}t||(n.props.loggingHandler.log(Je.ExecuteAutoInvokeActionNoProvider),h.g.warn("[ActionableMessageDebug] ActionableMessageCardWrapper executeAutoInvokeAction: no action provider supplied that can process auto invoke actions"))}},n.attachInlineActionAnchorHandlers=function(e){var t=e.querySelectorAll('a[href^="'+x+'"]');if(t)for(var r=0;r<t.length;r++){t.item(r).addEventListener("click",n.onInlineActionAnchorClicked)}},n.detachInlineActionAnchorHandlers=function(e){if(e){var t=e.querySelectorAll('a[href^="'+x+'"]');if(t)for(var r=0;r<t.length;r++){t.item(r).removeEventListener("click",n.onInlineActionAnchorClicked)}}},n.handleActionResponse=function(e,t){var r;n.props.loggingHandler.log(Je.HandleActionResponseStart+":"+(n.cardDetails?null===(r=n.cardDetails.cardId)||void 0===r?void 0:r.slice(0,8):" ")),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionResponse started. cardId: "+n.cardDetails.cardId);var a=n.props.telemetryHandler;if(t||a.logTelemetryProvider(n.cardDetails,R),3===n.state.cardState)return n.props.loggingHandler.log(Je.HandleActionResponseStopUpdate),void h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionResponse: card was hidden because of a processing error, so stop update");t&&(a.stampPerfCheckpoint(b.a.AutoInvokeActionEnd),a.updatePerfCheckpointsBeforeUpdatingAutoInvokeResponse()),n.previousHttpResponse=e,e.success?n.handleActionSuccessResponse(e,t):n.handleActionErrorResponse(e,t),(n.isRetryHttpActionFlow||e.success)&&n.clearActionRetryData()},n.handleActionSuccessResponse=function(e,t){n.props.loggingHandler.log(Je.HandleActionSuccessResponseStart),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionSuccessResponse: Start");var a=n.props,i=a.telemetryHandler,o=a.onCardDetailsUpdated;if(e.newCardPayload&&"function"==typeof o){var s=Pe(n.cardDetails,n.cardDetails.connectorSenderGuid,e.newCardPayload,e.newCardSignature,void 0,n.cardDetails.cardId);n.props.loggingHandler.log(Je.HandleActionSuccessResponseOnCardDetailsUpdated),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionSuccessResponse: New card payload available and onCardDetailsUpdated being called."),o([s])}n.isCardVisible()?e.hideCard||e.removeCard?(i.logTelemetryProvider(n.cardDetails,e.hideCard?P:T),n.props.loggingHandler.log(Je.HandleActionSuccessResponseHideCard),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionSuccessResponse: Hiding card"),n.setHideCard(!1),n.showMessageBody()):t||(h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionSuccessResponse: Showing action result message"),n.displayActionStatusMessage(e.displayMessage,r.Success)):e.newCardPayload||e.showOriginalCard?(n.props.loggingHandler.log(Je.HandleActionSuccessResponseShowCard),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionSuccessResponse: Showing card"),n.setState({cardState:1})):(n.setHideCard(!1),n.showMessageBody())},n.handleActionErrorResponse=function(e,t){if(n.props.loggingHandler.log(Je.HandleActionErrorResponseStart),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionErrorResponse: Start"),t)!1===n.showCardOnFailure&&(n.props.loggingHandler.log(Je.HandleActionErrorResponseHideCard),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionErrorResponse: hiding card"),n.setHideCard(!1),n.showMessageBody());else if(!Object(g.i)("rp-actionableMessages-identity-linking")||n.isRetryHttpActionFlow||e.status&&"completed"===e.status.toLowerCase())n.props.loggingHandler.log(Je.HandleActionErrorResponseShowMessage),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionErrorResponse: displaying action message - either completed or retry failed"),n.displayActionStatusMessage(e.displayMessage,r.Error);else{var i=null;if(e.errors&&e.errors.length>0&&(i=e.errors[0]),n.shouldHandleAuthErrors(e,i)){var o=null;"401"===(null==i?void 0:i.httpStatusCode)&&i.url?o=i.url:e.authenticationUrl&&(o=e.authenticationUrl),n.authenticationUrl=n.addAuthenticationUrlEssentials(o),n.props.loggingHandler.log(Je.HandleActionErrorResponseHandleAuth),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionErrorResponse: Handling authentication error");var s=n.props.actionableMessageCardStrings.information.authenticationFlowAcknowledgeMessage,l=n.props.actionableMessageCardStrings.information.authenticationFlowAcknowledgeButtonText;n.displayActionStatusMessage(s,r.Warning,a.Freeze,l,n.handleAuthenticationFlow)}else{var c=e.displayMessage;(null==i?void 0:i.message)&&(c=i.message),n.props.loggingHandler.log(Je.HandleActionErrorResponseShowErrorMessage),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionErrorResponse: Display error message"),n.displayActionStatusMessage(c,r.Error)}}},n.clearActionRetryData=function(){h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper clearActionRetryData: Start"),n.isRetryHttpActionFlow=!1,n.authenticationUrl=null,n.previousHttpAction=null,n.previousHttpResponse=null,n.authenticationWindow=null},n.checkAuthenticationWindow=function(e){return function(){n.authenticationWindow&&(n.authenticationWindow.closed?n.cancelAuthenticationFlow():e<j?n.setAuthenticationWindowTimeout(e+F):n.cancelAuthenticationFlow())}},n.setAuthenticationWindowTimeout=function(e){n.authenticationWindowTimeout=setTimeout(n.checkAuthenticationWindow(e),F)},n.handleAuthenticationFlow=function(){h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleAuthenticationFlow: Start"),n.setState({cardState:4});var e=Ke();n.authenticationWindow=window.open(n.authenticationUrl,"_blank",e),n.authenticationWindow?n.setAuthenticationWindowTimeout(0):n.cancelAuthenticationFlow()},n.displayActionStatusMessage=function(e,t,r,i,o){void 0===r&&(r=a.AutoDismiss),void 0===i&&(i=null),void 0===o&&(o=null),n.responseMessage.message=e,n.responseMessage.type=t,n.responseMessage.viewType=r,n.responseMessage.acknowledgeButtonText=i,n.responseMessage.onAcknowledgeActionResponse=o,n.setState({cardState:5})},n.isCardVisible=function(){var e=n.state.cardState;return 2!==e&&3!==e},n.onInlineActionAnchorClicked=function(e){if(n.inlineActionDefinitions){var t=e.target.href.substr(x.length),r=n.inlineActionDefinitions[t];if(r){e.preventDefault();var a=n.parseCustomAction(r);n.executeAction(a,!1)}}},n.parseCustomAction=function(e){var t=u.AdaptiveCard.actionTypeRegistry.createInstance(e.type);return t.parse(e),t.setParent(n.adaptiveCard),t},n.applyConstrainWidthToCardContainer=function(){var e=n.props.cardDetails;if((null==e?void 0:e.isAdaptiveCard)&&!1!==e.card.constrainWidth){var t=E,r=S,a=n.currentHostConfig;(null==a?void 0:a.cardMaximumWidth)&&"number"==typeof(t=a.cardMaximumWidth)&&(t+="px"),(null==a?void 0:a.cardHorizontalAlignment)&&(r=a.cardHorizontalAlignment),(null==a?void 0:a.cardHostBackgroundColor)&&n.cardContainer.parentElement&&(n.cardContainer.parentElement.style.backgroundColor=a.cardHostBackgroundColor),n.cardContainer.style.maxWidth=t,"center"===r&&(n.cardContainer.style.margin="auto")}},n.state={cardState:2},n.initializeCardProperties(),n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.loggingHandler.log(Je.ComponentDidMount),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper mount."),this.tryUpdateCardElement(this.props.cardDetails),window.addEventListener("message",this.handlePostMessage)},t.prototype.componentDidUpdate=function(e){var t,n=this.props,r=n.actionableMessageContentHandler,a=n.contentHandlerUndoMode,i=n.cardDetails;this.props.loggingHandler.log(Je.ComponentDidUpdate+":"+(this.cardDetails?null===(t=this.cardDetails.cardId)||void 0===t?void 0:t.slice(0,8):" ")),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper update. cardId: "+this.cardDetails.cardId),a===e.contentHandlerUndoMode&&r===e.actionableMessageContentHandler||(a?r&&r.onUndo():this.currentCardElement&&r&&r.onApply(this.currentCardElement)),i!==e.cardDetails&&(this.props.loggingHandler.log(Je.ComponentDidUpdateUpdate),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper update and updateCardElement. cardId: "+this.cardDetails.cardId),this.tryUpdateCardElement(i,!1))},t.prototype.componentWillUnmount=function(){var e;this.props.loggingHandler.log(Je.ComponentWillUnmount+":"+(this.cardDetails?null===(e=this.cardDetails.cardId)||void 0===e?void 0:e.slice(0,8):" ")),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper unmount."),this.cardDetails&&Object(Ye.b)(this.cardDetails.cardId),this.currentCardElement&&this.cleanupCard(),this.cancelAuthenticationFlow(!0),window.removeEventListener("message",this.handlePostMessage)},t.prototype.render=function(){var e=this;this.props.loggingHandler.log(Je.Render),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper render");var t=this.state.cardState;return function(e){return 1===e||4===e||5===e}(t)&&o.createElement("div",{className:Xe.container+" allowTextSelection",ref:function(t){return e.setCardContainer(t)}},function(e,t){return 5===e&&!!t&&!!t.message}(t,this.responseMessage)&&this.renderActionResponse(),function(e){return 4===e}(t)&&this.renderActionSpinner())},t.prototype.addAuthenticationUrlEssentials=function(e){return e?e+"&client=webviewbasedamclients":e},t.prototype.shouldHandleAuthErrors=function(e,t){return!(null==t||!t.httpStatusCode||"401"!==t.httpStatusCode&&"403"!==t.httpStatusCode)||!!e.authenticationUrl},t=Object(i.__decorate)([s.observer],t)}(o.Component),$e=function(e){if(e.parent){var t=e.getReferencedInputs();return Object.values(t).map((function(e){return e}))}return e.getAllInputs()},et=n(16),tt=n(3856),nt=n(903),rt=n(762),at=n(521),it=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.isRequired=!1,n.isMultiline=!1,n.style=tt.InputTextStyle.Text,n.isFocusedAtLeastOnce=!1,n.setTextFieldRef=function(e){n.textField=e},n.isValidText=function(e){return(!n.isRequired||""!==e)&&(!n.regex||new RegExp(n.regex,"g").test(e))},n.validateText=function(e){return n.isFocusedAtLeastOnce&&!n.isValidText(e)?t.strings.warning.requiredField:""},n.setFocused=function(){n.isFocusedAtLeastOnce=!0},n.getMaxLength=function(e){var t;return void 0===e||void 0===n.defaultValue?t:t=Math.max(e,n.defaultValue.length)},n}return Object(i.__extends)(t,e),t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.internalRender=function(){var e=this;this.textFieldElement=document.createElement("div"),this.textFieldElement.className=ue.a.inputElementWrapper;var n,r=this.placeholder||t.strings.placeholder.textInput,a=Object(m.a)(),i=function(){e.inlineAction.execute()};return this.inlineAction&&(n=this.inlineAction.iconUrl?o.createElement(rt.a,{imageProps:{src:this.inlineAction.iconUrl,alt:this.inlineAction.title,height:"32px"},onClick:i}):o.createElement(at.a,{text:this.inlineAction.title,styles:{root:{border:"none"}},onClick:i})),Z.render(o.createElement(o.StrictMode,null,this.label&&o.createElement(l.a,{required:this.isRequired,htmlFor:a},this.label),o.createElement(nt.a,{horizontal:!0,tokens:{childrenGap:15}},o.createElement(nt.a.Item,{grow:1},o.createElement(he.a,{id:a,componentRef:this.setTextFieldRef,maxLength:this.getMaxLength(this.maxLength),placeholder:r,multiline:this.isMultiline,onFocus:this.setFocused,onGetErrorMessage:this.validateText,defaultValue:this.defaultValue,title:r})),this.inlineAction&&o.createElement(nt.a.Item,{className:"ac-inlineActionButton"},n))),this.textFieldElement),this.textFieldElement},t.prototype.internalValidateProperties=function(e){this.isValidText(this.value)||e.addFailure(this,tt.ValidationEvent.InvalidPropertyValue,t.strings.warning.missingRequiredInput)},t.prototype.getJsonTypeName=function(){return"Input.Text"},t.prototype.isSet=function(){return!(!this.textField||!this.textField.value)},t.prototype.remove=function(){return this.textFieldElement&&(Z.unmountComponentAtNode(this.textFieldElement),this.textFieldElement=null),e.prototype.remove.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){return this.textField?this.textField.value:""},enumerable:!1,configurable:!0}),t.valueProperty=new tt.StringProperty(tt.Versions.v1_0,"value"),t.isRequiredProperty=new tt.BoolProperty(tt.Versions.v1_2,"isRequired",!1),t.maxLengthProperty=new tt.NumProperty(tt.Versions.v1_0,"maxLength"),t.isMultilineProperty=new tt.BoolProperty(tt.Versions.v1_0,"isMultiline",!1),t.placeholderProperty=new tt.StringProperty(tt.Versions.v1_0,"placeholder"),t.styleProperty=new tt.EnumProperty(tt.Versions.v1_0,"style",tt.InputTextStyle,tt.InputTextStyle.Text),t.inlineActionProperty=new tt.ActionProperty(tt.Versions.v1_0,"inlineAction",["Action.ShowCard"]),t.regexProperty=new tt.StringProperty(tt.Versions.v1_3,"regex",!0),Object(i.__decorate)([Object(tt.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),Object(i.__decorate)([Object(tt.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),Object(i.__decorate)([Object(tt.property)(t.maxLengthProperty)],t.prototype,"maxLength",void 0),Object(i.__decorate)([Object(tt.property)(t.isMultilineProperty)],t.prototype,"isMultiline",void 0),Object(i.__decorate)([Object(tt.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),Object(i.__decorate)([Object(tt.property)(t.styleProperty)],t.prototype,"style",void 0),Object(i.__decorate)([Object(tt.property)(t.inlineActionProperty)],t.prototype,"inlineAction",void 0),Object(i.__decorate)([Object(tt.property)(t.regexProperty)],t.prototype,"regex",void 0),t}(tt.Input);!function(e){e[e.Ok=0]="Ok",e[e.RequiredIsEmpty=1]="RequiredIsEmpty",e[e.NotNumber=2]="NotNumber",e[e.LessThanMin=3]="LessThanMin",e[e.MoreThanMax=4]="MoreThanMax"}(Ze||(Ze={}));var ot=function(e,t,n,r){if(r&&null===e)return Ze.RequiredIsEmpty;if(null!==e){if("number"!=typeof e)return Ze.NotNumber;if("number"==typeof n&&n<e)return Ze.MoreThanMax;if("number"==typeof t&&t>e)return Ze.LessThanMin}return Ze.Ok},st=Object(y.a)((function(e){var t,n=Object(i.__read)(o.useState(e.value),2),r=n[0],a=n[1],s=Object(i.__read)(o.useState(!1),2),c=s[0],d=s[1],u=e.min,p=e.max,h=e.required,g=e.label,f=Object(m.a)();return o.createElement(o.Fragment,null,g&&o.createElement(l.a,{required:h,htmlFor:f},g),o.createElement(he.a,{id:f,type:"number",value:(t=r,"number"==typeof t?t.toString():t),min:u,max:p,onFocus:function(){d(!0)},onChange:function(t,n){var r=n?Number(n):null;e.onValueChanged(r),a(r)},placeholder:e.placeholder,onGetErrorMessage:function(t){if(!c)return"";var n=t?Number(t):null,r=e.strings,a=e.onValueChanged,i=ot(n,u,p,h);switch(a(n),i){case Ze.RequiredIsEmpty:return r.warning.requiredField;case Ze.LessThanMin:return r.format(r.warning.inputNumberLessThanMin,u);case Ze.MoreThanMax:return r.format(r.warning.inputNumberMoreThanMax,p);case Ze.NotNumber:return r.warning.inputNumberNotNumeric;case Ze.Ok:default:return""}}}))})),lt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isRequired=!1,t.currentValue=null,t.onTextFieldValueChanged=function(e){t.currentValue=e},t}return Object(i.__extends)(t,e),t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.internalRender=function(){this.numberTextFieldElement=document.createElement("div"),this.numberTextFieldElement.className=ue.a.inputElementWrapper;var e=this.placeholder||t.strings.placeholder.numberInput;return Z.render(o.createElement(o.StrictMode,null,o.createElement(st,{placeholder:e,onValueChanged:this.onTextFieldValueChanged,min:this.min,max:this.max,required:this.isRequired,label:this.label,value:this.defaultValue,strings:t.strings})),this.numberTextFieldElement),this.numberTextFieldElement},t.prototype.internalValidateProperties=function(e){this.isRequired&&!this.currentValue?e.addFailure(this,tt.ValidationEvent.InvalidPropertyValue,t.strings.warning.missingRequiredInput):ot(this.value,this.min,this.max,this.isRequired)!==Ze.Ok&&e.addFailure(this,tt.ValidationEvent.InvalidPropertyValue,t.strings.warning.invalidInput)},t.prototype.getJsonTypeName=function(){return"Input.Number"},t.prototype.isSet=function(){return null!==this.currentValue},t.prototype.remove=function(){return this.numberTextFieldElement&&(Z.unmountComponentAtNode(this.numberTextFieldElement),this.numberTextFieldElement=null),e.prototype.remove.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){return this.currentValue},enumerable:!1,configurable:!0}),t.valueProperty=new tt.NumProperty(tt.Versions.v1_0,"value"),t.isRequiredProperty=new tt.BoolProperty(tt.Versions.v1_2,"isRequired",!1),t.placeholderProperty=new tt.StringProperty(tt.Versions.v1_0,"placeholder"),t.minProperty=new tt.NumProperty(tt.Versions.v1_0,"min"),t.maxProperty=new tt.NumProperty(tt.Versions.v1_0,"max"),Object(i.__decorate)([Object(tt.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),Object(i.__decorate)([Object(tt.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),Object(i.__decorate)([Object(tt.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),Object(i.__decorate)([Object(tt.property)(t.minProperty)],t.prototype,"min",void 0),Object(i.__decorate)([Object(tt.property)(t.maxProperty)],t.prototype,"max",void 0),t}(tt.Input),ct=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isRequired=!1,t.selectedDate=null,t.onSelectDate=function(e){e instanceof Date&&(t.selectedDate=e)},t.dateNotValid=function(){return t.isRequired&&null===t.selectedDate},t}return Object(i.__extends)(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.defaultValue&&(this.selectedDate=new Date(Object(se.m)(Object(se.lc)(this.defaultValue)).getTime()))},t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.internalRender=function(){this.datePickerElement=document.createElement("div"),this.datePickerElement.className=ue.a.inputElementWrapper;var e=new Date(Object(se.m)(Object(se.lc)()).getTime()),n=this.defaultValue?new Date(Object(se.m)(Object(se.lc)(this.defaultValue)).getTime()):null,r=this.min?new Date(Object(se.m)(Object(se.lc)(this.min)).getTime()):null,a=this.max?new Date(Object(se.m)(Object(se.lc)(this.max)).getTime()):null,i=this.placeholder||t.strings.placeholder.dateInput,s=Object(m.a)();return Z.render(o.createElement(o.StrictMode,null,this.label&&o.createElement(l.a,{required:this.isRequired,htmlFor:s},this.label),o.createElement(le.a,{id:s,strings:t.strings.datePicker,isMonthPickerVisible:!1,showMonthPickerAsOverlay:!0,firstDayOfWeek:ce.c.Sunday,today:e,value:n,minDate:r,maxDate:a,placeholder:i,ariaLabel:i,onSelectDate:this.onSelectDate})),this.datePickerElement),this.datePickerElement},t.prototype.internalValidateProperties=function(e){this.dateNotValid()&&e.addFailure(this,tt.ValidationEvent.InvalidPropertyValue,t.strings.warning.missingRequiredInput)},t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.isSet=function(){return null!==this.selectedDate},t.prototype.remove=function(){return this.datePickerElement&&(Z.unmountComponentAtNode(this.datePickerElement),this.datePickerElement=null),e.prototype.remove.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){return this.selectedDate?this.selectedDate.toISOString():null},enumerable:!1,configurable:!0}),t.valueProperty=new tt.StringProperty(tt.Versions.v1_0,"value"),t.isRequiredProperty=new tt.BoolProperty(tt.Versions.v1_2,"isRequired",!1),t.placeholderProperty=new tt.StringProperty(tt.Versions.v1_0,"placeholder"),t.minProperty=new tt.StringProperty(tt.Versions.v1_0,"min"),t.maxProperty=new tt.StringProperty(tt.Versions.v1_0,"max"),Object(i.__decorate)([Object(tt.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),Object(i.__decorate)([Object(tt.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),Object(i.__decorate)([Object(tt.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),Object(i.__decorate)([Object(tt.property)(t.minProperty)],t.prototype,"min",void 0),Object(i.__decorate)([Object(tt.property)(t.maxProperty)],t.prototype,"max",void 0),t}(tt.Input),dt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isRequired=!1,t.valueOn="true",t.valueOff="false",t.wrap=!1,t.checked=!1,t.onCheckboxChanged=function(e,n){t.checked=!!n},t}return Object(i.__extends)(t,e),t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.internalRender=function(){this.checkboxElement=document.createElement("div");var e=Object(m.a)();return Z.render(o.createElement(o.StrictMode,null,this.label&&o.createElement(l.a,{required:this.isRequired,htmlFor:e},this.label),o.createElement(re.a,{id:e,defaultChecked:this.checked,onChange:this.onCheckboxChanged,label:this.title})),this.checkboxElement),this.checkboxElement},t.prototype.internalValidateProperties=function(e){this.isRequired&&!this.checked&&e.addFailure(this,tt.ValidationEvent.InvalidPropertyValue,t.strings.warning.missingRequiredInput)},t.prototype.getJsonTypeName=function(){return"Input.Toggle"},t.prototype.isSet=function(){return this.isRequired?this.value===this.valueOn:!!this.value},t.prototype.remove=function(){return this.checkboxElement&&(Z.unmountComponentAtNode(this.checkboxElement),this.checkboxElement=null),e.prototype.remove.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){return this.checked?this.valueOn:this.valueOff},enumerable:!1,configurable:!0}),t.valueProperty=new tt.StringProperty(tt.Versions.v1_0,"value"),t.isRequiredProperty=new tt.BoolProperty(tt.Versions.v1_2,"isRequired",!1),t.titleProperty=new tt.StringProperty(tt.Versions.v1_0,"title"),t.valueOnProperty=new tt.StringProperty(tt.Versions.v1_0,"valueOn",!0,void 0,"true",(function(e){return"true"})),t.valueOffProperty=new tt.StringProperty(tt.Versions.v1_0,"valueOff",!0,void 0,"false",(function(e){return"false"})),t.wrapProperty=new tt.BoolProperty(tt.Versions.v1_2,"wrap",!1),Object(i.__decorate)([Object(tt.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),Object(i.__decorate)([Object(tt.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),Object(i.__decorate)([Object(tt.property)(t.titleProperty)],t.prototype,"title",void 0),Object(i.__decorate)([Object(tt.property)(t.valueOnProperty)],t.prototype,"valueOn",void 0),Object(i.__decorate)([Object(tt.property)(t.valueOffProperty)],t.prototype,"valueOff",void 0),Object(i.__decorate)([Object(tt.property)(t.wrapProperty)],t.prototype,"wrap",void 0),t}(tt.Input),ut=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.choices=[],t.isMultiSelect=!1,t.wrap=!1,t.isRequired=!1,t.onDropdownChanged=function(e,n){t.selectedChoiceIndices=[n]},t.onChoiceGroupChanged=function(e,n){t.selectedChoiceIndices=[n.index]},t}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"isCompact",{get:function(){return"expanded"!==this.style},set:function(e){this.style=e?void 0:"expanded"},enumerable:!1,configurable:!0}),t.prototype.initialize=function(){var e=this;this.mappedChoices=this.choices.map((function(e,t){return{key:e.value,text:e.title,index:t}})),this.selectedChoiceIndices=[];for(var t=this.parseValueString(this.defaultValue),n=function(n){t.filter((function(t){return t===e.choices[n].value})).length>0&&r.selectedChoiceIndices.push(n)},r=this,a=0;a<this.choices.length;a++)n(a);this.initialized=!0},t.prototype.renderCheckboxes=function(e){for(var t=this,n=[],r=function(r){n.push(o.createElement(re.a,{defaultChecked:e.filter((function(e){return e===t.choices[r].value})).length>0,label:a.choices[r].title,onChange:a.getOnCheckboxChangedHandler(r)}))},a=this,i=0;i<this.choices.length;i++)r(i);return n},t.prototype.getOnCheckboxChangedHandler=function(e){var t=this;return function(n,r){r?t.selectedChoiceIndices.push(e):t.selectedChoiceIndices.splice(t.selectedChoiceIndices.indexOf(e),1)}},t.prototype.parseValueString=function(e){return e?e.split(this.hostConfig.choiceSetInputValueSeparator):[]},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.initialize()},t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.internalRender=function(){if(this.element=document.createElement("div"),this.element.style.width="100%",!this.initialized)return h.g.warn("[ActionableMessageDebug] CustomChoiceSetInput: Control not initialized before render"),this.element;var e=Object(m.a)();if(this.isMultiSelect)Z.render(o.createElement(o.StrictMode,null,this.label&&o.createElement(l.a,{required:this.isRequired,htmlFor:e},this.label),o.createElement("div",{id:e},this.renderCheckboxes(this.parseValueString(this.defaultValue)))),this.element);else if(this.isCompact){var n=this.placeholder||t.strings.placeholder.choiceSetInput;Z.render(o.createElement(o.StrictMode,null,this.label&&o.createElement(l.a,{required:this.isRequired,htmlFor:e},this.label),o.createElement(ie.a,{id:e,onChanged:this.onDropdownChanged,options:this.mappedChoices,defaultSelectedKey:this.defaultValue,placeHolder:n})),this.element)}else Z.render(o.createElement(o.StrictMode,null,this.label&&o.createElement(l.a,{required:this.isRequired,htmlFor:e},this.label),o.createElement(ae.a,{id:e,onChange:this.onChoiceGroupChanged,options:this.mappedChoices,defaultSelectedKey:this.defaultValue})),this.element);return this.element},t.prototype.internalValidateProperties=function(e){this.isRequired&&!this.value&&e.addFailure(this,tt.ValidationEvent.InvalidPropertyValue,t.strings.warning.missingRequiredInput)},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},t.prototype.isSet=function(){return void 0!==this.value},t.prototype.remove=function(){return this.element&&(Z.unmountComponentAtNode(this.element),this.element=null),e.prototype.remove.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){var e=void 0;if(this.selectedChoiceIndices)for(var t=0;t<this.selectedChoiceIndices.length;t++){""!==e&&(e+=this.hostConfig.choiceSetInputValueSeparator);var n=this.selectedChoiceIndices[t];this.choices[n].value?e+=this.choices[n].value:e+=this.choices[n].title}return e},enumerable:!1,configurable:!0}),t.valueProperty=new tt.StringProperty(tt.Versions.v1_0,"value"),t.choicesProperty=new tt.SerializableObjectCollectionProperty(tt.Versions.v1_0,"choices",tt.Choice),t.styleProperty=new tt.ValueSetProperty(tt.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"}],"compact"),t.isMultiSelectProperty=new tt.BoolProperty(tt.Versions.v1_0,"isMultiSelect",!1),t.placeholderProperty=new tt.StringProperty(tt.Versions.v1_0,"placeholder"),t.wrapProperty=new tt.BoolProperty(tt.Versions.v1_2,"wrap",!1),t.isRequiredProperty=new tt.BoolProperty(tt.Versions.v1_2,"isRequired",!1),Object(i.__decorate)([Object(tt.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),Object(i.__decorate)([Object(tt.property)(t.choicesProperty)],t.prototype,"choices",void 0),Object(i.__decorate)([Object(tt.property)(t.styleProperty)],t.prototype,"style",void 0),Object(i.__decorate)([Object(tt.property)(t.isMultiSelectProperty)],t.prototype,"isMultiSelect",void 0),Object(i.__decorate)([Object(tt.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),Object(i.__decorate)([Object(tt.property)(t.wrapProperty)],t.prototype,"wrap",void 0),Object(i.__decorate)([Object(tt.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),t}(tt.Input),pt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderLivePersonaControlCard=function(e){var n=window.LivePersonaCardHoverTargetV2,r=o.createElement(n,{cardParameters:{personaInfo:{identifiers:{Smtp:e.smtp,PersonaType:"User"}},behavior:{locationToOpen:"Card"}}},o.createElement("span",{"data-debug":e.name,style:{display:"inline-block"}},e.name)),a=t.lpcElement.querySelector("[data-mention-name='"+e.name+"']");Z.render(r,a)},t}return Object(i.__extends)(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.mentions=t.mentions},t.prototype.internalRender=function(){var t=this;return Object(g.i)("rp-actionableMessages-lpc")&&this.mentions&&0!=this.mentions.length?(this.lpcElement=e.prototype.internalRender.call(this),this.mentions.forEach((function(e){t.lpcElement.innerHTML=t.lpcElement.innerHTML.replace(new RegExp(e.name,"i"),'<span data-mention-name="'+e.name+'"></span>')})),this.mentions.forEach((function(e){return t.renderLivePersonaControlCard(e)})),this.lpcElement):e.prototype.internalRender.call(this)},t}(tt.TextBlock),ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.smtp=t.smtp},t.prototype.internalRender=function(){if(!this.smtp||!Object(g.i)("rp-actionableMessages-lpc"))return e.prototype.internalRender.call(this);var t,n=window.LivePersonaCardHoverTargetV2;this.lpcElement=document.createElement("div");var r=o.createElement(n,{cardParameters:{personaInfo:{identifiers:{Smtp:this.smtp,PersonaType:"User"}},behavior:{locationToOpen:"Card"}}},o.createElement("div",{ref:function(e){return t=e}}));return Z.render(r,this.lpcElement),t.appendChild(e.prototype.internalRender.call(this)),this.lpcElement},t.prototype.remove=function(){return this.lpcElement&&(Z.unmountComponentAtNode(this.lpcElement),this.lpcElement=null),e.prototype.remove.call(this)},t}(tt.Image),mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.email=t.email},t.prototype.internalRender=function(){this.personaElement=document.createElement("div");var e=o.createElement(gt,{emailAddress:this.email,name:""});return Z.render(e,this.personaElement),this.personaElement},t.prototype.remove=function(){return this.personaElement&&(Z.unmountComponentAtNode(this.personaElement),this.personaElement=null),e.prototype.remove.call(this)},t.prototype.getJsonTypeName=function(){return"Persona"},t.prototype.renderSpeech=function(){return this.email},t}(tt.CardElement);function gt(e){var t=Object($.a)(e),n=e.emailAddress,r=e.name,a=e.mailBoxType;return o.createElement(t,null,o.createElement(X.a,{emailAddress:n,name:r,size:Q.c.size48,showPersonaDetails:!1,mailboxType:a}))}var ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onExecute=function(e){try{var t=new URL(e.url);if("http:"===t.protocol.toLowerCase()||"https:"===t.protocol.toLowerCase())window.open(t.href,"_blank");else{var n="mailto:"===t.protocol.toLowerCase()?"Mailto action":"Invalid URL";h.g.info("[ActionableMessageDebug] onExecuteAction: open url not executed. "+n)}}catch(e){h.g.info("[ActionableMessageDebug] onExecuteAction: open url not executed. Malformed URL. "+e.message)}},t}return Object(i.__extends)(t,e),t}(tt.OpenUrlAction),bt=!1,yt=function(e,t){var n=Ae().render(e);t.didProcess=!0,t.outputHtml=n},vt=function(e){bt||(bt=!0,tt.GlobalSettings.allowMarkForTextHighlighting=!0,tt.AdaptiveCard.onProcessMarkdown=yt,function(e){tt.GlobalSettings.applets.refresh.mode=tt.RefreshMode.Automatic,tt.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes=-1,tt.GlobalSettings.applets.refresh.maximumConsecutiveAutomaticRefreshes=1,tt.GlobalSettings.applets.refresh.allowManualRefreshesAfterAutomaticRefreshes=!1,it.strings=e,tt.AdaptiveApplet.elementsRegistry.register("Input.Text",it),lt.strings=e,tt.AdaptiveApplet.elementsRegistry.register("Input.Number",lt),ct.strings=e,tt.AdaptiveApplet.elementsRegistry.register("Input.Date",ct),dt.strings=e,tt.AdaptiveApplet.elementsRegistry.register("Input.Toggle",dt),ut.strings=e,tt.AdaptiveApplet.elementsRegistry.register("Input.ChoiceSet",ut),tt.AdaptiveApplet.elementsRegistry.register("TextBlock",pt),tt.AdaptiveApplet.elementsRegistry.register("Image",ht),tt.AdaptiveApplet.elementsRegistry.register("Persona",mt),tt.AdaptiveApplet.actionsRegistry.register(tt.OpenUrlAction.JsonTypeName,ft)}(e))};n(9238);var Ct=n(4634),xt=function(e){function t(t){var n=e.call(this,t)||this;return n.initializeCardProperties=function(){var e=n.props.actionableMessageCardStrings;n.responseMessage={message:"",type:r.Error,viewType:a.AutoDismiss},n.cardElementId=k+Object(m.a)(),vt(e)},n.renderActionResponse=function(){return o.createElement(N,{message:n.responseMessage.message,type:n.responseMessage.type,viewType:n.responseMessage.viewType,autoDismissTimeout:n.props.snackBarTimeout,onHideActionResponse:n.setShowCard,acknowledgeButtonText:n.responseMessage.acknowledgeButtonText,onAcknowledgeActionResponse:n.responseMessage.onAcknowledgeActionResponse})},n.setCardContainer=function(e){n.cardContainer!==e&&(h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: setCardContainer"),n.cardContainer=e,n.pendingCardToShow&&n.addCardElementToDOM(n.pendingCardToShow))},n.removeCardElementFromDOM=function(){var e=document.getElementById(n.cardElementId);e&&n.cardContainer&&n.cardContainer.contains(e)&&(h.g.info("[ActionableMessageDebug] ActionableMessageCard: removing old card from container"),n.cardContainer.removeChild(e),n.currentCardElement=null)},n.addCardElementToDOM=function(e){n.cardContainer?(n.pendingCardToShow=null,n.removeCardElementFromDOM(),h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: adding card element to DOM"),n.currentCardElement=e,n.cardContainer.appendChild(n.currentCardElement)):n.pendingCardToShow=e},n.setHideCard=function(){h.g.info("[ActionableMessageDebug] hideCard. cardId: "+n.props.cardDetails.cardId),n.setState({cardState:2}),n.props.showMessageBodyCallback&&n.props.showMessageBodyCallback(!0)},n.setShowCard=function(){h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper setCardVisibility: setting card visibility to true "),n.setState({cardState:1}),n.props.onCardRendered&&n.props.onCardRendered(n.currentCardElement)},n.cleanupCard=function(){var e;h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper cleanupCard: cardId: "+n.props.cardDetails.cardId),(null===(e=n.adaptiveApplet)||void 0===e?void 0:e.card)&&n.adaptiveApplet.card.getAllInputs().forEach((function(e){e.remove()})),n.props.actionableMessageContentHandler&&n.props.actionableMessageContentHandler.onUndo()},n.getTheme=function(){return Object(i.__awaiter)(n,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e=this.props.cardDetails.card,[4,K(e.theme?e.theme:A)];case 1:return[2,t.sent()]}}))}))},n.onInlineCardExpanded=function(e,t){n.props.actionableMessageContentHandler&&n.props.actionableMessageContentHandler.onApply(e.card.renderedElement),e.renderedElement.scrollIntoView(!0)},n.activityRequestFailed=function(e,t){var a=n.props.actionableMessageCardStrings.error.generic;return"string"==typeof t.content&&(a=t.content),n.displayActionStatusMessage(a,r.Error),-1},n.activityRequestSucceeded=function(e,t){"string"==typeof t.content&&n.displayActionStatusMessage(t.content,r.Success)},n.onCardChanged=function(e){var t=n.props,r=t.actionableMessageContentHandler,a=t.contentHandlerUndoMode,i=t.fixImagesBeforeRenderCallback;a?r&&r.onUndo():n.currentCardElement&&r&&r.onApply(n.currentCardElement),i&&i(n.adaptiveApplet.renderedElement,n.getOriginator())},n.initializeAdaptiveCard=function(e,t){n.adaptiveApplet=new tt.AdaptiveApplet,n.adaptiveApplet.channelAdapter=n.props.httpChannelAdapter,n.adaptiveApplet.onActivityRequestFailed=n.activityRequestFailed,n.adaptiveApplet.onActivityRequestSucceeded=n.activityRequestSucceeded,n.adaptiveApplet.onCardChanged=n.onCardChanged,n.adaptiveApplet.hostConfig=t.hostConfig,n.adaptiveApplet.setCard(e),n.adaptiveApplet.card.onInlineCardExpanded=n.onInlineCardExpanded,t.stylesheetUrl&&Ge(e.theme,t.stylesheetUrl)},n.displayActionStatusMessage=function(e,t,r,i,o){void 0===r&&(r=a.AutoDismiss),void 0===i&&(i=null),void 0===o&&(o=null),n.responseMessage.message=e,n.responseMessage.type=t,n.responseMessage.viewType=r,n.responseMessage.acknowledgeButtonText=i,n.responseMessage.onAcknowledgeActionResponse=o,n.setState({cardState:3})},n.tryUpdateCardElement=function(e){return Object(i.__awaiter)(n,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),(t=e.card)||this.setHideCard(),[4,this.getTheme()];case 1:if(!(n=r.sent()))throw new Error("Unable to get a theme");if(this.initializeAdaptiveCard(Object(et.toJS)(t),n),!this.adaptiveApplet.renderedElement)throw new Error("Rendered card element not found");return this.addCardElementToDOM(this.adaptiveApplet.renderedElement),this.setShowCard(),[3,3];case 2:return r.sent(),this.setHideCard(),[3,3];case 3:return[2]}}))}))},n.getOriginator=function(){return n.props.cardDetails.card.originator||n.props.cardDetails.connectorSenderGuid},n.state={cardState:2},n.initializeCardProperties(),n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){this.tryUpdateCardElement(this.props.cardDetails)},t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.actionableMessageContentHandler,r=t.contentHandlerUndoMode;r===e.contentHandlerUndoMode&&n===e.actionableMessageContentHandler||(r?n&&n.onUndo():this.currentCardElement&&n&&n.onApply(this.currentCardElement))},t.prototype.componentWillUnmount=function(){h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper unmount"),this.currentCardElement&&this.cleanupCard()},t.prototype.render=function(){var e=this;h.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper render");var t=this.state.cardState;return function(e){return 1===e||3===e}(t)&&o.createElement("div",{className:Ct.container+" allowTextSelection",ref:function(t){return e.setCardContainer(t)}},function(e,t){return 3===e&&!!t&&!!t.message}(t,this.responseMessage)&&this.renderActionResponse())},t=Object(i.__decorate)([s.observer],t)}(o.Component);n(9238);var At=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.render=function(){if(!t.hasCardDetails(t.props.cardDetails))return null;var e=t.getCardVersion(t.props.cardDetails.card);return"V2"!==e||t.props.isActionableMessageV2Enabled?"V2"===e?o.createElement(xt,{key:t.props.cardDetails.cardId,cardDetails:t.props.cardDetails,httpChannelAdapter:t.props.httpChannelAdapter,snackBarTimeout:t.props.snackBarTimeout,telemetryHandler:t.props.telemetryHandler,contentHandlerUndoMode:t.props.contentHandlerUndoMode,actionableMessageContentHandler:t.props.actionableMessageContentHandler,actionableMessageCardStrings:t.props.actionableMessageCardStrings,onCardRendered:t.props.onCardRendered,showMessageBodyCallback:t.props.showMessageBodyCallback,fixImagesBeforeRenderCallback:t.props.fixImagesBeforeRenderCallback}):o.createElement(Qe,{key:t.props.cardDetails.cardId,cardDetails:t.props.cardDetails,snackBarTimeout:t.props.snackBarTimeout,loggingHandler:t.props.loggingHandler,telemetryHandler:t.props.telemetryHandler,contentHandlerUndoMode:t.props.contentHandlerUndoMode,actionableMessageContentHandler:t.props.actionableMessageContentHandler,actionProviders:t.props.actionProviders,actionableMessageCardStrings:t.props.actionableMessageCardStrings,getClientAuthToken:t.props.getClientAuthToken,isTrustedDomain:t.props.isTrustedDomain,showMessageBodyCallback:t.props.showMessageBodyCallback,adjustCardElementBeforeRenderCallback:t.props.adjustCardElementBeforeRenderCallback,downloadThemeCallback:t.props.downloadThemeCallback,onCardRendered:t.props.onCardRendered,onCardDetailsUpdated:t.props.onCardDetailsUpdated}):(t.props.showMessageBodyCallback(!0),null)},t}return Object(i.__extends)(t,e),t.prototype.hasCardDetails=function(e){return!!e},t.prototype.getCardVersion=function(e){var t;return(null===(t=null==e?void 0:e.version)||void 0===t?void 0:t.startsWith("2."))?"V2":"V1"},t=Object(i.__decorate)([s.observer],t)}(o.Component);n.d(t,"ActionableMessageCardWrapper",(function(){return At})),n.d(t,"parseCardFromStringOrObject",(function(){return Pe}))},1959:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(220);var a=Object(r.a)((function(e){return Object(r.a)((function(t){var n=Object(r.a)((function(e){return function(n){return t(n,e)}}));return function(r,a){return e(r,a?n(a):t)}}))}));function i(e,t){return a(e)(t)}},4634:function(e,t,n){var r=n(15480),a=n(107);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},64:function(e,t,n){"use strict";var r,a,i,o;n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(r||(r={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(a||(a={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(i||(i={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(o||(o={}));var s=7},701:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),a=n(1),i=n(209),o=n(507),s=n(502),l=n(310),c=n(262),d=n(348),u=n(465),p=Object(i.a)(),h=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i._checkBox=a.createRef(),i._renderContent=function(e,t,n){void 0===n&&(n={});var l=i.props,c=l.disabled,u=l.inputProps,p=l.name,h=l.ariaLabel,m=l.ariaLabelledBy,g=l.ariaDescribedBy,f=l.onRenderLabel,b=void 0===f?i._onRenderLabel:f,y=l.checkmarkIconProps,v=l.ariaPositionInSet,C=l.ariaSetSize,x=l.title,A=l.label;return a.createElement("div",{className:i._classNames.root,title:x},a.createElement(o.a,null),a.createElement("input",Object(r.__assign)({type:"checkbox"},u,{"data-ktp-execute-target":n["data-ktp-execute-target"],checked:e,disabled:c,className:i._classNames.input,ref:i._checkBox,name:p,id:i._id,title:x,onChange:i._onChange,onFocus:i._onFocus,onBlur:i._onBlur,"aria-disabled":c,"aria-label":h||A,"aria-labelledby":m,"aria-describedby":Object(s.a)(g,n["aria-describedby"]),"aria-posinset":v,"aria-setsize":C,"aria-checked":t?"mixed":e?"true":"false"})),a.createElement("label",{className:i._classNames.label,htmlFor:i._id},a.createElement("div",{className:i._classNames.checkbox,"data-ktp-target":n["data-ktp-target"]},a.createElement(d.a,Object(r.__assign)({iconName:"CheckMark"},y,{className:i._classNames.checkmark}))),b(i.props,i._onRenderLabel)))},i._onFocus=function(e){var t=i.props.inputProps;t&&t.onFocus&&t.onFocus(e)},i._onBlur=function(e){var t=i.props.inputProps;t&&t.onBlur&&t.onBlur(e)},i._onChange=function(e){var t=i.props.onChange,n=i.state,r=n.isChecked;n.isIndeterminate?(t&&t(e,r),void 0===i.props.indeterminate&&i.setState({isIndeterminate:!1})):(t&&t(e,!r),void 0===i.props.checked&&i.setState({isChecked:!r}))},i._onRenderLabel=function(e){var t=e.label,n=e.title;return t?a.createElement("span",{"aria-hidden":"true",className:i._classNames.text,title:n},t):null},Object(l.a)(i),i._id=i.props.id||Object(c.a)("checkbox-"),i.state={isChecked:!!(void 0!==t.checked?t.checked:t.defaultChecked),isIndeterminate:!!(void 0!==t.indeterminate?t.indeterminate:t.defaultIndeterminate)},i}return Object(r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n={};return void 0!==e.indeterminate&&(n.isIndeterminate=!!e.indeterminate),void 0!==e.checked&&(n.isChecked=!!e.checked),Object.keys(n).length?n:null},t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.disabled,i=t.boxSide,o=t.theme,s=t.styles,l=t.onRenderLabel,c=void 0===l?this._onRenderLabel:l,d=t.keytipProps,h=this.state,m=h.isChecked,g=h.isIndeterminate;return this._classNames=p(s,{theme:o,className:n,disabled:r,indeterminate:g,checked:m,reversed:"start"!==i,isUsingCustomLabelRender:c!==this._onRenderLabel}),d?a.createElement(u.a,{keytipProps:d,disabled:r},(function(t){return e._renderContent(m,g,t)})):this._renderContent(m,g)},Object.defineProperty(t.prototype,"indeterminate",{get:function(){return!!this.state.isIndeterminate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checked",{get:function(){return!!this.state.isChecked},enumerable:!0,configurable:!0}),t.prototype.focus=function(){this._checkBox.current&&this._checkBox.current.focus()},t.defaultProps={boxSide:"start"},t}(a.Component)},9238:function(e,t,n){var r=n(15487),a=n(107);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)}}]);
//# sourceMappingURL=owa.MailBoot~ActionableMessageCardWrapper.js.map
self.scriptsLoaded['owa.MailBoot~ActionableMessageCardWrapper.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ActionableMessageCardWrapper.js'] = (new Date()).getTime();