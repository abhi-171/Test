self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FilterContextMenu.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[408],{10286:function(e,t,n){var r=n(12628),i=n(107);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},11094:function(e,t,n){"use strict";n.r(t);var r=n(32),i=n(12626),o=n(8510),c=n(7),a=n(12627),u=n(6536);function l(e){switch(e){case 1:return Object(c.b)(a.a);case 3:return Object(c.b)(a.b);case 7:return Object(c.b)(a.d);case 5:return Object(c.b)(a.c);case 8:return Object(c.b)(u.a);default:throw new Error("Sort not implemented")}}var s=n(7864),d=n(5630),f=n(6537),b=n(105),m=n(34);function p(e){switch(e){case"All":return Object(c.b)(o.a);case"Unread":return Object(c.b)(d.a);case"Flagged":return Object(c.b)(s.a);case"ToOrCcMe":return Object(c.b)(o.e);case"HasAttachment":return Object(c.b)(f.a);case"Mentioned":return Object(c.b)(o.c);case"TaskActive":case"TaskOverdue":case"TaskCompleted":case"DeprecatedSuggestions":case"DeprecatedSuggestionsRespond":case"DeprecatedSuggestionsDelete":case"DeprecatedNoClutter":case"DeprecatedClutter":case"SystemCategory":case"UserCategory":case"Pinned":case"Focused":case"Locked":case"Hashtag":case"Liked":return m.d("Filter not implemented"),"";default:return Object(b.a)(e)}}var g=n(4734),h=n(1633),w=n(1),S=n(202),x=n(770),y=n(86),O=n(4057),j=n(1664),v=n(2759),C=n(1673),M=n(10286),I=Object(r.a)((function(e){var t=w.useMemo((function(){return h.X.tableViews.get(e.tableViewId)}),[e.tableViewId]),n=function(){var e=Object(h.I)(t),n=e.sortDirection==h.c.ASCENDING_SORT_DIR,r=e.sortColumn,o=h.c.getSupportedSortColumns(t.tableQuery.folderId),u=[],s=[];o.forEach((function(t){var n=r==t;s.push({key:t.toString(),name:l(t),data:{sortOrder:n?e.sortDirection:h.c.getDefaultSortDirectionForSortColumn(t),sortColumn:t},onClick:a,canCheck:!0,isChecked:n})})),u.push({key:"sortBySection",itemType:S.a.Section,sectionProps:{bottomDivider:!0,title:Object(c.b)(i.j),items:s}});var d=function(e){switch(e){case 1:return{ascendingString:Object(c.b)(i.g),descendingString:Object(c.b)(i.f)};case 3:case 8:return{ascendingString:Object(c.b)(i.a),descendingString:Object(c.b)(i.b)};case 7:return{ascendingString:Object(c.b)(i.h),descendingString:Object(c.b)(i.d)};case 5:return{ascendingString:Object(c.b)(i.e),descendingString:Object(c.b)(i.c)};default:throw new Error("Sort not implemented")}}(r),f=d.ascendingString,b=d.descendingString,m=[{key:"ascending",name:f,data:{sortOrder:"Ascending",sortColumn:r},onClick:a,canCheck:!0,isChecked:n},{key:"descending",name:b,data:{sortOrder:"Descending",sortColumn:r},onClick:a,canCheck:!0,isChecked:!n}];return u.push({key:"sortOrderSection",itemType:S.a.Section,sectionProps:{bottomDivider:!0,title:Object(c.b)(i.k),items:m}}),u},r=function(t){return{key:t.toString(),name:p(t),data:t,canCheck:!0,isChecked:e.currentViewFilter==t,onClick:u}},a=function(t,n){e.dismissContextMenu(),g.e.importAndExecute(n.data.sortColumn,n.data.sortOrder,e.tableViewId,e.filterMenuSource)},u=function(t,n){e.dismissContextMenu();var r=n.data;"Important"===r?g.c.importAndExecute(e.filterMenuSource):g.d.importAndExecute(r,e.filterMenuSource)},s=e.dismissContextMenu,d=e.contextMenuTargetElement,f=function(){var a=e.supportedViewFilters.filter((function(e){return!(Object(j.c)()&&("Mentioned"===e||"ToOrCcMe"===e))})).map((function(e){return r(e)}));if(Object(v.b)()&&t.tableQuery.folderId&&"inbox"==Object(C.a)(t.tableQuery.folderId)){var l=v.h.tryImportForRender(),s=(null==l?void 0:l())||0;a.push({key:"importantFilter",name:Object(c.b)(o.d),canCheck:!0,data:"Important",onClick:u,secondaryText:s>0?s.toString():null,itemProps:{styles:{secondaryText:M.secondaryText}}})}if(1!=t.tableQuery.type){a.push({key:"divider",name:"-",itemType:S.a.Divider});var d=h.X.tableViews.get(e.tableViewId).tableQuery.folderId;a.push({key:"sortBy",name:Object(c.b)(i.i),items:n()});var f=O.a.tryImportForRender();if(f){var b=f(d,e.dismissContextMenu,"filterMenu");b&&(a.push({key:"divider",name:"-",itemType:S.a.Divider}),a.push(b))}}return a}();return w.createElement(x.a,{shouldFocusOnMount:!0,target:d,directionalHint:y.DirectionalHint.bottomRightEdge,onDismiss:s,items:f})}));var D=n(0),k=n(348),E=n(1829),N=n(188),_=n(3),F=Object(_.createStore)("mailListFilterView",{filterContextMenuDisplayState:!1}),P=F(),Q=Object(N.action)("showFilterDropDownContextMenu")((function(){F().filterContextMenuDisplayState=!0})),T=Object(N.action)("hideFilterDropDownContextMenu")((function(){F().filterContextMenuDisplayState=!1})),V=n(3728);Object(_.mutator)(V.e,(function(e){F().filterContextMenuDisplayState=!0}));var H=n(1659),A=n(40),K=n(213),R=n(10286),L=Object(r.a)((function(e){var t,n=w.useRef(),r=h.X.tableViews.get(e.tableViewId),i=Object(h.O)(r),a=r.tableQuery,u="spotlight"===a.scenarioType,l="All"==i&&!u,s=function(t){t.stopPropagation();var n=P.filterContextMenuDisplayState;u?g.b.importAndExecute(e.filterMenuSource):l?n?z():Q():g.d.importAndExecute("All",e.filterMenuSource)},d=K(e.containerClassName,e.isInboxWithPivots&&R.filterPivots,P.filterContextMenuDisplayState?R.filterAllOpened:R.filterAll),f={role:H.a.button},b=w.useMemo((function(){return l?Object(c.b)(o.b):u?Object(c.b)(o.d):p(i)}),[e.tableViewId]),m=Object(A.i)("mon-tri-filterButtonStyling"),S="Ascending"==(null===(t=null==a?void 0:a.sortBy)||void 0===t?void 0:t.sortDirection)?"SortUp":"SortDown",x=l?m?S:"ChevronDownMed":"Cancel";return w.createElement("div",Object(D.__assign)({ref:function(e){return n.current=e},className:d,onClick:s,onKeyDown:function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),s(e))}},Object(H.b)(f),{tabIndex:0}),w.createElement("div",{className:K(R.filterContents,m&&R.monarchFilterContents)},m&&w.createElement(k.a,{className:m?R.filterIcon:R.icon,iconName:"Filter"}),b,w.createElement(k.a,{className:m?R.sortOrderIcon:R.icon,iconName:x})),P.filterContextMenuDisplayState&&w.createElement(I,{currentViewFilter:i,supportedViewFilters:e.supportedViewFilters,dismissContextMenu:z,contextMenuTargetElement:n.current,filterMenuSource:e.filterMenuSource,tableViewId:e.tableViewId}))}));function z(){T(),E.b.importAndExecute()}n.d(t,"MailFilterContextMenu",(function(){return I})),n.d(t,"MailListFilterMenu",(function(){return L}))},12626:function(e){e.exports=JSON.parse('{"i":"JMc","j":"KMc","k":"LMc","a":"MMc","b":"NMc","g":"OMc","f":"PMc","d":"QMc","h":"RMc","c":"SMc","e":"TMc"}')},12627:function(e){e.exports=JSON.parse('{"a":"FMc","b":"GMc","d":"HMc","c":"IMc"}')},12628:function(e,t,n){(t=e.exports=n(106)(!1)).push([e.i,'._2HxQ4wKES5wjvIgnjfLcQK,._3HGhEMHDY2i8us0auVPsuI{cursor:pointer;font-size:14px;font-weight:400;color:"[theme:themePrimary, default:#0078D4]";font-weight:600;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;height:32px}html[dir] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir] ._3HGhEMHDY2i8us0auVPsuI{padding:0 8px;border-radius:2px;margin-top:5px}html[dir=ltr] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir=ltr] ._3HGhEMHDY2i8us0auVPsuI{margin-left:auto;margin-right:-8px}html[dir=rtl] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir=rtl] ._3HGhEMHDY2i8us0auVPsuI{margin-right:auto;margin-left:-8px}html[dir] ._2HxQ4wKES5wjvIgnjfLcQK:hover,html[dir] ._3HGhEMHDY2i8us0auVPsuI{background-color:"[theme:neutralLighter, default:#f3f2f1]"}html[dir] .SNcGPM0gk8ayZzwzROpZX{margin-bottom:8px}html[dir] ._3lIR1LfENBYPLTyCDNhq5k{margin-top:6px}._2oQ9sQfC-vORW35CueNgmA{font-weight:400;font-size:10px;color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._2oQ9sQfC-vORW35CueNgmA{padding-left:4px}html[dir=rtl] ._2oQ9sQfC-vORW35CueNgmA{padding-right:4px}._2_SkjBhZSNqf9Kyzy4u3E7{font-size:14px}html[dir=ltr] ._2_SkjBhZSNqf9Kyzy4u3E7{padding-right:7px}html[dir=rtl] ._2_SkjBhZSNqf9Kyzy4u3E7{padding-left:7px}._2Bkh9v8E1TnE5lKtn0SYsl{font-size:16px}html[dir=ltr] ._2Bkh9v8E1TnE5lKtn0SYsl{padding-left:14px}html[dir=rtl] ._2Bkh9v8E1TnE5lKtn0SYsl{padding-right:14px}.QCFDYNlgEXFDrarlbtyNf{color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] .QCFDYNlgEXFDrarlbtyNf{margin-right:3px}html[dir=rtl] .QCFDYNlgEXFDrarlbtyNf{margin-left:3px}._20HunDtNJtjpwLyRVIvyIV{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"[theme:neutralSecondary, default:#605e5c]"}',""]),t.locals={filterAll:"_2HxQ4wKES5wjvIgnjfLcQK",filterAllOpened:"_3HGhEMHDY2i8us0auVPsuI",filterPivots:"SNcGPM0gk8ayZzwzROpZX",filterContents:"_3lIR1LfENBYPLTyCDNhq5k",icon:"_2oQ9sQfC-vORW35CueNgmA",filterIcon:"_2_SkjBhZSNqf9Kyzy4u3E7",sortOrderIcon:"_2Bkh9v8E1TnE5lKtn0SYsl",secondaryText:"QCFDYNlgEXFDrarlbtyNf",monarchFilterContents:"_20HunDtNJtjpwLyRVIvyIV"}},2480:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1737),i=n(40);function o(){return Object(i.i)("tri-spotlight2")&&!Object(r.a)(2048)}},2595:function(e,t,n){"use strict";var r=n(3),i=Object(r.createStore)("spotlightStore",{spotlightItems:[],rollupDismissed:!1,logicalId:null,requestStartTime:null});t.a=i},2759:function(e,t,n){"use strict";var r=n(44),i=n(2595);function o(e){var t=e.itemId,n=e.conversationId,r=e.rowKey;return Object(i.a)().spotlightItems.some((function(e){return t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r}))}var c=n(2480);n.d(t,"i",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"m",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"g",(function(){return m})),n.d(t,"j",(function(){return p})),n.d(t,"k",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c.a}));var a=new r.c((function(){return Promise.all([n.e(3),n.e(44),n.e(56),n.e(58),n.e(62),n.e(78),n.e(747)]).then(n.bind(null,17130))})),u=new r.a(a,(function(e){return e.initializeSpotlight})),l=new r.b(a,(function(e){return e.getSpotlightLogicalId})),s=new r.b(a,(function(e){return e.getSpotlightItem})),d=new r.b(a,(function(e){return e.getUnacknowledgedSpotlightCount})),f=new r.a(a,(function(e){return e.onSpotlightDismissedFromRP})),b=new r.a(a,(function(e){return e.getSpotlightDonationJson})),m=new r.a(a,(function(e){return e.getSpotlightReasonString})),p=new r.a(a,(function(e){return e.loadImportantTable})),g=new r.a(a,(function(e){return e.logSpotlightItemClicked})),h=new r.a(a,(function(e){return e.logSpotlightResultsRendered})),w=Object(r.d)(a,(function(e){return e.SpotlightIconTeachingMoment}))},3263:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.createStore)("whatsNewStore",{cards:null,disablePauseInboxTryIt:!1})},3264:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("OPEN_PAUSE_INBOX")},3552:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},3728:function(e,t,n){"use strict";var r=n(44),i=n(3263),o=n(3552);function c(){var e=Object(i.a)();return e.cards?Object.keys(e.cards).filter((function(t){return e.cards[t].status===o.a.Unread})).length:0}var a=n(3264);n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return a.a}));var u=new r.c((function(){return Promise.all([n.e(0),n.e(28),n.e(790)]).then(n.bind(null,17097))})),l=Object(r.d)(u,(function(e){return e.WhatsNewFluentPane})),s=new r.a(u,(function(e){return e.initializeWhatsNewIfNecessary})),d=new r.a(u,(function(e){return e.openPremiumDashboard}))},4057:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(44),i=new r.c((function(){return n.e(878).then(n.bind(null,5978))})),o=new r.b(i,(function(e){return e.getPauseInboxContextMenuItem}))},4734:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return s}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(41),n.e(56),n.e(62),n.e(78),n.e(79),n.e(85),n.e(128),n.e(634)]).then(n.bind(null,9594))})),o=new r.a(i,(function(e){return e.selectFilter})),c=new r.a(i,(function(e){return e.selectSort})),a=new r.a(i,(function(e){return e.togglePauseInbox})),u=new r.a(i,(function(e){return e.clearFilter})),l=new r.a(i,(function(e){return e.loadSpotlightFilter})),s=new r.a(i,(function(e){return e.clearSpotlightFilter}))},6536:function(e){e.exports=JSON.parse('{"a":"eea"}')},6537:function(e){e.exports=JSON.parse('{"a":"cVb"}')},7864:function(e){e.exports=JSON.parse('{"a":"EMc"}')},8510:function(e){e.exports=JSON.parse('{"b":"zMc","a":"AMc","e":"BMc","c":"CMc","d":"DMc"}')}}]);
//# sourceMappingURL=owa.FilterContextMenu.js.map
self.scriptsLoaded['owa.FilterContextMenu.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FilterContextMenu.js'] = (new Date()).getTime();