self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~HtmlEditorLinkPlugin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[602],{1001:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(0);function i(e){return Object(r.__assign)({__type:"GetItemRequest:#Exchange"},e)}},1002:function(e,n,t){"use strict";var r=t(28),i=t(0);function o(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(i.__assign)({__type:"GetItemJsonRequest:#Exchange"},t)),Object(r.a)("GetItem",e,n)}t.d(n,"a",(function(){return o}))},1682:function(e,n,t){"use strict";var r,i,o;t.d(n,"c",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return o})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},17123:function(e,n,t){"use strict";t.r(n);var r=t(0),i=t(3239),o=t(5047),a=t(2463),u=t(1773),c=t(34),s=t(3807),d=t(134),l=t(2554);var f="x_OWAAutoLink",h="a",p="img",b="div",g="OWALinkSpinner",m="UpgradeCompose",v="LINK_TEMP_INSERTED_CLASS",w="RestoreCursor",O="span[fluid-url], div[fluid-url]",C="sharepoint.com",k="sharepoint-df.com",E="text/html;content=titled-hyperlink";function S(e,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){return e?(t={},P(i.e,e,t),P(f,e,t),function(e,n){var t=[];e.sharingLinkIds.forEach((function(e){n[e]||(t=t.concat(e))})),t.length>0&&(Object(s.a)(t),l.d.importAndExecute(e.composeId),Object(d.r)("AttachmentComposeSPLinkRemove"))}(n,t),[2]):[2]}))}))}function P(e,n,t){n.queryElements("."+e,(function(e){t[e.id]=!0}))}var A=t(3165),y=t(1775),I=t(3814),j=t(1678),L=t(40);var R=t(2809),D=t(1662),_=t(5041),x=t(7),T=t(2061),N=t(2598),F=t(25);var M=t(2093),U=t(296);function W(e){switch(e){case a.a.OneDrivePro:case a.a.OfficeOneDrivePro:return!0;case a.a.OneDriveConsumer:return Object(U.a)()||Object(L.i)("doc-link-filePicker");case a.a.Dropbox:case a.a.Box:case a.a.GDrive:return Object(L.i)("doc-link-filePicker");default:return!1}}function B(e,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,I.g.import()];case 1:return[4,r.sent()(e)];case 2:return r.sent()?n?(t=e.getAttribute(I.b),[4,a.f.import()]):[3,5]:[3,8];case 3:return[4,r.sent()(t)];case 4:if(!W(r.sent()))return[2,null];r.label=5;case 5:return[4,I.f.import()];case 6:return[4,r.sent()(e.href)];case 7:if((null==(i=r.sent())?void 0:i.length)>0)return[2,i];r.label=8;case 8:return[2,e.href]}}))}))}function V(e,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,B(e,!1)];case 1:return t=r.sent(),n!==a.a.OfficeOneDrivePro?[3,3]:[4,M.a.import()];case 2:if(i=r.sent(),!(t=i(t)))throw new Error("Can not get ODB URL from Office link.");r.label=3;case 3:return[2,t]}}))}))}function G(e,n,t,r){var o;return e&&(n.editor.addUndoSnapshot(),t.push(r.id),o=function(e){e.setAttribute("contenteditable","false"),e.style.pointerEvents="none",e.addEventListener("click",(function(e){e.preventDefault()}));var n=document.createElement("span");return n.className=g+" "+A.a,e.appendChild(n),Object(i.j)(n),[n]}(r),n.editor.select(r,-3),n.editor.triggerContentChangedEvent("Link"),Object(d.r)("AttachmentComposeSPLinksShouldReplaceText")),o}var H=t(10435);function q(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,u.B.import()];case 1:return t.sent(),(n=Object(u.l)(e.id))&&e.href!==n.url&&(n=null,c.d("Stored url is different from the href on anchor element")),H.b.import(),[2,n]}}))}))}var K=t(3196);function $(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Object(L.i)("doc-SxS-jsApi-ODB-Links")?[4,K.a.import()]:[3,2];case 1:n.sent()(e),n.label=2;case 2:return[2]}}))}))}var z=[];function Y(e,n,t,o,s,f,h,p,b,g,m,v){return Object(r.__awaiter)(this,void 0,void 0,(function(){var w,O,C,k,E,S,P,y,I,j,L,M,U,W,B,H,K,Y,J;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.editor?(O={anchorElementsSource:g,canceledReason:"",didBeautifyOrRehydrate:!1,shouldBeautify:t,shouldRehydrate:o,extension:"",hasValidFileName:!0},c.g.info("LinkPlugin.getSharingInfoToTryUpdateLink: shouldBeautify="+t+" isPreviouslyBeautified="+s+", anchorElementsSource="+g),C=G(t,e,b,f),k=f.id,E=Object(u.i)(f.id),[4,q(f)]):[2];case 1:return S=r.sent(),y=!1,S?[3,4]:-1!==z.indexOf(E)?[2]:(w=new d.b("BeautifyLinkE2E"),z.push(E),Object(d.r)("AttachmentComposeSPLinks",{anchorElementSource:g}),w.addCheckmark("GetSharingInfoStart"),[4,V(f,n)]);case 2:return I=r.sent(),[4,Object(_.b)(I,g,t,o,n,E,null)];case 3:return P=r.sent(),w.addCheckmark("GetSharingInfoEnd"),j=Object(D.d)(P.FileName),O.extension=j,(L=z.indexOf(E))>0&&z.splice(L,1),function(e,n,t,r){if(e){var i=n.indexOf(t.id);n.splice(i,1),function(e,n){n.forEach((function(n){try{e.removeChild(n)}catch(e){}})),e.setAttribute("contenteditable","true"),e.style.pointerEvents="auto",e.removeEventListener("click",(function(e){e.preventDefault()}))}(t,r)}}(t,b,f,C),(M=function(e,n,t,r){if(!e.editor)return Object(d.r)("ComposeEditorIsNullDuringProcessSPLinks",[t<20?t:20]),"editorDisposed";if(i=n,o=r.id,i!==o)return c.g.warn("LinkId changes during server call LinkIdBefore: "+n+", LinkIdNow: "+r.id),"linkIdChanged";var i,o,a=e.editor.queryElements("#"+r.id);return a&&1===a.length&&a[0]===r?null:(c.g.warn("The result from querying the editor is not matching the original anchor element with id: "+r.id),"userCanceledOperation")}(e,k,p,f))?(O.canceledReason=M,w.addCustomData(O),w.end(),[2]):n===a.a.OneDriveConsumer&&4!==P.SharingLinkKind&&5!==P.SharingLinkKind?[2]:(e.editor.addUndoSnapshot(),U=P&&0===P.ResultCode,W=!Object(x.f)(P.FileName),O.hasValidFileName=W,y=ue(f)&&g===u.a.PasteHtml&&U&&f.text===P.FileName,(t||y)&&U&&W&&function(e){e.id=A.b+e.id}(f),[3,5]);case 4:t&&c.d("We should not pass true for shouldBeautifyLink when processing the same link again."),r.label=5;case 5:return E=Object(u.i)(f.id),S?(s||S.sharingInfo.getSharingInfoSucceeded)&&(Object(i.g)(E),Object(u.d)(f.id,h.sharingLinkIds)):(B=(t||o)&&(P&&0==P.ResultCode||s),Object(_.c)(E,f.href,h.sharingLinkIds,P,B,s,g,n,I!==f.href?I:null)),[4,l.f.import()];case 6:return r.sent()(E,e.getRecipientWells(),e.fromAddress,h.composeId,v),t||o?(S||(S=Object(u.l)(E)),H=S&&!Object(x.f)(S.fileName),S&&S.sharingInfo.getSharingInfoSucceeded||s?(function(e,n){if(e&&Object(u.p)(n)&&0===e.permissionLevel){var t="edit"===e.sharingInfo.linkType?2:1;Object(u.G)(e.linkId,t)}}(S,k),Object(i.i)(e.editor,e.editorViewState,e.getRecipientWells,e.fromAddress,h.composeId,f,S,H,t||y,s,m),O.didBeautifyOrRehydrate=!0,null==w||w.addCustomData(O),[4,$(f.href)]):[3,8]):(O.didBeautifyOrRehydrate=!1,O.shouldBeautify=!1,O.shouldRehydrate=!1,null==w||w.addCustomData(O),null==w||w.end(),[2]);case 7:return r.sent(),[3,9];case 8:null==w||w.addCustomData(O),r.label=9;case 9:return null==w||w.end(),g!==u.a.PasteHtml&&g!==u.a.InsertLinkFromToolbar&&g!==u.a.InsertLinkFromAttachMenu&&g!==u.a.AutoLink&&g!==u.a.LinkContextMenu?[3,11]:(K=P)?(Y=Object(F.a)().SessionSettings,[4,R.g.import()]):[3,11];case 10:J=r.sent(),T.f.importAndExecute(N.b.SuggestedAttachments,Y.UserPuid,Y.ExternalDirectoryTenantGuid,J(h.composeId),null,JSON.stringify([{ListId:K.ListId,SiteId:K.SiteId,UniqueId:K.ItemUniqueId,WebId:K.WebId}])),r.label=11;case 11:return[2]}}))}))}function J(e,n){return n?e.getAttribute(A.c)===A.d:Object(A.h)(e)}var X="OwaReferenceAttachments",Z=["OWAHT","OWAAM",X,"OwaReferenceAttachmentsEnd","LPUrlAnchor","LPImageAnchor"],Q="OLK-Hidden";function ee(e,n){for(var t=n;t=t.parentNode;)if(t===e)return!0;return!1}var ne=t(208),te=t(213);function re(e,n,t){e.id&&0!==e.id.length&&!t||(J(e,n===u.a.PasteHtml)?e.id=A.b+Object(ne.a)():e.id=A.e+Object(ne.a)()),-1===e.className.indexOf(i.e)&&(e.className=te(e.className,i.e))}function ie(e,n,t,i,o,s,d,l,f,h){return Object(r.__awaiter)(this,void 0,void 0,(function(){var p,b,g,m,v,w,O,C,k,E,S;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:p=[],v=0,r.label=1;case 1:return v<e.length?function(e,n){if(e.id&&Z.filter((function(n){return 0===e.id.indexOf(n)})).length>0)return!1;if(-1!==e.className.indexOf(Q))return!1;if(!e.href)return!1;if(n)for(var t=0;t<n.length;t++)if(ee(n[t],e))return!1;return!0}(b=e[v],n)?[4,B(b,!0)]:[3,5]:[3,6];case 2:return(g=r.sent())?[4,a.f.import()]:[3,5];case 3:return[4,r.sent()(g)];case 4:if(!W(m=r.sent()))return[3,5];re(b,t,d),p.push({id:b.id,url:b.href,anchorElement:b,providerType:m}),r.label=5;case 5:return v++,[3,1];case 6:for(c.g.info("process anchor elements total count: "+p.length),v=0;v<p.length;v++)w=p[v],O=J(w.anchorElement,t===u.a.PasteHtml),C=ue(w.anchorElement),k=ce(w.anchorElement),E=ae(w.anchorElement)&&C&&l,S=O||C||k,oe(t,O,C,E,k),Y(i,w.providerType,E,S,O,w.anchorElement,o,v,s,t,f,h);return[2]}}))}))}function oe(e,n,t,r,i){var o="";r?o="shouldBeautify":n?o="isLinkPreviouslyBeautified":t?o="isLinkPureAnchorElement":i&&(o="isLinkWithOnlyOneSpanChild"),e===u.a.PasteHtml?Object(d.r)("ComposeSPLinksFromPaste",[o]):Object(d.r)("ComposeSPLinksFromDraft",[o])}function ae(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,B(e,!1)];case 1:return[2,n.sent().toLowerCase()===e.text.toLowerCase()]}}))}))}function ue(e){return!e.children||0===e.children.length}function ce(e){return e.children&&1===e.children.length&&e.children[0].tagName.toUpperCase()===i.f&&(!e.children[0].children||0===e.children[0].children.length)}var se=["fluid-url","owaLinkId"];function de(e,n,t,r,i,o){if(c.g.info("LinkPlugin.handleBeforePasteEvent"),Object(y.b)(1)){var a=e.fragment.querySelector(O);if(a){var s=document.createElement(h);s.href=a.getAttribute("fluid-url"),s.textContent=s.href,a.parentNode.replaceChild(s,a)}}var l=e.fragment.querySelectorAll(h),f=e.fragment.querySelectorAll(p);!function(e,n,t){var r;if(Object(L.i)("doc-edge-link")){var i=null===(r=e.clipboardData)||void 0===r?void 0:r.linkPreview;if(0===t.length&&1===n.length&&(null==i?void 0:i.preferred_format)===E&&(Object(d.r)("EdgeLinkPaste",{domain:i.domain}),i.domain===C||i.domain===k)){var o=n[0];o.innerText=o.href}}}(e,l,f);var b=function(e,n){for(var t=e.replace(/\s/g,""),r="",i=0;i<n.length;i++){var o=n[i];r+=fe(o)}return t.toLowerCase()===r.toLowerCase()}(e.fragment.textContent,l);ie(l,null,u.a.PasteHtml,n,t,r,!0,b&&0===f.length,i,o);var g=e.sanitizingOption,m=g.additionalAllowedAttributes,v=g.attributeCallbacks,w=g.additionalAllowedCssClasses;m.push.apply(m,se),w.push(A.a),Object(j.chainSanitizerCallback)(v,"id",A.i),Object(j.chainSanitizerCallback)(v,"shash",le)}function le(e,n,t){return n.getAttribute(I.d)}function fe(e){var n=e.getAttribute(I.b);return(null==n?void 0:n.length)>0?n:e.href}var he=t(5731),pe=t(5),be=t(2558),ge=t(76),me=75,ve=Object(ge.l)()?function(e){return e.metaKey}:function(e){return e.ctrlKey};var we=8,Oe=46;function Ce(e){if(Object(o.a)(e)){var n=e;if(Object(A.h)(n)){var t=n.getAttribute("contenteditable");return!!t&&"false"===t.toLowerCase()}}return!1}var ke=t(2417);function Ee(e,n,t,i,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,d,l,f,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 1!==(s=e.editor.queryElements(b)).length?[3,4]:(c.g.info("shareLinkComposeHandling: only one div element"),d=s[0].innerHTML,[4,M.e.import()]);case 1:return l=r.sent(),0===s[0].childElementCount&&l(d)&&-1===d.indexOf(" ")?((f=document.createElement("a")).href=d,f.innerText=d,re(f,u.a.ShareLinkCompose,!1),e.editor.deleteNode(s[0]),e.editor.insertNode(f),[4,a.d.import()]):[3,4];case 2:return h=r.sent(),[4,Y(e,h(0),!0,!1,!1,f,n,0,t,u.a.ShareLinkCompose,i,o)];case 3:return r.sent(),[2,!0];case 4:return[2,!1]}}))}))}var Se=".",Pe="#";function Ae(e,n,t,i,o,a,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.editor?o!==u.a.EditorLoadedOrDraftOrReply&&o!==u.a.Undo?[3,2]:[4,Ee(e,n,t,a,c)]:(Object(d.r)("processAllLinksInNullEditor",{source:o}),[2]);case 1:if(r.sent())return[2];r.label=2;case 2:return e.editor?(s=e.editor.queryElements(h),l=e.editor.queryElements(Pe+X),function(e,n){e.editor.queryElements(Se+g,(function(e){-1===n.indexOf(e.parentElement.id)&&e.parentElement.removeChild(e)}))}(e,t),[4,ie(s,l,o,e,n,t,i,!1,a,c)]):[2];case 3:return r.sent(),[4,ke.j.import()];case 4:return r.sent()(e.editor,e.editorViewState,e.getRecipientWells,n,e.fromAddress,a),[2]}}))}))}function ye(e,n,t,o,a,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return d=e,c.g.info("LinkPlugin.processContentChangedEvent: "+d.source),"SetContent"!==d.source&&d.source!==m&&d.source!==i.d&&d.source!==w?[3,2]:(l=function(e){if("SetContent"===e)return u.a.Undo;if(e===m)return u.a.ReplyOrForward;if(e===i.d)return u.a.LinkContextMenu;if(e===w)return u.a.RestoreCursor;return c.d("anchor element source was not detected"),u.a.Unknown}(d.source),[4,Ae(n,t,o,d.source===m,l,a,s)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}var Ie=t(62);function je(e,n){switch(e.rawEvent.which){case 40:!function(e,n){var t=n.getContentSearcherOfCursor(e),r=null==t?void 0:t.getInlineElementAfter(),i=null==t?void 0:t.getInlineElementBefore(),o=n.getSelectionRange();if(!i&&r&&o&&o.collapsed){var a=r.getContainerNode();if(Ce(a)){c.g.info("down arrow to move select to next line");var u=n.getBodyTraverser(a);if(u){var s=u.getNextBlockElement();s&&(n.select(s.getStartNode(),-2),e.rawEvent.preventDefault())}}}}(e,n);break;case 8:!function(e,n){var t=n.getContentSearcherOfCursor(e),r=null==t?void 0:t.getInlineElementBefore(),i=n.getSelectionRange();if(r&&i&&i.collapsed){var o=r.getContainerNode();if(Ce(o))return n.deleteNode(o),Object(j.clearEventDataCache)(e),void e.rawEvent.preventDefault()}Le()&&Re(n)}(e,n);break;case 46:!function(e,n){if(Le()){var t=n.getContentSearcherOfCursor(e),r=null==t?void 0:t.getInlineElementAfter(),i=null==t?void 0:t.getInlineElementBefore(),o=n.getSelectionRange();if(!i&&r&&o&&o.collapsed)if(Ce(r.getContainerNode()))return;Re(n)}}(e,n);break;default:return}}function Le(){return Object(Ie.e)()||Object(Ie.f)()}function Re(e){e.queryElements('[contenteditable="false"]',(function(n){if(Ce(n)){var t=e.getDocument().createElement("span");t.innerText="​",t.className=v,n.parentNode.insertBefore(t,n.nextSibling)}})),e.runAsync((function(){e.isDisposed()||e.queryElements("."+v,(function(e){e.parentNode&&e.parentNode.removeChild(e)}))}))}var De=function(){function e(e,n,t,r,o,a){var c=this;void 0===a&&(a=!1),this.editorViewState=e,this.linkIdContainer=n,this.getRecipientWells=t,this.fromAddress=r,this.isCalendar=o,this.allowCtrlK=a,this.tryGetAllSPLinks=function(){c.pendingSPLinksTask||(c.pendingSPLinksTask=setTimeout((function(){c.getAllSPLinks()}),500))},this.onScroll=function(){Object(u.j)()>0&&Object(i.h)()},this.linkIdsWithSpinner=[]}return e.prototype.getName=function(){return"Link"},e.prototype.initialize=function(e){if(c.g.info("LinkPlugin.initialize"),this.editor=e,this.onCutDisposer=this.editor.addDomEventHandler("cut",this.tryGetAllSPLinks),window.addEventListener("resize",this.onScroll),this.allowCtrlK){var n=this.getRecipientWells(),t={toRecipientWell:n[0],ccRecipientWell:n[1],bccRecipientWell:n[2],attachmentWell:this.linkIdContainer};this.editor.addContentEditFeature(function(e,n,t,r){return{keys:[me],allowFunctionKeys:!0,shouldHandleEvent:function(e){var n=e.rawEvent;return!n.altKey&&!n.shiftKey&&ve(n)},handleEvent:function(i){var o=i.rawEvent;o.preventDefault(),o.stopPropagation(),he.c.import().then((function(i){return i(n,e.getDocument().defaultView,be.b.ShortKey,Object(pe.Qb)(),t,r)}))}}}(this.editor,this.editorViewState,this.fromAddress,t))}},e.prototype.onPluginEvent=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t,s,d,l,f,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 14!==e.eventType?[3,1]:(this.onScroll(),[3,9]);case 1:return 10!==e.eventType?[3,2]:(de(e,this,this.linkIdContainer,this.linkIdsWithSpinner,this.editor.getDocument().defaultView,this.isCalendar),[3,9]);case 2:return 11!==e.eventType?[3,3]:(c.g.info("LinkPlugin.EditorReady"),Ae(this,this.linkIdContainer,this.linkIdsWithSpinner,!1,u.a.EditorLoadedOrDraftOrReply,this.editor.getDocument().defaultView,this.isCalendar),[3,9]);case 3:return 7!==e.eventType?[3,8]:"AutoLink"!==(n=e).source&&"CreateLink"!==n.source&&"TextPrediction"!==n.source||!n.data||!Object(o.a)(n.data)?[3,6]:[4,a.f.import()];case 4:return[4,r.sent()(n.data.href)];case 5:return W(t=r.sent())?(s=u.a.Unknown,"AutoLink"===n.source||"TextPrediction"===n.source?s=u.a.AutoLink:"CreateLink"===n.source&&(s=u.a.InsertLinkFromToolbar),c.g.info("LinkPlugin.handleLink"),re(n.data,u.a.AutoLink,!0),Y(this,t,"AutoLink"===n.source||"TextPrediction"===n.source,!0,!1,n.data,this.linkIdContainer,0,this.linkIdsWithSpinner,s,this.editor.getDocument().defaultView,this.isCalendar),[3,7]):[2];case 6:ye(e,this,this.linkIdContainer,this.linkIdsWithSpinner,this.editor.getDocument().defaultView,this.isCalendar),r.label=7;case 7:return[3,9];case 8:if(8===e.eventType)return c.g.info("LinkPlugin.ExtractContentWithDom"),function(e){for(var n,t=e.querySelectorAll("."+A.a),r=0;r<t.length;r++)null===(n=t[r].parentNode)||void 0===n||n.removeChild(t[r]);var o=e.querySelectorAll("["+i.a+"]");for(r=0;r<o.length;r++)o[r].removeAttribute(i.a)}(e.clonedRoot),[2];2===e.eventType||6===e.eventType?(d=this.editor.getSelectionRange())&&(l=d.startContainer,f=d.endContainer,l===f&&"a"===l.nodeName.toLowerCase()&&Ce(h=l)&&d.startOffset===d.endOffset&&(d.startOffset!==l.childNodes.length?(c.g.info("move select before the anchor element."),this.editor.select(h,-2)):(c.g.info("move select after the anchor element."),this.editor.select(h,-3)))):0===e.eventType&&je(e,this.editor),r.label=9;case 9:return this.processLinkRemovalRelatedEvents(e),[2]}}))}))},e.prototype.processLinkRemovalRelatedEvents=function(e){(function(e,n){if(7===e.eventType)return!0;if(0===e.eventType){var t=e.rawEvent;return t.which===we||t.which===Oe}return 1===e.eventType&&(n&&n.getSelectionRange()&&!n.getSelectionRange().collapsed)})(e,this.editor)&&this.tryGetAllSPLinks()},e.prototype.getAllSPLinks=function(){this.pendingSPLinksTask=null,S(this.editor,this.linkIdContainer)},e.prototype.dispose=function(){var e;if(c.g.info("LinkPlugin.dispose"),this.onCutDisposer&&(this.onCutDisposer(),this.onCutDisposer=null),this.pendingSPLinksTask&&(clearTimeout(this.pendingSPLinksTask),this.pendingSPLinksTask=null),this.editor=null,window.removeEventListener("resize",this.onScroll),Object(u.j)()>0){Object(i.h)();var n=null===(e=this.linkIdContainer)||void 0===e?void 0:e.sharingLinkIds;(null==n?void 0:n.length)>0&&n.forEach((function(e){Object(i.m)(e)}))}},e}();t.d(n,"LinkPlugin",(function(){return De}))},1726:function(e,n,t){"use strict";t.d(n,"e",(function(){return s})),t.d(n,"m",(function(){return d})),t.d(n,"i",(function(){return l})),t.d(n,"g",(function(){return f})),t.d(n,"l",(function(){return h})),t.d(n,"k",(function(){return p})),t.d(n,"j",(function(){return b})),t.d(n,"h",(function(){return g})),t.d(n,"f",(function(){return m})),t.d(n,"n",(function(){return v}));var r=t(44),i=t(2063);t.d(n,"o",(function(){return i.a}));var o=t(1825);t.d(n,"b",(function(){return o.a}));var a=t(1913);t.d(n,"d",(function(){return a.a})),t.d(n,"c",(function(){return a.b}));var u=t(1922);t.d(n,"a",(function(){return u.a}));var c=new r.c((function(){return Promise.all([t.e(3),t.e(23),t.e(32),t.e(63),t.e(206),t.e(314)]).then(t.bind(null,3528))})),s=new r.a(c,(function(e){return e.addAndInitializeAttachments})),d=new r.a(c,(function(e){return e.setPreviewImageUrl})),l=new r.a(c,(function(e){return e.refreshDownloadUrl})),f=new r.a(c,(function(e){return e.createAttachmentInfo})),h=new r.a(c,(function(e){return e.setAttachmentInfo})),p=new r.a(c,(function(e){return e.refreshThumbnailImageUrl})),b=new r.a(c,(function(e){return e.refreshPreviewImageUrl})),g=new r.b(c,(function(e){return e.getAttachment})),m=new r.b(c,(function(e){return e.checkPendingAttachmentOperation})),v=new r.b(c,(function(e){return e.shouldShowImageView}))},1792:function(e,n,t){"use strict";var r=t(2062),i=t(2036),o=t(1726),a=t(1876),u=t(2544),c=t(1793);function s(e,n,t,s){if(Object(o.d)(t))return function(e){return 2===Object(a.a)(e)?f():d()}(t);if(3===Object(a.a)(t)&&!s)return l();var h;switch(n){case 2:h={allowEdit:!1,previewMethod:i.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:h={allowEdit:!1,previewMethod:i.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:h={allowEdit:!1,previewMethod:i.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:h={allowEdit:e.wacEdit,previewMethod:i.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:h={allowEdit:!1,previewMethod:i.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:h={allowEdit:!1,previewMethod:i.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:h=f();break;case 11:h={allowEdit:!1,previewMethod:i.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:h={allowEdit:!1,previewMethod:i.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:h={allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]};break;case 13:h={allowEdit:!1,previewMethod:i.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]};break;default:h=function(e){return Object(u.a)(e)||Object(c.a)(e)}(t)?l():d()}return h}function d(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.Download]}}function l(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function f(){return{allowEdit:!1,previewMethod:i.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var h=t(188),p=Object(h.action)("setIsPlaceholderAttachment")((function(e,n){e.isPlaceholderAttachment=n})),b=Object(h.action)("setThumbnailLoadState")((function(e,n){e.thumbnailLoadState=n}));function g(e,n,t,r,o,a){return void 0===a&&(a=null),{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:t,isReadOnly:n,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]},parentItemId:a,fileType:o}}var m,v=t(25);function w(){return Object(v.a)().SessionSettings.CompanyName}function O(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub",e[e.FolderTree=12]="FolderTree"}(m||(m={})),t.d(n,"e",(function(){return s})),t.d(n,"h",(function(){return p})),t.d(n,"i",(function(){return b})),t.d(n,"d",(function(){return g})),t.d(n,"g",(function(){return w})),t.d(n,"f",(function(){return O})),t.d(n,"b",(function(){return i.a})),t.d(n,"a",(function(){return r.a})),t.d(n,"c",(function(){return m}))},1822:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(105);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1830:function(e,n){e.exports=function(e){return e instanceof Date}},1869:function(e,n,t){var r=t(1830),i=36e5,o=6e4,a=2,u=/[T ]/,c=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],h=/^-(\d{2})$/,p=/^-?(\d{3})$/,b=/^-?(\d{2})-?(\d{2})$/,g=/^-?W(\d{2})$/,m=/^-?W(\d{2})-?(\d{1})$/,v=/^(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,C=/([Z+-].*)$/,k=/^(Z)$/,E=/^([+-])(\d{2})$/,S=/^([+-])(\d{2}):?(\d{2})$/;function P(e,n,t){n=n||0,t=t||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*n+t+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,n){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var t=(n||{}).additionalDigits;t=null==t?a:Number(t);var A=function(e){var n,t={},r=e.split(u);c.test(r[0])?(t.date=null,n=r[0]):(t.date=r[0],n=r[1]);if(n){var i=C.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}(e),y=function(e,n){var t,r=d[n],i=f[n];if(t=l.exec(e)||i.exec(e)){var o=t[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(t=s.exec(e)||r.exec(e)){var a=t[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(A.date,t),I=y.year,j=function(e,n){if(null===n)return null;var t,r,i,o;if(0===e.length)return(r=new Date(0)).setUTCFullYear(n),r;if(t=h.exec(e))return r=new Date(0),i=parseInt(t[1],10)-1,r.setUTCFullYear(n,i),r;if(t=p.exec(e)){r=new Date(0);var a=parseInt(t[1],10);return r.setUTCFullYear(n,0,a),r}if(t=b.exec(e)){r=new Date(0),i=parseInt(t[1],10)-1;var u=parseInt(t[2],10);return r.setUTCFullYear(n,i,u),r}if(t=g.exec(e))return o=parseInt(t[1],10)-1,P(n,o);if(t=m.exec(e)){o=parseInt(t[1],10)-1;var c=parseInt(t[2],10)-1;return P(n,o,c)}return null}(y.restDateString,I);if(j){var L,R=j.getTime(),D=0;return A.time&&(D=function(e){var n,t,r;if(n=v.exec(e))return(t=parseFloat(n[1].replace(",",".")))%24*i;if(n=w.exec(e))return t=parseInt(n[1],10),r=parseFloat(n[2].replace(",",".")),t%24*i+r*o;if(n=O.exec(e)){t=parseInt(n[1],10),r=parseInt(n[2],10);var a=parseFloat(n[3].replace(",","."));return t%24*i+r*o+1e3*a}return null}(A.time)),A.timezone?L=function(e){var n,t;if(n=k.exec(e))return 0;if(n=E.exec(e))return t=60*parseInt(n[2],10),"+"===n[1]?-t:t;if(n=S.exec(e))return t=60*parseInt(n[2],10)+parseInt(n[3],10),"+"===n[1]?-t:t;return 0}(A.timezone):(L=new Date(R+D).getTimezoneOffset(),L=new Date(R+D+L*o).getTimezoneOffset()),new Date(R+D+L*o)}return new Date(e)}},1913:function(e,n,t){"use strict";function r(e){return(null==e?void 0:e.AttachmentId)&&i(e.AttachmentId.Id)}function i(e){return e&&-1!==e.indexOf("smime-")}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i}))},1921:function(e,n,t){"use strict";var r=t(1674);function i(){var e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var o=t(1822),a=t(1793);function u(){return i()}function c(e){return(e&&e.length>0&&function(e){return e.some((function(e){return!((n=e).IsInline&&!Object(a.a)(n));var n}))}(e)?i():[]).map(o.a)}t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return c}))},1922:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return i})),t.d(n,"d",(function(){return o})),t.d(n,"e",(function(){return a})),t.d(n,"f",(function(){return u})),t.d(n,"g",(function(){return c})),t.d(n,"h",(function(){return s})),t.d(n,"i",(function(){return d})),t.d(n,"j",(function(){return l})),t.d(n,"k",(function(){return f})),t.d(n,"l",(function(){return h})),t.d(n,"a",(function(){return p}));var r="Box",i="Dropbox",o="Facebook",a="GDrive",u="Mailbox",c="MailMessage",s="OneDriveConsumer",d="OneDrivePro",l="WopiBox",f="WopiDropbox",h="WopiEgnyte",p={providers:{BOX:r,DROPBOX:i,FACEBOOK:o,GDRIVE:a,MAILBOX:u,ONE_DRIVE_CONSUMER:s,ONE_DRIVE_PRO:d,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:l,WOPI_EGNYTE:h}}},2036:function(e,n,t){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),n.a=r},2061:function(e,n,t){"use strict";t.d(n,"g",(function(){return o})),t.d(n,"j",(function(){return a})),t.d(n,"v",(function(){return u})),t.d(n,"l",(function(){return c})),t.d(n,"o",(function(){return s})),t.d(n,"r",(function(){return d})),t.d(n,"i",(function(){return l})),t.d(n,"b",(function(){return f})),t.d(n,"c",(function(){return h})),t.d(n,"h",(function(){return p})),t.d(n,"e",(function(){return b})),t.d(n,"d",(function(){return g})),t.d(n,"f",(function(){return m})),t.d(n,"k",(function(){return v})),t.d(n,"m",(function(){return w})),t.d(n,"p",(function(){return O})),t.d(n,"q",(function(){return C})),t.d(n,"n",(function(){return k})),t.d(n,"u",(function(){return E})),t.d(n,"a",(function(){return S})),t.d(n,"s",(function(){return P})),t.d(n,"t",(function(){return A}));var r=t(44),i=new r.c((function(){return Promise.all([t.e(23),t.e(51),t.e(730)]).then(t.bind(null,5924))})),o=new r.a(i,(function(e){return e.logEntityClicked})),a=new r.a(i,(function(e){return e.logResponseReceived})),u=new r.a(i,(function(e){return e.logSessionEnd})),c=new r.a(i,(function(e){return e.logResponseRendered})),s=new r.a(i,(function(e){return e.logSearchBoxStateChanged})),d=new r.a(i,(function(e){return e.logSearchResultInteraction})),l=new r.a(i,(function(e){return e.logResponseNeverRendered})),f=new r.a(i,(function(e){return e.flushNonRenderedResponseReceivedItemsFromCache})),h=new r.a(i,(function(e){return e.logCachedContentRendered})),p=new r.a(i,(function(e){return e.logFeedback})),b=new r.a(i,(function(e){return e.logClientLayout})),g=new r.a(i,(function(e){return e.logClientDataSource})),m=new r.a(i,(function(e){return e.logEntitiesFromFilePicker})),v=new r.a(i,(function(e){return e.logResponseRecievedV2})),w=new r.a(i,(function(e){return e.logResultsRendered})),O=new r.a(i,(function(e){return e.logSearchEntityActions})),C=new r.a(i,(function(e){return e.logSearchFeedbackActions})),k=new r.a(i,(function(e){return e.logSearchActions})),E=new r.a(i,(function(e){return e.logSecondaryEntityActionClicked})),S=new r.a(i,(function(e){return e.clearProcessedTraceIds})),P=new r.a(i,(function(e){return e.logSearchSuggestionsClientLayoutEvent})),A=new r.a(i,(function(e){return e.logSearchSuggestionsResultsRenderedEvent}))},2062:function(e,n,t){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),n.a=r},2063:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(3),i=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",(function(e){return{attachmentId:e}}))},2140:function(e,n,t){"use strict";var r=t(44),i=[0,1],o=t(2208),a=t(2165),u=t(7),c=t(105),s=t(1682);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(u.b)(a.a),messageParts:[Object(u.b)(a.a),l()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(u.b)(o.b),messageParts:[Object(u.b)(o.b),l()],color:s.a.Red};default:return Object(c.a)(e)}}function l(){return{text:Object(u.b)(o.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=t(1921),h=t(1822),p=t(0),b=t(40),g=t(1674);function m(){var e=Object(g.a)();if(Object(b.i)("fwk-devTools")){if(Object(b.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(p.__assign)(Object(p.__assign)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(b.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(p.__assign)(Object(p.__assign)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function v(){var e=m();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}t.d(n,"g",(function(){return O})),t.d(n,"a",(function(){return i})),t.d(n,"f",(function(){return d})),t.d(n,"b",(function(){return f.a})),t.d(n,"e",(function(){return h.a})),t.d(n,"d",(function(){return v})),t.d(n,"c",(function(){return m}));var w=new r.c((function(){return t.e(1686).then(t.bind(null,16825))})),O=new r.b(w,(function(e){return e.getAccessIssuesForAttachments}))},2165:function(e){e.exports=JSON.parse('{"a":"nla"}')},2208:function(e){e.exports=JSON.parse('{"a":"lla","b":"mla"}')},2417:function(e,n,t){"use strict";t.d(n,"e",(function(){return a})),t.d(n,"f",(function(){return u})),t.d(n,"h",(function(){return c})),t.d(n,"g",(function(){return s})),t.d(n,"j",(function(){return d})),t.d(n,"i",(function(){return l})),t.d(n,"k",(function(){return f})),t.d(n,"l",(function(){return h})),t.d(n,"d",(function(){return p}));var r=t(44),i=t(2555);t.d(n,"a",(function(){return i.a})),t.d(n,"c",(function(){return i.c})),t.d(n,"b",(function(){return i.b}));var o=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(26),t.e(30),t.e(32),t.e(40),t.e(63),t.e(64),t.e(68),t.e(67),t.e(92),t.e(103),t.e(679)]).then(t.bind(null,6963))})),a=(new r.b(o,(function(e){return e.insertLinksIntoComposeEditor})),new r.b(o,(function(e){return e.getAllInsertLinksIds}))),u=new r.b(o,(function(e){return e.getAtLeastOneInsertLinkPendingOrFailed})),c=new r.b(o,(function(e){return e.getBlockDialogOnSendStrings})),s=new r.b(o,(function(e){return e.getBlockDialogOnSaveStrings})),d=new r.b(o,(function(e){return e.insertLinkPlaceholdersRemoveOrRehydrate})),l=new r.b(o,(function(e){return e.getPendingInsertLinkIds})),f=new r.b(o,(function(e){return e.insertLinks})),h=new r.b(o,(function(e){return e.updateUpsellUserSelectionText})),p=Object(r.d)(o,(function(e){return e.InsertLinksBlockDialog}))},2544:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1743);function i(e){return(e.__type||e.OwsTypeName)===r.d}},2555:function(e){e.exports=JSON.parse('{"c":"X6a","a":"Y6a","b":"Z6a"}')},2558:function(e,n,t){"use strict";t.d(n,"c",(function(){return u})),t.d(n,"a",(function(){return c})),t.d(n,"g",(function(){return s})),t.d(n,"e",(function(){return d})),t.d(n,"f",(function(){return l}));var r=t(44),i=t(2746);t.d(n,"b",(function(){return i.a}));var o=t(2813);t.d(n,"d",(function(){return o.a}));var a=new r.c((function(){return Promise.all([t.e(9),t.e(34),t.e(39),t.e(40),t.e(97),t.e(604)]).then(t.bind(null,5533))})),u=Object(r.d)(a,(function(e){return e.Ribbon})),c=Object(r.d)(a,(function(e){return e.ContextualFormatBar})),s=new r.a(a,(function(e){return e.updateRibbonWidth})),d=new r.b(a,(function(e){return e.formatPainterFinish})),l=new r.b(a,(function(e){return e.showInsertLinkDialog}))},2598:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e.Mail="owa.react",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.Sonora="outlook.inlinefilepicker"}(r||(r={})),n.b=r},2746:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e.OriginalRibbon="OriginalRibbon",e.FilePickerLinkContextMenu="FilePickerLinkContextMenu",e.ShortKey="ShortKey",e.FlightedRibbon="FlightedRibbon"}(r||(r={}))},2809:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"d",(function(){return u})),t.d(n,"c",(function(){return c})),t.d(n,"e",(function(){return s})),t.d(n,"f",(function(){return d})),t.d(n,"g",(function(){return l})),t.d(n,"h",(function(){return f}));var r=t(44),i=t(3046);t.d(n,"a",(function(){return i.a}));var o=new r.c((function(){return Promise.all([t.e(3),t.e(30),t.e(488)]).then(t.bind(null,6965))})),a=new r.b(o,(function(e){return e.clearCachedAttachmentSuggestions})),u=new r.b(o,(function(e){return e.getAttachmentSuggestionsAction})),c=new r.b(o,(function(e){return e.createCloudFileFromAttachmentData})),s=new r.b(o,(function(e){return e.getAttachmentSuggestionsMenuItems})),d=new r.b(o,(function(e){return e.getAttachmentSuggestionsTraceId})),l=new r.b(o,(function(e){return e.getAttachmentSuggestionsTraceIdByComposeId})),f=new r.a(o,(function(e){return e.logEntitiesFromFilePicker}))},2813:function(e,n,t){"use strict";function r(e){var n="";if(null==e||"I"===e.nodeName)return"";if("#text"===e.nodeName)return e.textContent.trim();for(var t=0;t<e.childNodes.length;t++)n+=r(e.childNodes[t]);return n}t.d(n,"a",(function(){return r}))},3046:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Contextual=0]="Contextual",e[e.MRUCloudy=1]="MRUCloudy",e[e.MRUClassic=2]="MRUClassic",e[e.MRUContextual=3]="MRUContextual",e[e.MRUClassicContextual=4]="MRUClassicContextual"}(r||(r={}))},3949:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return u}));var r=t(44),i=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(20),t.e(23),t.e(27),t.e(30),t.e(32),t.e(36),t.e(41),t.e(44),t.e(55),t.e(63),t.e(64),t.e(68),t.e(92),t.e(104),t.e(147),t.e(148),t.e(210),t.e(209),t.e(208),t.e(211),t.e(315)]).then(t.bind(null,5914))})),o=new r.a(i,(function(e){return e.prefetchAllWacResources})),a=new r.a(i,(function(e){return e.prefetchWacResourcesForAttachments})),u=new r.a(i,(function(e){return e.prefetchWacResourcesForFiles}))},5041:function(e,n,t){"use strict";var r=t(0),i=t(3),o=Object(i.action)("ON_SHARING_LINK_DETECTED",(function(e,n,t,r,i,o,a,u,c,s){return{linkId:e,linkUrl:n,sharingLinkIds:t,response:r,shouldAddComposeLinkViewState:i,isPreviouslyBeautified:o,source:a,providerType:u,unwrappedUrl:c,creationDateTime:s}})),a=t(3239),u=t(1773),c=t(2463),s=t(3949);Object(i.orchestrator)(o,(function(e){Object(u.c)(e.linkId,e.linkUrl,e.sharingLinkIds,e.response,e.source,e.providerType,e.unwrappedUrl,e.creationDateTime),e.shouldAddComposeLinkViewState&&Object(a.g)(e.linkId)})),Object(i.orchestrator)(o,(function(e){var n,t;(null===(n=e.response)||void 0===n?void 0:n.FileName)&&function(e,n){Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,c.g.import()];case 1:return t.sent()(n)&&s.c.importAndExecute([e]),[2]}}))}))}(null===(t=e.response)||void 0===t?void 0:t.FileName,e.providerType)}));var d=t(134),l=t(1662),f=t(2055),h=t(5);function p(e){var n=!1;if(e){try{var t=Object(h.lc)(e);n=Object(h.Eb)(t,Object(h.h)(Object(h.Pb)(),-10))&&Object(h.Gb)(t,Object(h.Pb)())}catch(e){}Object(d.r)("validlinkCreatedDateTime",{isNewlyCreatedLink:n})}return n}function b(e,n,t,i,o,a,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,h,b,g,m,v;return Object(r.__generator)(this,(function(w){switch(w.label){case 0:return h="",b=function(e){var n,t,i=e.toLowerCase();try{for(var o=Object(r.__values)(["onedrive.aspx","onenote.aspx","allitems.aspx","all.aspx","sites"]),a=o.next();!a.done;a=o.next()){var u=a.value;if(-1!==i.indexOf(u))return u}}catch(e){n={error:e}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}return"NoErrorExpected"}(e),g=new d.b("GetSharingInformationForLink"),[4,c.g.import()];case 1:m=w.sent(),g.addCustomData({anchorElementsSource:n.toString(),shouldBeautify:t,shouldRehydrate:i,expectedErrorType:b,providerType:o}),w.label=2;case 2:return w.trys.push([2,5,,6]),[4,f.h.import()];case 3:return[4,w.sent()(e,o,p(u))];case 4:return s=w.sent(),[3,6];case 5:return v=w.sent(),h=v.fetchErrorType,s={ResultCode:1},[3,6];case 6:return 0!==s.ResultCode||m(o)&&!s.CanonicalUrl?(0===s.ResultCode&&m(o)&&!s.CanonicalUrl&&(s.ResultCode=1,h="NullCanonicalUrlFromSuccessResponse"),Object(d.r)("GetSharingInformationFailure",{errorType:h,resultCode:s.ResultCode||-1,anchorElementsSource:n.toString(),shouldBeautify:t,shouldRehydrate:i,expectedErrorType:b}),g.addCustomData({errorType:h,resultCode:s.ResultCode||-1,extension:""}),g.endWithError("ServerError")):(g.addCustomData({errorType:"",resultCode:s.ResultCode||-1,extension:Object(l.d)(s.FileName||""),sharingLinkKind:s.SharingLinkKind,linkId:a}),g.end()),[2,s]}}))}))}t.d(n,"a",(function(){return"contenteditable"})),t.d(n,"c",(function(){return o})),t.d(n,"b",(function(){return b})),t.d(n,"d",(function(){return p}))},5047:function(e,n,t){"use strict";var r=t(2210),i=t.n(r);function o(e){return i()(e,"HTMLAnchorElement")}function a(e){return i()(e,"HTMLElement")}t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return a}))},5731:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"c",(function(){return a})),t.d(n,"b",(function(){return u})),t.d(n,"d",(function(){return c}));var r=t(44),i=new r.c((function(){return Promise.all([t.e(9),t.e(97),t.e(525)]).then(t.bind(null,11087))})),o=Object(r.d)(i,(function(e){return e.ComposeRibbon})),a=new r.b(i,(function(e){return e.showInsertLinkDialog})),u=Object(r.d)(i,(function(e){return e.InsertMenuItem})),c=new r.b(i,(function(e){return e.showInsertLinkTeachingMoment}))},706:function(e,n,t){"use strict";var r=t(44),i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};t.d(n,"f",(function(){return a})),t.d(n,"g",(function(){return u})),t.d(n,"b",(function(){return c})),t.d(n,"e",(function(){return s})),t.d(n,"d",(function(){return d})),t.d(n,"c",(function(){return l})),t.d(n,"a",(function(){return i}));var o=new r.c((function(){return Promise.all([t.e(3),t.e(23),t.e(664)]).then(t.bind(null,17142))})),a=new r.a(o,(function(e){return e.subscribe})),u=new r.a(o,(function(e){return e.unsubscribe})),c=new r.b(o,(function(e){return e.getChannelId})),s=(new r.b(o,(function(e){return e.getChannelReady})),new r.a(o,(function(e){return e.setup}))),d=new r.a(o,(function(e){return e.initializeNotificationManager})),l=new r.b(o,(function(e){return e.getNotificationEmitter}))},883:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(0),i=t(1),o=t(517),a=t(516),u=t(521),c=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(n,e),n.prototype.render=function(){return i.createElement(u.a,Object(r.__assign)({},this.props,{primary:!0,onRenderDescription:o.b}))},n=Object(r.__decorate)([Object(a.a)("PrimaryButton",["theme","styles"],!0)],n)}(i.Component)}}]);
//# sourceMappingURL=owa.MailBoot~HtmlEditorLinkPlugin.js.map
self.scriptsLoaded['owa.MailBoot~HtmlEditorLinkPlugin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~HtmlEditorLinkPlugin.js'] = (new Date()).getTime();