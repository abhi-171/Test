self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[163],{1718:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2013),o=n(1911);function i(e){return Object(o.b)().scenarioStores.get(Object(r.a)(e))||Object(o.a)()}},1777:function(e,t,n){"use strict";n.d(t,"q",(function(){return d})),n.d(t,"t",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"i",(function(){return O})),n.d(t,"o",(function(){return v})),n.d(t,"b",(function(){return F})),n.d(t,"m",(function(){return S})),n.d(t,"f",(function(){return m})),n.d(t,"p",(function(){return p})),n.d(t,"s",(function(){return j})),n.d(t,"r",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return w})),n.d(t,"k",(function(){return I})),n.d(t,"n",(function(){return E})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return P})),n.d(t,"h",(function(){return T})),n.d(t,"l",(function(){return A}));var r=n(0),o=n(52),i=n(1633),a=n(1640),c=n(3),u=n(1710),s=n(25),d=Object(c.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(_(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(c.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(_(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(c.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,o){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:o}})),b=Object(c.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,t){return{rowKey:e,latestItemIdsInForks:t}})),O=Object(c.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),v=Object(c.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),F=Object(c.action)("ITEM_PART_SELECTED",(function(e,t,n,r,o){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:o}})),S=Object(c.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),m=Object(c.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),p=Object(c.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,o){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:o}})),j=Object(c.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),g=Object(c.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),h=Object(c.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),w=Object(c.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),I=Object(c.action)("RESET_SELECTION",(function(e){return{tableView:e}})),E=Object(c.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(o.c)(_(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),y=Object(c.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),P=Object(c.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),T=Object(c.action)("RESET_BUS_STOP_STATE_MAP"),A=Object(c.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function _(e,t,n,o){return{name:function(e,t,n,o){return!(function(e){return e===a.b.MailListItemRichPreview||e===a.b.KeyboardShiftEnter||e===a.b.MailListItemBodyDoubleClick}(e)||Object(u.c)()&&!function(e){var t;return e===a.b.KeyboardEnter||e===a.b.MailListItemBody||e===a.b.RouteHandler||e===a.b.CommandBarArrows||e===a.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,o){if(Object(u.c)())return!1;if(e===a.b.KeyboardUpDown){var c=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==c&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return o===i.d.Next?s===c+1||s===t.rowKeys.length-1&&c===t.rowKeys.length-1:s===c-1||0===s&&0===c}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,o))}(e,t,n,o)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},1816:function(e,t,n){"use strict";function r(){return{isBeingDragged:!1}}n.d(t,"a",(function(){return r}))},1834:function(e,t,n){"use strict";var r=n(44),o=n(2391),i=n(3),a=n(1634),c=Object(i.mutatorAction)("loadPopoutDataToFolderStore",(function(e){var t=e.folderId,n=e.mailboxInfo,r=e.permission,o=e.principalSMTPAddress,i=Object(a.o)();if(!i.get(t)){var c={FolderId:{Id:t},mailboxInfo:n,PermissionSet:{Permissions:[r]},principalSMTPAddress:o};i.set(t,c)}})),u=n(3375),s=Object(i.mutatorAction)("loadPopoutDataToPublicFolderFavoriteStore",(function(e){var t=e.folderId,n=e.mailboxInfo,r=e.replicaItem,o=u.b.folderTable;if(!o.get(t)){var i={FolderId:{Id:t},mailboxInfo:n,ReplicaList:[r]};o.set(t,i)}})),d=n(2249),l=n(957),f=n(1653),b=n(1640),O=n(188),v=Object(O.action)("selectFolderWithFallbackInFolderForest")((function(e,t){var n=Object(l.a)(e)||e;Object(b.r)(n)?Object(f.isFolderInFavorites)(n)?Object(d.a)(n,"favorites",t):Object(d.a)(n,"primaryFolderTree",t):Object(o.a)(t)})),F=n(1686);function S(e,t){var n=Object(F.c)();return(null==n?void 0:n.id)&&n.treeType==t&&e.toLowerCase()==n.id.toLowerCase()}var m=n(3401),p=n(3402),j=n(3569);Object(i.orchestrator)(j.a,(function(e){v("notes",e.actionSource)}));n.d(t,"c",(function(){return h})),n.d(t,"l",(function(){return w})),n.d(t,"h",(function(){return I})),n.d(t,"g",(function(){return E})),n.d(t,"i",(function(){return y})),n.d(t,"f",(function(){return P})),n.d(t,"j",(function(){return T})),n.d(t,"k",(function(){return A})),n.d(t,"e",(function(){return _})),n.d(t,"b",(function(){return R})),n.d(t,"d",(function(){return L})),n.d(t,"o",(function(){return o.a})),n.d(t,"m",(function(){return c})),n.d(t,"n",(function(){return s})),n.d(t,"p",(function(){return d.a})),n.d(t,"q",(function(){return v})),n.d(t,"a",(function(){return S}));var g=new r.c((function(){return Promise.all([n.e(20),n.e(41),n.e(570)]).then(n.bind(null,17151))})),h=new r.a(g,(function(e){return e.loadDumpster})),w=new r.a(g,(function(e){return e.toggleFavoriteFolder})),I=new r.a(g,(function(e){return e.selectFolderNode})),E=new r.a(g,(function(e){return e.selectFavoriteSearch})),y=new r.a(g,(function(e){return e.selectGroup})),P=new r.a(g,(function(e){return e.selectFavoriteCategory})),T=new r.a(g,(function(e){return e.selectPersona})),A=new r.a(g,(function(e){return e.selectPrivateDistributionList})),_=new r.a(g,(function(e){return e.prefetchFrequentlyUsedFolders})),R=new r.a(g,(function(e){return e.deleteFolderInFolderForest})),L=new r.a(g,(function(e){return e.logConsumerDeletedRetentionPolicy}));Object(r.f)(m.a,g,(function(e){return e.selectPreviousNodeOrchestrator})),Object(r.f)(p.a,g,(function(e){return e.validateDumpsterQuotaOrchestrator}))},1863:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker",e[e.Spaces=5]="Spaces",e[e.FileSuggestions=6]="FileSuggestions"}(r||(r={})),t.b=r},1897:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(16),o=n(3),i={mailFavoritesViewState:{contextMenuState:null,shouldShowFindFavoritesPicker:!1},favoritePersonasRootFolderId:void 0,isFavoritingInProgress:new r.ObservableMap({}),favoriteNodeViewStates:new r.ObservableMap({})},a=Object(o.createStore)("mailFavorites",i);t.a=a()},1911:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(3),i=function(){return{alteredQuery:"",alterationProviderId:null,answerPlaceholderId:null,currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],isAnswerRendered:!1,isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,showSearchBoxInCompactMode:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new r.ObservableMap,queryAlterationType:null,queryActionSource:null,queryAlterationLogicalId:null,traceIdToLogicalIdMap:new r.ObservableMap,tableViewId:null,isScopePickerVisible:!1}},a={scenarioStores:new r.ObservableMap},c=Object(o.createStore)("commonSearchStore",a);t.b=c},2012:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"n",(function(){return s})),n.d(t,"o",(function(){return d})),n.d(t,"p",(function(){return l})),n.d(t,"r",(function(){return f})),n.d(t,"q",(function(){return b})),n.d(t,"u",(function(){return O})),n.d(t,"s",(function(){return v})),n.d(t,"t",(function(){return F})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return j})),n.d(t,"d",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return w})),n.d(t,"j",(function(){return I})),n.d(t,"k",(function(){return E}));var r=n(44),o=new r.c((function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(8),n.e(15),n.e(17),n.e(21),n.e(23),n.e(30),n.e(51),n.e(266),n.e(273),n.e(725)]).then(n.bind(null,2754))})),i=new r.b(o,(function(e){return e.clearSearchBox})),a=new r.b(o,(function(e){return e.endSearchSession})),c=new r.b(o,(function(e){return e.onDownArrowPressedSearchInput})),u=new r.b(o,(function(e){return e.onBackspacePressedSearchInput})),s=new r.b(o,(function(e){return e.onLeftArrowPressedSearchInput})),d=(new r.b(o,(function(e){return e.onRightArrowPressedSearchInput})),new r.b(o,(function(e){return e.onUpArrowPressedSearchInput}))),l=new r.b(o,(function(e){return e.removeSuggestionPillFromSearchBox})),f=new r.b(o,(function(e){return e.setLatestQFRequestId})),b=new r.b(o,(function(e){return e.setIsSuggestionsDropdownVisible})),O=new r.b(o,(function(e){return e.updateIsSuggestionSetComplete})),v=new r.b(o,(function(e){return e.setShowSearchBoxInCompactMode})),F=new r.a(o,(function(e){return e.setSpellerData})),S=(Object(r.d)(o,(function(e){return e.PersonaPill})),Object(r.d)(o,(function(e){return e.PrivateDistributionListPill})),Object(r.d)(o,(function(e){return e.SearchBoxDropdown}))),m=Object(r.d)(o,(function(e){return e.SearchBoxPillWell})),p=Object(r.d)(o,(function(e){return e.SuggestionsCallout})),j=Object(r.d)(o,(function(e){return e.CompactSearchBox})),g=Object(r.d)(o,(function(e){return e.SearchScopePicker})),h=new r.b(o,(function(e){return e.getSuggestionAtIndex})),w=new r.b(o,(function(e){return e.isInSearchMode})),I=new r.b(o,(function(e){return e.isQFRequestIdEqualToLatest})),E=new r.b(o,(function(e){return e.isSearchBoxEmpty}))},2013:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1863);function o(e){switch(e){case r.b.Mail:return"Mail";case r.b.Calendar:return"Calendar";case r.b.FilesHub:return"FilesHub";case r.b.FilesPicker:return"FilesPicker";case r.b.Spaces:return"Spaces";case r.b.FileSuggestions:return"FileSuggestions";default:throw Error("Unknown SearchScenarioId value!")}}},2020:function(e,t,n){"use strict";n.r(t);var r=n(44),o=n(0),i=n(134),a=n(884),c=n(208),u=n(25),s=n(3),d=n(3013),l=n(1653);Object(s.orchestrator)(l.migrateOutlookFavorites,(function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r,s,O,v,F,S,m,p,j,g;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return e=function(){var e=Object(u.a)().UserOptions.FavoriteNodes;if(!e)return{owsFavoritesData:[],clientFavoritesData:[]};var t=[],n=[];return e.forEach((function(e){var r=Object(l.parseFavoriteNode)(e);switch(r.type){case 1:var o=r;if(!Object(l.isPersonaInFavorites)(o.personaId,o.mainEmailAddress)){var i=function(e,t,n){return{treeType:"favorites",type:"persona",favoriteId:e,displayName:t.displayName,searchFolderId:t.searchFolderId,client:n?"Migration":"OWA",allEmailAddresses:t.allEmailAddresses,personaId:t.personaId,mainEmailAddress:t.mainEmailAddress,isSearchFolderPopulated:!!t.searchFolderId,isSyncUpdateDone:!0}}(f=Object(c.a)(),o,!0),u=function(e){var t=[],n=[],r=e.displayName||e.mainEmailAddress;if(r){if(e.mainEmailAddress){t.push({Key:"MainEmailAddress",Value:e.mainEmailAddress}),e.searchFolderId&&t.push({Key:"SearchFolderId",Value:Object(l.convertEWSFolderIdToRestFolderId)(e.searchFolderId)});var o=e.allEmailAddresses&&e.allEmailAddresses.filter((function(e){return!!e}));o.length>0?n.push({Key:"EmailAddresses",Values:o}):n.push({Key:"EmailAddresses",Values:[e.mainEmailAddress]})}if(e.personaId&&t.push({Key:"PersonaId",Value:Object(l.convertEWSFolderIdToRestFolderId)(e.personaId)}),0!==t.length)return{Type:"persona",DisplayName:r,SingleValueSettings:t,MultiValueSettings:n,Client:"Migration"}}}(o);u&&(t.push(u),n.push(i))}break;case 4:var s=r.id,d=Object(a.o)().filter((function(e){return e.Id===s}))[0];if(d&&!Object(l.isCategoryInFavorites)(s)){var f=Object(c.a)(),b=Object(l.createClientFavoriteCategoryData)(f,d,!0),O=Object(l.createOwsFavoriteCategoryData)(d,!0);t.push(O),n.push(b)}}})),{owsFavoritesData:t,clientFavoritesData:n}}(),t=e.owsFavoritesData,n=e.clientFavoritesData,0===t.length?(b(),[2]):[4,l.lazyAddMultipleFavoritesToStore.import()];case 1:o.sent()(n),(r=n.filter((function(e){return"persona"===e.type}))).length>0&&Object(d.a)(r),s=Math.ceil(t.length/20),O=!1,(v=new i.b("MigrateOutlookFavoriteService",{isCore:!0})).addCustomProperty("totalBatchCount",s),F=0,S=0,o.label=2;case 2:return F<s?(m=t.slice(S,S+20),(p=new i.b("MigrateOutlookFavoriteSingleBatchService",{isCore:!0})).addCustomProperty("favoritesCount",m.length),j=n.slice(S,S+20),[4,f(m,j,p)]):[3,5];case 3:O=o.sent(),o.label=4;case 4:return F++,S+=20,[3,2];case 5:return O?v.endWithError("ServerError"):v.end(),(g=!Object(l.getIsBitEnabled)(8))?(l.lazySetOutlookFavoritesBitFlag.importAndExecute(8),O||b()):b(),Object(i.r)(g?"FirstAttemptMigrationCompleted":"SecondAttemptMigrationCompleted",[O],{isCore:!0}),[2]}}))}))}));function f(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i,a,c,u,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Object(l.createMultipleOutlookFavoritesService)(e)];case 1:return r=o.sent(),[3,3];case 2:return i=o.sent(),n.endWithError("ServerError",i),[2,!0];case 3:return o.trys.push([3,5,,6]),a=(r.value||[]).map((function(e){return Object(l.convertServiceResponseToFavoriteData)(e,e.Type.toLowerCase())})),[4,l.lazyAddMultipleFavoritesCompleted.import()];case 4:return o.sent()(t,a),c=a.filter((function(e){return"persona"===e.type})),u=a.filter((function(e){return"category"===e.type})),n.addCustomProperty("migratedPersonasCount",c.length),n.addCustomProperty("migratedCategoriesCount",u.length),n.end(),[3,6];case 5:return s=o.sent(),n.endWithError("ClientError",s),[2,!0];case 6:return[2,!1]}}))}))}function b(){l.lazySetOutlookFavoritesBitFlag.importAndExecute(16)}var O=n(1897),v=n(1816),F=n(1654),S=Object(s.mutatorAction)("setFavoriteNodeViewStateMutator",(function(e,t){Object(O.b)().favoriteNodeViewStates.set(e,t)}));function m(e){return Object(O.b)().favoriteNodeViewStates.has(e)||S(e,{drag:Object(v.a)(),drop:Object(F.a)()}),Object(O.b)().favoriteNodeViewStates.get(e)}var p=n(188),j=Object(p.action)("showFindFavoritesPicker")((function(e){O.a.mailFavoritesViewState.shouldShowFindFavoritesPicker=e})),g=n(2534);n.d(t,"lazyModule",(function(){return h})),n.d(t,"lazyToggleFavoritesTreeExpansion",(function(){return w})),n.d(t,"lazyRemoveFavoriteSearch",(function(){return I})),n.d(t,"lazyRemoveFavoritePersona",(function(){return E})),n.d(t,"lazyOnSelectedPersonaNodeChanged",(function(){return y})),n.d(t,"lazyHandleToggleFavoritePersonaError",(function(){return P})),n.d(t,"lazyMarkFavoritePersonaNodeAsAdded",(function(){return T})),n.d(t,"lazyOnFavoritePersonaSelected",(function(){return A})),n.d(t,"lazyAddFavoriteFolder",(function(){return _})),n.d(t,"lazyRemoveFavoriteFolder",(function(){return R})),n.d(t,"lazyAddFavoriteFolderV1",(function(){return L})),n.d(t,"lazyRemoveFavoriteFolderV1",(function(){return C})),n.d(t,"lazyOnFavoritePersonaUpdated",(function(){return N})),n.d(t,"lazyAddFavoritePersona",(function(){return D})),n.d(t,"lazyInitializeFavoritePersonas",(function(){return M})),n.d(t,"lazyOutlookFavoritePersonasLoaded",(function(){return V})),n.d(t,"getFavoriteNodeViewStateFromId",(function(){return m})),n.d(t,"getStore",(function(){return O.b})),n.d(t,"showFindFavoritesPicker",(function(){return j})),n.d(t,"isFavoritingInProgress",(function(){return g.a}));var h=new r.c((function(){return Promise.all([n.e(36),n.e(56),n.e(62),n.e(78),n.e(251),n.e(633)]).then(n.bind(null,17134))})),w=new r.a(h,(function(e){return e.toggleFavoritesTreeExpansion})),I=new r.a(h,(function(e){return e.removeFavoriteSearch})),E=new r.a(h,(function(e){return e.removeFavoritePersona})),y=new r.a(h,(function(e){return e.onSelectedPersonaNodeChanged})),P=new r.a(h,(function(e){return e.handleToggleFavoritePersonaError})),T=new r.a(h,(function(e){return e.markFavoritePersonaNodeAsAdded})),A=new r.a(h,(function(e){return e.onFavoritePersonaSelected})),_=new r.b(h,(function(e){return e.addFavoriteFolder})),R=new r.b(h,(function(e){return e.removeFavoriteFolder})),L=new r.a(h,(function(e){return e.addFavoriteFolderV1})),C=new r.a(h,(function(e){return e.removeFavoriteFolderV1})),N=new r.a(h,(function(e){return e.onFavoritePersonaUpdated})),D=new r.a(h,(function(e){return e.addFavoritePersona})),M=new r.a(h,(function(e){return e.initializeFavoritePersonas})),V=new r.a(h,(function(e){return e.outlookFavoritePersonasLoaded}))},2249:function(e,t,n){"use strict";var r=n(1834),o=n(3271),i=n(3380),a=n(1634),c=n(2590),u=n(2662),s=n(1829),d=n(1686),l=n(3537),f=n(2592),b=n(1633),O=n(1640),v=n(1673),F=n(957),S=n(52),m=n(1644),p=n(3),j=n(1710),g=n(2075),h=n(2119),w=n(1768),I=n(7),E=n(3928),y=n(1725);var P=Object(p.action)("selectFolder",(function(e,t,n,r){var o=Object(d.c)().id;return Object(S.c)({name:"SwitchMailFolder",options:{variant:3},customData:[Object(v.a)(e),o?Object(v.a)(o):"",t,n,Object(b.B)(Object(b.A)(e))]},{folderId:e,treeType:t,previousFolderId:o,actionSource:n,folderNodeType:r,isNewFolderSameAsPreviousFolder:e==o})}));t.a=P,Object(p.orchestrator)(P,(function(e){var t,n=e.folderId,d=e.treeType,S=e.previousFolderId,p=e.actionSource,P=e.folderNodeType,T=e.isNewFolderSameAsPreviousFolder,A=Object(h.a)(),_=a.d.folderTable.get(n);6===P&&(_=w.a.folderTable.get(n));var R=Promise.resolve(),L=Object(b.G)(),C=L&&1==L.tableQuery.type;T&&L&&(Object(j.c)()&&Object(g.a)()||Object(f.a)(L));var N=L&&Object(b.O)(L);if(!T||N&&"All"!==N||"spotlight"==(null===(t=null==L?void 0:L.tableQuery)||void 0===t?void 0:t.scenarioType)){R=function(e,t,n,r){var o;e&&(o=Object(F.a)(e));var a=o||e;return Object(i.a)({id:a,type:null!=r?r:0,treeType:t},n)}(n,d,p,P);var D=Object(v.a)(n);Object(c.a)(n),Object(a.G)(_)&&"inbox"!==D&&D!==m.h&&Object(l.b)(n),D===m.g?r.c.importAndExecute(m.h,_.mailboxInfo):D===m.a&&r.c.importAndExecute(m.b,_.mailboxInfo)}return s.b.importAndExecute(),Object(o.a)(p),"ResetInbox"===p&&O.s.importAndExecute(Object(I.b)(E.a),"assertive"),R.then((function(){Object(u.a)(n,S,C,null==L?void 0:L.id,y.a.Auto,A,p)})),R})),Object(p.mutator)(P,(function(e){e.isNewFolderSameAsPreviousFolder&&(d.a.selectedNode.treeType=e.treeType),b.X.rowInfoForVLV.clear(),b.X.scrollTop=0}))},2391:function(e,t,n){"use strict";var r=n(957);var o=n(2249),i=n(1653);function a(e){var t=Object(r.a)("inbox"),n=Object(i.isFolderInFavorites)(t)?"favorites":"primaryFolderTree";Object(o.a)(t,n,e)}n.d(t,"a",(function(){return a}))},2396:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("LOAD_FAVORITES");t.a=o},2397:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(44),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(1300)]).then(n.bind(null,2996))})),i=Object(r.d)(o,(function(e){return e.StarCharm}))},2480:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1737),o=n(40);function i(){return Object(o.i)("tri-spotlight2")&&!Object(r.a)(2048)}},2533:function(e,t,n){"use strict";var r=n(208),o=n(40);t.a={RemoveFavoritePersonaAction:{name:"RemoveFavoritePersonaAction",customData:function(e,t){return[t]}},AddFavoriteSearch:{name:"AddFavoriteSearch",customData:function(e,t){return[t,Object(o.i)("tri-favorites-roaming")]}},RemoveFavoriteSearch:{name:"RemoveFavoriteSearch",customData:function(e,t){return[t,Object(o.i)("tri-favorites-roaming")]}},AddFavoritePersonaAction:{name:"AddFavoritePersonaAction",customData:function(e,t,n,r,o,i){return[r]}},ValidateAndUpdateFavorite:{name:"ValidateAndUpdateFavorite",customData:function(e,t,n){return Object(r.b)(e)?[e]:null}},DeleteFolderFailure:{name:"DeleteFolderFailure",customData:function(e){return[e]}},OnFavoritePersonaSelectedAction:{name:"OnFavoritePersonaSelectedAction"},OnFavoritePersonaUpdatedAction:{name:"OnFavoritePersonaUpdatedAction"},InitializeFavoritePersonasAction:{name:"InitializeFavoritePersonasAction"},OneOffAddressUsedForFavorite:"OneOffAddressUsedForFavorite",OutlookFavoritePersonasLoaded:{name:"OutlookFavoritePersonasLoaded"}}},2534:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1897),o=n(1653),i=n(40);function a(e){return Object(i.i)("tri-favorites-roaming")?Object(o.isOutlookFavoritingInProgress)(e):!0===Object(r.b)().isFavoritingInProgress.get(e)}},2595:function(e,t,n){"use strict";var r=n(3),o=Object(r.createStore)("spotlightStore",{spotlightItems:[],rollupDismissed:!1,logicalId:null,requestStartTime:null});t.a=o},2597:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(44),o=new r.c((function(){return Promise.all([n.e(20),n.e(46),n.e(77),n.e(242),n.e(588)]).then(n.bind(null,5912))})),i=new r.a(o,(function(e){return e.loadGroups})),a=new r.a(o,(function(e){return e.loadGroupsFromSessionData})),c=new r.a(o,(function(e){return e.removeGroupFromLeftNav})),u=new r.a(o,(function(e){return e.toggleGroupTreeExpansion})),s=new r.a(o,(function(e){return e.unsubscribeFromUnreadNotifications})),d=new r.a(o,(function(e){return e.setGroupLastVisitedTime}))},2759:function(e,t,n){"use strict";var r=n(44),o=n(2595);function i(e){var t=e.itemId,n=e.conversationId,r=e.rowKey;return Object(o.a)().spotlightItems.some((function(e){return t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r}))}var a=n(2480);n.d(t,"i",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"h",(function(){return l})),n.d(t,"m",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"g",(function(){return O})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return F})),n.d(t,"l",(function(){return S})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a.a}));var c=new r.c((function(){return Promise.all([n.e(3),n.e(44),n.e(56),n.e(58),n.e(62),n.e(78),n.e(747)]).then(n.bind(null,17130))})),u=new r.a(c,(function(e){return e.initializeSpotlight})),s=new r.b(c,(function(e){return e.getSpotlightLogicalId})),d=new r.b(c,(function(e){return e.getSpotlightItem})),l=new r.b(c,(function(e){return e.getUnacknowledgedSpotlightCount})),f=new r.a(c,(function(e){return e.onSpotlightDismissedFromRP})),b=new r.a(c,(function(e){return e.getSpotlightDonationJson})),O=new r.a(c,(function(e){return e.getSpotlightReasonString})),v=new r.a(c,(function(e){return e.loadImportantTable})),F=new r.a(c,(function(e){return e.logSpotlightItemClicked})),S=new r.a(c,(function(e){return e.logSpotlightResultsRendered})),m=Object(r.d)(c,(function(e){return e.SpotlightIconTeachingMoment}))},2899:function(e,t,n){"use strict";var r=n(3),o=n(16),i=n(3758);Object(r.mutator)(i.a,(function(e){c().prefetchedFolderIds.set(e.folderId,!0)}));n.d(t,"b",(function(){return c}));var a={frequentlyUsedFolders:[],isInitialized:!1,prefetchedFolderIds:new o.ObservableMap({})},c=Object(r.createStore)("frequentlyUsedFoldersStore",a),u=c();t.a=u},3013:function(e,t,n){"use strict";var r=n(3),o=n(52),i=n(2533);t.a=Object(r.action)("outlookFavoritePersonasLoaded",(function(e){return Object(o.c)(i.a.OutlookFavoritePersonasLoaded,{personas:e})}))},3015:function(e,t,n){"use strict";var r=n(188),o=n(2438);t.a=Object(r.action)("commandBarAction")((function(e){o.a.navigationButtonSelected=e}))},3016:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="#"},3077:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(335);function o(){return Object(r.a)().favorites}},3081:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("POPULATE_PUBLIC_FOLDER_OUTLOOK_FAVORITE_STORE")},3082:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("POPULATE_PUBLIC_FOLDER_FAVORITE_STORE_V1")},3083:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ADD_PUBLIC_FOLDER_TO_STORE",(function(e,t){return{state:e,item:t}}))},3168:function(e,t,n){"use strict";var r=n(1633),o=n(2099);function i(e,t){var n;switch(t){case 0:n=o.a;break;case 1:n=Object(o.f)()}return{categoryName:null,folderId:e,focusedViewFilter:-1,listViewType:t,viewFilter:"All",sortBy:r.c.getDefaultSortBy(),requestShapeName:n,type:2,shouldTryToUseSessionDataResponse:!1,scenarioType:"group"}}var a=n(25);function c(){var e=Object(a.a)().UserOptions.GlobalListViewTypeReact;return null==e?0:e}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}))},3185:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("REMOVE_FAVORITE_FROM_PUBLIC_FOLDER_STORE",(function(e){return{folderId:e}}))},3271:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),o=n(3754),i=n(1930),a=n(2012),c=n(1718),u=n(1863),s=n(880),d=n(2437),l=n(2478),f=n(2267);function b(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,i.b()];case 1:return t.sent(),s.c.import().then((function(e){e("MailModuleNotificationBarHost")})),Object(c.a)(u.a.Mail).searchSessionGuid?[4,a.g.import()]:[3,3];case 2:t.sent()(u.a.Mail,e),t.label=3;case 3:return Object(l.a)()&&Object(d.a)()&&Object(f.a)(!1),Object(o.a)(),[2]}}))}))}},3375:function(e,t,n){"use strict";var r=n(3081),o=n(3082),i=n(44),a=n(2396),c=n(0),u=n(3083),s=n(3),d=n(2511),l=n(1837),f=n(25),b=(Object(s.mutator)(u.a,(function(e){var t=e.state,n=e.item,r=n.FolderId.Id,o=Object(f.a)().SessionSettings.DefaultPublicFolderMailbox,i=Object(l.a)(o);if(!t.folderTable.has(r)){var a=Object(c.__assign)({},Object(d.c)(n,i));t.folderTable.set(r,a)}})),n(3185)),O=n(1768);Object(s.mutator)(b.a,(function(e){var t=e.folderId;O.a.folderTable.has(t)&&O.a.folderTable.delete(t)}));n.d(t,"a",(function(){return F})),n.d(t,"b",(function(){return O.a}));var v=new i.c((function(){return Promise.all([n.e(21),n.e(52),n.e(885)]).then(n.bind(null,17321))}));Object(i.f)(a.a,v,(function(e){return e.loadPublicFolderFavoritesOchestrator})),Object(i.f)(r.a,v,(function(e){return e.populatePublicFolderOutlookFavoriteStoreOrchestrator})),Object(i.f)(o.a,v,(function(e){return e.populatePublicFolderFavoriteStoreV1Orchestrator}));var F=Object(i.d)(v,(function(e){return e.PostedToLine}))},3380:function(e,t,n){"use strict";var r=n(0),o=n(884),i=n(3168),a=n(2020),c=n(2076),u=n(1633),s=n(3163),d=n(1653),l=n(1708),f=n(3407),b=n(2148);var O=n(3015),v=n(2162),F=n(2597),S=n(1706),m=n(3),p=n(1686);function j(e,t){var n=Object(p.d)();if(1===n.selectedNode.type&&a.lazyOnSelectedPersonaNodeChanged.importAndExecute(n.selectedNode),2===n.selectedNode.type){if("DeleteGroup"!=t){var m=Object(u.G)();m&&F.d.importAndExecute(Object(S.b)(m.tableQuery))}2!==e.type&&Object(O.a)(v.a.Email)}var j=Object(r.__assign)({},e);return g(j),function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,O,v,F,S;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(e.type){case 0:return[3,1];case 4:return[3,2];case 1:return[3,6];case 5:return[3,10];case 2:return[3,14];case 6:return[3,15]}return[3,16];case 1:return O=Object(c.a)(e.id),n=Object(b.a)(e.id,Object(u.A)(e.id),"mail",null,null,null,{sortColumn:O.sortColumn,sortDirection:O.sortOrder}),[3,17];case 2:return Object(a.isFavoritingInProgress)(e.id)?(v=Object(o.k)(e.id,Object(o.o)()),[4,l.e.import()]):[3,4];case 3:return n=r.sent()(v,Object(u.A)(e.id)),[3,5];case 4:n=Object(f.a)(e.id),r.label=5;case 5:return[3,17];case 6:return(F=e).isSearchFolderPopulated?[3,8]:[4,l.f.import()];case 7:return n=r.sent()(F.displayName,F.allEmailAddresses,Object(u.A)(e.id)),[3,9];case 8:n=Object(b.a)(F.searchFolderId,Object(u.A)(F.searchFolderId),"persona"),r.label=9;case 9:return[3,17];case 10:return(S=d.favoritesStore.outlookFavorites.get(e.id)).isSearchFolderPopulated?[3,12]:[4,l.g.import()];case 11:return n=r.sent()(S.displayName,S.members,S.pdlId,S.owsPersonaId,Object(u.A)(e.id)),[3,13];case 12:n=Object(b.a)(S.searchFolderId,Object(u.A)(S.searchFolderId),"privatedistributionlist"),r.label=13;case 13:return[3,17];case 14:return n=Object(i.a)(e.id,Object(i.b)()),[3,17];case 15:return n=Object(b.a)(e.id,1,"mail"),[3,17];case 16:return[3,17];case 17:return[2,Object(s.a)(n,null,t)]}}))}))}(j,t)}n.d(t,"a",(function(){return j}));var g=Object(m.mutatorAction)("setSelectedFolderNode",(function(e){Object(p.d)().selectedNode=e}))},3401:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("SELECT_PREVIOUS_NODE",(function(e){return{actionSource:e}}))},3402:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("TRY_VALIDATE_DUMPSTER_QUOTA",(function(e){return{folderId:e}}))},3407:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2148),o=n(884),i=n(1633),a=n(957);function c(e){var t=Object(o.k)(e,Object(o.o)());return Object(r.a)(Object(a.a)("msgfolderroot"),Object(i.A)(null),"category",-1,"UserCategory",t)}},3537:function(e,t,n){"use strict";var r=n(3757),o=n(2899),i=n(188),a=Object(i.action)("sortFolders")((function(){var e=Object(o.b)(),t=e.frequentlyUsedFolders.sort((function(e,t){return e.Weight==t.Weight?Math.abs(Date.parse(t.lvt)-Date.parse(e.lvt)):t.Weight-e.Weight}));e.frequentlyUsedFolders=t})),c=Object(i.action)("addFrequentlyUsedFolder")((function(e){var t=!1,n=Object(o.b)();if(n.isInitialized){for(var i=n.frequentlyUsedFolders.length-1;i>=0;i--){var c=n.frequentlyUsedFolders[i];if(c.FolderId==e)c.Weight+=5,c.Weight=Math.min(c.Weight,20),c.lvt=(new Date).toISOString(),t=!0;else if(c.Weight--,c.Weight=Math.max(c.Weight,0),c.Weight<=0){var u=Math.abs(Date.now()-Date.parse(c.lvt));u<6048e5&&u>=0||n.frequentlyUsedFolders.splice(i,1)}}t||n.frequentlyUsedFolders.push({FolderId:e,Weight:10,lvt:(new Date).toISOString()}),a(),n.frequentlyUsedFolders.splice(10),Object(r.a)()}})),u=n(3016);n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u.a}))},3569:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("OPEN_NOTES_FOLDER",(function(e){return{actionSource:e}}))},3754:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2182),o=n(1780),i=n(1762),a=n(2119),c=n(1710),u=n(495);function s(){null===i.a.primaryComposeId||Object(u.v)()?Object(c.c)()&&Object(a.a)()&&Object(r.a)("FolderNodeClick"):o.r.importAndExecute(null)}},3757:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(426),o=n(2899),i=n(34);function a(){var e=[];Object(o.b)().frequentlyUsedFolders.forEach((function(t){e.push(JSON.stringify(t))})),Object(r.a)((function(t){t.UserOptions.FrequentlyUsedFolders=e}),[{key:"FrequentlyUsedFolders",valuetype:"StringArray",value:e}]).catch((function(e){i.g.warn("saveFrequentlyUsedFolders: "+e)}))}},3758:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("folderPrefetchedAction",(function(e){return{folderId:e}}))},3928:function(e){e.exports=JSON.parse('{"a":"O0b"}')},429:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,o=t%n;return(((e-=r)/n&(t-=o)/n)>>>0)*n+((r&o)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},730:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=1,o=16}}]);
//# sourceMappingURL=owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js.map
self.scriptsLoaded['owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();