self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OwaRoamingDictionary.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[874],{11160:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(11081),i=n(40),c=n(208),a=n(3224),s=n(85),u=n(296),l=n(375),d=n(34),f=void 0,g=36e5,v=122,b="1.0.0",p="Web";function _(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e?[4,e.saveWordListToRoamingService(Object(c.a)())]:[3,2];case 1:if(t.sent().success)return[2,!0];t.label=2;case 2:return[2,!1]}}))}))}function O(e){f=window.setInterval((function(){e&&_(e)}),g)}function j(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return"wl.skydrive",e="https://officeapps.live.com",Object(u.a)()?[4,Object(l.getDelegationTokenForOwa)("wl.skydrive")]:[3,2];case 1:return[2,(n=i.sent())||""];case 2:return t=Object(r.__read)(Object(l.getAccessTokenforResourceAsLazy)(e),2),n=t[0],o=t[1],n?[3,4]:[4,o];case 3:n=i.sent(),i.label=4;case 4:return[2,n||""]}}))}))}function h(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,new Promise((function(e){a.d.importAndExecute((function(t){(null==t?void 0:t.proofingLocale)?e(t.proofingLocale):e(Object(s.j)())}))}))]}))}))}var w=void 0;function m(){y()}function y(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return w?(d.g.info("[roamingDictionary] Instance of roaming dictionary already exists. Returning"),[2,w]):[3,1];case 1:return[4,h()];case 2:return e=n.sent(),(w=function(e){return d.g.info("[roamingDictionary] Initialize roaming dictionary"),new o.b(j,Object(i.i)("ring-dogfood")?"PPE":"PROD",v,b,p,e,void 0)}(null!=e?e:"en"))?(d.g.info("[roamingDictionary] Loading word list from service"),[4,w.loadWordListFromRoamingService(Object(c.a)())]):[3,4];case 3:return(t=n.sent()).success?(d.g.info("[roamingDictionary] Word list loaded successfully"),O(w)):d.g.info("[roamingDictionary] Error loading word list: "+t.errorMessage),[3,5];case 4:d.g.info("[roamingDictionary] iniitalizeRoamingDictionary failed"),n.label=5;case 5:return[2,w]}}))}))}function A(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return(e=w)?[4,_(w)]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return e?(n=w,clearInterval(f),O(n),[2,!0]):[2,!1]}var n}))}))}n.d(t,"preloadRoamingDictionary",(function(){return m})),n.d(t,"getRoamingDictionary",(function(){return y})),n.d(t,"saveRoamingDictionary",(function(){return A}))},16688:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(10627),i=n(10580),c=n(208),a=n(134),s=n(2),u="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",l=0,d=void 0;function f(e,t,n,o,i,f){var g,v;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e={name:t,properties:{}},n&&(null===(g=Object.keys(n))||void 0===g||g.forEach((function(t){e.properties["Data_"+t]=n[t]}))),"Office.System.Activity"===o&&i&&(null===(v=Object.keys(i))||void 0===v||v.forEach((function(t){e.properties["Activity_"+t]=i[t]}))),d||(b=Object(s.o)(),d=void 0!==b?(b.slice(0,8)+"-"+b.slice(8,12)+"-"+b.slice(12,16)+"-"+b.slice(16,20)+"-"+b.slice(20)).toLowerCase():Object(c.a)()),f=/_/gi,e.properties.App_Name="Outlook",e.properties.App_Platform="Web",e.properties.App_Version=Object(s.p)(),e.properties.Event_Contract=o,e.properties.Event_Name=null==t?void 0:t.replace(f,"."),e.properties.Event_Time=new Date,e.properties.Event_Sequence=l++,e.properties.Event_Source="OWA",e.properties.Release_AudienceGroup=function(){switch(Object(s.v)()){case"Dogfood":return"Dogfood";case"Microsoft":return"Microsoft";case"FirstRelease":case"WW":default:return"Production"}}(),e.properties.Session_Id=d,[4,Object(a.i)(u)];case 1:return r.sent().logEvent(e),[2]}var b}))}))}var g=n(296),v=n(439),b=n(375),p=n(34),_="Compose.Send",O="https://augloop.office.com/v2";function j(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return Object(g.a)()?[4,Object(b.getDelegationTokenForOwa)(_)]:[3,2];case 1:return[2,t.sent()];case 2:return[4,Object(v.a)(O,Object(c.a)())];case 3:return(e=t.sent())?[2,e.AccessToken]:[2,void 0];case 4:return[2]}}))}))}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return p.g.info("[AugLoopPlugin] requestAuthToken callback"),e={},[4,j()];case 1:return[2,(e.Token=t.sent(),e)]}}))}))}var w=n(10581),m="AugLoopSessionCloseError",y={};function A(e){return y[e]?p.g.info("[augloopSession] cached augloop session. Id:"+e):(p.g.info("[augloopSession] Initialize augloop session. Id:"+e),y[e]=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=Object(o.createRuntime)())?[4,t.init(Object(i.a)(),{appName:"Outlook",appPlatform:"Web",appVersion:"1.0",releaseAudienceGroup:void 0,releaseChannel:void 0,releaseFork:void 0,sessionId:e,flights:Object(w.a)().join(";")},{onResult:S,onAnnotationResult:L,sendTelemetryEvent:f,requestAuthToken:h,isFeatureEnabled:D,executeLocalLambda:E,areLicenseFeaturesEnabled:k},{telemetryAggregationIntervalSec:30,initSession:!1})]:[3,2];case 1:return n.sent(),[2,t.createSession({docSessionId:Object(c.a)()})];case 2:return[2,Promise.resolve(null)]}}))}))}(e)),y[e]}function S(e,t,n,r){}function D(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return p.g.info("[augloopSession] isFeatureEnabled callback: feature name: "+e),[2,!0]}))}))}function E(e,t,n,r){return Promise.resolve(null)}function k(e){return Promise.resolve(!1)}function L(e){}function R(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,y[e]];case 1:if(t=n.sent()){try{t.close()}catch(e){Object(a.r)(m,{error:e.message},{logEvery:1}),p.g.info("[augloopSession] exception encountered when closing augLoop session: "+e.message)}p.g.info("[augloopSession] disposed augloop session. Id:"+e),delete y[e]}return[2]}}))}))}n.d(t,"getAugLoopSession",(function(){return A})),n.d(t,"disposeAugLoopSession",(function(){return R}))}}]);
//# sourceMappingURL=owa.OwaRoamingDictionary.js.map
self.scriptsLoaded['owa.OwaRoamingDictionary.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OwaRoamingDictionary.js'] = (new Date()).getTime();