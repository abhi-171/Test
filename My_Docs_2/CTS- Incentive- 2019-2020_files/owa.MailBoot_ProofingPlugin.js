self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ProofingPlugin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[698],{1011:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return f}));var r=n(0),i=n(1),o=n(378),a=n(220),s=n(203),c=n(714);function l(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var a=e;return a.isSlot?0===(n=i.Children.toArray(n)).length?a(t):a(Object(r.__assign)(Object(r.__assign)({},t),{children:n})):i.createElement.apply(i,Object(r.__spreadArrays)([e,t],n))}function u(e,t){void 0===t&&(t={});var n=t.defaultProp,a=void 0===n?"children":n;return function(t,n,l,u,d){if(i.isValidElement(n))return n;var f=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];for(var i={},a=[],l=0,u=n;l<u.length;l++){var d=u[l];a.push(d&&d.className),Object(c.a)(i,d)}return i.className=Object(o.a)([e,a],{rtl:Object(s.a)(t)}),i}(u,d,t,function(e,t){var n,r;"string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,r=n):r=t;return r}(a,n));if(l){if(l.component){var h=l.component;return i.createElement(h,Object(r.__assign)({},f))}if(l.render)return l.render(f,e)}return i.createElement(e,Object(r.__assign)({},f))}}var d=Object(a.c)((function(e){return u(e)}));function f(e,t){var n={},r=e,i=function(e){if(t.hasOwnProperty(e)){var i=function(n){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if(i.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return h(t[e],n,r[e],r.slots&&r.slots[e],r._defaultStyles&&r._defaultStyles[e],r.theme)};i.isSlot=!0,n[e]=i}};for(var o in t)i(o);return n}function h(e,t,n,r,i,o){return void 0!==e.create?e.create(t,n,r,i):d(e)(t,n,r,i,o)}},1015:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(52),i=n(707);function o(e,t){Object.keys(i.a).some((function(n){return i.a[n]==t&&(Object(r.h)(e,{key:n,id:t},{isCore:!0}),!0)}))}},1031:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),i=n(1),o=n(209),a=n(310),s=n(1032),c=n(749),l=n(86),u=Object(o.a)(),d=function(e){function t(t){var n=e.call(this,t)||this;return n.rootElement=i.createRef(),Object(a.a)(n),n.state={},n._defaultCalloutProps={beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:l.DirectionalHint.rightCenter},n}return Object(r.__extends)(t,e),t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()},t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.targetElement,o=e.onDismiss,a=e.hasCloseButton,l=void 0===a?this.props.hasCloseIcon:a,d=e.isWide,f=e.styles,h=e.theme,g=e.target,p=Object(r.__assign)(Object(r.__assign)({},this._defaultCalloutProps),t),m={theme:h,isWide:d,calloutProps:Object(r.__assign)(Object(r.__assign)({},p),{theme:p.theme}),hasCloseButton:l},y=u(f,m),b=y.subComponentStyles?y.subComponentStyles.callout:void 0;return i.createElement(c.a,Object(r.__assign)({target:g||n,onDismiss:o},p,{className:y.root,styles:b,hideOverflow:!0}),i.createElement("div",{ref:this.rootElement},i.createElement(s.a,Object(r.__assign)({},this.props))))},t.defaultProps={calloutProps:{beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:l.DirectionalHint.rightCenter}},t}(i.Component)},1032:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(469),i=n(1033),o=n(828),a=Object(r.a)(i.a,o.a,void 0,{scope:"TeachingBubbleContent"})},1033:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),i=n(1),o=n(209),a=n(63),s=n(310),c=n(521),l=n(883),u=n(703),d=n(406),f=n(903),h=n(886),g=Object(o.a)(),p=function(e){function t(t){var n=e.call(this,t)||this;return n.rootElement=i.createRef(),n._onKeyDown=function(e){n.props.onDismiss&&e.which===a.a.escape&&n.props.onDismiss()},Object(s.a)(n),n.state={},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.onDismiss&&document.addEventListener("keydown",this._onKeyDown,!1)},t.prototype.componentWillUnmount=function(){this.props.onDismiss&&document.removeEventListener("keydown",this._onKeyDown)},t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()},t.prototype.render=function(){var e,t,n,o,a,s=this.props,p=s.children,m=s.illustrationImage,y=s.primaryButtonProps,b=s.secondaryButtonProps,v=s.headline,_=s.hasCondensedHeadline,I=s.hasCloseButton,S=void 0===I?this.props.hasCloseIcon:I,C=s.onDismiss,O=s.closeButtonAriaLabel,T=s.hasSmallHeadline,E=s.isWide,P=s.styles,w=s.theme,j=s.ariaDescribedBy,R=s.ariaLabelledBy,x=s.footerContent,A=s.focusTrapZoneProps,N=g(P,{theme:w,hasCondensedHeadline:_,hasSmallHeadline:T,hasCloseButton:S,hasHeadline:!!v,isWide:E,primaryButtonClassName:y?y.className:void 0,secondaryButtonClassName:b?b.className:void 0});if(m&&m.src&&(e=i.createElement("div",{className:N.imageContent},i.createElement(d.a,Object(r.__assign)({},m)))),v){var D="string"==typeof v?"p":"div";t=i.createElement("div",{className:N.header},i.createElement(D,{role:"heading",className:N.headline,id:R},v))}if(p){var F="string"==typeof p?"p":"div";n=i.createElement("div",{className:N.body},i.createElement(F,{className:N.subText,id:j},p))}return(y||b||x)&&(o=i.createElement(f.a,{className:N.footer,horizontal:!0,horizontalAlign:x?"space-between":"end"},i.createElement(f.a.Item,{align:"center"},i.createElement("span",null,x)),i.createElement(f.a.Item,null,b&&i.createElement(c.a,Object(r.__assign)({},b,{className:N.secondaryButton})),y&&i.createElement(l.a,Object(r.__assign)({},y,{className:N.primaryButton}))))),S&&(a=i.createElement(u.a,{className:N.closeButton,iconProps:{iconName:"Cancel"},title:O,ariaLabel:O,onClick:C})),i.createElement("div",{className:N.content,ref:this.rootElement,role:"dialog",tabIndex:-1,"aria-labelledby":R,"aria-describedby":j,"data-is-focusable":!0},e,i.createElement(h.a,Object(r.__assign)({isClickableOutsideFocusTrap:!0},A),i.createElement("div",{className:N.bodyContent},t,n,o,a)))},t}(i.Component)},10579:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(r||(r={})),function(e){e.ContextualSpelling="818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",e.WrongSpelling="363d7011-83dd-4cc0-bdec-ea4af4df4dbb",e.TonalRewrite="965c8b90-32a3-4451-8c09-eba2c163dcec"}(i||(i={}))},10582:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3061),i=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(r.PARAM_TYPES,e),userGeneratedMetadata:Reflect.getMetadata(r.TAGGED,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(r.TAGGED_PROP,e)||[]},e}();t.MetadataReader=i},10583:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3703);t.isStackOverflowExeption=function(e){return e instanceof RangeError||e.message===r.STACK_OVERFLOW}},10584:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3703),i=n(3061),o=n(4098),a=n(4993),s=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();t.LazyServiceIdentifer=s,t.inject=function(e){return function(t,n,s){if(void 0===e)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(t.name));var c=new o.Metadata(i.INJECT_TAG,e);"number"==typeof s?a.tagParameter(t,n,s,c):a.tagProperty(t,n,c)}}},10585:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3061),i=n(5491),o=n(4098),a=n(15140),s=function(){function e(e,t,n,s){this.id=i.id(),this.type=e,this.serviceIdentifier=n,this.name=new a.QueryableString(t||""),this.metadata=new Array;var c=null;"string"==typeof s?c=new o.Metadata(r.NAMED_TAG,s):s instanceof o.Metadata&&(c=s),null!==c&&this.metadata.push(c)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(r.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return e.key!==r.INJECT_TAG&&e.key!==r.MULTI_INJECT_TAG&&e.key!==r.NAME_TAG&&e.key!==r.UNMANAGED_TAG&&e.key!==r.NAMED_TAG}))},e.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===r.NAMED_TAG}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return e.key!==r.INJECT_TAG&&e.key!==r.MULTI_INJECT_TAG&&e.key!==r.NAME_TAG&&e.key!==r.UNMANAGED_TAG&&e.key!==r.NAMED_TAG})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(r.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var r=0,i=t.metadata;r<i.length;r++){var o=i[r];if(o.key===e&&o.value===n)return!0}return!1}},e}();t.Target=s},10586:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9173),i=n(9174),o=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingWhenOnSyntax=o},10587:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3061),i=n(4098),o=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||o(n,t))};t.traverseAncerstors=o;var a=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new i.Metadata(e,t),n}};t.taggedConstraint=a;var s=a(r.NAMED_TAG);t.namedConstraint=s;t.typeConstraint=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var r=t.bindings[0].implementationType;return e===r}return!1}}},10588:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r=(e,t)=>{let n=!1;for(let r=0;r<e.length;r+=1)e[r]===t&&(n=!0,e.splice(r,1),r-=1);return n},i=()=>({listeners:[]})},10589:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4994);class i{static logUnhandledError(e,t,n,i){e.logEvent(575705184,n,r.e.Error,i,r.f.CriticalExperimentation,t)}static addUnhandledExceptionsListeners(e,t,n){}}},10590:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1681),i=n(3234),o=function(e,t){return function(n,r){t(n,r,e)}};let a=class{constructor(e){this.registrables=e,this.initializeCalled=!1,this.shutDownCalled=!1}async initialize(){if(!this.initializeCalled){this.initializeCalled=!0;for(const e of this.registrables)await e.initialize();this.shutDownCalled=!1}}async shutDown(){this.shutDownCalled||(this.shutDownCalled=!0,await Promise.all(this.registrables.map(async e=>e.shutDown())))}async addRegistrable(e){await e.initialize(),this.registrables.push(e)}};a=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)(),o(0,Object(r.multiInject)(i.a.IRegistrable))],a)},10591:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1681),i=n(3234),o=function(e,t){return function(n,r){t(n,r,e)}};let a=class{constructor(e){this._cleanables=e,this.disableCalled=!1}disableContentScript(){this.disableCalled||(this.disableCalled=!0,this._cleanables.forEach(e=>e.cleanUp()))}};a=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)(),o(0,Object(r.multiInject)(i.a.ICleanable))],a)},10592:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(16),i=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};class o{constructor(e){this.equalsTo=e=>{if(!e||this._codesList.length!==e.length)return!1;for(let t=0;t<this._codesList.length;t+=1)if(this._codesList[t]!==e[t])return!1;return!0},this.add=e=>!this._codesList.includes(e)&&(this._codesList.push(e),!0),this.remove=e=>{const t=this._codesList.indexOf(e);return!(t<0)&&(this._codesList.splice(t,1),!0)},this.moveUp=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const n=this._codesList[t-1];return this._codesList[t-1]=this._codesList[t],this._codesList[t]=n,!0},this.moveToTop=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const n=this._codesList[t];for(let e=t;e>0;e-=1)this._codesList[e]=this._codesList[e-1];return this._codesList[0]=n,!0},this._codesList=e}get count(){return this._codesList?this._codesList.length:0}get defaultLanguageCode(){return this._codesList&&this._codesList.length>0?this._codesList[0]:""}get codesList(){return this._codesList||[]}}i([r.observable],o.prototype,"_codesList",void 0),i([r.computed],o.prototype,"count",null),i([r.computed],o.prototype,"defaultLanguageCode",null),i([r.computed],o.prototype,"codesList",null)},10593:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.NewData="NewData",e.RemoveData="RemoveData",e.ChangeData="ChangeData"}(r||(r={}))},10594:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.IgnoreOnce="IgnoreOnce",e.ApplySuggestion="ApplySuggestion"}(r||(r={}))},10595:function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e[e.ClientInitialized=0]="ClientInitialized"}(r||(r={})),function(e){e[e.WordDictionaryInit=0]="WordDictionaryInit"}(i||(i={}))},10596:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return u}));var r,i,o=n(1681),a=n(3234),s=n(4996),c=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){return function(n,r){t(n,r,e)}};!function(e){e[e.SettingsShown=0]="SettingsShown",e[e.CalloutShown=1]="CalloutShown",e[e.PageContext=2]="PageContext"}(r||(r={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout",e[e.PageContext=2]="PageContext"}(i||(i={}));let u=class extends s.a{constructor(e,t,n){super(),this._isSignedInUser=e,this._featureFlagsReader=t,this._languageDetector=n,this.enablers=[!0],this.disablers=[this,this._isSignedInUser]}check(){return!this._featureFlagsReader.flags.enableUnsignedInEditor}async emitAndEvaluateAsync(e){return this.emitAndEvaluate(e)&&this.checkForMultipleLanguages()}async checkForMultipleLanguages(){const e=await this.countUniqueLanguages();return!this._featureFlagsReader.flags.enableSuppressUnsignedInEditorForMultiLang||e<=1}async countUniqueLanguages(){return(await this._languageDetector.getBrowserLanguages()).reduce((e,t)=>{const n=t.split("-");if(n.length>0){const t=n[0];e.add(t)}return e},new Set).size}};u=c([Object(o.injectable)(),l(0,Object(o.inject)(a.a.IsSignedInUser)),l(1,Object(o.inject)(a.a.IFeatureFlagsReader)),l(2,Object(o.inject)(a.a.IUxLanguageDetector))],u)},10597:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(7533),i=n(7532);class o{constructor(e,t){this._backgroundActivityId=e,this._hostEmitter=t,this._startTime=r.a()}get startTime(){return this._startTime}setSuccess(e){this._hostEmitter.emit(i.a.activitySetSuccessTelemetryEvent,{address:this._backgroundActivityId,message:e})}setResult(e,t,n){this._hostEmitter.emit(i.a.activitySetResultTelemetryEvent,{address:this._backgroundActivityId,message:{resultCode:e,resultType:t,resultTag:n}})}addDataField(e,t,n){this._hostEmitter.emit(i.a.activityAddDataFieldTelemetryEvent,{address:this._backgroundActivityId,message:{name:e,value:t,classification:n}})}async endNow(){return this._hostEmitter.emit(i.a.activityEndNowTelemetryEvent,{address:this._backgroundActivityId,message:null}),new Promise(()=>{})}}},10598:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,i=n(1681),o=n(9176),a=n(9178);let s=r=class{constructor(){this.supportsBrowserWordBreaking=!1}getForwardBreakByWord(e,t){let n=this.getForwardBreak(e,t);return n&&(n.wordBreakType!==a.a.WhiteSpace||(n=this.getForwardBreak(e,n.cp),n))?n.cp:e.length}getBackwardBreakByWord(e,t){let n=this.getBackwardBreak(e,t);return n&&(n.wordBreakType!==a.a.WhiteSpace||(n=this.getBackwardBreak(e,n.cp),n))?n.cp:0}getForwardBreak(e,t){return this.getForwardBreakInternal(e,t,e.length)}getBackwardBreak(e,t){return this.getBackwardBreakInternal(e,t)}getTextStartWordBreak(e){return this.getTextWordBreak(e,0)}getTextWordBreak(e,t){return{cp:t,wordBreakType:r.getWordBreakType(e,t)}}getBreaks(e){const t=this.getBreaksForRange(e,0,e.length);return e.length&&t.splice(0,0,this.getTextStartWordBreak(e)),t}getBreaksForRange(e,t,n){const i=[];if(!e)return i;let o=t,s=!1;for(;!s;){const t=this.getForwardBreakInternal(e,o,n);if(t)if(t.wordBreakType===a.a.Invalid)if(o=t.cp+1,o>=n)s=!0;else{const n=r.getWordBreakType(e,t.cp),a=r.getWordBreakType(e,o);n!==a&&i.push({cp:o,wordBreakType:a})}else i.push(t),o=t.cp;else s=!0}return i}getWordCount(e,t){return this.getWordCountFromWordBreaks(e,t).wordCount}getWordCountInRange(e,t,n){const r=this.getBreaksForRange(e,t,n);return r.splice(0,0,this.getTextWordBreak(e,t)),this.getWordCount(r,e)}getWordCountFromWordBreaks(e,t){const n={browserWordBreakCount:0,wordCount:0};for(let i=0;i<e.length;i+=1){const o=e[i];o.wordBreakType===a.a.AlphaNumeric||o.wordBreakType===a.a.Undetermined?(o.wordBreakType===a.a.Undetermined&&(n.browserWordBreakCount+=1),r.shouldCountAlphaBreak(i,e,t)&&(n.wordCount+=1)):o.wordBreakType!==a.a.Punctuation&&o.wordBreakType!==a.a.PuncuationWithoutBreak||r.shouldCountPuncuationBreak(i,e,t)&&(n.wordCount+=1)}return n}static shouldCountAlphaBreak(e,t,n){if(!e)return!0;const i=t[e];if(!i.cp)return!0;const o=t[e-1];let s=!0;if(o.wordBreakType===a.a.Punctuation){let e=!1;for(let t=o.cp;t<i.cp;t+=1){const i=n.charAt(t);if("-"===i){if(e)return!0;e=!0}else e=!1;if(s=r.doesPunctuationIndiciateNewWord(i),s)return!0}}else if(o.wordBreakType===a.a.Undetermined)return!1;return(i.wordBreakType!==a.a.Undetermined||o.wordBreakType===a.a.WhiteSpace)&&s}static shouldCountPuncuationBreak(e,t,n){const i=t[e];if(r.doesPunctuationIndiciateNewWord(n.charAt(i.cp)))return!1;if(!e)return!0;if(!i.cp)return!1;const o=t[e-1];return o.wordBreakType===a.a.WhiteSpace||o.wordBreakType===a.a.FootnoteEndnotePunctuation}static doesPunctuationIndiciateNewWord(e){return"–"===e||"—"===e}getBackwardBreakInternal(e,t){if(t<=1)return;let n=t;for(;n>0;){const t=r.getWordBreakType(e,n-1);switch(t){case a.a.Undetermined:break;case a.a.AlphaNumeric:case a.a.Punctuation:case a.a.WhiteSpace:case a.a.PuncuationWithoutBreak:case a.a.FootnoteEndnotePunctuation:{if(n<=1)return;const i=n-1,o=r.getWordBreakType(e,i-1);if(t!==o&&r.shouldCreateBreakOnNextWordBreak(t,o)&&(o!==a.a.Undetermined||!this.supportsBrowserWordBreaking))return{cp:i,wordBreakType:t};break}}n-=1}}getForwardBreakInternal(e,t,n){if(t>=n-1)return;let i=t;for(;i<n;){const t=r.getWordBreakType(e,i);switch(t){case a.a.Undetermined:break;case a.a.AlphaNumeric:case a.a.Punctuation:case a.a.WhiteSpace:case a.a.PuncuationWithoutBreak:case a.a.FootnoteEndnotePunctuation:{if(i>=n-1)return;const o=i+1,s=r.getWordBreakType(e,o);if(t!==s&&r.shouldCreateBreakOnNextWordBreak(t,s)&&(s!==a.a.Undetermined||!this.supportsBrowserWordBreaking))return{cp:o,wordBreakType:s};break}}i+=1}}static shouldCreateBreakOnNextWordBreak(e,t){const n=e===a.a.AlphaNumeric&&t!==a.a.PuncuationWithoutBreak,r=e===a.a.PuncuationWithoutBreak&&t!==a.a.AlphaNumeric,i=e===a.a.Punctuation||e===a.a.FootnoteEndnotePunctuation,o=e===a.a.WhiteSpace;return r||n||i||o}static getWordBreakType(e,t){const n=e.charAt(t).toString();return o.isAlphaNum(n)?a.a.AlphaNumeric:r.isWhiteSpace(n)?a.a.WhiteSpace:r.isPunctuation(n)?a.a.Punctuation:r.isPunctuationWithoutBreak(n)?a.a.PuncuationWithoutBreak:r.isFootnoteEndnotePunctuation(n)?a.a.FootnoteEndnotePunctuation:a.a.Undetermined}static isWhiteSpace(e){return new RegExp("[\\u0000-\\u001F]|\\u0020|[\\u007F-\\u009F]|\\u00A0|[\\u2000-\\u200C]|\\u202F|\\u205F|\\u2420|[\\u2422-\\u2424]|\\u3000|\\uFF02").test(e)}static isPunctuation(e){return new RegExp("[!-&]|[\\(-\\.]|/|[:-@]|[\\[-`]|[{-~]|¡|¦|§|©|«|¬|®|°|±|[´-·]|»|¿|×|÷|ǃ|;|[‒-―]|[‚-•]|[․-…]|\\u202F|‰|‹|›|‼|‽|⁈|⁉|\\u2060|℃|℅|℆|℉|№|™|∑|−|√|∞|∫|≈|≠|≤|≥|\\u25A1|\\u25AA|\\u25AB|◊|●|◦|[☹-☻]|❢|。|[〝-〟]|\\uFEFF|！|．|；|？|｡").test(e)}static isPunctuationWithoutBreak(e){return"'"===e||"‘"===e||"’"===e}static isFootnoteEndnotePunctuation(e){return""===e}};s=r=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(i.injectable)()],s)},10599:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1681),i=n(3199);let o=class{generate(){return Object(i.v4)()}};o=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],o)},10600:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,i=n(1681),o=n(4995),a=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},s=function(e,t){return function(n,r){t(n,r,e)}};!function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(r||(r={}));let c=class{constructor(e,t){this._textExtractor=e,this._indexReadjuster=t,this.findOffsetPositions=(e,t)=>{const n=new Map;let i=0;t.sort((e,t)=>e.index-t.index);const o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let a=0;const s=this._textExtractor.extractElementText(e);if(t[0]&&t[0].index<0||t[t.length-1]&&t[t.length-1].index>s.length)return n;const c=this._indexReadjuster.getReadjustedIndices(e,t,s);for(;o.nextNode();){const e=o.currentNode,s=i,l=e.textContent?e.textContent.length:0,u=s+l;for(let i=a;i<t.length;i+=1){const o=c[i];if(o.indexType===r.Start&&o.index>=s&&o.index<u)a+=1,n.set(t[i].startIndex,{startNode:e,startOffset:o.index-s});else{if(!(o.indexType===r.End&&o.index>s&&o.index<=u))break;{a+=1;const r=n.get(t[i].startIndex);if(!r)throw new Error("The critique's end index has no conforming start index.");r.endNode=e,r.endOffset=o.index-s,n.set(t[i].startIndex,r)}}}if(i+=l,a===t.length)break}return n},this.createRange=(e,t)=>{if(!t||!t.endNode||!t.endOffset)return;const n=e.createRange();return n.setStart(t.startNode,t.startOffset),n.setEnd(t.endNode,t.endOffset),n}}getCritiqueRanges(e,t){const n=[];t.forEach(e=>{n.push({index:e.start,indexType:r.Start,startIndex:e.start}),n.push({index:e.start+e.length,indexType:r.End,startIndex:e.start})});const i=this.findOffsetPositions(e,n),o=e.ownerDocument||document;return t.map(e=>{const t=i.get(e.start);return{critique:e,range:this.createRange(o,t)}})}includePrecedingSpace(e,t){let n;if(t.startOffset>=0&&t.startContainer.textContent&&" "===t.startContainer.textContent.charAt(t.startOffset-1))n={startNode:t.startContainer,startOffset:t.startOffset-1};else if(0===t.startOffset){const r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(r.currentNode=t.startContainer;r.previousNode();){const e=r.currentNode;if(e.nodeType===e.TEXT_NODE&&e.textContent&&e.textContent.length>0){e.textContent.endsWith(" ")&&(n={startNode:e,startOffset:e.textContent.length-1});break}}}return n&&t.setStart(n.startNode,n.startOffset),t}};c=a([Object(i.injectable)(),s(0,Object(i.inject)(o.a.ITextExtractor)),s(1,Object(i.inject)(o.a.IIndexReadjuster))],c)},10601:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1681),i=n(4995),o=function(e,t){return function(n,r){t(n,r,e)}};let a=class{constructor(e){this._featureFlagsReader=e}extractElementText(e){let t="";return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement?t=e.value:this._featureFlagsReader.flags.enableV2InputSquiggles||e.closest("[contenteditable]")||1!==e.childNodes.length||e.childNodes[0].nodeType!==e.TEXT_NODE?e.innerText&&(t=e.innerText):t=e.textContent||"",t}};a=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)(),o(0,Object(r.inject)(i.a.IFeatureFlagsReader))],a)},10602:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(15160),i=n(1681);let o=class{constructor(){this.getIndex=e=>e.index>=0?e.index:e,this.getNewValue=(e,t)=>e.index>=0?(e.index=t,e):e=t,this._dmp=new r.diff_match_patch}getReadjustedIndices(e,t,n,r){const i=[],o=e.textContent||"",a=r?this._dmp.diff_main(n,o):this._dmp.diff_main(o,n);if(1===a.length&&0===a[0][0])return t;let s=0,c=0,l=0,u=0,d=0;for(const e of a){const n=e[0],r=e[1].length;switch(n){case 0:u=r,d=r;break;case 1:u=0,d=r;break;case-1:c+=r;continue}for(let e=s;e<t.length;e+=1){const r=this.getIndex(t[e]);if(r<l)throw new Error("Indices are not sorted!");if(!(r>=l&&r<l+d))break;i[e]=0===n?this.getNewValue(t[e],r+c-l):this.getNewValue(t[e],c),s+=1}if(s===t.length)break;c+=u,l+=d}for(let e=s;e<t.length;e+=1)i[e]=this.getNewValue(t[e],c);return i}};o=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(i.injectable)()],o)},10603:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,i=n(1681),o=n(4995),a=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},s=function(e,t){return function(n,r){t(n,r,e)}};let c=r=class{constructor(e){this._hostSettings=e}static getMatchRegexRange(e,t,n=0){const r=[];let i=t.exec(e);for(;null!==i;){if(i[n]){const e=i.index;r.push({begin:e,end:e+i[n].length})}i=t.exec(e)}return r}expandEndRange(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?r.NewExpandRuleChecks:r.ExpandRuleChecks;for(const n of t){const t=r.getMatchRegexRange(e,n);if(t.length>0&&0===t[0].begin)return t[0].end-1}return this._hostSettings.newLineSentenceSeparatorEnabled?-1:0}isEndPuncSpecialCase(e){const t=r.getMatchRegexRange(e,r.SpecialCaseCheck),n=this._hostSettings.newLineSentenceSeparatorEnabled?e.length-1:e.length;return t.some(e=>e.end===n)}findBeginBoundary(e,t,n){const i=this._hostSettings.newLineSentenceSeparatorEnabled?r.NewEndPuncCheck:r.EndPuncCheck,o=e.substring(n,t),a=r.getMatchRegexRange(o,i);for(let e=a.length-1;e>=0;e-=1){const t=o.substring(0,a[e].end);if(!this.isEndPuncSpecialCase(t)){const t=o.substring(a[e].begin,o.length),r=this.expandEndRange(t);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===r:!r)continue;return n+a[e].end+r}}return n}findEndBoundary(e,t,n){const i=e.substring(t,n),o=this._hostSettings.newLineSentenceSeparatorEnabled?r.NewEndPuncCheck:r.EndPuncCheck,a=r.getMatchRegexRange(i,o);for(const e of a){const n=i.substring(0,e.end);if(!this.isEndPuncSpecialCase(n)){const n=i.substring(e.begin,i.length),r=this.expandEndRange(n);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===r:!r)continue;return t+e.end+r}}return-1}splitInUnits(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?r.NewEndExpandRuleCheck:r.EndExpandRuleCheck,n=e.replace(r.SpecialCaseCheck,e=>"#".repeat(e.length));return r.getMatchRegexRange(n,t).map(e=>e.end)}};c.ClosingBrace="[)]}༻༽⁆〉》」』】〕〗〙〛〞〟）］｝｠｣]",c.SmileyChar="[☹☺☻]",c.OtherSpaceChar="[\0-\b\n--\u2028-\u2029  ]",c.Digit="[0-9٠-٩۰-۹०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙０-９]",c.OtherNumber="[²³¹¼½¾৴-৹௰௱௲౸-౾൰-൵༪-༳፩-፼៰-៹〇〡-〩〸〹〺]",c.Punct="[!-#%-*,-/:-;?-@_{}¡«¬·»¿;·՚-՟։-֊־׀׃׆׳-״؉-؊،-؍؛؞-؟٪-٭۔।-॥॰෴๏๚-๛༄-༒༺-༽྅࿐-࿔၊-၏჻፡-፨᙭-᙮។-៖៘-៚᠀-᠊‐-‧‰-⁃⁅-⁑⁓-⁞、-〃〈-】〔-〟〰〽゠・！-＃％-＊，-／：-；？-＠［-］＿｛｝｟-･]",c.Symbol="[$+<=>^`|~¢£¤¥-©¬®¯°±´¶¸×÷˂-˅˒-˟˥-˫˭˯-˿͵΄΅϶҂؆؇؈؋؎؏۞۩۽۾৲৳৺૱୰௳-௺౿൹฿༁༂༃༓༕༖༗༚-༟༴༶༸྾-࿅࿇-࿌࿎࿏႞႟᎐-᎙៛⁄⁒〄〒〓〠〶〷〾〿゛゜＄＋＜＝＞＾｀｜～￠-￦￨-￮]",c.OtherControl="[؀-؃۝᠎​-‍⁠-⁤⁪-⁯]",c.LetterUpperLower_Halfwidth="[A-Za-zªµºÀ-ÐÑ-ÖØ-öø-ƺƼ-ƿǄ-ʓʕ-ͳͶͷͻͼͽΆΈΉΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԣԱ-Ֆա-ևႠ-Ⴥ]",c.LetterUpperLower_Fullwidth="[Ａ-Ｚａ-ｚ]",c.LetterOther_NonCjThai="[ƻǀ-ǃʔא-תװױײء-ؿف-يٮٯ-ۓٱەۮۯۺۻۼۿऄ-हऽॐक़-ॡॲॻ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়ৠৡৰৱਅ-ਊਏਐਓ-ਙਚ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-നപ-ഹഽൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜໝༀཀ-ཇཉ-ཬྈ-ྋក-ឳៗៜက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎა-ჺᄀ-ᅙᅟᅠ-ᆢᆨ-ᇹሀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙶᠠ-ᡷᢀ-ᢨᢪ〆〼가-힣ﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]",c.LetterOther_Cj="[ぁ-ゖゟァ-ヺヿ豈-鶴侮-頻並-龎ｦ-ﾝ]",c.LetterOther_Thai="[ก-ะาำเ-ๅ]",c.EndPunc="[?!.։۔܁܂।॥።᙮᠃᠉⳹⳾。꓿꘎꛳︒﹒．｡]",c.EndPuncCJ="[。｡]",c.SpaceChar="[   -   　\t]",c.FinalQuotationChar="[»’”›\"']",c.OtherChar=`${r.ClosingBrace}|${r.SmileyChar}`,c.LineEnd="[\u2028\u2029\n\r]",c.LeftContext_OrdinalNumber=`(${r.SpaceChar}|${r.OtherSpaceChar}|${r.Punct}|${r.OtherControl})`,c.LeftContext_Abbrev_Cj=`(${r.SpaceChar}|${r.OtherSpaceChar}|${r.Punct}|${r.Symbol}|${r.OtherControl}|${r.Digit}|${r.OtherNumber})`,c.expandRule1=`(${r.EndPunc}(${r.OtherChar}|${r.FinalQuotationChar}|${r.SpaceChar})*${r.LineEnd})`,c.expandRule2=`(${r.EndPunc}(${r.OtherChar})*(${r.SpaceChar})+)`,c.expandRule3=`(${r.EndPuncCJ}(${r.OtherChar})*)`,c.expandRule4=`((${r.LineEnd})+)`,c.expandRule5=`(${r.EndPunc}(${r.OtherChar}|${r.FinalQuotationChar}|${r.SpaceChar})*(${r.LineEnd})+)`,c.ExpandRuleChecks=[new RegExp(r.expandRule1,"ig"),new RegExp(r.expandRule2,"ig"),new RegExp(r.expandRule3,"ig")],c.NewExpandRuleChecks=[new RegExp(r.expandRule2,"ig"),new RegExp(r.expandRule3,"ig"),new RegExp(r.expandRule4,"ig"),new RegExp(r.expandRule5,"ig")],c.EndExpandRuleCheck=new RegExp(`${r.expandRule1}|${r.expandRule2}|${r.expandRule3}`,"ig"),c.NewEndExpandRuleCheck=new RegExp(`${r.expandRule2}|${r.expandRule3}\n    |${r.expandRule4}|${r.expandRule5}`,"ig"),c.specialCase1="[.。﹒．｡]{2,6}|[.]([ ][.]){1,5}",c.specialCase2_Halfwidth="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]",c.specialCase2_Fullwidth="((([Ｌ]?[Ｘ]{1,3}|[Ｘ][ＬＣ]|[Ｌ])?([Ｖ]?[Ｉ]{1,3}|[Ｉ][ＶＸ]|[Ｖ]))|([Ｌ]?[Ｘ]{1,3}|[Ｘ][ＬＣ]|[Ｌ])|(([ｌ]?[ｘ]{1,3}|[ｘ][ｌｃ]|[ｌ])?([ｖ]?[ｉ]{1,3}|[ｉ][ｖｘ]|[ｖ]))|([ｌ]?[ｘ]{1,3}|[ｘ][ｌｃ]|[ｌ]))[.﹒．]",c.specialCase2=`${r.specialCase2_Halfwidth}|${r.specialCase2_Fullwidth}`,c.specialCase3="([0-9]{1,4}[.]|[０-９]{1,4}[.﹒．])",c.specialCase4="([0-9]+(([aoªºᵃᵒ])|((er)[ao]?)|(([ᵉ][ʳ])[ᵃᵒ]?)|([mdtvn][ao])|([ᵐᵈᵗᵛⁿ][ᵃʳ]))[.]|[A-Za-zÀÄÈÉÔÖÜßàäèéôöü]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-zÀÄÈÉÔÖÜßàäèéôöü]+((STR)|(str))[.])",c.specialCase5=`((${r.LetterUpperLower_Halfwidth}|${r.LetterOther_NonCjThai}|${r.LetterOther_Thai})[.])+|((${r.LetterOther_Cj})[.﹒．])+`,c.specialCase6=`(${r.LetterUpperLower_Fullwidth})[.﹒．]`,c.sensitiveCaseOrdinalNumber=`${r.LeftContext_OrdinalNumber}(${r.specialCase2}|${r.specialCase3}|${r.specialCase4})`,c.sensitiveCaseAbbrev=`${r.LeftContext_Abbrev_Cj}(${r.specialCase5})`,c.noSensitiveCase=`${r.specialCase1}|${r.specialCase6}`,c.specialCase=`${r.noSensitiveCase}|${r.sensitiveCaseOrdinalNumber}|${r.sensitiveCaseAbbrev}`,c.EndPuncCheck=new RegExp(`${r.EndPunc}|${r.EndPuncCJ}`,"ig"),c.NewEndPuncCheck=new RegExp(`${r.EndPunc}|${r.EndPuncCJ}|${r.LineEnd}`,"ig"),c.SpecialCaseCheck=new RegExp(r.specialCase,"g"),c=r=a([Object(i.injectable)(),s(0,Object(i.inject)(o.a.IHostSettings))],c)},10604:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1681);let i=class{findBeginBoundary(e,t,n){return Math.min(t,n)}findEndBoundary(e,t,n){return e.length<n?-1:Math.max(t,n)}splitInUnits(e){return[e.length]}};i=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],i)},10605:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,i=n(1681),o=n(4995),a=n(9177),s=function(e,t){return function(n,r){t(n,r,e)}};let c=r=class{constructor(e,t){this._sentenceSeparator=e,this._unitySeparator=t}splitInUnitsFromExtendedBoundaries(e,t,n,i){const o=this._getUnitSeparator(n),a=i||r._extendBoundariesFromDiffBounds(e,t,o),s=r._splitInUnits(o,e,t,a);return!s.length||s[s.length-1].validEndBoundary&&!1!==s[s.length-1].validEndBoundary||(s[s.length-1]=r._checkForValidSeparatorAtEnd(e,s[s.length-1],o)),s}extendBoundariesFromDiffBounds(e,t,n){return r._extendBoundariesFromDiffBounds(e,t,this._getUnitSeparator(n))}_getUnitSeparator(e){switch(e){case a.TextUnit.Sentence:return this._sentenceSeparator;default:return this._unitySeparator}}static _extendBoundariesFromDiffBounds(e,t,n){let r,i=0,o=e.length,a=t.firstDiffLeft+1;if(e.length)do{if(a-=1,i=n.findBeginBoundary(e,a,0),o=n.findEndBoundary(e,e.length-t.firstDiffRight,e.length),r=-1!==o,o=-1!==o?o:e.length,a<e.length){if(i===n.findBeginBoundary(e,a+1,0))continue}let s=i,c=0;for(;s&&a===s+c;){c+=1;const t=s;if(s=n.findBeginBoundary(e,s-1,0),s<t-1){i=s;break}}}while(!(o-i));return{offset:i,span:o-i,validEndBoundary:r}}static _splitInUnits(e,t,n,i){if(!n.firstDiffLeft&&!n.firstDiffRight&&!i.offset&&i.span===t.length)return r._fullTextSplit(e,t);const o=t.slice(i.offset,i.offset+i.span),a=n.firstDiffLeft-i.offset,s=n.firstDiffRight-(t.length-i.offset-i.span);let c=0,l=0;const u=[],d=Math.min(o.length,o.length-s+2);do{const t=c;c=e.findEndBoundary(o,Math.max(c,a-2),d),l=-1!==c&&c<d?c:o.length,l-t&&u.push({offset:t+i.offset,span:l-t,validEndBoundary:-1!==c,enforcedCompleteTileTextUnit:i.enforcedCompleteTileTextUnit})}while(l<o.length);return u}static _checkForValidSeparatorAtEnd(e,t,n){if(!1===t.validEndBoundary&&t.span>=2){let r,i=t.span;do{r=e.slice(t.offset+i-2,t.offset+i),i-=1}while(!/\S/.test(r)&&i>=2);t.validEndBoundary=-1!==n.findEndBoundary(r,0,r.length)}return t}static _fullTextSplit(e,t){const n=[],r=e.splitInUnits(t);let i=0;return r.forEach(e=>{n.push({offset:i,span:e-i,validEndBoundary:-1!==e}),i=e}),(!r.length||r.length&&r[r.length-1]!==t.length)&&n.push({offset:i,span:t.length-i,validEndBoundary:!1}),n}};c=r=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(i.injectable)(),s(0,Object(i.inject)(o.a.ITextUnitSeparator)),s(0,Object(i.named)(a.TextUnit.Sentence)),s(1,Object(i.inject)(o.a.ITextUnitSeparator)),s(1,Object(i.named)(a.TextUnit.Default))],c)},10606:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1681),i=n(7534);let o=class extends i.a{replace(e,t){if(!this.element)return;const n=this.element.value.length,r=Math.min(e.start,n),i=Math.min(e.start+e.length,n);this.element.setRangeText(t.text,r,i,"end"),this.dispatchInputEvent()}remove(e){if(!this.element)return;const t=this.element.value.length;let n=Math.min(e.start,t);const r=Math.min(e.start+e.length,t);" "===this.element.value[n-1]&&(n-=1),this.element.setRangeText("",n,r),this.dispatchInputEvent()}};o=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],o)},10607:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.HtmlEditTextProcessor="HtmlEditTextProcessor",e.HtmlElementTextProcessor="HtmlElementTextProcessor",e.KixTextProcessor="KixTextProcessor",e.ContentEditableTextProcessor="ContentEditableTextProcessor",e.ContentEditableWithTimeoutTextProcessor="ContentEditableWithTimeoutTextProcessor"}(r||(r={}))},10608:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1681),i=n(4995),o=n(7534),a=function(e,t){return function(n,r){t(n,r,e)}};let s=class extends o.a{constructor(e,t){super(e),this.textNodeRangeBuilder=t,this.getRangeAndPerformOperation=(e,t)=>{if(!this.element)return;const n=this.element.ownerDocument;if(!n)return;const r=this.textNodeRangeBuilder.getCritiqueRanges(this.element,[e])[0];r.range&&t(n,r.range,this.element)},this.selectRange=(e,t)=>{const n=e.getSelection();return!!n&&(n.removeAllRanges(),n.addRange(t),n.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),!0)}}replace(e,t){window.requestAnimationFrame(()=>this.getRangeAndPerformOperation(e,(e,n)=>{this.selectRange(e,n),this.doReplacement(e,t.text)}))}remove(e){window.requestAnimationFrame(()=>this.getRangeAndPerformOperation(e,(e,t,n)=>{this.textNodeRangeBuilder.includePrecedingSpace(n,t),this.selectRange(e,t),this.doRemoval(e)}))}doReplacement(e,t){const n=new Event("createUndoCheckpoint");e.dispatchEvent(n),this.innerDoReplacement(e,t),e.dispatchEvent(n)}doRemoval(e){const t=new Event("createUndoCheckpoint");e.dispatchEvent(t),this.innerDoRemoval(e),e.dispatchEvent(t)}innerDoReplacement(e,t){e.execCommand("insertText",!1,t),this.dispatchInputEvent()}innerDoRemoval(e){e.execCommand("delete",!1),this.dispatchInputEvent()}};s=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)(),a(0,Object(r.inject)(i.a.ITextRetrieverFactory)),a(1,Object(r.inject)(i.a.ITextNodeRangeBuilder))],s)},10609:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this.element=e}retrieve(){return this.element.value}}},10610:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this.element=e}retrieve(){return this.element?this.element.innerText:""}}},10611:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1681),i=n(7530),o=n(6876);let a=class extends o.a{checkUserInfo(){return this.licenseType===i.b.NoLicense&&this.identityProvider===i.a.MSA}};a=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],a)},10612:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1681),i=n(7530),o=n(6876);let a=class extends o.a{checkUserInfo(){return this._expiry?Date.now()<=this._expiry:this.licenseType===i.b.Subscription}setGracePeriodUntil(e){this._expiry=e}};a=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],a)},10613:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1681),i=n(6876);let o=class extends i.a{checkUserInfo(){return!!this.isLoggedIn}};o=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],o)},10614:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1681),i=n(4994),o=n(3234),a=n(4996),s=n(9181),c=n(9180),l=function(e,t){return function(n,r){t(n,r,e)}};let u=class extends a.a{constructor(e,t,n,r){super(),this._isUpsellUser=e,this.logger=t,this._featureFlagsReader=n,this.hostSettings=r,this.disablers=[this],this.enablers=[!1,this._isUpsellUser]}emitAndEvaluate(e){if(e.eventId===c.a.UpsellButtonClicked){const t=this.logger.getNewActivity(i.c.ActionUpsellButtonClicked,i.f.CriticalExperimentation);t&&(t.addDataField("Event_Source",e.sender,i.a.EssentialServiceMetadata),t.setSuccess(!0),t.endNow())}return super.emitAndEvaluate(e)}check(){return!this._featureFlagsReader.flags.enableUpsellFeature}processCallBackResult(e,t,n){return this._upsellLinkFromListener=n.upsellLink,super.processCallBackResult(e,t,n)}goPremium(e,t,n){const r={eventId:c.a.UpsellButtonClicked,sender:e,critique:t,location:n};this._upsellLinkFromListener=void 0,this.emitAndEvaluate(r),this._upsellLinkFromListener?(Object(s.a)(this._upsellLinkFromListener),this._upsellLinkFromListener=void 0):Object(s.a)(this.hostSettings.upsellLink,e===c.c.ShowCritiqueCallout?"callout":e===c.c.SettingsPage?"settings":"")}};u=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)(),l(0,Object(r.inject)(o.a.IsUpsellUser)),l(1,Object(r.inject)(o.a.ILogger)),l(2,Object(r.inject)(o.a.IFeatureFlagsReader)),l(3,Object(r.inject)(o.a.IHostSettings))],u)},10615:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1681),i=n(4996),o=n(9183);let a=class extends i.a{constructor(){super(),this.disablers=[],this.enablers=[!1]}openSettings(e){const t={eventId:o.a.SettingsClicked,sender:e};this.emitAndEvaluate(t)}};a=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],a)},10616:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return u}));var r,i,o=n(1681),a=n(3234),s=n(4996),c=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){return function(n,r){t(n,r,e)}};!function(e){e[e.ShowPage=0]="ShowPage",e[e.GetMoreCommands=1]="GetMoreCommands"}(r||(r={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout"}(i||(i={}));let u=class extends s.a{constructor(e){super(),this._isPremiumUser=e,this.disablers=[],this.enablers=[!1,this._isPremiumUser]}};u=c([Object(o.injectable)(),l(0,Object(o.inject)(a.a.IsPremiumUser))],u)},10617:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r,i,o=n(1681),a=n(3234),s=n(4996),c=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){return function(n,r){t(n,r,e)}};!function(e){e[e.ShowPage=0]="ShowPage"}(r||(r={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.DropDown=1]="DropDown"}(i||(i={}));let u=class extends s.a{constructor(e){super(),this._isPremiumUser=e,this.disablers=[],this.enablers=[!1,this._isPremiumUser]}};u=c([Object(o.injectable)(),l(0,Object(o.inject)(a.a.IsPremiumUser))],u)},10618:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11081),i=n(1681),o=n(3234),a=n(4996),s=function(e,t){return function(n,r){t(n,r,e)}};let c=class extends a.a{constructor(e){super(),this.hostSettings=e,this.disablers=[this],this.enablers=[!0]}check(){return!this.hostSettings.enableRoamingDictionary}getRoamingDictionary(){return this._roamingDictionary}isReady(){return!0===this.hostSettings.enableRoamingDictionary&&void 0!==this._roamingDictionary&&this._roamingDictionary.getLoadState()===r.a.LOADED}processCallBackResult(e,t,n){return this._roamingDictionary=n.roamingDictionary,super.processCallBackResult(e,t,n)}};c=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(i.injectable)(),s(0,Object(i.inject)(o.a.IHostSettings))],c)},10619:function(e,t,n){"use strict";function r(e,t){return!(!e||!t)&&(e.start===t.start&&e.length===t.length&&e.priority===t.priority&&e.textInContext===t.textInContext)}function i(e,t){return!(!e||!t)&&!(e.start>=t.start+t.length||t.start>=e.start+e.length)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));const o=(e,t,n)=>{if(e&&void 0!==t&&void 0!==n)return e.substring(t,t+n)}},1062:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={Accept:"",AccessibiltyChecker:"",Accounts:"",Add:"",AddEvent:"",AddFriend:"",AddReaction:"",Airplane:"",AirplaneSolid:"",AlarmClock:"",AlertSolid:"",AlignLeft:"",AlignRight:"",AnalyticsLogo:"",Archive:"",Arrivals:"",Ascending:"",Assign:"",Attach:"",AutoEnhanceOn:"",Back:"",BingLogo:"",BlockContact:"",Blocked:"",BookingsLogo:"",BoxLogo:"",BulletedList:"",Bullseye:"",Calendar:"",CalendarReply:"",CalendarSettings:"",Camera:"",Cancel:"",Car:"",CaretLeftSolid8:"",CaretRightSolid8:"",CellPhone:"",ChatInviteFriend:"",Checkbox:"",CheckboxComposite:"",CheckMark:"",ChevronDown:"",ChevronDownMed:"",ChevronLeft:"",ChevronRight:"",ChevronRightMed:"",ChevronUp:"",ChromeClose:"",ChromeMinimize:"",CircleFill:"",CirclePlus:"",CircleRing:"",CityNext:"",Clear:"",ClearFilter:"",ClearNight:"",ClipboardList:"",Clock:"",ClosePane:"",Cloud:"",CloudAdd:"",CloudEdit:"",CloudLink:"",CloudUpload:"",CodeEdit:"",CollapseContent:"",Color:"",CommentUrgent:"",Completed:"",CompletedSolid:"",Contact:"",ContactCard:"",ContactList:"",ContactLock:"",Copy:"",DateTime:"",DeclineCall:"",Delete:"",DeliveryTruck:"",Descending:"",DeveloperTools:"",Diamond:"",DocumentSearch:"",Door:"",DoubleChevronDown:"",DoubleChevronLeft:"",DoubleChevronRight:"",DoubleChevronUp:"",Down:"",Download:"",Drop:"",DropboxLogo:"",EaseOfAccess:"",EatDrink:"",Edit:"",Education:"",EgnyteLogo:"",Embed:"",Emi:"",Emoji:"",Emoji2:"",Encryption:"",Equalizer:"",Error:"",ErrorBadge:"",Event:"",EventAccepted:"",EventDeclined:"",EventInfo:"",EventTentative:"",EventToDoLogo:"",ExploreContent:"",FabricFolder:"",FabricMoveToFolder:"",FacebookLogo:"",FangBody:"",FavoriteList:"",FavoriteStar:"",FavoriteStarFill:"",Feedback:"",FileTemplate:"",Filter:"",Flag:"",Flashlight:"",Flow:"",FluidLogo:"",Folder:"",FolderHorizontal:"",Forward:"",ForwardEvent:"",Frigid:"",FullScreen:"",FullView:"",GIF:"",GiftCard:"",GlobalNavButton:"",Globe:"",GoogleDriveLogo:"",GoToToday:"",GripperDotsVertical:"",Group:"",Heart:"",HeartBroken:"",HeartFill:"",Help:"",Hide:"",Hide3:"",History:"",Home:"",Hotel:"",Important:"",Inbox:"",Info:"",InsertSignatureLine:"",InsertTextBox:"",Insights:"",Label:"",LargeGrid:"",Lightbulb:"",LightningBolt:"",Like:"",Link:"",LinkedInLogo:"",List:"",LocaleLanguage:"",Location:"",LocationDot:"",Lock:"",Mail:"",MailAlert:"",MailCheck:"",MailForward:"",MailOptions:"",MailPause:"",MapDirections:"",MapPin:"",MarkAsProtected:"",Megaphone:"",MicrosoftTranslatorLogo:"",MiniExpand:"",MiniExpandMirrored:"",MobileSelected:"",Money:"",More:"",MoreVertical:"",MSNVideos:"",NavigateExternalInline:"",NewMail:"",NotePinned:"",OfficeChat:"",OneDriveFileVault:"",OneDriveLogo:"",OneNoteLogo:"",OpenInNewTab:"",OpenInNewWindow:"",OpenPane:"",OpenSource:"",Org:"",OutlookLogo:"",OutlookLogoInverse:"",OutlookSpacesBucket:"",Package:"",Page:"",PageEdit:"",PageLink:"",PageRemove:"",ParkingLocation:"",ParkingLocationMirrored:"",PartlyCloudyDay:"",Paste:"",PasteAsText:"",PaymentCard:"",Pdf:"",PencilReply:"",People:"",PeopleAlert:"",Personalize:"",Phone:"",Photo2:"",Pinned:"",PinnedSolid:"",PlainText:"",Play:"",Poi:"",Print:"",Puzzle:"",QuickNote:"",Read:"",Recent:"",RectangularClipping:"",RedEye:"",Refresh:"",RemoveContent:"",RemoveEvent:"",RemoveFromTrash:"",RemoveLink:"",Rename:"",ReopenPages:"",Reply:"",ReplyAll:"",ReportHacked:"",Ribbon:"",RightDoubleQuote:"",Ringer:"",RingerOff:"",Rotate:"",Sad:"",Save:"",ScheduleEventAction:"",ScrollUpDown:"",Search:"",SearchCalendar:"",Send:"",Settings:"",Share:"",ShowTimeAs:"",SkypeForBusinessLogo:"",SkypeForBusinessLogo16:"",SkypeLogo:"",SkypeLogo16:"",Soccer:"",Sort:"",SortDown:"",SortLines:"",SortUp:"",SpecialEvent:"",SquareShapeSolid:"",Stack:"",StatusCircleCheckmark:"",StatusCircleErrorX:"",StatusCircleQuestionMark:"",Stopwatch:"",Sunny:"",SyncOccurence:"",SyncToPC:"",System:"",TabCenter:"",Tag:"",TagSolid:"",TeamsLogo:"",TextDocumentSettings:"",TextDocumentShared:"",Ticket:"",Tiles:"",ToDoLogoOutline:"",TvMonitor:"",Undo:"",Unknown:"",Unlock:"",UnsyncOccurence:"",Up:"",Upload:"",Video:"",View:"",ViewAll:"",Volume2:"",Waffle:"",Warning:"",WebPublish:"",WipePhone:"",World:"",YammerLogo:"",ZoomIn:"",ZoomOut:""};t.b={fontFileName:"controlIcons",icons:r}},10620:function(e,t,n){"use strict";function r(e,t){return!(!e||!t)&&(e.offset===t.offset+t.span||t.offset===e.offset+e.span)}function i(e,t){return!(!e||!t)&&!(e.offset>=t.offset+t.span||t.offset>=e.offset+e.span)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},10621:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,i=n(3234),o=n(1681),a=n(4994),s=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},c=function(e,t){return function(n,r){t(n,r,e)}};let l=r=class{constructor(e,t){this._logger=e,this._hostSettings=t,this._eventName="End2EndTelemetry",this._performanceApiGarbageCollectorIntervalInMs=1e4}startEntry(e){if(!this._hostSettings.enableE2eMetric)return;this._scheduleGarbageCollection();const[t]=this._getPerformanceEntryNames(e);window.performance.mark(t)}_getPerformanceEntryNames(e){const t=`${this._eventName}-${e}`;return[`${t}--${r.START_SUFFIX}`,`${t}--${r.END_SUFFIX}`,t]}commitEntry(e){if(!this._hostSettings.enableE2eMetric)return;const[t,n,r]=this._getPerformanceEntryNames(e);if(0!==window.performance.getEntriesByName(t).length)try{window.performance.mark(n),window.performance.measure(r,t,n);const i=window.performance.getEntriesByName(r)[0];this._logToTelemetry(i.duration),this._clearPerformanceDataById(e)}catch(e){this._logger.logEvent(587863522,a.b.TelemetryError,a.e.Error,`Error while commiting a telemetry entry, error: ${e}`,a.f.CriticalExperimentation)}}_logToTelemetry(e){const t=this._logger.getNewActivity(this._eventName,a.f.CriticalExperimentation);t&&(t.addDataField(this._eventName,e,a.a.EssentialServiceMetadata),t.setSuccess(!0),t.endNow())}_clearAndReschedule(e){const t=Date.now(),n=window.performance.getEntries().filter(n=>{if(!n.name.match(`${this._eventName}(.*)`))return!1;const r=window.performance.timeOrigin+n.startTime;return!!(e&&!e.didTimeout&&0===e.timeRemaining()||t-r<this._performanceApiGarbageCollectorIntervalInMs)||(window.performance.clearMarks(n.name),window.performance.clearMeasures(n.name),!1)});this._garbageCollectionScheduler=void 0,n.length>0&&this._scheduleGarbageCollection()}_scheduleGarbageCollection(){this._garbageCollectionScheduler||("requestIdleCallback"in window?this._garbageCollectionScheduler=window.requestIdleCallback(e=>this._clearAndReschedule(e),{timeout:this._performanceApiGarbageCollectorIntervalInMs}):this._garbageCollectionScheduler=setTimeout(()=>{this._clearAndReschedule()},this._performanceApiGarbageCollectorIntervalInMs))}_clearPerformanceDataById(e){const[t,n,r]=this._getPerformanceEntryNames(e);window.performance.clearMarks(t),window.performance.clearMarks(n),window.performance.clearMeasures(r)}};l.END_SUFFIX="end",l.START_SUFFIX="start",l=r=s([Object(o.injectable)(),c(0,Object(o.inject)(i.a.ILogger)),c(1,Object(o.inject)(i.a.IHostSettings))],l)},10622:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(1681),i=n(7533),o=n(3234),a=n(7532),s=n(4994),c=function(e,t){return function(n,r){t(n,r,e)}};let l=class{constructor(e,t){this._hostEmitter=e,this._logger=t,this._remoteObjects={},this.onOtelClientIdRequest=async e=>{const t=async()=>{const n=localStorage.getItem("OTelJS.ClientId");n?this._hostEmitter.emit(a.a.otelClientIdResponse,{address:e.address,message:n}):setTimeout(t,5e3)};t()},this.onTelemetryEvent=async e=>{try{if(e&&e.message){const t=e.message;t.tagID&&t.level&&t.message&&this._logger.logEvent(t.tagID,t.eventName,t.level,t.message,t.sampling,t.data,t.experimentation)}}catch(e){this._logger.logEvent(589844953,s.b.AriaError,s.e.Error,"The call to Aria failed",s.f.CriticalBusinessImpact)}return!1},this.onNewActivityTelemetryEvent=async e=>{try{if(e&&e.address&&e.message){const t=e.message;this._remoteObjects[e.address]=this._logger.getNewActivity(t.eventName,t.sampling,t.experimentation)}}catch(e){this._logger.logEvent(589844954,s.b.GetNewActivityError,s.e.Error,"The call to getNewActivity failed",s.f.CriticalBusinessImpact)}return!1},this.onAddDataFieldTelemetryEvent=async e=>this.processEnvelope(e,(e,t)=>{e.addDataField(t.name,t.value,t.classification)}),this.onSetResultTelemetryEvent=async e=>this.processEnvelope(e,(e,t)=>{e.setResult(t.resultCode,t.resultType,t.resultTag)}),this.onSetSuccessTelemetryEvent=async e=>this.processEnvelope(e,(e,t)=>{e.setSuccess(t)}),this.onEndNowTelemetryEvent=async e=>this.processEnvelope(e,(t,n)=>{t.endNow().then(()=>{delete this._remoteObjects[e.address]}).catch(()=>{delete this._remoteObjects[e.address]})}),this.processEnvelope=async(e,t)=>{try{if(e&&e.address){const n=e.message,r=this._remoteObjects[e.address];r&&t(r,n)}}catch(e){this._logger.logEvent(589844955,s.b.EnvelopeFormatError,s.e.Error,"The call to processEnvelope failed",s.f.CriticalBusinessImpact)}return!1},setInterval(()=>{this.cleanupActivities()},6e5)}async initialize(){this._hostEmitter.on(a.a.telemetryEvent,this.onTelemetryEvent),this._hostEmitter.on(a.a.newActivityTelemetryEvent,this.onNewActivityTelemetryEvent),this._hostEmitter.on(a.a.activityAddDataFieldTelemetryEvent,this.onAddDataFieldTelemetryEvent),this._hostEmitter.on(a.a.activitySetResultTelemetryEvent,this.onSetResultTelemetryEvent),this._hostEmitter.on(a.a.activitySetSuccessTelemetryEvent,this.onSetSuccessTelemetryEvent),this._hostEmitter.on(a.a.activityEndNowTelemetryEvent,this.onEndNowTelemetryEvent),this._hostEmitter.on(a.a.otelClientIdRequest,this.onOtelClientIdRequest)}async shutDown(){this._hostEmitter.off(a.a.telemetryEvent),this._hostEmitter.off(a.a.newActivityTelemetryEvent),this._hostEmitter.off(a.a.activityAddDataFieldTelemetryEvent),this._hostEmitter.off(a.a.activitySetResultTelemetryEvent),this._hostEmitter.off(a.a.activitySetSuccessTelemetryEvent),this._hostEmitter.off(a.a.activityEndNowTelemetryEvent),this._hostEmitter.off(a.a.otelClientIdRequest)}cleanupActivities(){Object.keys(this._remoteObjects).forEach(e=>{const t=this._remoteObjects[e];t&&i.a()-t.startTime>36e8&&delete this._remoteObjects[e]})}};l=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)(),c(0,Object(r.inject)(o.a.IHostEmitter)),c(1,Object(r.inject)(o.a.ILogger))],l)},10623:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1681);let i=class{triggerCallback(e,t){t?(this.userInfo=void 0,this.lastError=t):this.lastError=void 0,this.userInfo=e(this.userInfo)}async executeAsync(e=!0){return new Promise((t,n)=>{this.execute(e,e=>(this.lastError?n(this.lastError):t(e),e))})}};i=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],i)},10624:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"BrowserInfo",(function(){return r})),n.d(t,"NodeInfo",(function(){return i})),n.d(t,"BotInfo",(function(){return o})),n.d(t,"detectBrowser",(function(){return c})),n.d(t,"parseUserAgent",(function(){return l})),n.d(t,"getNodeVersion",(function(){return u}));class r{constructor(e,t){this.name=e,this.version=t}}class i{constructor(e){this.version=e,this.name="node"}}class o{constructor(){this.bot=!0,this.name="bot",this.version=null}}const a=3,s=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]];function c(e){return e?l(e):navigator?l(navigator.userAgent):u()}function l(e){const t=""!==e&&s.reduce((t,[n,r])=>{if(t)return t;const i=r.exec(e);return!!i&&[n,i]},!1);if(!t)return null;const[n,i]=t;if("searchbot"===n)return new o;let c=i[1]&&i[1].split(/[._]/).slice(0,3);return c?c.length<a&&(c=[...c,...d(a-c.length)]):c=[],new r(n,c.join("."))}function u(){return e&&e.version?new i(e.version.slice(1)):null}function d(e){const t=[];for(let n=0;n<e;n+=1)t.push("0");return t}}.call(this,n(136))},10625:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1681);let i=class{getUrl(e){return e}};i=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],i)},10626:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1681);let i=class{getUILanguage(){return navigator.language}async getBrowserLanguages(){return Promise.resolve([navigator.language])}};i=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],i)},10640:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email"}(r||(r={}))},10641:function(e){e.exports=JSON.parse('{"d":"ydc","e":"zdc","a":"Adc","b":"Bdc","c":"Cdc"}')},1073:function(e,t,n){"use strict";var r=n(1062);n.d(t,"a",(function(){return r.b}))},11209:function(e,t,n){"use strict";var r=n(1681),i=n(3234),o=n(7531),a=n(4994);let s=class{async initialize(e){}addCorrelationID(e){}log(e,t,n,r){this.dispatchLog(null,e,t,n,r)}debug(e,t,n){this.dispatchLog(null,e,a.e.Debug,t,n)}error(e,t,n){this.dispatchLog(null,e,a.e.Error,t,n)}warn(e,t,n){this.dispatchLog(null,e,a.e.Warn,t,n)}info(e,t,n){this.dispatchLog(null,e,a.e.Info,t,n)}logEvent(e,t,n,r,i,o){this.dispatchLog(t,e,n,r,o)}dispatchLog(e,t,n,r,i){switch(n){case a.e.Debug:case a.e.Error:case a.e.Info:case a.e.Warn:break;default:throw new Error("Invalid logging level")}}};s=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],s),n.d(t,"a",(function(){return l}));var c=function(e,t){return function(n,r){t(n,r,e)}};let l=class{constructor(e,t){this._transports=e,this._activityTransport=t,this._debugMode=!1,this._initialized=!1,this._initializing=!1}async initialize(e,t,n){if(!this._initialized){if(!this._initializing)try{this._debugMode=await e.read(o.a.DebugMode),this._debugMode&&this._transports.push(new s);for(const r of this._transports)await r.initialize(e,t,n);this._activityTransport&&await this._activityTransport.initialize(e,t,n)}finally{this._initializing=!1}this._initialized=!0}}addCorrelationID(e){for(const t of this._transports)t.addCorrelationID(e);this._activityTransport&&this._activityTransport.addCorrelationID(e)}log(e,t,n,r){this.logEvent(e,null,t,n,a.f.Measure,r)}info(e,t,n){this.logEvent(e,null,a.e.Info,t,a.f.Measure,n)}warn(e,t,n){this.logEvent(e,null,a.e.Warn,t,a.f.Measure,n)}error(e,t,n){this.logEvent(e,null,a.e.Error,t,a.f.CriticalBusinessImpact,n)}debug(e,t,n){this.logEvent(e,null,a.e.Debug,t,a.f.Diagnostics,n)}logServiceRequest(e,t,n,r,i){for(const o of this._transports)t&&(o.serviceRequestID=t),this.logEvent(e,null,n,r,a.f.Measure,i)}logEvent(e,t,n,r,i,o,s){if(this._initialized&&(this._debugMode||n!==a.e.Debug))for(const a of this._transports)a.logEvent(e,t,n,r,i,o,s)}getNewActivity(e,t,n){return this._initialized&&this._activityTransport?this._activityTransport.getNewActivity(e,t,n):void 0}};l=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)(),c(0,Object(r.multiInject)(i.a.ITransportLogger)),c(1,Object(r.inject)(i.a.ITransportActivity))],l)},11210:function(e,t,n){"use strict";var r=n(15162),i=n(1681),o=n(3234),a=n(7531),s=n(4994);class c{constructor(e){this._activityScope=e}setSuccess(e){this._activityScope.setSuccess(e)}setResult(e,t,n){this._activityScope.setResult(e,t,n)}get startTime(){return this._activityScope.startTime}addDataField(e,t,n){const r=n;this._activityScope.addDataField(e,null==t?"":t,r)}async endNow(){return this._activityScope.endNow().then(e=>({eventAccepted:e.eventAccepted,message:e.message}))}}n.d(t,"a",(function(){return d}));var l,u=function(e,t){return function(n,r){t(n,r,e)}};let d=l=class{constructor(e){this._userInfoStrategy=e,this._appId="",this._initialized=!1,this._initializing=!1,this._enableOptionalDiagnostic=!0,this._configurationId="",this.requiredDiagnosticEventCategoryName=new Set(["ExtensionInstalled","BackgroundScriptInitialization","ContentScriptLifetime","SignInInitialized"]),this.requiredUnsignedInEventCategoryName=new Set(["AnnouncementShown","AnnouncementDismissed","AnnouncementClickedThrough"])}async initialize(e,t,n){if(!this._initialized){if(!this._initializing){let i;this._initializing=!0;try{i=JSON.parse(await e.read(a.a.TelemetryTenant))}catch(t){i=JSON.parse(e.getDefaultValue(a.a.TelemetryTenant))}try{const o=await e.read(a.a.LogGroupName),s=await e.read(a.a.SendToAria),c=await e.read(a.a.DefaultEventName),l=await e.read(a.a.DefaultLoggingLevel),u=await e.read(a.a.AppId);if(this._configurationId=await e.read(a.a.ConfigurationId),this._namespace=["Office",i.tenantName,o].join("."),this._defaultEventName=[this._namespace,c].join("."),this._loggingLevel=l,this._appId=u,this._sessionContext=t,this._enableOptionalDiagnostic=await e.read(a.a.EnableTelemetry),n&&n.on("enableTelemetry",async()=>{this._enableOptionalDiagnostic=await e.read(a.a.EnableTelemetry)}),!r.STE.isContextSet()){const e={};t&&(e["Device.OsVersion"]=t.os),r.STE.setContext(e)}r.STE.setTml({Office:{[i.tenantName]:{ariaTenantToken:i.ariaTenantToken,nexusTenantToken:i.nexusTenantToken,[o]:{}}}}),s&&r.STE.setAriaSendEventEnabled(!0)}finally{this._initializing=!1}}this._initialized=!0}}logEvent(e,t,n,r,i,o,a){if(this._initialized&&this._defaultEventName){let s=this._defaultEventName;t&&(s=[this._namespace,t].join(".")),this.sendLog(s,e,n,r,i,o,a)}}getNewActivity(e,t,n){if(!this._initialized)return;if(!this._enableOptionalDiagnostic&&!this.requiredDiagnosticEventCategoryName.has(e))return;const i=[this._namespace,e].join("."),o=new r.Activity.ActivityScope(i);let a=!0;if(this._userInfoStrategy.execute(!1,e=>(e?(e.userId&&o.addDataField("User_Id",e.userId,r.DataClassification.SystemMetadata),e.tenantId&&o.addDataField("Tenant_Id",e.tenantId,r.DataClassification.SystemMetadata),o.addDataField("Identity_Provider",e.identityProvider,r.DataClassification.SystemMetadata),e.licenseType&&o.addDataField("License_Type",e.licenseType,r.DataClassification.SystemMetadata)):a=!1,e)),a||this.requiredDiagnosticEventCategoryName.has(e)||this.requiredUnsignedInEventCategoryName.has(e)){if(this._sessionContext&&(o.addDataField("Browser_Type",this._sessionContext.browserType,r.DataClassification.SystemMetadata),o.addDataField("Browser_Version",this._sessionContext.browserVersion||"",r.DataClassification.SystemMetadata),o.addDataField("Store_Runtime_Id",this._sessionContext.extensionStoreId||"",r.DataClassification.SystemMetadata),o.addDataField("Extension_Version",this._sessionContext.extensionVersion||"",r.DataClassification.SystemMetadata),o.addDataField("Extension_Version_Name",this._sessionContext.extensionVersionName||"",r.DataClassification.SystemMetadata)),o.addDataField("App_Id",this._appId,r.DataClassification.SystemMetadata),o.addDataField("CorrelationID",this._sessionCorrelationId?this._sessionCorrelationId:"",r.DataClassification.SystemMetadata),o.addDataField("ConfigurationId",this._configurationId,r.DataClassification.SystemMetadata),n){const t=l.createFunnelContract(e,n);o.addDataContract(t)}return new c(o)}}addCorrelationID(e){this._sessionCorrelationId=e}static createFunnelContract(e,t){const n=s.d[t];return new r.Contracts.Office.System.Funnel(e,n)}sendLog(e,t,n,i,o,a,c){if(!this._initialized||void 0===this._loggingLevel)return;if(n>this._loggingLevel)return;let u=[];this.serviceRequestId&&u.push({name:"Service_Request_Id",value:this.serviceRequestId,classification:r.DataClassification.SystemMetadata}),this._sessionContext&&(u.push({name:"Browser_Type",value:this._sessionContext.browserType,classification:r.DataClassification.SystemMetadata}),u.push({name:"Browser_Version",value:this._sessionContext.browserVersion||"",classification:r.DataClassification.SystemMetadata}),u.push({name:"Store_Runtime_Id",value:this._sessionContext.extensionStoreId||"",classification:r.DataClassification.SystemMetadata}),u.push({name:"Extension_Version",value:this._sessionContext.extensionVersion||"",classification:r.DataClassification.SystemMetadata}),u.push({name:"Extension_Version_Name",value:this._sessionContext.extensionVersionName||"",classification:r.DataClassification.SystemMetadata}));let d="",f="",h="";this._userInfoStrategy.execute(!1,e=>(e&&(e.userId&&(d=e.userId),e.tenantId&&(f=e.tenantId),e.identityProvider&&(h=e.identityProvider.toString())),e)),u=u.concat([{name:"Tag",value:t.toString(),classification:r.DataClassification.SystemMetadata},{name:"Tag_Hex",value:t.toString(16),classification:r.DataClassification.SystemMetadata},{name:"Level",value:s.e[n],classification:r.DataClassification.SystemMetadata},{name:"App_Id",value:this._appId,classification:r.DataClassification.SystemMetadata},{name:"User_Id",value:d,classification:r.DataClassification.EndUserIdentifiableInformation},{name:"Tenant_Id",value:f,classification:r.DataClassification.EndUserIdentifiableInformation},{name:"Identity_Provider",value:h,classification:r.DataClassification.SystemMetadata}]),i&&u.push({name:"Message",value:i,classification:r.DataClassification.SystemMetadata}),this._sessionCorrelationId&&u.push({name:"Correlation_Id",value:this._sessionCorrelationId,classification:r.DataClassification.SystemMetadata}),a&&u.push({name:"Data",value:JSON.stringify(a),classification:r.DataClassification.SystemMetadata});const g=[];if(c){const t=l.createFunnelContract(e,c);g.push(t)}r.STE.sendTelemetryEvent({eventName:e,dataFields:u,dataContracts:g,eventFlags:{persistence:r.STE.PersistencePriority.Normal,cost:r.STE.CostPriority.Normal,sampling:o}})}};d=l=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(i.injectable)(),u(0,Object(i.inject)(o.a.IUserInfoStrategy))],d)},11212:function(e,t,n){"use strict";var r=n(3234),i=n(2342),o=n(4995);n(3853);const a={IContentValidator:Symbol.for("IContentValidator"),ILanguageRetriever:r.a.ILanguageRetriever,ILogger:r.a.ILogger,CritiqueEventHandler:Symbol.for("CritiqueEventHandler"),DictionaryCritiqueFilter:Symbol.for("DictionaryCritiqueFilter"),EventHub:Symbol.for("EventHub"),FilteringEventHandler:Symbol.for("FilteringEventHandler"),ICritiqueActionHandler:Symbol.for("ICritiqueActionHandler"),ICritiqueContextValidator:Symbol.for("ICritiqueContextValidator"),ICritiqueDispatcher:Symbol.for("ICritiqueDispatcher"),ICritiqueInterpreter:Symbol.for("ICritiqueInterpreter"),ICritiqueStore:Symbol.for("ICritiqueStore"),ICritiquesBrokerFactory:Symbol.for("ICritiquesBrokerFactory"),IProofingPersistedStore:r.a.IProofingPersistedStore,ITextExtractor:o.a.ITextExtractor,NodeEventHandler:Symbol.for("NodeEventHandler"),SpanEventHandler:Symbol.for("SpanEventHandler"),IHighContrastModeDetector:Symbol.for("IHighContrastModeDetector"),ILanguageScriptDirectionDetector:Symbol.for("ILanguageScriptDirectionDetector"),IUxLanguageDetector:Symbol.for("IUxLanguageDetector"),IHostEmitterArray:r.a.IHostEmitterArray,IProofingEmitter:r.a.IProofingEmitter,IHostSettings:i.a.IHostSettings,IProofingDom:i.a.IProofingDom,IPresentationSettings:Symbol.for("IPresentationSettings"),IWordDictionary:i.a.IWordDictionary,ICritiqueFilterer:i.a.ICritiqueFilterer};n.d(t,"a",(function(){return s}));const s={IFeatureFlagsReader:r.a.IFeatureFlagsReader,IHostSettings:r.a.IHostSettings,IInstrumentationMessageProcessor:r.a.IInstrumentationMessageProcessor,ILocalizer:r.a.ILocalizer,ILogger:r.a.ILogger,IProofingPersistedStore:r.a.IProofingPersistedStore,IResourceUrlFormatter:r.a.IResourceUrlFormatter,IShowSynonymsFeature:r.a.IShowSynonymsFeature,IUpsellFeature:r.a.IUpsellFeature,IRoamingDictionaryFeature:r.a.IRoamingDictionaryFeature,IExternalSettingsFeature:r.a.IExternalSettingsFeature,IUnsignedInEditorFeature:r.a.IUnsignedInEditorFeature,ICalloutFocusManager:Symbol.for("ICalloutFocusManager"),ICritiqueCalloutStateStore:Symbol.for("ICritiqueCalloutStateStore"),IDropdownStateStoreFactory:Symbol.for("IDropdownStateStoreFactory"),ISuggestionButtonStateStore:Symbol.for("ISuggestionButtonStateStore"),ISuggestionButtonStateStoreFactory:Symbol.for("ISuggestionButtonStateStoreFactory"),SuggestionButton:Symbol.for("SuggestionButton"),ISquigglerStateStoreFactory:Symbol.for("ISquigglerStateStoreFactory"),ISquiggleStateStoreFactory:Symbol.for("ISquiggleStateStoreFactory"),ISquiggleTooltipStateStore:Symbol.for("ISquiggleTooltipStateStore"),ISquiggleTooltipStateStoreFactory:Symbol.for("ISquiggleTooltipStateStoreFactory"),IContentValidator:a.IContentValidator,ICritiqueInterpreter:a.ICritiqueInterpreter,ILanguageScriptDirectionDetector:a.ILanguageScriptDirectionDetector,IPresentationSettings:a.IPresentationSettings,IWordDictionary:a.IWordDictionary,IPresentationDomSettings:Symbol.for("IPresentationDomSettings"),IStyleDefinitions:Symbol.for("IPresentationDomStyleDefinitions"),IUpsellStore:i.a.IUpsellStore,IShadowElementPropsFactory:Symbol.for("IShadowElementPropsFactory"),IShadowElementStateFactory:Symbol.for("IShadowElementStateFactory"),ITextRetrieverFactory:o.a.ITextRetrieverFactory}},1271:function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(1273),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(122))},1273:function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i,o,a,s,c=1,l={},u=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){g(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){g(e.data)},r=function(e){o.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,r=function(e){var t=d.createElement("script");t.onreadystatechange=function(){g(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):r=function(e){setTimeout(g,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&g(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),r=function(t){e.postMessage(a+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return l[c]=i,r(c),c++},f.clearImmediate=h}function h(e){delete l[e]}function g(e){if(u)setTimeout(g,0,e);else{var t=l[e];if(t){u=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}(t)}finally{h(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(122),n(136))},15129:function(e){e.exports=JSON.parse('{"b":"Ddc","a":"Edc","i":"Fdc","e":"Gdc","f":"Hdc","h":"Idc","g":"Jdc","d":"Kdc","c":"Ldc","k":"Mdc","j":"Ndc"}')},15130:function(e,t,n){(t=e.exports=n(106)(!1)).push([e.i,'._2vu6nHbBMYeBeGWSvjGGe3{color:"[theme:themePrimary, default:#0078D4]";font-size:16px}html[dir=ltr] ._2vu6nHbBMYeBeGWSvjGGe3{margin-right:5px}html[dir=rtl] ._2vu6nHbBMYeBeGWSvjGGe3{margin-left:5px}._2ES3fWQLAEojIJTfsimZI4{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}._2ES3fWQLAEojIJTfsimZI4,._1B1cG4KkIkBXxwvZHW7GGW{display:-webkit-box;display:-ms-flexbox;display:flex}._1B1cG4KkIkBXxwvZHW7GGW{min-width:0!important}html[dir] ._1B1cG4KkIkBXxwvZHW7GGW{padding:6px;border:1px solid;border-color:"[theme:neutralLight, default:#edebe9]"!important}html[dir=ltr] ._1B1cG4KkIkBXxwvZHW7GGW{-webkit-box-shadow:2px 2px "[theme:neutralLight, default:#edebe9]";box-shadow:2px 2px "[theme:neutralLight, default:#edebe9]"}html[dir=rtl] ._1B1cG4KkIkBXxwvZHW7GGW{-webkit-box-shadow:-2px 2px "[theme:neutralLight, default:#edebe9]";box-shadow:-2px 2px "[theme:neutralLight, default:#edebe9]"}html[dir] ._1B1cG4KkIkBXxwvZHW7GGW:hover{background-color:"[theme:neutralLighterAlt, default:#faf9f8]"}.CtFKmac3lOrS-OaDyX4Pj{color:"[theme:themeDark, default:#0D62AA]";font-size:12px}._3rwNwM0PfIa6B2e-BrohjF{color:"[theme:themePrimary, default:#0078D4]";font-weight:700;font-size:14px;font-weight:400}html[dir=ltr] ._3rwNwM0PfIa6B2e-BrohjF{margin-right:3px}html[dir=rtl] ._3rwNwM0PfIa6B2e-BrohjF{margin-left:3px}._3rwNwM0PfIa6B2e-BrohjF._2U8NfTxNV9779HJvK3SpmC{display:none}.qNBF68_DAEGvoOurje0Jy{font-size:14px;font-weight:400;width:292px;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;display:-webkit-box;display:-ms-flexbox;display:flex}html[dir] .qNBF68_DAEGvoOurje0Jy{margin:15px 15px 7px 15px}._160mp_Po1qvAddzJWUD56D{color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._12QqW0IKgo0CaT4lCC2udh{padding:10px 15px 10px 5px}html[dir=rtl] ._12QqW0IKgo0CaT4lCC2udh{padding:10px 5px 10px 15px}.ZFd6ioKVXyTRkmnz8z8AF{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}html[dir] .ZFd6ioKVXyTRkmnz8z8AF{background-color:"[theme:neutralLight, default:#edebe9]"}._16auZW0uSiGbxCcy5KAM9X{font-size:14px;font-weight:400;font-weight:700}html[dir] ._14K7rZiTBxnBkUZTZveLV8{margin-top:7px}._2wgViKiTD8LcrYUtE8Nl8F{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}html[dir] ._2wgViKiTD8LcrYUtE8Nl8F{padding-top:10px}html[dir=ltr] ._2wgViKiTD8LcrYUtE8Nl8F{padding-right:10px}html[dir=rtl] ._2wgViKiTD8LcrYUtE8Nl8F{padding-left:10px}.Ujife4nUKFI71K6CECbHy{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;width:338px;height:360px}._1S0D_60rcy6LiZF4SmOSy-{-ms-flex-item-align:center;align-self:center}html[dir] ._1S0D_60rcy6LiZF4SmOSy-{padding-top:25px}html[dir=ltr] ._1S0D_60rcy6LiZF4SmOSy-{padding-left:24px}html[dir=rtl] ._1S0D_60rcy6LiZF4SmOSy-{padding-right:24px}._3FsjbnMHqbOe95d0uO3Dx{-ms-flex-item-align:center;align-self:center}html[dir] ._3FsjbnMHqbOe95d0uO3Dx{padding-top:10px}html[dir=ltr] ._3FsjbnMHqbOe95d0uO3Dx{padding-left:24px}html[dir=rtl] ._3FsjbnMHqbOe95d0uO3Dx{padding-right:24px}._3n0QDMOghSjefXJF9Eqkqp{font-size:17px;font-weight:300;color:"[theme:themePrimary, default:#0078D4]";-ms-flex-item-align:center;align-self:center;font-size:16px;font-weight:600}html[dir] ._3n0QDMOghSjefXJF9Eqkqp{padding-top:10px}._3irJridJew5-I084uJvETr{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around}.re-atOySKAJZv1OiOrHwZ{font-size:12px;font-weight:600}html[dir] .re-atOySKAJZv1OiOrHwZ{text-align:center;padding:10px 15px 15px 15px}._2PUBWaPuzz8jgy0AQlRCiJ .ms-Dialog-main{max-width:450px}html[dir=ltr] .pIucPmrgZovuHrgmbi-rP{padding-left:5px}html[dir=rtl] .pIucPmrgZovuHrgmbi-rP{padding-right:5px}._2oP95ia0WbqNecorS6f8Tx{font-size:12px}html[dir=ltr] ._2oP95ia0WbqNecorS6f8Tx{padding-right:5px}html[dir=rtl] ._2oP95ia0WbqNecorS6f8Tx{padding-left:5px}._3h2F0teYDuRazaFSQGdJRS{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._3JH7ifM1YpFA9XfAW2o6J5{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;height:40px}._3qMg1YOJiia_YaMhCuIYee{font-size:16px}html[dir=ltr] ._3qMg1YOJiia_YaMhCuIYee{margin-right:5px}html[dir=rtl] ._3qMg1YOJiia_YaMhCuIYee{margin-left:5px}',""]),t.locals={skittleDiamonIcon:"_2vu6nHbBMYeBeGWSvjGGe3",skittleContainer:"_2ES3fWQLAEojIJTfsimZI4",skittleInfo:"_1B1cG4KkIkBXxwvZHW7GGW",goPremiumLink:"CtFKmac3lOrS-OaDyX4Pj",skittleCount:"_3rwNwM0PfIa6B2e-BrohjF",hideCount:"_2U8NfTxNV9779HJvK3SpmC",skittleCountContainer:"qNBF68_DAEGvoOurje0Jy",premimumFlagsFound:"_160mp_Po1qvAddzJWUD56D",linkInnerContainer:"_12QqW0IKgo0CaT4lCC2udh",linkContainer:"ZFd6ioKVXyTRkmnz8z8AF",calloutTitle:"_16auZW0uSiGbxCcy5KAM9X",skittleCalloutTextContainer:"_14K7rZiTBxnBkUZTZveLV8",editorImage:"_2wgViKiTD8LcrYUtE8Nl8F",premPrevSkittleContainer:"Ujife4nUKFI71K6CECbHy",editorPremPrevImage:"_1S0D_60rcy6LiZF4SmOSy-",editorPremPrevImageDialog:"_3FsjbnMHqbOe95d0uO3Dx",premPrevTitle:"_3n0QDMOghSjefXJF9Eqkqp",premPrevbuttonsContainer:"_3irJridJew5-I084uJvETr",editorPremPrevText:"re-atOySKAJZv1OiOrHwZ",dialogBox:"_2PUBWaPuzz8jgy0AQlRCiJ",premimumpreviewDaysText:"pIucPmrgZovuHrgmbi-rP",goPremiumText:"_2oP95ia0WbqNecorS6f8Tx",skittleCalloutContainer:"_3h2F0teYDuRazaFSQGdJRS",goPremiumButoon:"_3JH7ifM1YpFA9XfAW2o6J5",premiumPreviewDiamonIcon:"_3qMg1YOJiia_YaMhCuIYee"}},15131:function(e,t,n){e.exports=n.p+"../resources/images/EditorUpsell-0f681fbff6a93db2b22ebeed8d01405e.svg"},15132:function(e,t,n){e.exports=n.p+"../resources/images/EditorImage-cbf82dda59d4ed6e4d355723c49c493b.svg"},15133:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(15134),a=n(3703),s=n(4629),c=n(3061),l=n(10582),u=n(15135),d=n(15142),f=n(15144),h=n(5491),g=n(6875),p=n(15147),m=n(15148),y=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+a.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=s.BindingScopeEnum.Transient;else if(t.defaultScope!==s.BindingScopeEnum.Singleton&&t.defaultScope!==s.BindingScopeEnum.Transient&&t.defaultScope!==s.BindingScopeEnum.Request)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=h.id(),this._bindingDictionary=new m.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new l.MetadataReader}return e.merge=function(t,n){var r=new e,i=u.getBindingDictionary(r),o=u.getBindingDictionary(t),a=u.getBindingDictionary(n);function s(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return s(o,i),s(a,i),r},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=e;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r(this,void 0,void 0,(function(){var t,n,r,o,a;return i(this,(function(i){switch(i.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,r=e,i.label=1;case 1:return n<r.length?(o=r[n],a=t(o.id),[4,o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var n=r(t.id);e._bindingDictionary.removeByCondition(n)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||s.BindingScopeEnum.Transient,n=new o.Binding(e,t);return this._bindingDictionary.add(e,n),new f.BindingToSyntax(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(a.CANNOT_UNBIND+" "+g.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new m.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,c.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,n){var r=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=u.createMockRequest(this,e,t,n);r=i.some((function(e){return e.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(e,t,n)),r},e.prototype.snapshot=function(){this._snapshots.push(p.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(a.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,s.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,s.TargetTypeEnum.Variable,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,c.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,s.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,s.TargetTypeEnum.Variable,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,c.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(r){var i=e.rebind.bind(e)(r);return t(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=e.bind.bind(e)(n);return t(r,i),r}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(r),unbindFunction:function(t){e.unbind.bind(e)(t)}};var i}},e.prototype._get=function(e,t,n,r,i,o){var s=null,c={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(null==(s=this._middleware(c)))throw new Error(a.INVALID_MIDDLEWARE_RETURN)}else s=this._planAndResolve()(c);return s},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=u.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return n=t.contextInterceptor(n),d.resolve(n)}},e}();t.Container=y},15134:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4629),i=n(5491),o=function(){function e(e,t){this.id=i.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=!1,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();t.Binding=o},15135:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15136),i=n(3703),o=n(4629),a=n(3061),s=n(10583),c=n(6875),l=n(15137),u=n(4098),d=n(15138),f=n(15139),h=n(15141),g=n(10585);function p(e){return e._bindingDictionary}function m(e,t,n,o,a){var s=y(n.container,a.serviceIdentifier),l=[];return s.length===r.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof a.serviceIdentifier&&e.getConstructorMetadata(a.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(a.serviceIdentifier).toSelf(),s=y(n.container,a.serviceIdentifier)),l=t?s:s.filter((function(e){var t=new h.Request(e.serviceIdentifier,n,o,e,a);return e.constraint(t)})),function(e,t,n,o){switch(t.length){case r.BindingCount.NoBindingsAvailable:if(n.isOptional())return t;var a=c.getServiceIdentifierAsString(e),s=i.NOT_REGISTERED;throw s+=c.listMetadataForTarget(a,n),s+=c.listRegisteredBindingsForServiceIdentifier(o,a,y),new Error(s);case r.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return t;case r.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return t;a=c.getServiceIdentifierAsString(e),s=i.AMBIGUOUS_MATCH+" "+a;throw s+=c.listRegisteredBindingsForServiceIdentifier(o,a,y),new Error(s)}}(a.serviceIdentifier,l,a,n.container),l}function y(e,t){var n=[],r=p(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=y(e.parent,t)),n}t.getBindingDictionary=p,t.plan=function(e,t,n,r,p,y,b,v){void 0===v&&(v=!1);var _=new l.Context(t),I=function(e,t,n,r,i,o){var s=e?a.MULTI_INJECT_TAG:a.INJECT_TAG,c=new u.Metadata(s,n),l=new g.Target(t,r,n,c);if(void 0!==i){var d=new u.Metadata(i,o);l.metadata.push(d)}return l}(n,r,p,"",y,b);try{return function e(t,n,r,a,s,c){var l,u;if(null===s){l=m(t,n,a,null,c),u=new h.Request(r,a,null,l,c);var g=new d.Plan(a,u);a.addPlan(g)}else l=m(t,n,a,s,c),u=s.addChildRequest(c.serviceIdentifier,l,c);l.forEach((function(n){var r=null;if(c.isArray())r=u.addChildRequest(n.serviceIdentifier,n,c);else{if(n.cache)return;r=u}if(n.type===o.BindingTypeEnum.Instance&&null!==n.implementationType){var s=f.getDependencies(t,n.implementationType);if(!a.container.options.skipBaseClassChecks){var l=f.getBaseClassDependencyCount(t,n.implementationType);if(s.length<l){var d=i.ARGUMENTS_LENGTH_MISMATCH(f.getFunctionName(n.implementationType));throw new Error(d)}}s.forEach((function(n){e(t,!1,n.serviceIdentifier,a,r,n)}))}}))}(e,v,p,_,null,I),_}catch(e){throw s.isStackOverflowExeption(e)&&_.plan&&c.circularDependencyToException(_.plan.rootRequest),e}},t.createMockRequest=function(e,t,n,r){var i=new g.Target(o.TargetTypeEnum.Variable,"",t,new u.Metadata(n,r)),a=new l.Context(e);return new h.Request(t,a,null,[],i)}},15136:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},15137:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5491),i=function(){function e(e){this.id=r.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();t.Context=i},15138:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){this.parentContext=e,this.rootRequest=t};t.Plan=r},15139:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10584),i=n(3703),o=n(4629),a=n(3061),s=n(6875);t.getFunctionName=s.getFunctionName;var c=n(10585);function l(e,t,n,r){var a=e.getConstructorMetadata(n),s=a.compilerGeneratedMetadata;if(void 0===s){var l=i.MISSING_INJECTABLE_ANNOTATION+" "+t+".";throw new Error(l)}var f=a.userGeneratedMetadata,h=Object.keys(f),g=function(e,t,n,r,i){for(var o=[],a=0;a<i;a++){var s=u(a,e,t,n,r);null!==s&&o.push(s)}return o}(r,t,s,f,0===n.length&&h.length>0?h.length:n.length),p=function e(t,n){for(var r=t.getPropertiesMetadata(n),i=[],a=Object.keys(r),s=0,l=a;s<l.length;s++){var u=l[s],f=r[u],h=d(r[u]),g=h.targetName||u,p=h.inject||h.multiInject,m=new c.Target(o.TargetTypeEnum.ClassProperty,g,p);m.metadata=f,i.push(m)}var y=Object.getPrototypeOf(n.prototype).constructor;if(y!==Object){var b=e(t,y);i=i.concat(b)}return i}(e,n);return g.concat(p)}function u(e,t,n,a,s){var l=s[e.toString()]||[],u=d(l),f=!0!==u.unmanaged,h=a[e],g=u.inject||u.multiInject;if((h=g||h)instanceof r.LazyServiceIdentifer&&(h=h.unwrap()),f){if(!t&&(h===Object||h===Function||void 0===h)){var p=i.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+n+".";throw new Error(p)}var m=new c.Target(o.TargetTypeEnum.ConstructorArgument,u.targetName,h);return m.metadata=l,m}return null}function d(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[a.INJECT_TAG],multiInject:t[a.MULTI_INJECT_TAG],targetName:t[a.NAME_TAG],unmanaged:t[a.UNMANAGED_TAG]}}t.getDependencies=function(e,t){return l(e,s.getFunctionName(t),t,!1)},t.getBaseClassDependencyCount=function e(t,n){var r=Object.getPrototypeOf(n.prototype).constructor;if(r!==Object){var i=l(t,s.getFunctionName(r),r,!0),o=i.map((function(e){return e.metadata.filter((function(e){return e.key===a.UNMANAGED_TAG}))})),c=[].concat.apply([],o).length,u=i.length-c;return u>0?u:e(t,r)}return 0}},15140:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();t.QueryableString=r},15141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5491),i=function(){function e(e,t,n,i,o){this.id=r.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var i=new e(t,this.parentContext,this,n,r);return this.childRequests.push(i),i},e}();t.Request=i},15142:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3703),i=n(4629),o=n(10583),a=n(6875),s=n(15143),c=function(e,t,n){try{return n()}catch(n){throw o.isStackOverflowExeption(n)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):n}},l=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,o=t.childRequests,u=t.target&&t.target.isArray(),d=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(u&&d)return o.map((function(t){return l(e)(t)}));var f=null;if(!t.target.isOptional()||0!==n.length){var h=n[0],g=h.scope===i.BindingScopeEnum.Singleton,p=h.scope===i.BindingScopeEnum.Request;if(g&&h.activated)return h.cache;if(p&&null!==e&&e.has(h.id))return e.get(h.id);if(h.type===i.BindingTypeEnum.ConstantValue)f=h.cache;else if(h.type===i.BindingTypeEnum.Function)f=h.cache;else if(h.type===i.BindingTypeEnum.Constructor)f=h.implementationType;else if(h.type===i.BindingTypeEnum.DynamicValue&&null!==h.dynamicValue)f=c("toDynamicValue",h.serviceIdentifier,(function(){return h.dynamicValue(t.parentContext)}));else if(h.type===i.BindingTypeEnum.Factory&&null!==h.factory)f=c("toFactory",h.serviceIdentifier,(function(){return h.factory(t.parentContext)}));else if(h.type===i.BindingTypeEnum.Provider&&null!==h.provider)f=c("toProvider",h.serviceIdentifier,(function(){return h.provider(t.parentContext)}));else{if(h.type!==i.BindingTypeEnum.Instance||null===h.implementationType){var m=a.getServiceIdentifierAsString(t.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+m)}f=s.resolveInstance(h.implementationType,o,l(e))}return"function"==typeof h.onActivation&&(f=h.onActivation(t.parentContext,f)),g&&(h.cache=f,h.activated=!0),p&&null!==e&&!e.has(h.id)&&e.set(h.id,f),f}}};t.resolve=function(e){return l(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}},15143:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3703),i=n(4629),o=n(3061);t.resolveInstance=function(e,t,n){var a,s,c=null;if(t.length>0){var l=t.filter((function(e){return null!==e.target&&e.target.type===i.TargetTypeEnum.ConstructorArgument})).map(n);s=l,c=function(e,t,n){var r=t.filter((function(e){return null!==e.target&&e.target.type===i.TargetTypeEnum.ClassProperty})),o=r.map(n);return r.forEach((function(t,n){var r;r=t.target.name.value();var i=o[n];e[r]=i})),e}(c=new((a=e).bind.apply(a,[void 0].concat(s))),t,n)}else c=new e;return function(e,t){if(Reflect.hasMetadata(o.POST_CONSTRUCT,e)){var n=Reflect.getMetadata(o.POST_CONSTRUCT,e);try{t[n.value]()}catch(t){throw new Error(r.POST_CONSTRUCT_ERROR(e.name,t.message))}}}(e,c),c}},15144:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3703),i=n(4629),o=n(15145),a=n(10586),s=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=e,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(r.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=i.BindingTypeEnum.Function,t},e.prototype.toAutoFactory=function(e){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},new a.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}();t.BindingToSyntax=s},15145:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15146),i=n(9173),o=n(9174),a=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingInWhenOnSyntax=a},15146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4629),i=n(10586),o=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},e}();t.BindingInSyntax=o},15147:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.of=function(t,n){var r=new e;return r.bindings=t,r.middleware=n,r},e}();t.ContainerSnapshot=r},15148:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3703),i=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(r.NULL_ARGUMENT);if(null==t)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(r.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(r.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null==e)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(r.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,r){var i=n.filter((function(t){return!e(t)}));i.length>0?t._map.set(r,i):t._map.delete(r)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error(r.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}();t.Lookup=i},15149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5491),i=function(e){this.id=r.id(),this.registry=e};t.ContainerModule=i;var o=function(e){this.id=r.id(),this.registry=e};t.AsyncContainerModule=o},15150:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3703),i=n(3061);t.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,e))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(i.PARAM_TYPES,t,e),e}}},15151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4098),i=n(4993);t.tagged=function(e,t){return function(n,o,a){var s=new r.Metadata(e,t);"number"==typeof a?i.tagParameter(n,o,a,s):i.tagProperty(n,o,s)}}},15152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3061),i=n(4098),o=n(4993);t.named=function(e){return function(t,n,a){var s=new i.Metadata(r.NAMED_TAG,e);"number"==typeof a?o.tagParameter(t,n,a,s):o.tagProperty(t,n,s)}}},15153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3061),i=n(4098),o=n(4993);t.optional=function(){return function(e,t,n){var a=new i.Metadata(r.OPTIONAL_TAG,!0);"number"==typeof n?o.tagParameter(e,t,n,a):o.tagProperty(e,t,a)}}},15154:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3061),i=n(4098),o=n(4993);t.unmanaged=function(){return function(e,t,n){var a=new i.Metadata(r.UNMANAGED_TAG,!0);o.tagParameter(e,t,n,a)}}},15155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3061),i=n(4098),o=n(4993);t.multiInject=function(e){return function(t,n,a){var s=new i.Metadata(r.MULTI_INJECT_TAG,e);"number"==typeof a?o.tagParameter(t,n,a,s):o.tagProperty(t,n,s)}}},15156:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3061),i=n(4098),o=n(4993);t.targetName=function(e){return function(t,n,a){var s=new i.Metadata(r.NAME_TAG,e);o.tagParameter(t,n,a,s)}}},15157:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3703),i=n(3061),o=n(4098);t.postConstruct=function(){return function(e,t,n){var a=new o.Metadata(i.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,e.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,a,e.constructor)}}},15158:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiBindToService=function(e){return function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){return e.bind(n).toService(t)}))}}}},15159:function(e,t,n){"use strict";t.__esModule=!0;var r=function(e,t){for(var n=!1,r=0;r<e.length;r+=1)e[r]===t&&(n=!0,e.splice(r,1),r-=1);return n},i=function(){function e(){this.anyRegistrations=[],this.registrations={}}return e.prototype.on=function(e,t){this.safelyGetRegistration(e).listeners.push(t)},e.prototype.onFirst=function(e,t){var n=this.safelyGetRegistration(e);void 0!==n.firstArgs&&t.apply(void 0,n.firstArgs),n.firstOnlyListeners.push(t)},e.prototype.onAny=function(e){this.anyRegistrations.push(e)},e.prototype.off=function(e,t){if(void 0!==e)if(void 0!==t){var n=this.safelyGetRegistration(e),i=r(n.listeners,t),o=r(n.firstOnlyListeners,t);if(!i&&!o)throw new Error("Tried to remove a non-existent listener for event name '"+e+"'.")}else this.registrations[e]={firstOnlyListeners:[],listeners:[]};else this.registrations={}},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.safelyGetRegistration(e);if(void 0===r.firstArgs){for(var i=0,o=r.firstOnlyListeners;i<o.length;i++){var a=o[i];a.apply(void 0,t)}r.firstArgs=t,r.firstOnlyListeners=[]}for(var s=0,c=r.listeners;s<c.length;s++){c[s].apply(void 0,t)}for(var l=0,u=this.anyRegistrations;l<u.length;l++){u[l].apply(void 0,[e].concat(t))}},e.prototype.waitFor=function(e){var t=this;return new Promise((function(n){var r=function(i){n(i),t.off(e,r)};t.on(e,r)}))},e.prototype.waitForFirst=function(e){var t=this;return new Promise((function(n){var r=function(i){n(i),t.off(e,r)};t.onFirst(e,r)}))},e.prototype.safelyGetRegistration=function(e){return void 0===this.registrations[e]&&(this.registrations[e]={firstOnlyListeners:[],listeners:[]}),this.registrations[e]},e}();t.EventEmitter=i,t.Squee=i},15160:function(e,t){function n(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}n.Diff,n.prototype.diff_main=function(e,t,n,r){void 0===r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var i=r;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[[0,e]]:[];void 0===n&&(n=!0);var o=n,a=this.diff_commonPrefix(e,t),s=e.substring(0,a);e=e.substring(a),t=t.substring(a),a=this.diff_commonSuffix(e,t);var c=e.substring(e.length-a);e=e.substring(0,e.length-a),t=t.substring(0,t.length-a);var l=this.diff_compute_(e,t,o,i);return s&&l.unshift([0,s]),c&&l.push([0,c]),this.diff_cleanupMerge(l),l},n.prototype.diff_compute_=function(e,t,n,r){var i;if(!e)return[[1,t]];if(!t)return[[-1,e]];var o=e.length>t.length?e:t,a=e.length>t.length?t:e,s=o.indexOf(a);if(-1!=s)return i=[[1,o.substring(0,s)],[0,a],[1,o.substring(s+a.length)]],e.length>t.length&&(i[0][0]=i[2][0]=-1),i;if(1==a.length)return[[-1,e],[1,t]];var c=this.diff_halfMatch_(e,t);if(c){var l=c[0],u=c[1],d=c[2],f=c[3],h=c[4],g=this.diff_main(l,d,n,r),p=this.diff_main(u,f,n,r);return g.concat([[0,h]],p)}return n&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,r):this.diff_bisect_(e,t,r)},n.prototype.diff_lineMode_=function(e,t,n){e=(u=this.diff_linesToChars_(e,t)).chars1,t=u.chars2;var r=u.lineArray,i=this.diff_main(e,t,!1,n);this.diff_charsToLines_(i,r),this.diff_cleanupSemantic(i),i.push([0,""]);for(var o=0,a=0,s=0,c="",l="";o<i.length;){switch(i[o][0]){case 1:s++,l+=i[o][1];break;case-1:a++,c+=i[o][1];break;case 0:if(a>=1&&s>=1){i.splice(o-a-s,a+s),o=o-a-s;for(var u,d=(u=this.diff_main(c,l,!1,n)).length-1;d>=0;d--)i.splice(o,0,u[d]);o+=u.length}s=0,a=0,c="",l=""}o++}return i.pop(),i},n.prototype.diff_bisect_=function(e,t,n){for(var r=e.length,i=t.length,o=Math.ceil((r+i)/2),a=o,s=2*o,c=new Array(s),l=new Array(s),u=0;u<s;u++)c[u]=-1,l[u]=-1;c[a+1]=0,l[a+1]=0;for(var d=r-i,f=d%2!=0,h=0,g=0,p=0,m=0,y=0;y<o&&!((new Date).getTime()>n);y++){for(var b=-y+h;b<=y-g;b+=2){for(var v=a+b,_=(T=b==-y||b!=y&&c[v-1]<c[v+1]?c[v+1]:c[v-1]+1)-b;T<r&&_<i&&e.charAt(T)==t.charAt(_);)T++,_++;if(c[v]=T,T>r)g+=2;else if(_>i)h+=2;else if(f){if((C=a+d-b)>=0&&C<s&&-1!=l[C])if(T>=(S=r-l[C]))return this.diff_bisectSplit_(e,t,T,_,n)}}for(var I=-y+p;I<=y-m;I+=2){for(var S,C=a+I,O=(S=I==-y||I!=y&&l[C-1]<l[C+1]?l[C+1]:l[C-1]+1)-I;S<r&&O<i&&e.charAt(r-S-1)==t.charAt(i-O-1);)S++,O++;if(l[C]=S,S>r)m+=2;else if(O>i)p+=2;else if(!f){if((v=a+d-I)>=0&&v<s&&-1!=c[v]){var T;_=a+(T=c[v])-v;if(T>=(S=r-S))return this.diff_bisectSplit_(e,t,T,_,n)}}}}return[[-1,e],[1,t]]},n.prototype.diff_bisectSplit_=function(e,t,n,r,i){var o=e.substring(0,n),a=t.substring(0,r),s=e.substring(n),c=t.substring(r),l=this.diff_main(o,a,!1,i),u=this.diff_main(s,c,!1,i);return l.concat(u)},n.prototype.diff_linesToChars_=function(e,t){var n=[],r={};function i(e){for(var t="",i=0,o=-1,a=n.length;o<e.length-1;){-1==(o=e.indexOf("\n",i))&&(o=e.length-1);var s=e.substring(i,o+1);i=o+1,(r.hasOwnProperty?r.hasOwnProperty(s):void 0!==r[s])?t+=String.fromCharCode(r[s]):(t+=String.fromCharCode(a),r[s]=a,n[a++]=s)}return t}return n[0]="",{chars1:i(e),chars2:i(t),lineArray:n}},n.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n][1],i=[],o=0;o<r.length;o++)i[o]=t[r.charCodeAt(o)];e[n][1]=i.join("")}},n.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(o,i)==t.substring(o,i)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i},n.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i},n.prototype.diff_commonOverlap_=function(e,t){var n=e.length,r=t.length;if(0==n||0==r)return 0;n>r?e=e.substring(n-r):n<r&&(t=t.substring(0,n));var i=Math.min(n,r);if(e==t)return i;for(var o=0,a=1;;){var s=e.substring(i-a),c=t.indexOf(s);if(-1==c)return o;a+=c,0!=c&&e.substring(i-a)!=t.substring(0,a)||(o=a,a++)}},n.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;var i=this;function o(e,t,n){for(var r,o,a,s,c=e.substring(n,n+Math.floor(e.length/4)),l=-1,u="";-1!=(l=t.indexOf(c,l+1));){var d=i.diff_commonPrefix(e.substring(n),t.substring(l)),f=i.diff_commonSuffix(e.substring(0,n),t.substring(0,l));u.length<f+d&&(u=t.substring(l-f,l)+t.substring(l,l+d),r=e.substring(0,n-f),o=e.substring(n+d),a=t.substring(0,l-f),s=t.substring(l+d))}return 2*u.length>=e.length?[r,o,a,s,u]:null}var a,s,c,l,u,d=o(n,r,Math.ceil(n.length/4)),f=o(n,r,Math.ceil(n.length/2));return d||f?(a=f?d&&d[4].length>f[4].length?d:f:d,e.length>t.length?(s=a[0],c=a[1],l=a[2],u=a[3]):(l=a[0],u=a[1],s=a[2],c=a[3]),[s,c,l,u,a[4]]):null},n.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],r=0,i=null,o=0,a=0,s=0,c=0,l=0;o<e.length;)0==e[o][0]?(n[r++]=o,a=c,s=l,c=0,l=0,i=e[o][1]):(1==e[o][0]?c+=e[o][1].length:l+=e[o][1].length,i&&i.length<=Math.max(a,s)&&i.length<=Math.max(c,l)&&(e.splice(n[r-1],0,[-1,i]),e[n[r-1]+1][0]=1,r--,o=--r>0?n[r-1]:-1,a=0,s=0,c=0,l=0,i=null,t=!0)),o++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),o=1;o<e.length;){if(-1==e[o-1][0]&&1==e[o][0]){var u=e[o-1][1],d=e[o][1],f=this.diff_commonOverlap_(u,d),h=this.diff_commonOverlap_(d,u);f>=h?(f>=u.length/2||f>=d.length/2)&&(e.splice(o,0,[0,d.substring(0,f)]),e[o-1][1]=u.substring(0,u.length-f),e[o+1][1]=d.substring(f),o++):(h>=u.length/2||h>=d.length/2)&&(e.splice(o,0,[0,u.substring(0,h)]),e[o-1][0]=1,e[o-1][1]=d.substring(0,d.length-h),e[o+1][0]=-1,e[o+1][1]=u.substring(h),o++),o++}o++}},n.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var r=e.charAt(e.length-1),i=t.charAt(0),o=r.match(n.nonAlphaNumericRegex_),a=i.match(n.nonAlphaNumericRegex_),s=o&&r.match(n.whitespaceRegex_),c=a&&i.match(n.whitespaceRegex_),l=s&&r.match(n.linebreakRegex_),u=c&&i.match(n.linebreakRegex_),d=l&&e.match(n.blanklineEndRegex_),f=u&&t.match(n.blanklineStartRegex_);return d||f?5:l||u?4:o&&!s&&c?3:s||c?2:o||a?1:0}for(var r=1;r<e.length-1;){if(0==e[r-1][0]&&0==e[r+1][0]){var i=e[r-1][1],o=e[r][1],a=e[r+1][1],s=this.diff_commonSuffix(i,o);if(s){var c=o.substring(o.length-s);i=i.substring(0,i.length-s),o=c+o.substring(0,o.length-s),a=c+a}for(var l=i,u=o,d=a,f=t(i,o)+t(o,a);o.charAt(0)===a.charAt(0);){i+=o.charAt(0),o=o.substring(1)+a.charAt(0),a=a.substring(1);var h=t(i,o)+t(o,a);h>=f&&(f=h,l=i,u=o,d=a)}e[r-1][1]!=l&&(l?e[r-1][1]=l:(e.splice(r-1,1),r--),e[r][1]=u,d?e[r+1][1]=d:(e.splice(r+1,1),r--))}r++}},n.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,n.whitespaceRegex_=/\s/,n.linebreakRegex_=/[\r\n]/,n.blanklineEndRegex_=/\n\r?\n$/,n.blanklineStartRegex_=/^\r?\n\r?\n/,n.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],r=0,i=null,o=0,a=!1,s=!1,c=!1,l=!1;o<e.length;)0==e[o][0]?(e[o][1].length<this.Diff_EditCost&&(c||l)?(n[r++]=o,a=c,s=l,i=e[o][1]):(r=0,i=null),c=l=!1):(-1==e[o][0]?l=!0:c=!0,i&&(a&&s&&c&&l||i.length<this.Diff_EditCost/2&&a+s+c+l==3)&&(e.splice(n[r-1],0,[-1,i]),e[n[r-1]+1][0]=1,r--,i=null,a&&s?(c=l=!0,r=0):(o=--r>0?n[r-1]:-1,c=l=!1),t=!0)),o++;t&&this.diff_cleanupMerge(e)},n.prototype.diff_cleanupMerge=function(e){e.push([0,""]);for(var t,n=0,r=0,i=0,o="",a="";n<e.length;)switch(e[n][0]){case 1:i++,a+=e[n][1],n++;break;case-1:r++,o+=e[n][1],n++;break;case 0:r+i>1?(0!==r&&0!==i&&(0!==(t=this.diff_commonPrefix(a,o))&&(n-r-i>0&&0==e[n-r-i-1][0]?e[n-r-i-1][1]+=a.substring(0,t):(e.splice(0,0,[0,a.substring(0,t)]),n++),a=a.substring(t),o=o.substring(t)),0!==(t=this.diff_commonSuffix(a,o))&&(e[n][1]=a.substring(a.length-t)+e[n][1],a=a.substring(0,a.length-t),o=o.substring(0,o.length-t))),0===r?e.splice(n-i,r+i,[1,a]):0===i?e.splice(n-r,r+i,[-1,o]):e.splice(n-r-i,r+i,[-1,o],[1,a]),n=n-r-i+(r?1:0)+(i?1:0)+1):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,i=0,r=0,o="",a=""}""===e[e.length-1][1]&&e.pop();var s=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),s=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),s=!0)),n++;s&&this.diff_cleanupMerge(e)},n.prototype.diff_xIndex=function(e,t){var n,r=0,i=0,o=0,a=0;for(n=0;n<e.length&&(1!==e[n][0]&&(r+=e[n][1].length),-1!==e[n][0]&&(i+=e[n][1].length),!(r>t));n++)o=r,a=i;return e.length!=n&&-1===e[n][0]?a:a+(t-o)},n.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,r=/</g,i=/>/g,o=/\n/g,a=0;a<e.length;a++){var s=e[a][0],c=e[a][1].replace(n,"&amp;").replace(r,"&lt;").replace(i,"&gt;").replace(o,"&para;<br>");switch(s){case 1:t[a]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case-1:t[a]='<del style="background:#ffe6e6;">'+c+"</del>";break;case 0:t[a]="<span>"+c+"</span>"}}return t.join("")},n.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)-1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_levenshtein=function(e){for(var t=0,n=0,r=0,i=0;i<e.length;i++){var o=e[i][0],a=e[i][1];switch(o){case 1:n+=a.length;break;case-1:r+=a.length;break;case 0:t+=Math.max(n,r),n=0,r=0}}return t+=Math.max(n,r)},n.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case-1:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},n.prototype.diff_fromDelta=function(e,t){for(var n=[],r=0,i=0,o=t.split(/\t/g),a=0;a<o.length;a++){var s=o[a].substring(1);switch(o[a].charAt(0)){case"+":try{n[r++]=[1,decodeURI(s)]}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+s)}break;case"-":case"=":var c=parseInt(s,10);if(isNaN(c)||c<0)throw new Error("Invalid number in diff_fromDelta: "+s);var l=e.substring(i,i+=c);"="==o[a].charAt(0)?n[r++]=[0,l]:n[r++]=[-1,l];break;default:if(o[a])throw new Error("Invalid diff operation in diff_fromDelta: "+o[a])}}if(i!=e.length)throw new Error("Delta length ("+i+") does not equal source text length ("+e.length+").");return n},n.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},n.prototype.match_bitap_=function(e,t,n){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var r=this.match_alphabet_(t),i=this;function o(e,r){var o=e/t.length,a=Math.abs(n-r);return i.Match_Distance?o+a/i.Match_Distance:a?1:o}var a=this.Match_Threshold,s=e.indexOf(t,n);-1!=s&&(a=Math.min(o(0,s),a),-1!=(s=e.lastIndexOf(t,n+t.length))&&(a=Math.min(o(0,s),a)));var c,l,u=1<<t.length-1;s=-1;for(var d,f=t.length+e.length,h=0;h<t.length;h++){for(c=0,l=f;c<l;)o(h,n+l)<=a?c=l:f=l,l=Math.floor((f-c)/2+c);f=l;var g=Math.max(1,n-l+1),p=Math.min(n+l,e.length)+t.length,m=Array(p+2);m[p+1]=(1<<h)-1;for(var y=p;y>=g;y--){var b=r[e.charAt(y-1)];if(m[y]=0===h?(m[y+1]<<1|1)&b:(m[y+1]<<1|1)&b|(d[y+1]|d[y])<<1|1|d[y+1],m[y]&u){var v=o(h,y-1);if(v<=a){if(a=v,!((s=y-1)>n))break;g=Math.max(1,2*n-s)}}}if(o(h+1,n)>a)break;d=m}return s},n.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},n.prototype.patch_addContext_=function(e,t){if(0!=t.length){for(var n=t.substring(e.start2,e.start2+e.length1),r=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,n=t.substring(e.start2-r,e.start2+e.length1+r);r+=this.Patch_Margin;var i=t.substring(e.start2-r,e.start2);i&&e.diffs.unshift([0,i]);var o=t.substring(e.start2+e.length1,e.start2+e.length1+r);o&&e.diffs.push([0,o]),e.start1-=i.length,e.start2-=i.length,e.length1+=i.length+o.length,e.length2+=i.length+o.length}},n.prototype.patch_make=function(e,t,r){var i,o;if("string"==typeof e&&"string"==typeof t&&void 0===r)i=e,(o=this.diff_main(i,t,!0)).length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&"object"==typeof e&&void 0===t&&void 0===r)o=e,i=this.diff_text1(o);else if("string"==typeof e&&t&&"object"==typeof t&&void 0===r)i=e,o=t;else{if("string"!=typeof e||"string"!=typeof t||!r||"object"!=typeof r)throw new Error("Unknown call format to patch_make.");i=e,o=r}if(0===o.length)return[];for(var a=[],s=new n.patch_obj,c=0,l=0,u=0,d=i,f=i,h=0;h<o.length;h++){var g=o[h][0],p=o[h][1];switch(c||0===g||(s.start1=l,s.start2=u),g){case 1:s.diffs[c++]=o[h],s.length2+=p.length,f=f.substring(0,u)+p+f.substring(u);break;case-1:s.length1+=p.length,s.diffs[c++]=o[h],f=f.substring(0,u)+f.substring(u+p.length);break;case 0:p.length<=2*this.Patch_Margin&&c&&o.length!=h+1?(s.diffs[c++]=o[h],s.length1+=p.length,s.length2+=p.length):p.length>=2*this.Patch_Margin&&c&&(this.patch_addContext_(s,d),a.push(s),s=new n.patch_obj,c=0,d=f,l=u)}1!==g&&(l+=p.length),-1!==g&&(u+=p.length)}return c&&(this.patch_addContext_(s,d),a.push(s)),a},n.prototype.patch_deepCopy=function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r],o=new n.patch_obj;o.diffs=[];for(var a=0;a<i.diffs.length;a++)o.diffs[a]=i.diffs[a].slice();o.start1=i.start1,o.start2=i.start2,o.length1=i.length1,o.length2=i.length2,t[r]=o}return t},n.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var r=0,i=[],o=0;o<e.length;o++){var a,s,c=e[o].start2+r,l=this.diff_text1(e[o].diffs),u=-1;if(l.length>this.Match_MaxBits?-1!=(a=this.match_main(t,l.substring(0,this.Match_MaxBits),c))&&(-1==(u=this.match_main(t,l.substring(l.length-this.Match_MaxBits),c+l.length-this.Match_MaxBits))||a>=u)&&(a=-1):a=this.match_main(t,l,c),-1==a)i[o]=!1,r-=e[o].length2-e[o].length1;else if(i[o]=!0,r=a-c,l==(s=-1==u?t.substring(a,a+l.length):t.substring(a,u+this.Match_MaxBits)))t=t.substring(0,a)+this.diff_text2(e[o].diffs)+t.substring(a+l.length);else{var d=this.diff_main(l,s,!1);if(l.length>this.Match_MaxBits&&this.diff_levenshtein(d)/l.length>this.Patch_DeleteThreshold)i[o]=!1;else{this.diff_cleanupSemanticLossless(d);for(var f,h=0,g=0;g<e[o].diffs.length;g++){var p=e[o].diffs[g];0!==p[0]&&(f=this.diff_xIndex(d,h)),1===p[0]?t=t.substring(0,a+f)+p[1]+t.substring(a+f):-1===p[0]&&(t=t.substring(0,a+f)+t.substring(a+this.diff_xIndex(d,h+p[1].length))),-1!==p[0]&&(h+=p[1].length)}}}}return[t=t.substring(n.length,t.length-n.length),i]},n.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,n="",r=1;r<=t;r++)n+=String.fromCharCode(r);for(r=0;r<e.length;r++)e[r].start1+=t,e[r].start2+=t;var i=e[0],o=i.diffs;if(0==o.length||0!=o[0][0])o.unshift([0,n]),i.start1-=t,i.start2-=t,i.length1+=t,i.length2+=t;else if(t>o[0][1].length){var a=t-o[0][1].length;o[0][1]=n.substring(o[0][1].length)+o[0][1],i.start1-=a,i.start2-=a,i.length1+=a,i.length2+=a}if(0==(o=(i=e[e.length-1]).diffs).length||0!=o[o.length-1][0])o.push([0,n]),i.length1+=t,i.length2+=t;else if(t>o[o.length-1][1].length){a=t-o[o.length-1][1].length;o[o.length-1][1]+=n.substring(0,a),i.length1+=a,i.length2+=a}return n},n.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,r=0;r<e.length;r++)if(!(e[r].length1<=t)){var i=e[r];e.splice(r--,1);for(var o=i.start1,a=i.start2,s="";0!==i.diffs.length;){var c=new n.patch_obj,l=!0;for(c.start1=o-s.length,c.start2=a-s.length,""!==s&&(c.length1=c.length2=s.length,c.diffs.push([0,s]));0!==i.diffs.length&&c.length1<t-this.Patch_Margin;){var u=i.diffs[0][0],d=i.diffs[0][1];1===u?(c.length2+=d.length,a+=d.length,c.diffs.push(i.diffs.shift()),l=!1):-1===u&&1==c.diffs.length&&0==c.diffs[0][0]&&d.length>2*t?(c.length1+=d.length,o+=d.length,l=!1,c.diffs.push([u,d]),i.diffs.shift()):(d=d.substring(0,t-c.length1-this.Patch_Margin),c.length1+=d.length,o+=d.length,0===u?(c.length2+=d.length,a+=d.length):l=!1,c.diffs.push([u,d]),d==i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(d.length))}s=(s=this.diff_text2(c.diffs)).substring(s.length-this.Patch_Margin);var f=this.diff_text1(i.diffs).substring(0,this.Patch_Margin);""!==f&&(c.length1+=f.length,c.length2+=f.length,0!==c.diffs.length&&0===c.diffs[c.diffs.length-1][0]?c.diffs[c.diffs.length-1][1]+=f:c.diffs.push([0,f])),l||e.splice(++r,0,c)}}},n.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},n.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var r=e.split("\n"),i=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<r.length;){var a=r[i].match(o);if(!a)throw new Error("Invalid patch string: "+r[i]);var s=new n.patch_obj;for(t.push(s),s.start1=parseInt(a[1],10),""===a[2]?(s.start1--,s.length1=1):"0"==a[2]?s.length1=0:(s.start1--,s.length1=parseInt(a[2],10)),s.start2=parseInt(a[3],10),""===a[4]?(s.start2--,s.length2=1):"0"==a[4]?s.length2=0:(s.start2--,s.length2=parseInt(a[4],10)),i++;i<r.length;){var c=r[i].charAt(0);try{var l=decodeURI(r[i].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+l)}if("-"==c)s.diffs.push([-1,l]);else if("+"==c)s.diffs.push([1,l]);else if(" "==c)s.diffs.push([0,l]);else{if("@"==c)break;if(""!==c)throw new Error('Invalid patch mode "'+c+'" in: '+l)}i++}}return t},n.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},n.patch_obj.prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case 1:e="+";break;case-1:e="-";break;case 0:e=" "}t[n+1]=e+encodeURI(this.diffs[n][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=n,e.exports.diff_match_patch=n,e.exports.DIFF_DELETE=-1,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},15161:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.Days=0]="Days",e[e.Suggestions=1]="Suggestions"}(r||(r={})),function(e){e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden"}(i||(i={}))},15162:function(e,t,n){var r;r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(t.DataClassification||(t.DataClassification={}))},function(e,t,n){"use strict";var r=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype.Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.Int64=r;var i=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype.Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.UInt64=i;var o=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16},e.ToInt32=function(e){return 2147483647&e|2147483648&e},e.ToUInt8=function(e){return 255&e},e.ToUInt32=function(e){return 4294967295&e},e}();t.Number=o},function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(3);!function(e){var t,n,s,c=!1,l=!1,u=!1;function d(){return c}!function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(t=e.SamplingPolicy||(e.SamplingPolicy={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(n=e.PersistencePriority||(e.PersistencePriority={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(s=e.CostPriority||(e.CostPriority={})),e.sendTelemetryEvent=function(e){return i(this,void 0,void 0,(function(){var r=this;return o(this,(function(c){return[2,new Promise((function(c,l){return i(r,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return function(e){e.eventFlags||(e.eventFlags={}),e.eventFlags.cost||(e.eventFlags.cost=s.Normal),e.eventFlags.sampling||(e.eventFlags.sampling=t.Measure),e.eventFlags.persistence||(e.eventFlags.persistence=n.Normal),e.dataFields||(e.dataFields=[]),e.dataContracts||(e.dataContracts=[])}(e),(r=this.checkReady())?[2,c(r)]:[4,a.EventProcessor.processEvent(e).catch((function(e){return c({eventAccepted:!1,message:e})}))];case 1:return i.sent(),[2,c({eventAccepted:!0})]}}))}))}))]}))}))},e.checkReady=function(){return c?l?void 0:{eventAccepted:!1,message:"Must call .setTml before .sendTelemetryEvent."}:{eventAccepted:!1,message:"Must call .setContext before .sendTelemetryEvent."}},e.isContextSet=d,e.setContext=function(e){if(!0===d()&&!0!==u)throw".setContext already called.";a.EventProcessor.setContext(r({},{"Data.SDX.Id":"","Data.SDX.Version":"","Data.SDX.InstanceId":"","App.Name":"TBD","App.Platform":"TBD","App.Version":"TBD","Device.OsBuild":"TBD","Device.OsVersion":"TBD","Host.Id":"","Host.Version":"","Release.Audience":"TBD","Release.AudienceGroup":"TBD","Release.Channel":"TBD","Release.Fork":"TBD"},e)),c=!0},e.setTml=function(e){a.EventProcessor.setTml(e),l=!0},e.setAriaSendEventEnabled=function(e){a.EventProcessor.setAriaSendEventEnabled(e)},e.enableTestMode=function(e){u=!0,a.EventProcessor.enableTestMode(e)}}(t.STE||(t.STE={}))},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(15),a=n(0),s=n(27);!function(e){var t;!function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(t||(t={}));var n={},c={},l={},u=!1;function d(e,n){var r=e.split("."),i=l,o=void 0;if(i){for(var a=0;a<r.length-1;a++){if(!i[r[a]])return;i=i[r[a]],n===t.Aria&&"string"==typeof i.ariaTenantToken?o=i.ariaTenantToken:n===t.Nexus&&"number"==typeof i.nexusTenantToken&&(o=i.nexusTenantToken)}return o}}function f(e,t,n,r){if(0===e.length)return!1;if(t&&!(e[0]>="A"&&e[0]<="Z"))return!1;for(var i=0;i<e.length;i++){var o=e[i];if(!(r&&"."===o||n&&"_"===o||o>="a"&&o<="z"||o>="A"&&o<="Z"||o>="0"&&o<="9"))return!1}return!0}e.processEvent=function(e){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){return e.dataFields.push({name:"Event.Time.String",value:(new Date).toISOString(),classification:a.DataClassification.SystemMetadata}),[2,new Promise((function(n,a){return r(t,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return!0!==(t=function(e){var t,n=e.eventName.split("."),r=n[n.length-1];if(!function(e){return e.length>=3&&"Office"===e[0]}(n))return"Invalid namespace.";if(!f(r,!0,!1,!1))return"Invalid eventNode";if(e.eventContract&&!f(e.eventContract.getContractName(),!1,!0,!0))return"Invalid eventContract.";if(!(e.eventName.length<=98))return"Invalid eventName";for(var i=0;i<e.dataFields.length;i++){if(!(f(t=e.dataFields[i].name,!1,!0,!0)&&t.length+5<100))return"Invalid dataField name.";e.dataFields[i].classification}return!0}(e))?[2,a(t)]:[4,s.RichApiSendEvent.isSupported()];case 1:return!0===r.sent()?[2,n(s.RichApiSendEvent.sendEvent(e))]:u?[2,n(o.AriaSendEvent.sendEvent(e))]:[2,a("RichApi is not supported. You can enable sending events directly to Aria by calling setAriaSendEventEnabled.")]}}))}))}))]}))}))},e.setContext=function(e){o.AriaSendEvent.setContext(e)},e.setTml=function(e){l=function e(t,n){if("object"!=typeof n)return n;for(var r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];o in t&&(t[o],1)?t[o]=e(t[o],n[o]):t[o]=n[o]}return t}(l,e)},e.setAriaSendEventEnabled=function(e){u=e},e.getAriaTenantToken=function(e){if(n[e])return n[e];var r=d(e,t.Aria);return"string"==typeof r?(n[e]=r,r):void 0},e.getNexusTenantToken=function(e){if(c[e])return c[e];var n=d(e,t.Nexus);return"number"==typeof n?(c[e]=n,n):void 0},e.enableTestMode=function(e){s.RichApiSendEvent.enableTestMode(e)}}(t.EventProcessor||(t.EventProcessor={}))},function(e,t,n){"use strict";!function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={}))},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(30),a=n(0);!function(e){!function(e){!function(e){var t=function(e){function t(t,n,r,i,o){var s=e.call(this,"Office.System.SDX")||this;return s.id=t,s.version=n,s.instanceId=r,s.name=i,s.marketplaceType=o,null!==t&&(s.Id=t),null!==n&&(s.Version=n),null!==r&&(s.InstanceId=r),null!==i&&(s.Name=i),null!==o&&(s.MarketplaceType=o),s.fields=[{name:"Id",required:!1,classification:a.DataClassification.EssentialServiceMetadata},{name:"Version",required:!1,classification:a.DataClassification.EssentialServiceMetadata},{name:"InstanceId",required:!1,classification:a.DataClassification.EssentialServiceMetadata},{name:"Name",required:!1,classification:a.DataClassification.EssentialServiceMetadata},{name:"MarketplaceType",required:!1,classification:a.DataClassification.EssentialServiceMetadata}],s}return i(t,e),t}(o.BaseContract);e.SDX=t;var n=function(e){function t(t,n,r){var i=e.call(this,"Office.System.Host")||this;return i.id=t,i.version=n,i.sessionId=r,null!=t&&(i.Id=t),null!=n&&(i.Version=n),null!=r&&(i.SessionId=r),i.fields=[{name:"Id",required:!1,classification:a.DataClassification.SystemMetadata},{name:"Version",required:!1,classification:a.DataClassification.SystemMetadata},{name:"SessionId",required:!1,classification:a.DataClassification.SystemMetadata}],i}return i(t,e),t}(o.BaseContract);e.Host=n;var r=function(e){function t(t,n,r){var i=e.call(this,"Office.System.Result")||this;return i.code=t,i.type=n,i.tag=r,i.Code=t,null!==n&&(i.Type=n),null!==r&&(i.Tag=r),i.fields=[{name:"Code",required:!0,classification:a.DataClassification.SystemMetadata},{name:"Type",required:!1,classification:a.DataClassification.SystemMetadata},{name:"Tag",required:!1,classification:a.DataClassification.SystemMetadata}],i}return i(t,e),t}(o.BaseContract);e.Result=r;var s=function(e){function t(t,n,r,i,o,s){var c=e.call(this,"Office.System.Activity")||this;return c.duration=t,c.count=n,c.aggMode=r,c.cV=i,c.success=o,c.result=s,null!=i&&(c.CV=i),c.Duration=t,c.Count=n,c.AggMode=r,null!=o&&(c.Success=o),null!=s&&(c.Result=s),c.fields=[{name:"CV",required:!1,classification:a.DataClassification.SystemMetadata},{name:"Duration",required:!0,classification:a.DataClassification.SystemMetadata},{name:"Count",required:!0,classification:a.DataClassification.SystemMetadata},{name:"AggMode",required:!1,classification:a.DataClassification.SystemMetadata},{name:"Success",required:!1,classification:a.DataClassification.SystemMetadata},{name:"Result",required:!1,classification:a.DataClassification.SystemMetadata}],c}return i(t,e),t}(o.BaseContract);e.Activity=s;var c=function(e){function t(t,n,r,i,o){var s=e.call(this,"Office.System.Error")||this;return s.ErrorGroup=t,s.Tag=n,null!=r&&(s.Code=r),null!=i&&(s.Id=i),null!=o&&(s.Count=o),s.fields=[{name:"ErrorGroup",required:!0,classification:a.DataClassification.SystemMetadata},{name:"Tag",required:!0,classification:a.DataClassification.SystemMetadata},{name:"Code",required:!1,classification:a.DataClassification.SystemMetadata},{name:"Id",required:!1,classification:a.DataClassification.SystemMetadata},{name:"Count",required:!1,classification:a.DataClassification.SystemMetadata}],s}return i(t,e),t}(o.BaseContract);e.Error=c;var l=function(e){function t(t,n){var r=e.call(this,"Office.System.Funnel")||this;return null!=t&&(r.Name=t),null!=n&&(r.State=n),r.fields=[{name:"Name",required:!1,classification:a.DataClassification.SystemMetadata},{name:"State",required:!1,classification:a.DataClassification.SystemMetadata}],r}return i(t,e),t}(o.BaseContract);e.Funnel=l}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(t.Contracts||(t.Contracts={}))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(11).polyfill(),r(n(2)),r(n(29)),r(n(5)),r(n(0)),r(n(32))},function(e,t,n){"use strict";var r=n(20),i=n(4),o=n(8),a=function(){function e(){}return e.getPayloadBlob=function(e,t){var n=new r.IO.MemoryStream,i=new r.CompactBinaryProtocolWriter(n);return i.WriteFieldBegin(r.BondDataType.BT_MAP,3),i.WriteMapContainerBegin(t,r.BondDataType.BT_STRING,r.BondDataType.BT_LIST),Object.keys(e).forEach((function(t){i.WriteString(t);var n=e[t];i.WriteContainerBegin(1,r.BondDataType.BT_STRUCT),i.WriteFieldBegin(r.BondDataType.BT_STRING,2),i.WriteString("act_default_source"),i.WriteFieldBegin(r.BondDataType.BT_STRING,5),i.WriteString(o.newGuid()),i.WriteFieldBegin(r.BondDataType.BT_INT64,6),i.WriteInt64(o.numberToBondInt64(Date.now())),i.WriteFieldBegin(r.BondDataType.BT_LIST,8),i.WriteContainerBegin(n.length,r.BondDataType.BT_STRUCT);for(var a=0;a<n.length;++a)i.WriteBlob(n[a]);i.WriteStructEnd(!1)})),i.WriteStructEnd(!1),n.GetBuffer()},e.getEventBlob=function(e){var t=new r.IO.MemoryStream,n=new r.CompactBinaryProtocolWriter(t);n.WriteFieldBegin(r.BondDataType.BT_STRING,1),n.WriteString(e.id),n.WriteFieldBegin(r.BondDataType.BT_INT64,3),n.WriteInt64(o.numberToBondInt64(e.timestamp)),n.WriteFieldBegin(r.BondDataType.BT_STRING,5),n.WriteString(e.type),n.WriteFieldBegin(r.BondDataType.BT_STRING,6),n.WriteString(e.name);var a=[],s=[];return Object.keys(e.properties).forEach((function(t){e.properties[t].pii===i.AWTPiiKind.NotSet?a.push(t):s.push(t)})),a.length&&(n.WriteFieldBegin(r.BondDataType.BT_MAP,13),n.WriteMapContainerBegin(a.length,r.BondDataType.BT_STRING,r.BondDataType.BT_STRING),a.forEach((function(t){n.WriteString(t),n.WriteString(e.properties[t].value)}))),s.length&&(n.WriteFieldBegin(r.BondDataType.BT_MAP,30),n.WriteMapContainerBegin(s.length,r.BondDataType.BT_STRING,r.BondDataType.BT_STRUCT),s.forEach((function(t){n.WriteString(t),n.WriteFieldBegin(r.BondDataType.BT_INT32,1),n.WriteInt32(1),n.WriteFieldBegin(r.BondDataType.BT_INT32,2),n.WriteInt32(e.properties[t].pii),n.WriteFieldBegin(r.BondDataType.BT_STRING,3),n.WriteString(e.properties[t].value),n.WriteStructEnd(!1)}))),n.WriteStructEnd(!1),t.GetBuffer()},e.base64Encode=function(e){return r.Encoding.Base64.GetString(e)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){"use strict";var r=n(1),i=/[xy]/g;t.numberToBondInt64=function(e){var t=new r.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(i,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.isPii=function(e){return!isNaN(e)&&null!==e&&e>=0&&e<=13}},function(e,t,n){"use strict";t.Version="1.2.0",t.FullVersionString="AWT-Web-CJS-"+t.Version},function(e,t,n){e.exports=n(6)},function(e,t,n){(function(t,r){var i;
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   4.1.1
 */i=function(){"use strict";function e(e){return"function"==typeof e}var i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,a=void 0,s=void 0,c=function(e,t){p[o]=e,p[o+1]=t,2===(o+=2)&&(s?s(m):I())},l="undefined"!=typeof window?window:void 0,u=l||{},d=u.MutationObserver||u.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function g(){var e=setTimeout;return function(){return e(m,1)}}var p=new Array(1e3);function m(){for(var e=0;e<o;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;o=0}var y,b,v,_,I=void 0;function S(e,t){var n=arguments,r=this,i=new this.constructor(T);void 0===i[O]&&H(i);var o,a=r._state;return a?(o=n[a-1],c((function(){return q(a,i,o,r._result)}))):k(r,i,e,t),i}function C(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(T);return A(t,e),t}f?I=function(){return t.nextTick(m)}:d?(b=0,v=new d(m),_=document.createTextNode(""),v.observe(_,{characterData:!0}),I=function(){_.data=b=++b%2}):h?((y=new MessageChannel).port1.onmessage=m,I=function(){return y.port2.postMessage(0)}):I=void 0===l?function(){try{var e=n(14);return void 0!==(a=e.runOnLoop||e.runOnContext)?function(){a(m)}:g()}catch(e){return g()}}():g();var O=Math.random().toString(36).substring(16);function T(){}var E=void 0,P=1,w=2,j=new B;function R(e){try{return e.then}catch(e){return j.error=e,j}}function x(t,n,r){n.constructor===t.constructor&&r===S&&n.constructor.resolve===C?function(e,t){t._state===P?D(e,t._result):t._state===w?F(e,t._result):k(t,void 0,(function(t){return A(e,t)}),(function(t){return F(e,t)}))}(t,n):r===j?(F(t,j.error),j.error=null):void 0===r?D(t,n):e(r)?function(e,t,n){c((function(e){var r=!1,i=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,(function(n){r||(r=!0,t!==n?A(e,n):D(e,n))}),(function(t){r||(r=!0,F(e,t))}),e._label);!r&&i&&(r=!0,F(e,i))}),e)}(t,n,r):D(t,n)}function A(e,t){var n,r;e===t?F(e,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=t),null===n||"object"!==r&&"function"!==r?D(e,t):x(e,t,R(t)))}function N(e){e._onerror&&e._onerror(e._result),M(e)}function D(e,t){e._state===E&&(e._result=t,e._state=P,0!==e._subscribers.length&&c(M,e))}function F(e,t){e._state===E&&(e._state=w,e._result=t,c(N,e))}function k(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+P]=n,i[o+w]=r,0===o&&e._state&&c(M,e)}function M(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?q(n,r,i,o):i(o);e._subscribers.length=0}}function B(){this.error=null}var L=new B;function q(t,n,r,i){var o=e(r),a=void 0,s=void 0,c=void 0,l=void 0;if(o){if((a=function(e,t){try{return e(t)}catch(e){return L.error=e,L}}(r,i))===L?(l=!0,s=a.error,a.error=null):c=!0,n===a)return void F(n,new TypeError("A promises callback cannot return that same promise."))}else a=i,c=!0;n._state!==E||(o&&c?A(n,a):l?F(n,s):t===P?D(n,a):t===w&&F(n,a))}var U=0;function H(e){e[O]=U++,e._state=void 0,e._result=void 0,e._subscribers=[]}function W(e,t){this._instanceConstructor=e,this.promise=new e(T),this.promise[O]||H(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&D(this.promise,this._result))):F(this.promise,new Error("Array Methods must be provided an Array"))}function G(e){this[O]=U++,this._result=this._state=void 0,this._subscribers=[],T!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof G?function(e,t){try{t((function(t){A(e,t)}),(function(t){F(e,t)}))}catch(t){F(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return W.prototype._enumerate=function(e){for(var t=0;this._state===E&&t<e.length;t++)this._eachEntry(e[t],t)},W.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===C){var i=R(e);if(i===S&&e._state!==E)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===G){var o=new n(T);x(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},W.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===E&&(this._remaining--,e===w?F(r,n):this._result[t]=n),0===this._remaining&&D(r,this._result)},W.prototype._willSettleAt=function(e,t){var n=this;k(e,void 0,(function(e){return n._settledAt(P,t,e)}),(function(e){return n._settledAt(w,t,e)}))},G.all=function(e){return new W(this,e).promise},G.race=function(e){var t=this;return i(e)?new t((function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},G.resolve=C,G.reject=function(e){var t=new this(T);return F(t,e),t},G._setScheduler=function(e){s=e},G._setAsap=function(e){c=e},G._asap=c,G.prototype={constructor:G,then:S,catch:function(e){return this.then(null,e)}},G.polyfill=function(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=G},G.Promise=G,G},e.exports=i()}).call(t,n(12),n(13))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,l=[],u=!1,d=-1;function f(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&h())}function h(){if(!u){var e=s(f);u=!0;for(var t=l.length;t;){for(c=l,l=[];++d<t;)c&&c[d].run();d=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new g(e,t)),1!==l.length||u||s(h)},g.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(3),o=n(26),a=n(6),s=/\./g,c="OTelJS.ClientId",l="2d0c842b097d46049a4c52d8fec89843-88e5473b-a960-4484-a08b-64796c688ef1-7865",u="Data.",d="zDC.",f="zC.",h="zT.",g=["Office.System.Host"];!function(e){var t=!1,n=null,p=0,m=null,y=void 0;function b(e,t){t.forEach((function(t){if((n=t.name).substr(0,3)===f||n.substr(0,3)===h||n.substr(0,4)===d)e.properties[t.name]=t.value;else{switch(t.classification){case a.DataClassification.EssentialServiceMetadata:e.properties[d+t.name]="ESM";break;case a.DataClassification.SystemMetadata:e.properties[d+t.name]="SM";break;default:return}e.properties[t.name]=t.value}var n}))}e.sendEvent=function(e){var a;t||(r.AWT.initialize(l),r.AWT.setContext("Client.Id",null!=n?n:("undefined"!=typeof localStorage&&(n=localStorage.getItem(c)),null==n&&(n=o.Utils.newGuid(),"undefined"!=typeof localStorage&&localStorage.setItem(c,n)),n)),r.AWT.setContext("Session.Id",(null==m&&(m=o.Utils.newGuid()),m)),y&&Object.keys(y).forEach((function(e){r.AWT.setContext(e,y[e])})),t=!0);try{a=function(e){var t,n={name:(t=e.eventName,t.toLowerCase().replace(s,"_")+"_sdxa"),properties:{},tenantToken:i.EventProcessor.getAriaTenantToken(e.eventName)};if(n.properties["Event.Sequence"]=++p,n.properties["Event.Name"]=e.eventName,n.properties["Event.Source"]="OTelJS",e.eventContract){n.properties["Event.Contract"]=e.eventContract.getContractName();var r=e.eventContract.getUnqualifiedName();b(n,e.eventContract.getFields(r))}return e.dataContracts.forEach((function(e){var t=u;g.indexOf(e.getContractName())>=0&&(t=""),b(n,e.getFields(t+e.getUnqualifiedName()))})),e.dataFields.forEach((function(e){"object"==typeof e.value?b(n,e.value.getFields(u+e.name)):b(n,[{name:u+e.name,value:e.value,classification:e.classification}])})),n}(e)}catch(e){return e.meesage}return a.tenantToken?(function(e){for(var t in e.properties)"string"!=typeof e.properties[t]&&(e.properties[t+".String"]=e.properties[t],delete e.properties[t])}(a),r.AWT.logEvent(a),!0):"Unable to find ariaTenantToken for namespace."},e.setContext=function(e){y=e}}(t.AriaSendEvent||(t.AriaSendEvent={}))},function(e,t,n){"use strict";var r=n(4);t.AWTPiiKind=r.AWTPiiKind;var i=n(17);t.AWT=i.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/"},function(e,t,n){"use strict";var r=n(4),i=n(18),o=n(8),a=n(9),s=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,c=/\./g,l=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,u=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),this._isInitialized)throw"Already Initialized";this._defaultTenantToken=e,this._overrideValuesFromConfig(t),i.default.initialize(this._config),this._isInitialized=!0},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&i.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._isDestroyed=!0,i.default.flushAndTeardown())},e.setContext=function(e,t,n){void 0===n&&(n="allTkns"),null!==(t=this._sanitizeProperty(e,t))&&(this._contextProperties[n]||(this._contextProperties[n]={}),this._contextProperties[n][e]=t)},e.logEvent=function(e){var t=this;if(this._isInitialized){if(!e.name||!e.properties)return;e.name=e.name.toLowerCase(),e.name.replace(c,"_");var n="";if(e.type?(e.type.toLowerCase(),n="custom."):e.type="custom",!s.test(e.name)||!s.test(e.type))return;if(e.type=n+e.type,isNaN(e.timestamp)&&(e.timestamp=(new Date).getTime()),e.tenantToken||(e.tenantToken=this._defaultTenantToken),e.id=o.newGuid(),Object.keys(e.properties).forEach((function(n){e.properties[n]=t._sanitizeProperty(n,e.properties[n]),null===e.properties[n]&&delete e.properties[n]})),this._addContextIfAbsent(e,e.tenantToken),this._addContextIfAbsent(e,"allTkns"),0===Object.keys(e.properties).length)return;this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.tenantToken)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.tenantToken)),this._setDefaultProperty(e,"EventInfo.SdkVersion",a.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),i.default.sendEvent(e)}},e._overrideValuesFromConfig=function(e){e.collectorUrl&&(this._config.collectorUrl=e.collectorUrl),e.sendingTimer>1e3&&(this._config.sendingTimer=e.sendingTimer)},e._getInitId=function(e){return void 0===this._initIdMap[e]&&(this._initIdMap[e]=o.newGuid()),this._initIdMap[e]},e._getSequenceId=function(e){return void 0===this._sequenceIdMap[e]&&(this._sequenceIdMap[e]=0),(++this._sequenceIdMap[e]).toString()},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:r.AWTPiiKind.NotSet}},e._addContextIfAbsent=function(e,t){if(this._contextProperties[t]){var n=this._contextProperties[t];Object.keys(n).forEach((function(t){e.properties[t]||(e.properties[t]=n[t])}))}},e._sanitizeProperty=function(e,t){return"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||(t={value:t}),l.test(e)&&null!=t&&null!==t.value&&void 0!==t.value&&""!==t.value?(void 0===t.pii&&(t.pii=r.AWTPiiKind.NotSet),t.value=t.value.toString(),o.isPii(t.pii)?t:null):null},e}();u._isInitialized=!1,u._isDestroyed=!1,u._contextProperties={},u._sequenceIdMap={},u._initIdMap={},u._config={collectorUrl:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",sendingTimer:1e3},Object.defineProperty(t,"__esModule",{value:!0}),t.default=u},function(e,t,n){"use strict";var r=n(19),i=n(7),o=n(24),a=n(25),s=n(9),c=function(){function e(){}return e.initialize=function(e){this._inboundQueues.push([]),this._recordBatcher=new r.default(2936012,this._outboundQueue),this._newEventsAllowed=!0,"undefined"==typeof Uint8Array&&(this._urlString+="&content-encoding=base64"),this._sendingTimer=e.sendingTimer,this._urlString=e.collectorUrl+this._urlString+"&x-apikey="},e.sendEvent=function(e){var t=this;this._newEventsAllowed&&(this._inboundQueues[this._inboundQueues.length-1].push(e),!this._running&&this._timeout<0&&!this._isCurrentlyFlushing&&(this._timeout=setTimeout((function(){return t._batchAndSendEvents(!1)}),this._sendingTimer)))},e.flushAndTeardown=function(){this._newEventsAllowed=!1,this._batchAndSendEvents(!0)},e.flush=function(e){this._inboundQueues.push([]),this._isCurrentlyFlushing?this._flushQueue.push(e):(this._isCurrentlyFlushing=!0,this._flush(e))},e._batchAndSendEvents=function(e){for(this._running=!0;this._inboundQueues[0].length>0&&this._outboundQueue.length<1;)this._recordBatcher.addEventToBatch(this._inboundQueues[0].pop());0===this._outboundQueue.length&&this._recordBatcher.flushBatch(),this._sendRequest(this._outboundQueue.pop(),0,e)},e._retryRequestIfNeeded=function(e,t,n,r,i){var a=this,s=!0;e&&void 0!==e.status&&(this._killSwitch.setKillSwitchTenants(e.getResponseHeader("kill-tokens"),e.getResponseHeader("kill-duration-seconds")).forEach((function(e){delete t[e],n--})),(!o.default.shouldRetryForStatus(e.status)||n<=0)&&(s=!1)),s&&i<4?setTimeout((function(){return a._sendRequest(t,i+1,!1)}),o.default.getMillisToBackoffForRetry(i)):this._handleRequestFinished(null)},e._sendRequest=function(e,t,n){var r=this,o=new XMLHttpRequest,a=0,s="";if(Object.keys(e).forEach((function(t){r._killSwitch.isTenantKilled(t)?delete e[t]:(s.length>0&&(s+=","),s+=t,a++)})),o.open("POST",this._urlString+s,!n),n||(o.ontimeout=function(){r._retryRequestIfNeeded(o,e,a,s,t)},o.onerror=function(){r._retryRequestIfNeeded(o,e,a,s,t)},o.onload=function(){r._handleRequestFinished(o)}),a>0){var c=i.default.getPayloadBlob(e,a);"undefined"==typeof Uint8Array?o.send(i.default.base64Encode(c)):o.send(new Uint8Array(c))}else n&&this._handleRequestFinished(null)},e._handleRequestFinished=function(e){var t=this;e&&this._killSwitch.setKillSwitchTenants(e.getResponseHeader("kill-tokens"),e.getResponseHeader("kill-duration-seconds")),this._inboundQueues[0].length>0?this._timeout=setTimeout((function(){return t._batchAndSendEvents(!1)}),this._sendingTimer):(this._timeout=-1,this._running=!1)},e._flush=function(e){var t=this;this._running||(this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._inboundQueues[0].length>0&&this._batchAndSendEvents(!1)),this._checkPrimaryInboundQueueEmpty((function(){t._inboundQueues.shift(),null!=e&&e(),t._flushQueue.length>0?setTimeout((function(){return t._flush(t._flushQueue.shift())}),t._sendingTimer):(t._isCurrentlyFlushing=!1,t._inboundQueues[0].length>0&&(t._timeout=setTimeout((function(){return t._batchAndSendEvents(!1)}),t._sendingTimer)))}))},e._checkPrimaryInboundQueueEmpty=function(e){var t=this;0===this._inboundQueues[0].length?this._checkOutboundQueueEmptyAndSent(e):setTimeout((function(){return t._checkPrimaryInboundQueueEmpty(e)}),250)},e._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._running?setTimeout((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250):e()},e}();c._outboundQueue=[],c._inboundQueues=[],c._newEventsAllowed=!1,c._killSwitch=new a.default,c._isCurrentlyFlushing=!1,c._flushQueue=[],c._running=!1,c._timeout=-1,c._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+s.FullVersionString,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c},function(e,t,n){"use strict";var r=n(7),i=function(){function e(e,t){this._maxRequestSize=e,this._outboundQueue=t,this._currentBatch={},this._currentBatchSize=0}return e.prototype.addEventToBatch=function(e){var t=r.default.getEventBlob(e);t.length>this._maxRequestSize||(this._currentBatchSize+t.length>this._maxRequestSize?this.flushBatch():(void 0===this._currentBatch[e.tenantToken]&&(this._currentBatch[e.tenantToken]=[]),this._currentBatch[e.tenantToken].push(t),this._currentBatchSize+=t.length))},e.prototype.flushBatch=function(){this._currentBatchSize>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentBatchSize=0)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,n){"use strict";var r=n(21);t.BondDataType=r.BondDataType;var i=n(22);t.Encoding=i;var o=n(23);t.IO=o;var a=n(1);t.Int64=a.Int64,t.UInt64=a.UInt64,t.Number=a.Number;var s=function(){function e(e){this._stream=e}return e.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},e.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},e.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)},e.prototype.WriteFieldBegin=function(e,t){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},e.prototype.WriteInt32=function(e){e=i.Zigzag.EncodeZigzag32(e),this.WriteUInt32(e)},e.prototype.WriteInt64=function(e){this.WriteUInt64(i.Zigzag.EncodeZigzag64(e))},e.prototype.WriteString=function(e){if(""===e)this.WriteUInt32(0);else{var t=i.Utf8.GetBytes(e);this.WriteUInt32(t.length),this._stream.Write(t,0,t.length)}},e.prototype.WriteStructEnd=function(e){this.WriteUInt8(e?r.BondDataType.BT_STOP_BASE:r.BondDataType.BT_STOP)},e.prototype.WriteUInt32=function(e){var t=i.Varint.GetBytes(a.Number.ToUInt32(e));this._stream.Write(t,0,t.length)},e.prototype.WriteUInt64=function(e){var t=i.Varint64.GetBytes(e);this._stream.Write(t,0,t.length)},e.prototype.WriteUInt8=function(e){this._stream.WriteByte(a.Number.ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},function(e,t,n){"use strict";!function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(t.BondDataType||(t.BondDataType={}))},function(e,t,n){"use strict";var r=n(1),i=function(){function e(){}return e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t},e}();t.Utf8=i;var o=function(){function e(){}return e.GetString=function(e){for(var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],i=e.length%3,o=0,a=e.length-i;o<a;o+=3){var s=(e[o]<<16)+(e[o+1]<<8)+e[o+2];r.push([n.charAt((t=s)>>18&63),n.charAt(t>>12&63),n.charAt(t>>6&63),n.charAt(63&t)].join(""))}switch(i){case 1:s=e[e.length-1],r.push(n.charAt(s>>2)),r.push(n.charAt(s<<4&63)),r.push("==");break;case 2:var c=(e[e.length-2]<<8)+e[e.length-1];r.push(n.charAt(c>>10)),r.push(n.charAt(c>>4&63)),r.push(n.charAt(c<<2&63)),r.push("=")}return r.join("")},e}();t.Base64=o;var a=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},e}();t.Varint=a;var s=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,n=e.high,r=[];n||4294967168&t;)r.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return r.push(127&t),r},e}();t.Varint64=s;var c=function(){function e(){}return e.EncodeZigzag32=function(e){return(e=r.Number.ToInt32(e))<<1^e>>31},e.EncodeZigzag64=function(e){var t=e.low,n=e.high,i=n<<1|t>>>31,o=t<<1;2147483648&n&&(i=~i,o=~o);var a=new r.UInt64("0");return a.low=o,a.high=i,a},e}();t.Zigzag=c},function(e,t,n){"use strict";var r=n(1),i=function(){function e(){this._buffer=[]}return e.prototype.WriteByte=function(e){this._buffer.push(r.Number.ToByte(e))},e.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])},e.prototype.GetBuffer=function(){return this._buffer},e}();t.MemoryStream=i},function(e,t,n){"use strict";var r=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*n,Math.min(t,12e4)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){"use strict";var r=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){var n=this;if(e&&t)try{var r=e.split(",");if("this-request-only"===t)return r;var i=1e3*parseInt(t,10);r.forEach((function(e){n._killedTokenDictionary[e]=Date.now()+i}))}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/[xy]/g;!function(e){e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(r,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}}(t.Utils||(t.Utils={}))},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(3);!function(e){var t,s=null,c=1e3,l=-1;function u(){return r(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,o){return r(e,void 0,void 0,(function(){var e,r,o;return i(this,(function(i){switch(i.label){case 0:if(-1!==l)return[2,t(1===l)];if(!function(){if(null===s)if("undefined"==typeof OfficeCore)try{var e=n(28);s=e.RequestContext}catch(e){return l=0,!1}else s=OfficeCore.RequestContext;return!0}()||null===s)return[2,t("Can't get OfficeCore RequestContext")];if(void 0===(e=new s))return[2,t("Can't get OfficeCore")];i.label=1;case 1:return i.trys.push([1,3,,4]),r={nexusTenantToken:1723,ariaTenantToken:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405"},e.telemetry.sendTelemetryEvent(r,"Office.Telemetry.RichApi.TestForSupport",null,null,[]),[4,e.sync().then((function(){return l=1,t(!0)}))];case 2:return i.sent(),[3,4];case 3:return"InvalidArgument"===(o=i.sent()).code?(l=0,[2,t("Not supported on the host")]):[2,t(JSON.stringify(o))];case 4:return[2,t("Shouldn't get here")]}}))}))}))]}))}))}function d(e,t){t.forEach((function(t){"number"==typeof t.value&&Math.abs(t.value)>2147483647&&Math.abs(t.value)<=9007199254740992&&Math.floor(t.value)===t.value?(e.push({name:"zT."+t.name,value:"int64",classification:o.DataClassification.SystemMetadata}),e.push({name:t.name,value:t.value.toString(),classification:t.classification})):"object"==typeof t.value?d(e,t.value.getFields(t.name)):e.push(t)}))}e.isSupported=u,e.enableTestMode=function(e){s=e,c=0},e.sendEvent=function(e){return r(this,void 0,void 0,(function(){var n=this;return i(this,(function(s){return[2,new Promise((function(s,c){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,u()];case 1:if(!0!==r.sent())return[2,c("RichApi is not supported.")];try{n=function(e){var t=new h;return t.nexusTenantToken=a.EventProcessor.getNexusTenantToken(e.eventName),t.ariaTenantToken=a.EventProcessor.getAriaTenantToken(e.eventName),t.eventName=e.eventName,t.eventContract=e.eventContract?e.eventContract.getContractName():null,t.samplingPolicy=e.eventFlags.sampling,t.costPriority=e.eventFlags.cost,t.persistencePriority=e.eventFlags.persistence,t.dataFields=[],d(t.dataFields,e.dataFields),e.eventContract&&(d(t.dataFields,[{name:"Event.Contract",value:e.eventContract.getContractName(),classification:o.DataClassification.SystemMetadata}]),d(t.dataFields,e.eventContract.getFields(null))),e.dataContracts.forEach((function(e){d(t.dataFields,e.getFields(null))})),t}(e)}catch(e){return[2,c(e.message)]}return t||(t=new f(g)),t.add(n),[2,s(!0)]}}))}))}))]}))}))};var f=function(){function e(e){this._processor=e,this._requestIsPending=!1,this._items=[]}return e.prototype.add=function(e){this._items.push(e),this._requestIsPending||this.processWorkBacklog()},e.prototype.getQueue=function(){return this._items},e.prototype.processWorkBacklog=function(){return r(this,void 0,void 0,(function(){var e,t=this;return i(this,(function(n){switch(n.label){case 0:return this._requestIsPending=!0,e=this._items,this._items=[],[4,this._processor(e)];case 1:return n.sent(),this._requestIsPending=!1,this._items.length>0&&setTimeout((function(){return t.processWorkBacklog()}),0),[2]}}))}))},e}(),h=function(){};function g(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return t=new s,e.forEach((function(e){var n={nexusTenantToken:e.nexusTenantToken,ariaTenantToken:e.ariaTenantToken},r={samplingPolicy:e.samplingPolicy,costPriority:e.costPriority,persistencePriority:e.persistencePriority};t.telemetry.sendTelemetryEvent(n,e.eventName,e.eventContract,r,e.dataFields)})),t.sync(),[4,(r=c,new Promise((function(e){return setTimeout(e,r)})))];case 1:return n.sent(),[2]}var r}))}))}}(t.RichApiSendEvent||(t.RichApiSendEvent={}))},function(t,n){if(void 0===e){var r=new Error('Cannot find module "@microsoft/office-api/office.core"');throw r.code="MODULE_NOT_FOUND",r}t.exports=e},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(5),s=n(31);!function(e){function t(e,t,r){r(n(e,t))}function n(e,t){return new c(e,t)}e.startPromise=function(e,n){t(e,void 0,n)},e.startPromiseWithParent=t,e.getNew=n;var c=function(){function e(t,n){this.eventName=t;var r=o.STE.checkReady();if(r&&!1===r.eventAccepted)throw r.message;this.cv=n?s.CorrelationVector.getNextChild(n.cv):s.CorrelationVector.getNext(),this.dataContracts=[],this.dataFields=[],this.result=void 0,this.success=void 0,this.startTime=e.getCurrentMicroseconds()}return e.getCurrentMicroseconds=function(){return 1e3*(new Date).getTime()},e.prototype.addDataContract=function(e){this.dataContracts.push(e)},e.prototype.addDataField=function(e,t,n){this.dataFields.push({name:e,value:t,classification:n})},e.prototype.setSuccess=function(e){this.success=e},e.prototype.setResult=function(e,t,n){this.result=new a.Contracts.Office.System.Result(e,t,n)},e.prototype.endNow=function(){return r(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(i){return t=e.getCurrentMicroseconds(),n=t-this.startTime,r=new a.Contracts.Office.System.Activity(n,1,0,this.cv.getString(),this.success,this.result),[2,o.STE.sendTelemetryEvent({eventName:this.eventName,eventContract:r,dataFields:this.dataFields,dataContracts:this.dataContracts})]}))}))},e}();e.ActivityScope=c}(t.Activity||(t.Activity={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){};t.FieldSpecification=i;var o=function(){function e(e){this._contractName=e}return e.prototype.getUnqualifiedName=function(){return this._contractName.split(".").pop()},e.prototype.getContractName=function(){return this._contractName},e.prototype.getFields=function(e){var t=this,n=[];return null!=e&&""!==e||(e=this.getUnqualifiedName()),this.fields.forEach((function(r){if(r.required&&null==t[r.name])throw new Error("Data contract "+t._contractName+" is missing required field: "+r.name);if(null!=t[r.name]){var i=e+"."+r.name;"object"==typeof t[r.name]&&"function"==typeof t[r.name].getFields?n.push.apply(n,t[r.name].getFields(i)):n.push({name:i,value:t[r.name],classification:r.classification})}})),n.push({name:"zC."+e,value:this._contractName,classification:r.DataClassification.SystemMetadata}),n},e}();t.BaseContract=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<19;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(t,++n)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(t.CorrelationVector||(t.CorrelationVector={}))},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=n(2);!function(e){function t(e,t,n,s,c,l,u){return r(this,void 0,void 0,(function(){var r,d;return i(this,(function(i){return r=new o.Contracts.Office.System.Error(t,n,s,c,l),d=[],void 0!==u&&d.push(u),[2,a.STE.sendTelemetryEvent({eventName:e,eventContract:r,dataContracts:d})]}))}))}e.sendError=function(e,n,o,a,s,c){return r(this,void 0,void 0,(function(){return i(this,(function(r){return[2,t(e,n,o,a,s,c)]}))}))},e.sendErrorWithSdx=t}(t.Error||(t.Error={}))}])},e.exports=r(function(){try{return n(15163)}catch(e){}}())},15163:function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},i=n(15164),o=(i.ObjectPathFactory.createPropertyObjectPath,i.ObjectPathFactory.createMethodObjectPath),a=(i.ObjectPathFactory.createIndexerObjectPath,i.ObjectPathFactory.createNewObjectObjectPath),s=(i.ObjectPathFactory.createChildItemObjectPathUsingIndexer,i.ObjectPathFactory.createChildItemObjectPathUsingGetItemAt,i.ObjectPathFactory.createChildItemObjectPathUsingIndexerOrGetItemAt,i.ActionFactory.createMethodAction),c=(i.ActionFactory.createSetPropertyAction,i.Utility.isNullOrUndefined),l=i.Utility.isUndefined,u=i.Utility.throwIfNotLoaded,d=(i.Utility.throwIfApiNotSupported,i.Utility.load),f=i.Utility.fixObjectPathIfNecessary,h=i.Utility._addActionResultHandler,g=(i.Utility._handleNavigationPropertyResults,i.Utility.adjustToDateTime,function(e){function t(){e.apply(this,arguments)}return r(t,e),Object.defineProperty(t.prototype,"_className",{get:function(){return"FlightingService"},enumerable:!0,configurable:!0}),t.prototype.getClientSessionId=function(){var e=s(this.context,this,"GetClientSessionId",1,[]),t=new i.ClientResult;return h(this,e,t),t},t.prototype.getDeferredFlights=function(){var e=s(this.context,this,"GetDeferredFlights",1,[]),t=new i.ClientResult;return h(this,e,t),t},t.prototype.getFeature=function(e,t,n,r){return new p(this.context,o(this.context,this,"GetFeature",1,[e,t,n,r],!1,!1,null))},t.prototype.getFeatureGate=function(e,t){return new p(this.context,o(this.context,this,"GetFeatureGate",1,[e,t],!1,!1,null))},t.prototype.resetOverride=function(e){s(this.context,this,"ResetOverride",0,[e])},t.prototype.setOverride=function(e,t,n){s(this.context,this,"SetOverride",0,[e,t,n])},t.prototype._handleResult=function(t){(e.prototype._handleResult.call(this,t),c(t))||f(this,t)},t.newObject=function(e){return new t(e,a(e,"Microsoft.Experiment.FlightingService",!1))},t.prototype.toJSON=function(){return{}},t}(i.ClientObject));t.FlightingService=g;var p=function(e){function t(){e.apply(this,arguments)}return r(t,e),Object.defineProperty(t.prototype,"_className",{get:function(){return"ABType"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return u("value",this.m_value,"ABType",this._isNull),this.m_value},enumerable:!0,configurable:!0}),t.prototype._handleResult=function(t){if(e.prototype._handleResult.call(this,t),!c(t)){var n=t;f(this,n),l(n.Value)||(this.m_value=n.Value)}},t.prototype.load=function(e){return d(this,e),this},t.prototype.toJSON=function(){return{value:this.m_value}},t}(i.ClientObject);t.ABType=p,function(e){e.boolean="Boolean",e.integer="Integer",e.string="String"}(t.FeatureType||(t.FeatureType={})),function(e){e.generalException="GeneralException"}(t.ExperimentErrorCodes||(t.ExperimentErrorCodes={}));var m=function(e){function t(t){e.call(this,t)}return r(t,e),Object.defineProperty(t.prototype,"flighting",{get:function(){return this.flightingService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"telemetry",{get:function(){return this.m_telemetry||(this.m_telemetry=y.newObject(this)),this.m_telemetry},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"flightingService",{get:function(){return this.m_flightingService||(this.m_flightingService=g.newObject(this)),this.m_flightingService},enumerable:!0,configurable:!0}),t}(i.ClientRequestContext);t.RequestContext=m;i.ObjectPathFactory.createPropertyObjectPath,o=i.ObjectPathFactory.createMethodObjectPath,i.ObjectPathFactory.createIndexerObjectPath,a=i.ObjectPathFactory.createNewObjectObjectPath,i.ObjectPathFactory.createChildItemObjectPathUsingIndexer,i.ObjectPathFactory.createChildItemObjectPathUsingGetItemAt,i.ObjectPathFactory.createChildItemObjectPathUsingIndexerOrGetItemAt,s=i.ActionFactory.createMethodAction,i.ActionFactory.createSetPropertyAction,c=i.Utility.isNullOrUndefined,l=i.Utility.isUndefined,u=i.Utility.throwIfNotLoaded,i.Utility.throwIfApiNotSupported,d=i.Utility.load,f=i.Utility.fixObjectPathIfNecessary,h=i.Utility._addActionResultHandler,i.Utility._handleNavigationPropertyResults,i.Utility.adjustToDateTime;var y=function(e){function t(){e.apply(this,arguments)}return r(t,e),Object.defineProperty(t.prototype,"_className",{get:function(){return"TelemetryService"},enumerable:!0,configurable:!0}),t.prototype.sendTelemetryEvent=function(e,t,n,r,i){s(this.context,this,"SendTelemetryEvent",0,[e,t,n,r,i],!1)},t.prototype._handleResult=function(t){(e.prototype._handleResult.call(this,t),c(t))||f(this,t)},t.newObject=function(e){return new t(e,a(e,"Microsoft.Telemetry.TelemetryService",!1,!1))},t.prototype.toJSON=function(){return{}},t}(i.ClientObject);t.TelemetryService=y,function(e){e.generalException="GeneralException"}(t.ErrorCodes||(t.ErrorCodes={}))},15164:function(e,t,n){"use strict";(function(e,n){
/*
* @overview es6-promise - a tiny implementation of Promises/A+.
* @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
* @license   Licensed under MIT license
*            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
* @version   2.3.0
*/
var r=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},i=function(){function e(e,t,n){this.m_actionInfo=e,this.m_isWriteOperation=t,this.m_isRestrictedResourceAccess=n}return Object.defineProperty(e.prototype,"actionInfo",{get:function(){return this.m_actionInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWriteOperation",{get:function(){return this.m_isWriteOperation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRestrictedResourceAccess",{get:function(){return this.m_isRestrictedResourceAccess},enumerable:!0,configurable:!0}),e}();t.Action=i;var o=function(){function e(e){this.m_callback=e}return e.prototype._handleResult=function(e){this.m_callback&&this.m_callback()},e}(),a=function(){function e(){}return e.createSetPropertyAction=function(e,t,n,r){H.validateObjectPath(t);var o={Id:e._nextId(),ActionType:4,Name:n,ObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},a=[r],s=H.setMethodArguments(e,o.ArgumentInfo,a);H.validateReferencedObjectPaths(s);var c=new i(o,!0,!1);return e._pendingRequest.addAction(c),e._pendingRequest.addReferencedObjectPath(t._objectPath),e._pendingRequest.addReferencedObjectPaths(s),c},e.createMethodAction=function(e,t,n,r,o,a){H.validateObjectPath(t);var s={Id:e._nextId(),ActionType:3,Name:n,ObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},c=H.setMethodArguments(e,s.ArgumentInfo,o);H.validateReferencedObjectPaths(c);var l=new i(s,1!=r,a);return e._pendingRequest.addAction(l),e._pendingRequest.addReferencedObjectPath(t._objectPath),e._pendingRequest.addReferencedObjectPaths(c),l},e.createQueryAction=function(e,t,n){H.validateObjectPath(t);var r={Id:e._nextId(),ActionType:2,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id};r.QueryInfo=n;var o=new i(r,!1,!1);return e._pendingRequest.addAction(o),e._pendingRequest.addReferencedObjectPath(t._objectPath),o},e.createRecursiveQueryAction=function(e,t,n){H.validateObjectPath(t);var r={Id:e._nextId(),ActionType:6,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id,RecursiveQueryInfo:n},o=new i(r,!1,!1);return e._pendingRequest.addAction(o),e._pendingRequest.addReferencedObjectPath(t._objectPath),o},e.createInstantiateAction=function(e,t){H.validateObjectPath(t);var n={Id:e._nextId(),ActionType:1,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id},r=new i(n,!1,!1);return e._pendingRequest.addAction(r),e._pendingRequest.addReferencedObjectPath(t._objectPath),e._pendingRequest.addActionResultHandler(r,new w(t)),r},e.createTraceAction=function(e,t,n){var r={Id:e._nextId(),ActionType:5,Name:"Trace",ObjectPathId:0},o=new i(r,!1,!1);return e._pendingRequest.addAction(o),n&&e._pendingRequest.addTrace(r.Id,t),o},e.createTraceMarkerForCallback=function(t,n){var r=e.createTraceAction(t,null,!1);t._pendingRequest.addActionResultHandler(r,new o(n))},e}();t.ActionFactory=a;var s=function(){function e(e,t){H.checkArgumentNull(e,"context"),this.m_context=e,this.m_objectPath=t,this.m_objectPath&&(e._processingResult||(a.createInstantiateAction(e,this),e._autoCleanup&&this._KeepReference&&e.trackedObjects._autoAdd(this)))}return Object.defineProperty(e.prototype,"context",{get:function(){return this.m_context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_objectPath",{get:function(){return this.m_objectPath},set:function(e){this.m_objectPath=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNull",{get:function(){return H.throwIfNotLoaded("isNull",this._isNull,null,this._isNull),this._isNull},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNullObject",{get:function(){return H.throwIfNotLoaded("isNullObject",this._isNull,null,this._isNull),this._isNull},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isNull",{get:function(){return this.m_isNull},set:function(e){this.m_isNull=e,e&&this.m_objectPath&&this.m_objectPath._updateAsNullObject()},enumerable:!0,configurable:!0}),e.prototype._handleResult=function(e){this._isNull=H.isNullOrUndefined(e),this.context.trackedObjects._autoTrackIfNecessaryWhenHandleObjectResultValue(this,e)},e.prototype._handleIdResult=function(e){this._isNull=H.isNullOrUndefined(e),H.fixObjectPathIfNecessary(this,e),this.context.trackedObjects._autoTrackIfNecessaryWhenHandleObjectResultValue(this,e)},e.prototype._recursivelySet=function(t,n,r,i,o){var a=t instanceof e;if(a){if(Object.getPrototypeOf(this)!==Object.getPrototypeOf(t))throw F.RuntimeError._createInvalidArgError({argumentName:"properties",errorLocation:this._className+".set"});t=JSON.parse(JSON.stringify(t))}try{for(var s,c=0;c<r.length;c++)s=r[c],t.hasOwnProperty(s)&&(this[s]=t[s]);for(c=0;c<i.length;c++)s=i[c],t.hasOwnProperty(s)&&this[s].set(t[s],n);for(c=0;c<o.length;c++)if(s=o[c],t.hasOwnProperty(s))throw new F.RuntimeError({code:_.invalidArgument,message:H._getResourceString(L.cannotApplyPropertyThroughSetMethod,s),debugInfo:{errorLocation:s}});var l=!a;for(s in n&&!H.isNullOrUndefined(l)&&(l=n.throwOnReadOnly),t)if(r.indexOf(s)<0&&i.indexOf(s)<0){var u=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),s);if(!u)throw new F.RuntimeError({code:_.invalidArgument,message:H._getResourceString(L.propertyDoesNotExist,s),debugInfo:{errorLocation:s}});if(l&&!u.set)throw new F.RuntimeError({code:_.invalidArgument,message:H._getResourceString(L.attemptingToSetReadOnlyProperty,s),debugInfo:{errorLocation:s}})}}catch(e){throw new F.RuntimeError({code:_.invalidArgument,message:H._getResourceString(L.invalidArgument,"properties"),debugInfo:{errorLocation:this._className+".set"},innerError:e})}},e}();t.ClientObject=s;var c=function(){function e(e){this.m_context=e,this.m_actions=[],this.m_actionResultHandler={},this.m_referencedObjectPaths={},this.m_flags=0,this.m_traceInfos={},this.m_pendingProcessEventHandlers=[],this.m_pendingEventHandlerActions={},this.m_responseTraceIds={},this.m_responseTraceMessages=[],this.m_preSyncPromises=[]}return Object.defineProperty(e.prototype,"flags",{get:function(){return this.m_flags},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"traceInfos",{get:function(){return this.m_traceInfos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_responseTraceMessages",{get:function(){return this.m_responseTraceMessages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_responseTraceIds",{get:function(){return this.m_responseTraceIds},enumerable:!0,configurable:!0}),e.prototype._setResponseTraceIds=function(e){if(e)for(var t=0;t<e.length;t++){var n=e[t];this.m_responseTraceIds[n]=n;var r=this.m_traceInfos[n];H.isNullOrUndefined(r)||this.m_responseTraceMessages.push(r)}},e.prototype.addAction=function(e){e.isWriteOperation&&(this.m_flags=1|this.m_flags),e.isRestrictedResourceAccess&&(this.m_flags=2|this.m_flags),this.m_actions.push(e)},Object.defineProperty(e.prototype,"hasActions",{get:function(){return this.m_actions.length>0},enumerable:!0,configurable:!0}),e.prototype.addTrace=function(e,t){this.m_traceInfos[e]=t},e.prototype.addReferencedObjectPath=function(e){if(!this.m_referencedObjectPaths[e.objectPathInfo.Id]){if(!e.isValid)throw new F.RuntimeError({code:_.invalidObjectPath,message:H._getResourceString(L.invalidObjectPath,H.getObjectPathExpression(e)),debugInfo:{errorLocation:H.getObjectPathExpression(e)}});for(;e;)e.isWriteOperation&&(this.m_flags=1|this.m_flags),e.isRestrictedResourceAccess&&(this.m_flags=2|this.m_flags),this.m_referencedObjectPaths[e.objectPathInfo.Id]=e,3==e.objectPathInfo.ObjectPathType&&this.addReferencedObjectPaths(e.argumentObjectPaths),e=e.parentObjectPath}},e.prototype.addReferencedObjectPaths=function(e){if(e)for(var t=0;t<e.length;t++)this.addReferencedObjectPath(e[t])},e.prototype.addActionResultHandler=function(e,t){this.m_actionResultHandler[e.actionInfo.Id]=t},e.prototype.buildRequestMessageBody=function(){var e={};for(var t in this.m_referencedObjectPaths)e[t]=this.m_referencedObjectPaths[t].objectPathInfo;for(var n=[],r=0;r<this.m_actions.length;r++)n.push(this.m_actions[r].actionInfo);return{AutoKeepReference:this.m_context._autoCleanup,Actions:n,ObjectPaths:e}},e.prototype.processResponse=function(e){if(e)for(var t=0;t<e.length;t++){var n=e[t],r=this.m_actionResultHandler[n.ActionId];r&&r._handleResult(n.Value)}},e.prototype.invalidatePendingInvalidObjectPaths=function(){for(var e in this.m_referencedObjectPaths)this.m_referencedObjectPaths[e].isInvalidAfterRequest&&(this.m_referencedObjectPaths[e].isValid=!1)},e.prototype._addPendingEventHandlerAction=function(e,t){this.m_pendingEventHandlerActions[e._id]||(this.m_pendingEventHandlerActions[e._id]=[],this.m_pendingProcessEventHandlers.push(e)),this.m_pendingEventHandlerActions[e._id].push(t)},Object.defineProperty(e.prototype,"_pendingProcessEventHandlers",{get:function(){return this.m_pendingProcessEventHandlers},enumerable:!0,configurable:!0}),e.prototype._getPendingEventHandlerActions=function(e){return this.m_pendingEventHandlerActions[e._id]},e.prototype._addPreSyncPromise=function(e){this.m_preSyncPromises.push(e)},Object.defineProperty(e.prototype,"_preSyncPromises",{get:function(){return this.m_preSyncPromises},enumerable:!0,configurable:!0}),e}();t.ClientRequest=c;var l=function(){function e(){}return e.prototype._resolveRequestUrlAndHeaderInfo=function(){return H._createPromiseFromResult(null)},e.prototype._createRequestExecutorOrNull=function(){return null},Object.defineProperty(e.prototype,"eventRegistration",{get:function(){return F.officeJsEventRegistration},enumerable:!0,configurable:!0}),e}();t.SessionBase=l;var u=function(){function e(t){if(this.m_customRequestHeaders={},this._onRunFinishedNotifiers=[],this.m_nextId=0,e._overrideSession)this.m_requestUrlAndHeaderInfoResolver=e._overrideSession;else if((H.isNullOrUndefined(t)||"string"==typeof t&&0===t.length)&&((t=e.defaultRequestUrlAndHeaders)||(t={url:f.localDocument,headers:{}})),"string"==typeof t)this.m_requestUrlAndHeaderInfo={url:t,headers:{}};else if(e.isRequestUrlAndHeaderInfoResolver(t))this.m_requestUrlAndHeaderInfoResolver=t;else{if(!e.isRequestUrlAndHeaderInfo(t))throw F.RuntimeError._createInvalidArgError("url");var n=t;this.m_requestUrlAndHeaderInfo={url:n.url,headers:{}},H._copyHeaders(n.headers,this.m_requestUrlAndHeaderInfo.headers)}this.m_requestUrlAndHeaderInfoResolver instanceof l&&(this.m_session=this.m_requestUrlAndHeaderInfoResolver),this._processingResult=!1,this._customData=f.iterativeExecutor,this.sync=this.sync.bind(this)}return Object.defineProperty(e.prototype,"session",{get:function(){return this.m_session},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventRegistration",{get:function(){return this.m_session?this.m_session.eventRegistration:F.officeJsEventRegistration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_url",{get:function(){return this.m_requestUrlAndHeaderInfo?this.m_requestUrlAndHeaderInfo.url:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_pendingRequest",{get:function(){return null==this.m_pendingRequest&&(this.m_pendingRequest=new c(this)),this.m_pendingRequest},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trackedObjects",{get:function(){return this.m_trackedObjects||(this.m_trackedObjects=new B(this)),this.m_trackedObjects},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestHeaders",{get:function(){return this.m_customRequestHeaders},enumerable:!0,configurable:!0}),e.prototype.load=function(t,n){H.validateContext(this,t);var r=e.parseQueryOption(n),i=a.createQueryAction(this,t,r);this._pendingRequest.addActionResultHandler(i,t)},e.parseQueryOption=function(e){var t={};if("string"==typeof e){var n=e;t.Select=H._parseSelectExpand(n)}else if(Array.isArray(e))t.Select=e;else if("object"==typeof e){var r=e;"string"==typeof r.select?t.Select=H._parseSelectExpand(r.select):Array.isArray(r.select)?t.Select=r.select:H.isNullOrUndefined(r.select)||H.throwError(L.invalidArgument,"option.select"),"string"==typeof r.expand?t.Expand=H._parseSelectExpand(r.expand):Array.isArray(r.expand)?t.Expand=r.expand:H.isNullOrUndefined(r.expand)||H.throwError(L.invalidArgument,"option.expand"),"number"==typeof r.top?t.Top=r.top:H.isNullOrUndefined(r.top)||H.throwError(L.invalidArgument,"option.top"),"number"==typeof r.skip?t.Skip=r.skip:H.isNullOrUndefined(r.skip)||H.throwError(L.invalidArgument,"option.skip")}else H.isNullOrUndefined(e)||H.throwError(L.invalidArgument,"option");return t},e.prototype.loadRecursive=function(t,n,r){if(!H.isPlainJsonObject(n))throw F.RuntimeError._createInvalidArgError("options");var i={};for(var o in n)i[o]=e.parseQueryOption(n[o]);var s=a.createRecursiveQueryAction(this,t,{Queries:i,MaxDepth:r});this._pendingRequest.addActionResultHandler(s,t)},e.prototype.trace=function(e){a.createTraceAction(this,e,!0)},e.prototype._processOfficeJsErrorResponse=function(e,t){},e.prototype.syncPrivateMain=function(){var e=this;return H._createPromiseFromResult(null).then((function(){if(!e.m_requestUrlAndHeaderInfo)return e.m_requestUrlAndHeaderInfoResolver._resolveRequestUrlAndHeaderInfo().then((function(t){if(e.m_requestUrlAndHeaderInfo=t,e.m_requestUrlAndHeaderInfo||(e.m_requestUrlAndHeaderInfo={url:f.localDocument,headers:{}}),H.isNullOrEmptyString(e.m_requestUrlAndHeaderInfo.url)&&(e.m_requestUrlAndHeaderInfo.url=f.localDocument),e.m_requestUrlAndHeaderInfo.headers||(e.m_requestUrlAndHeaderInfo.headers={}),"function"==typeof e.m_requestUrlAndHeaderInfoResolver._createRequestExecutorOrNull){var n=e.m_requestUrlAndHeaderInfoResolver._createRequestExecutorOrNull();n&&(e._requestExecutor=n)}}))})).then((function(){var t=e._pendingRequest;return e.m_pendingRequest=null,e.processPreSyncPromises(t).then((function(){return e.syncPrivate(t)}))}))},e.prototype.syncPrivate=function(e){var t=this;if(!e.hasActions)return this.processPendingEventHandlers(e);var n=e.buildRequestMessageBody(),r=e.flags;this._requestExecutor||(H._isLocalDocumentUrl(this.m_requestUrlAndHeaderInfo.url)?this._requestExecutor=new k(this):this._requestExecutor=new E);var i=this._requestExecutor,o={};H._copyHeaders(this.m_requestUrlAndHeaderInfo.headers,o),H._copyHeaders(this.m_customRequestHeaders,o);var a={Url:this.m_requestUrlAndHeaderInfo.url,Headers:o,Body:n};e.invalidatePendingInvalidObjectPaths();var s=null,c=null;return i.executeAsync(this._customData,r,a).then((function(n){return s=t.processRequestExecutorResponseMessage(e,n),t.processPendingEventHandlers(e).catch((function(e){H.log("Error in processPendingEventHandlers"),H.log(JSON.stringify(e)),c=e}))})).then((function(){if(s)throw H.log("Throw error from response: "+JSON.stringify(s)),s;if(c){H.log("Throw error from ProcessEventHandler: "+JSON.stringify(c));var t=null;if(c instanceof F.RuntimeError)(t=c).traceMessages=e._responseTraceMessages;else{var n=null;n="string"==typeof c?c:c.message,H.isNullOrEmptyString(n)&&(n=H._getResourceString(L.cannotRegisterEvent)),t=new F.RuntimeError({code:_.cannotRegisterEvent,message:n,traceMessages:e._responseTraceMessages})}throw t}}))},e.prototype.processRequestExecutorResponseMessage=function(e,t){t.Body&&t.Body.TraceIds&&e._setResponseTraceIds(t.Body.TraceIds);var n=e._responseTraceMessages;if(t.Body){var r=null;if(t.Body.Results?r=t.Body.Results:t.Body.ProcessedResults&&t.Body.ProcessedResults.Results&&(r=t.Body.ProcessedResults.Results),r){this._processingResult=!0;try{e.processResponse(r)}finally{this._processingResult=!1}}}return H.isNullOrEmptyString(t.ErrorCode)?t.Body&&t.Body.Error?new F.RuntimeError({code:t.Body.Error.Code,message:t.Body.Error.Message,traceMessages:n,debugInfo:{errorLocation:t.Body.Error.Location}}):null:new F.RuntimeError({code:t.ErrorCode,message:t.ErrorMessage,traceMessages:n})},e.prototype.processPendingEventHandlers=function(e){for(var t=H._createPromiseFromResult(null),n=0;n<e._pendingProcessEventHandlers.length;n++){var r=e._pendingProcessEventHandlers[n];t=t.then(this.createProcessOneEventHandlersFunc(r,e))}return t},e.prototype.createProcessOneEventHandlersFunc=function(e,t){return function(){return e._processRegistration(t)}},e.prototype.processPreSyncPromises=function(e){for(var t=H._createPromiseFromResult(null),n=0;n<e._preSyncPromises.length;n++){var r=e._preSyncPromises[n];t=t.then(this.createProcessOneProSyncFunc(r))}return t},e.prototype.createProcessOneProSyncFunc=function(e){return function(){return e}},e.prototype.sync=function(e){return this.syncPrivateMain().then((function(){return e}))},e._run=function(t,n,r,i,o,a){return void 0===r&&(r=3),void 0===i&&(i=5e3),e._runCommon("run",null,t,n,r,i,o,a)},e.isRequestUrlAndHeaderInfo=function(e){return"object"==typeof e&&null!==e&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})&&!H.isNullOrUndefined(e.url)},e.isRequestUrlAndHeaderInfoResolver=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e._resolveRequestUrlAndHeaderInfo},e._runBatch=function(t,n,r,i,o,a,c){var l,u;void 0===i&&(i=3),void 0===o&&(o=5e3);var d=null,f=0;if(n.length>0&&("string"==typeof n[0]||e.isRequestUrlAndHeaderInfo(n[0])||e.isRequestUrlAndHeaderInfoResolver(n[0]))&&(d=n[0],f=1),n.length==f+1)l=r,u=n[f+0];else{if(n.length!=f+2)return e.createErrorPromise(t);if(n[f+0]instanceof s)l=function(){return n[f+0].context};else{if(!Array.isArray(n[f+0]))return e.createErrorPromise(t);var h=n[f+0];if(0==h.length)return e.createErrorPromise(t);for(var g=0;g<h.length;g++){if(!(h[g]instanceof s))return e.createErrorPromise(t);if(h[g].context!=h[0].context)return e.createErrorPromise(t,L.invalidRequestContext)}l=function(){return h[0].context}}u=n[f+1]}return e._runCommon(t,d,l,u,i,o,a,c)},e.createErrorPromise=function(e,t){return void 0===t&&(t=L.invalidArgument),F.OfficePromise.reject(H.createRuntimeError(t,H._getResourceString(t),e))},e._runCommon=function(t,n,r,i,o,a,s,c){e._overrideSession&&(n=e._overrideSession);var l,u,d=new F.OfficePromise((function(e,t){e()})),f=!1;return d.then((function(){if((l=r(n))._autoCleanup)return new F.OfficePromise((function(e,t){l._onRunFinishedNotifiers.push((function(){l._autoCleanup=!0,e()}))}));l._autoCleanup=!0})).then((function(){if("function"!=typeof i)return e.createErrorPromise(t);var n=i(l);return(H.isNullOrUndefined(n)||"function"!=typeof n.then)&&H.throwError(L.runMustReturnPromise),n})).then((function(e){return l.sync(e)})).then((function(e){f=!0,u=e})).catch((function(e){u=e})).then((function(){var t=l.trackedObjects._retrieveAndClearAutoCleanupList();for(var r in l._autoCleanup=!1,t)t[r]._objectPath.isValid=!1;var i=0;if(H._synchronousCleanup||e.isRequestUrlAndHeaderInfoResolver(n))return u();function u(){for(var e in i++,t)l.trackedObjects.remove(t[e]);return l.sync().then((function(){s&&s(i)})).catch((function(){c&&c(i),i<o&&setTimeout((function(){u()}),a)}))}u()})).then((function(){l._onRunFinishedNotifiers&&l._onRunFinishedNotifiers.length>0&&l._onRunFinishedNotifiers.shift()();if(f)return u;throw u}))},e.prototype._nextId=function(){return++this.m_nextId},e}();t.ClientRequestContext=u;var d=function(){function e(e){this.m_type=e}return Object.defineProperty(e.prototype,"value",{get:function(){if(!this.m_isLoaded)throw new F.RuntimeError({code:_.valueNotLoaded,message:H._getResourceString(L.valueNotLoaded),debugInfo:{errorLocation:"clientResult.value"}});return this.m_value},enumerable:!0,configurable:!0}),e.prototype._handleResult=function(e){this.m_isLoaded=!0,"object"==typeof e&&e&&e._IsNull||(1===this.m_type?this.m_value=H.adjustToDateTime(e):this.m_value=e)},e}();t.ClientResult=d;var f=function(){function e(){}return e.flags="flags",e.getItemAt="GetItemAt",e.id="Id",e.idPrivate="_Id",e.index="_Index",e.items="_Items",e.iterativeExecutor="IterativeExecutor",e.localDocument="http://document.localhost/",e.localDocumentApiPrefix="http://document.localhost/_api/",e.processQuery="ProcessQuery",e.referenceId="_ReferenceId",e.isTracked="_IsTracked",e.sourceLibHeader="SdkVersion",e.embeddingPageOrigin="EmbeddingPageOrigin",e.embeddingPageSessionInfo="EmbeddingPageSessionInfo",e.eventMessageCategory=65536,e.eventWorkbookId="Workbook",e.eventSourceRemote="Remote",e}();t.Constants=f;var h,g,p=1,m=function(e){return e.DdaMethod.Version=p,e},y=function(e){return p=e.Version,e.Error&&(e.error={},e.error.Code=e.Error),e};!function(e){e[e.Success=0]="Success",e[e.Timeout=1]="Timeout",e[e.InternalError=5001]="InternalError"}(h||(h={})),function(e){e.SendingId="sId",e.RespondingId="rId",e.CommandKey="command",e.SessionInfoKey="sessionInfo",e.ParamsKey="params",e.ApiReadyCommand="apiready",e.ExecuteMethodCommand="executeMethod",e.GetAppContextCommand="getAppContext",e.RegisterEventCommand="registerEvent",e.UnregisterEventCommand="unregisterEvent",e.FireEventCommand="fireEvent"}(g||(g={}));var b=function(e){function t(t,n){e.call(this),this.m_chosenWindow=null,this.m_chosenOrigin=null,this.m_enabled=!0,this.m_onMessageHandler=this._onMessage.bind(this),this.m_callbackList={},this.m_id=0,this.m_timeoutId=-1,this.m_appContext=null,this.m_url=t,this.m_options=n,this.m_options||(this.m_options={sessionKey:Math.random().toString()}),this.m_options.sessionKey||(this.m_options.sessionKey=Math.random().toString()),this.m_options.container||(this.m_options.container=document.body),this.m_options.timeoutInMilliseconds||(this.m_options.timeoutInMilliseconds=6e4),this.m_options.height||(this.m_options.height="400px"),this.m_options.width||(this.m_options.width="100%")}return r(t,e),t.prototype._getIFrameSrc=function(){var e=window.location.protocol+"//"+window.location.host,t=f.embeddingPageOrigin+"="+encodeURIComponent(e)+"&"+f.embeddingPageSessionInfo+"="+encodeURIComponent(this.m_options.sessionKey),n=!1;this.m_url.toLowerCase().indexOf("/_layouts/preauth.aspx")>0&&(n=!0);var r=document.createElement("a");return r.href=this.m_url,n?0===r.hash.length||"#"===r.hash?r.hash="#"+t:r.hash=r.hash+"&"+t:0===r.search.length||"?"===r.search?r.search="?"+t:r.search=r.search+"&"+t,r.href},t.prototype.init=function(){var e=this;window.addEventListener("message",this.m_onMessageHandler);var t=this._getIFrameSrc();return new F.OfficePromise((function(n,r){var i=document.createElement("iframe");e.m_options.id&&(i.id=e.m_options.id),i.style.height=e.m_options.height,i.style.width=e.m_options.width,i.src=t,e.m_options.container.appendChild(i),e.m_timeoutId=setTimeout((function(){e.close();var t=H.createRuntimeError(_.timeout,H._getResourceString(L.timeout),"EmbeddedSession.init");r(t)}),e.m_options.timeoutInMilliseconds),e.m_promiseResolver=n}))},t.prototype._invoke=function(e,t,n){this.m_enabled?(m&&(n=m(n)),this._sendMessageWithCallback(this.m_id++,e,n,(function(e){y&&(e=y(e));var n=e.Error;delete e.Error,t(n||h.Success,e)}))):t(h.InternalError,null)},t.prototype.close=function(){window.removeEventListener("message",this.m_onMessageHandler),window.clearTimeout(this.m_timeoutId),this.m_enabled=!1},Object.defineProperty(t.prototype,"eventRegistration",{get:function(){return this.m_sessionEventManager||(this.m_sessionEventManager=new C(this._registerEventImpl.bind(this),this._unregisterEventImpl.bind(this))),this.m_sessionEventManager},enumerable:!0,configurable:!0}),t.prototype._createRequestExecutorOrNull=function(){return new v(this)},t.prototype._resolveRequestUrlAndHeaderInfo=function(){return H._createPromiseFromResult(null)},t.prototype._registerEventImpl=function(e,t){var n=this;return new F.OfficePromise((function(r,i){n._sendMessageWithCallback(n.m_id++,g.RegisterEventCommand,{EventId:e,TargetId:t},(function(){r(null)}))}))},t.prototype._unregisterEventImpl=function(e,t){var n=this;return new F.OfficePromise((function(r,i){n._sendMessageWithCallback(n.m_id++,g.UnregisterEventCommand,{EventId:e,TargetId:t},(function(){r()}))}))},t.prototype._onMessage=function(e){var t=this;if(this.m_enabled&&(!this.m_chosenWindow||this.m_chosenWindow===e.source&&this.m_chosenOrigin===e.origin)){var n=e.data;if(n&&n[g.CommandKey]===g.ApiReadyCommand)!this.m_chosenWindow&&this._isValidDescendant(e.source)&&n[g.SessionInfoKey]===this.m_options.sessionKey&&(this.m_chosenWindow=e.source,this.m_chosenOrigin=e.origin,this._sendMessageWithCallback(this.m_id++,g.GetAppContextCommand,null,(function(e){t._setupContext(e),window.clearTimeout(t.m_timeoutId),t.m_promiseResolver()})));else if(n&&n[g.CommandKey]===g.FireEventCommand){var r=n[g.ParamsKey],i=r.EventId,o=r.TargetId,a=r.Data;if(this.m_sessionEventManager)for(var s=this.m_sessionEventManager.getHandlers(i,o),c=0;c<s.length;c++)s[c](a)}else if(n&&n.hasOwnProperty(g.RespondingId)){var l=n[g.RespondingId],u=this.m_callbackList[l];"function"==typeof u&&u(n[g.ParamsKey]),delete this.m_callbackList[l]}}},t.prototype._sendMessageWithCallback=function(e,t,n,r){this.m_callbackList[e]=r;var i={};i[g.SendingId]=e,i[g.CommandKey]=t,i[g.ParamsKey]=n,this.m_chosenWindow.postMessage(JSON.stringify(i),this.m_chosenOrigin)},t.prototype._isValidDescendant=function(e){function t(n){if(n===e)return!0;for(var r=0,i=n.frames.length;r<i;r++)if(t(n.frames[r]))return!0;return!1}for(var n=(this.m_options.container||document.body).getElementsByTagName("iframe"),r=0,i=n.length;r<i;r++)if(t(n[r].contentWindow))return!0;return!1},t.prototype._setupContext=function(e){this.m_appContext=e},t}(l);t.EmbeddedSession=b;var v=function(){function e(e){this.m_session=e}return e.prototype.executeAsync=function(t,n,r){var i=this,o=U.buildMessageArrayForIRequestExecutor(t,n,r,e.SourceLibHeaderValue);return new F.OfficePromise((function(t,n){i.m_session._invoke(g.ExecuteMethodCommand,(function(e,n){var r;H.log("Response:"),H.log(JSON.stringify(n)),r=e==h.Success?U.buildResponseOnSuccess(U.getResponseBodyFromSafeArray(n.Data),U.getResponseHeadersFromSafeArray(n.Data)):U.buildResponseOnError(n.error.Code,n.error.Message),t(r)}),e._transformMessageArrayIntoParams(o))}))},e._transformMessageArrayIntoParams=function(t){return{ArrayData:t,DdaMethod:{DispatchId:e.DispidExecuteRichApiRequestMethod}}},e.DispidExecuteRichApiRequestMethod=93,e.SourceLibHeaderValue="Embedded",e}();!function(e){var t=function(t){function n(e){t.call(this,"string"==typeof e?e:e.message),this.name="Error","string"==typeof e?this.message=e:(this.code=e.code,this.message=e.message,this.traceMessages=e.traceMessages||[],this.innerError=e.innerError||null,this.debugInfo=this._createDebugInfo(e.debugInfo||{}))}return r(n,t),n.prototype.toString=function(){return this.code+": "+this.message},n.prototype._createDebugInfo=function(t){var n={code:this.code,message:this.message,toString:function(){return JSON.stringify(this)}};for(var r in t)n[r]=t[r];return this.innerError&&(this.innerError instanceof e.Error?n.innerError=this.innerError.debugInfo:n.innerError=this.innerError),n},n._createInvalidArgError=function(t){return new e.RuntimeError({code:_.invalidArgument,message:H.isNullOrEmptyString(t.argumentName)?H._getResourceString(L.invalidArgumentGeneric):H._getResourceString(L.invalidArgument,t.argumentName),debugInfo:t.errorLocation?{errorLocation:t.errorLocation}:{},innerError:t.innerError})},n}(Error);e.RuntimeError=t}(F=t._Internal||(t._Internal={})),t.Error=F.RuntimeError;var _=function(){function e(){}return e.accessDenied="AccessDenied",e.generalException="GeneralException",e.activityLimitReached="ActivityLimitReached",e.invalidObjectPath="InvalidObjectPath",e.propertyNotLoaded="PropertyNotLoaded",e.valueNotLoaded="ValueNotLoaded",e.invalidRequestContext="InvalidRequestContext",e.invalidArgument="InvalidArgument",e.runMustReturnPromise="RunMustReturnPromise",e.cannotRegisterEvent="CannotRegisterEvent",e.apiNotFound="ApiNotFound",e.connectionFailure="ConnectionFailure",e.timeout="Timeout",e.invalidOrTimedOutSession="InvalidOrTimedOutSession",e}();t.ErrorCodes=_;var I=function(){function e(e,t,n,r){var i=this;this.m_id=e._nextId(),this.m_context=e,this.m_name=n,this.m_handlers=[],this.m_registered=!1,this.m_eventInfo=r,this.m_callback=function(e){i.m_eventInfo.eventArgsTransformFunc(e).then((function(e){return i.fireEvent(e)}))}}return Object.defineProperty(e.prototype,"_registered",{get:function(){return this.m_registered},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_id",{get:function(){return this.m_id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_handlers",{get:function(){return this.m_handlers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_context",{get:function(){return this.m_context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_callback",{get:function(){return this.m_callback},enumerable:!0,configurable:!0}),e.prototype.add=function(e){var t=a.createTraceAction(this.m_context,null,!1);return this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:t.actionInfo.Id,handler:e,operation:0}),new S(this.m_context,this,e)},e.prototype.remove=function(e){var t=a.createTraceAction(this.m_context,null,!1);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:t.actionInfo.Id,handler:e,operation:1})},e.prototype.removeAll=function(){var e=a.createTraceAction(this.m_context,null,!1);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:e.actionInfo.Id,handler:null,operation:2})},e.prototype._processRegistration=function(e){var t=this,n=H._createPromiseFromResult(null),r=e._getPendingEventHandlerActions(this);if(!r)return n;for(var i=[],o=0;o<this.m_handlers.length;o++)i.push(this.m_handlers[o]);var a=!1;for(o=0;o<r.length;o++)if(e._responseTraceIds[r[o].id])switch(a=!0,r[o].operation){case 0:i.push(r[o].handler);break;case 1:for(var s=i.length-1;s>=0;s--)if(i[s]===r[o].handler){i.splice(s,1);break}break;case 2:i=[]}return a&&(!this.m_registered&&i.length>0?n=n.then((function(){return t.m_eventInfo.registerFunc(t.m_callback)})).then((function(){return t.m_registered=!0})):this.m_registered&&0==i.length&&(n=n.then((function(){return t.m_eventInfo.unregisterFunc(t.m_callback)})).catch((function(e){H.log("Error when unregister event: "+JSON.stringify(e))})).then((function(){return t.m_registered=!1}))),n=n.then((function(){return t.m_handlers=i}))),n},e.prototype.fireEvent=function(e){for(var t=[],n=0;n<this.m_handlers.length;n++){var r=this.m_handlers[n],i=H._createPromiseFromResult(null).then(this.createFireOneEventHandlerFunc(r,e)).catch((function(e){H.log("Error when invoke handler: "+JSON.stringify(e))}));t.push(i)}F.OfficePromise.all(t)},e.prototype.createFireOneEventHandlerFunc=function(e,t){return function(){return e(t)}},e}();t.EventHandlers=I;var S=function(){function e(e,t,n){this.m_context=e,this.m_allHandlers=t,this.m_handler=n}return e.prototype.remove=function(){this.m_allHandlers&&this.m_handler&&(this.m_allHandlers.remove(this.m_handler),this.m_allHandlers=null,this.m_handler=null)},e}();t.EventHandlerResult=S,function(e){var t=function(){function t(){}return t.prototype.register=function(t,n,r){switch(t){case 4:return H.promisify((function(e){return Office.context.document.bindings.getByIdAsync(n,e)})).then((function(e){return H.promisify((function(t){return e.addHandlerAsync(Office.EventType.BindingDataChanged,r,t)}))}));case 3:return H.promisify((function(e){return Office.context.document.bindings.getByIdAsync(n,e)})).then((function(e){return H.promisify((function(t){return e.addHandlerAsync(Office.EventType.BindingSelectionChanged,r,t)}))}));case 2:return H.promisify((function(e){return Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,r,e)}));case 1:return H.promisify((function(e){return Office.context.document.settings.addHandlerAsync(Office.EventType.SettingsChanged,r,e)}));case 5:return H.promisify((function(e){return OSF.DDA.RichApi.richApiMessageManager.addHandlerAsync("richApiMessage",r,e)}));case 13:return H.promisify((function(e){return Office.context.document.addHandlerAsync(Office.EventType.ObjectDeleted,r,{id:n},e)}));case 14:return H.promisify((function(e){return Office.context.document.addHandlerAsync(Office.EventType.ObjectSelectionChanged,r,{id:n},e)}));case 15:return H.promisify((function(e){return Office.context.document.addHandlerAsync(Office.EventType.ObjectDataChanged,r,{id:n},e)}));case 16:return H.promisify((function(e){return Office.context.document.addHandlerAsync(Office.EventType.ContentControlAdded,r,{id:n},e)}));default:throw e.RuntimeError._createInvalidArgError("eventId")}},t.prototype.unregister=function(t,n,r){switch(t){case 4:return H.promisify((function(e){return Office.context.document.bindings.getByIdAsync(n,e)})).then((function(e){return H.promisify((function(t){return e.removeHandlerAsync(Office.EventType.BindingDataChanged,{handler:r},t)}))}));case 3:return H.promisify((function(e){return Office.context.document.bindings.getByIdAsync(n,e)})).then((function(e){return H.promisify((function(t){return e.removeHandlerAsync(Office.EventType.BindingSelectionChanged,{handler:r},t)}))}));case 2:return H.promisify((function(e){return Office.context.document.removeHandlerAsync(Office.EventType.DocumentSelectionChanged,{handler:r},e)}));case 1:return H.promisify((function(e){return Office.context.document.settings.removeHandlerAsync(Office.EventType.SettingsChanged,{handler:r},e)}));case 5:return H.promisify((function(e){return OSF.DDA.RichApi.richApiMessageManager.removeHandlerAsync("richApiMessage",{handler:r},e)}));case 13:return H.promisify((function(e){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectDeleted,{id:n,handler:r},e)}));case 14:return H.promisify((function(e){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectSelectionChanged,{id:n,handler:r},e)}));case 15:return H.promisify((function(e){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectDataChanged,{id:n,handler:r},e)}));case 16:return H.promisify((function(e){return Office.context.document.removeHandlerAsync(Office.EventType.ContentControlAdded,{id:n,handler:r},e)}));default:throw e.RuntimeError._createInvalidArgError("eventId")}},t}();e.officeJsEventRegistration=new t}(F=t._Internal||(t._Internal={}));var C=function(){function e(e,t){this.m_handlersByEventByTarget={},this.m_registerEventImpl=e,this.m_unregisterEventImpl=t}return e.prototype.getHandlers=function(e,t){H.isNullOrUndefined(t)&&(t="");var n=this.m_handlersByEventByTarget[e];n||(n={},this.m_handlersByEventByTarget[e]=n);var r=n[t];return r||(r=[],n[t]=r),r},e.prototype.register=function(e,t,n){if(!n)throw F.RuntimeError._createInvalidArgError("handler");var r=this.getHandlers(e,t);return r.push(n),1===r.length?this.m_registerEventImpl(e,t):H._createPromiseFromResult(null)},e.prototype.unregister=function(e,t,n){if(!n)throw F.RuntimeError._createInvalidArgError("handler");for(var r=this.getHandlers(e,t),i=r.length-1;i>=0;i--)if(r[i]===n){r.splice(i,1);break}return 0===r.length?this.m_unregisterEventImpl(e,t):H._createPromiseFromResult(null)},e}();t.EventRegistration=C;var O=function(){function e(){this.m_eventRegistration=new C(this._registerEventImpl.bind(this),this._unregisterEventImpl.bind(this)),this.m_richApiMessageHandler=this._handleRichApiMessage.bind(this)}return e.prototype.ready=function(){var t=this;return this.m_ready||(e._testReadyImpl?this.m_ready=e._testReadyImpl().then((function(){t.m_isReady=!0})):this.m_ready=F.officeJsEventRegistration.register(5,"",this.m_richApiMessageHandler).then((function(){t.m_isReady=!0}))),this.m_ready},Object.defineProperty(e.prototype,"isReady",{get:function(){return this.m_isReady},enumerable:!0,configurable:!0}),e.prototype.register=function(e,t,n){var r=this;return this.ready().then((function(){return r.m_eventRegistration.register(e,t,n)}))},e.prototype.unregister=function(e,t,n){var r=this;return this.ready().then((function(){return r.m_eventRegistration.unregister(e,t,n)}))},e.prototype._registerEventImpl=function(e,t){return H._createPromiseFromResult(null)},e.prototype._unregisterEventImpl=function(e,t){return H._createPromiseFromResult(null)},e.prototype._handleRichApiMessage=function(e){if(e&&e.entries)for(var t=0;t<e.entries.length;t++){var n=e.entries[t];if(n.messageCategory==f.eventMessageCategory){H._logEnabled&&H.log(JSON.stringify(n));var r=this.m_eventRegistration.getHandlers(n.messageType,n.targetId);if(r.length>0){var i=JSON.parse(n.message);n.isRemoteOverride&&(i.source=f.eventSourceRemote);for(var o=0;o<r.length;o++)r[o](i)}}}},e.getGenericEventRegistration=function(){return e.s_genericEventRegistration||(e.s_genericEventRegistration=new e),e.s_genericEventRegistration},e.richApiMessageEventCategory=65536,e}();t._testSetRichApiMessageReadyImpl=function(e){O._testReadyImpl=e},t._testTriggerRichApiMessageEvent=function(e){O.getGenericEventRegistration()._handleRichApiMessage(e)};var T=function(e){function t(t,n,r,i){e.call(this,t,n,r,i),this.m_genericEventInfo=i}return r(t,e),t.prototype.add=function(e){var t=this;return 0==this._handlers.length&&this.m_genericEventInfo.registerFunc&&this.m_genericEventInfo.registerFunc(),O.getGenericEventRegistration().isReady||this._context._pendingRequest._addPreSyncPromise(O.getGenericEventRegistration().ready()),a.createTraceMarkerForCallback(this._context,(function(){t._handlers.push(e),1==t._handlers.length&&O.getGenericEventRegistration().register(t.m_genericEventInfo.eventType,t.m_genericEventInfo.getTargetIdFunc(),t._callback)})),new S(this._context,this,e)},t.prototype.remove=function(e){var t=this;1==this._handlers.length&&this.m_genericEventInfo.unregisterFunc&&this.m_genericEventInfo.unregisterFunc(),a.createTraceMarkerForCallback(this._context,(function(){for(var n=t._handlers,r=n.length-1;r>=0;r--)if(n[r]===e){n.splice(r,1);break}0==n.length&&O.getGenericEventRegistration().unregister(t.m_genericEventInfo.eventType,t.m_genericEventInfo.getTargetIdFunc(),t._callback)}))},t.prototype.removeAll=function(){},t}(I);t.GenericEventHandlers=T;var E=function(){function e(){}return e.prototype.executeAsync=function(t,n,r){var i=JSON.stringify(r.Body),o=r.Url;"/"!=o.charAt(o.length-1)&&(o+="/");var a={method:"POST",url:o=(o+=f.processQuery)+"?"+f.flags+"="+n.toString(),headers:{},body:i};if(a.headers[f.sourceLibHeader]=e.SourceLibHeaderValue,a.headers["CONTENT-TYPE"]="application/json",r.Headers)for(var s in r.Headers)a.headers[s]=r.Headers[s];return P.sendRequest(a).then((function(e){var t;if(200===e.statusCode)t={ErrorCode:null,ErrorMessage:null,Headers:e.headers,Body:JSON.parse(e.body)};else{H.log("Error Response:"+e.body);var n=H._parseErrorResponse(e);t={ErrorCode:n.errorCode,ErrorMessage:n.errorMessage,Headers:e.headers,Body:null}}return t}))},e.SourceLibHeaderValue="officejs-rest",e}();t.HttpRequestExecutor=E;var P=function(){function e(){}return e.setCustomSendRequestFunc=function(t){e.s_customSendRequestFunc=t},e.xhrSendRequestFunc=function(e){return new F.OfficePromise((function(t,n){var r=new XMLHttpRequest;if(r.open(e.method,e.url),r.onload=function(){var e={statusCode:r.status,headers:H._parseHttpResponseHeaders(r.getAllResponseHeaders()),body:r.responseText};t(e)},r.onerror=function(){n(new F.RuntimeError({code:_.connectionFailure,message:H._getResourceString(L.connectionFailureWithStatus,r.statusText)}))},e.headers)for(var i in e.headers)r.setRequestHeader(i,e.headers[i]);r.send(e.body)}))},e.sendRequest=function(t){e.validateAndNormalizeRequest(t);var n=e.s_customSendRequestFunc;return n||(n=e.xhrSendRequestFunc),n(t)},e.setCustomSendLocalDocumentRequestFunc=function(t){e.s_customSendLocalDocumentRequestFunc=t},e.sendLocalDocumentRequest=function(t){return e.validateAndNormalizeRequest(t),(e.s_customSendLocalDocumentRequestFunc||e.officeJsSendLocalDocumentRequestFunc)(t)},e.officeJsSendLocalDocumentRequestFunc=function(e){e=H._validateLocalDocumentRequest(e);var t=H._buildRequestMessageSafeArray(e);return new F.OfficePromise((function(e,n){OSF.DDA.RichApi.executeRichApiRequestAsync(t,(function(t){var n;n="succeeded"==t.status?{statusCode:U.getResponseStatusCode(t),headers:U.getResponseHeaders(t),body:U.getResponseBody(t)}:U.buildHttpResponseFromOfficeJsError(t.error.code,t.error.message),H.log(JSON.stringify(n)),e(n)}))}))},e.validateAndNormalizeRequest=function(e){if(H.isNullOrUndefined(e))throw F.RuntimeError._createInvalidArgError({argumentName:"request"});H.isNullOrEmptyString(e.method)&&(e.method="GET"),e.method=e.method.toUpperCase()},e.logRequest=function(t){if(H._logEnabled){if(H.log("---HTTP Request---"),H.log(t.method+" "+t.url),t.headers)for(var n in t.headers)H.log(n+": "+t.headers[n]);e._logBody&&H.log(t.body)}},e.logResponse=function(t){if(H._logEnabled){if(H.log("---HTTP Response---"),H.log(""+t.statusCode),t.headers)for(var n in t.headers)H.log(n+": "+t.headers[n]);e._logBody&&H.log(t.body)}},e._logBody=!1,e}();t.HttpUtility=P;var w=function(){function e(e){this.m_clientObject=e}return e.prototype._handleResult=function(e){this.m_clientObject._handleIdResult(e)},e}();t.InstantiateActionResultHandler=w;var j=function(){function e(e){this.m_session=e}return e.prototype.executeAsync=function(e,t,n){var r={url:f.processQuery,method:"POST",headers:n.Headers,body:n.Body},i={id:R.nextId(),type:1,flags:t,message:r};return H.log(JSON.stringify(i)),this.m_session.sendMessageToHost(i).then((function(e){H.log("Received response: "+JSON.stringify(e));var t,n=e.message;if(200===n.statusCode)t={ErrorCode:null,ErrorMessage:null,Headers:n.headers,Body:n.body};else{H.log("Error Response:"+n.body);var r=H._parseErrorResponse(n);t={ErrorCode:r.errorCode,ErrorMessage:r.errorMessage,Headers:n.headers,Body:null}}return t}))},e}(),R=function(e){function t(t){var n=this;e.call(this),this.m_promiseResolver={},this.m_bridge=t,this.m_bridge.onMessageFromHost=function(e){n.onMessageFromHost(e)}}return r(t,e),t.prototype._resolveRequestUrlAndHeaderInfo=function(){return H._createPromiseFromResult(null)},t.prototype._createRequestExecutorOrNull=function(){return H.log("NativeBridgeSession::CreateRequestExecutor"),new j(this)},Object.defineProperty(t.prototype,"eventRegistration",{get:function(){return F.officeJsEventRegistration},enumerable:!0,configurable:!0}),t.init=function(e){if(e&&"object"==typeof e){var n=new t(e);u._overrideSession=n,P.setCustomSendLocalDocumentRequestFunc((function(e){var r={id:t.nextId(),type:1,flags:0,message:e};return n.sendMessageToHost(r).then((function(e){return e.message}))}))}},t.prototype.sendMessageToHost=function(e){var t=this;return this.m_bridge.sendMessageToHost(JSON.stringify(e)),new F.OfficePromise((function(n,r){t.m_promiseResolver[e.id]=n}))},t.prototype.onMessageFromHost=function(e){if("test"===e)A._testFunc&&A._testFunc();else{var t=JSON.parse(e);if("number"==typeof t.id){var n=this.m_promiseResolver[t.id];n&&n(t),delete this.m_promiseResolver[t.id]}}},t.nextId=function(){return t.s_nextId++},t.s_nextId=1,t}(l),x=function(){function e(){}return e.init=function(e){R.init(e)},e}();t.HostBridge=x,"object"==typeof _richApiNativeBridge&&_richApiNativeBridge&&x.init(_richApiNativeBridge);var A=function(){function e(){}return e.setTestFunc=function(t){e._testFunc=t},e}();t.HostBridgeTest=A;var N=function(){function e(e,t,n,r){this.m_objectPathInfo=e,this.m_parentObjectPath=t,this.m_isWriteOperation=!1,this.m_isCollection=n,this.m_isInvalidAfterRequest=r,this.m_isValid=!0}return Object.defineProperty(e.prototype,"objectPathInfo",{get:function(){return this.m_objectPathInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWriteOperation",{get:function(){return this.m_isWriteOperation},set:function(e){this.m_isWriteOperation=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRestrictedResourceAccess",{get:function(){return this.m_isRestrictedResourceAccess},set:function(e){this.m_isRestrictedResourceAccess=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCollection",{get:function(){return this.m_isCollection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInvalidAfterRequest",{get:function(){return this.m_isInvalidAfterRequest},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentObjectPath",{get:function(){return this.m_parentObjectPath},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"argumentObjectPaths",{get:function(){return this.m_argumentObjectPaths},set:function(e){this.m_argumentObjectPaths=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this.m_isValid},set:function(t){this.m_isValid=t,!t&&6===this.m_objectPathInfo.ObjectPathType&&this.m_savedObjectPathInfo&&(e.copyObjectPathInfo(this.m_savedObjectPathInfo.pathInfo,this.m_objectPathInfo),this.m_parentObjectPath=this.m_savedObjectPathInfo.parent,this.m_isValid=!0,this.m_savedObjectPathInfo=null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getByIdMethodName",{get:function(){return this.m_getByIdMethodName},set:function(e){this.m_getByIdMethodName=e},enumerable:!0,configurable:!0}),e.prototype._updateAsNullObject=function(){this.m_isInvalidAfterRequest=!1,this.m_isValid=!0,this.m_objectPathInfo.ObjectPathType=7,this.m_objectPathInfo.Name="",this.m_objectPathInfo.ArgumentInfo={},this.m_parentObjectPath=null,this.m_argumentObjectPaths=null},e.prototype.updateUsingObjectData=function(t){var n=t[f.referenceId];if(!H.isNullOrEmptyString(n)){if(!this.m_savedObjectPathInfo&&!this.isInvalidAfterRequest&&e.isRestorableObjectPath(this.m_objectPathInfo.ObjectPathType)){var r={};e.copyObjectPathInfo(this.m_objectPathInfo,r),this.m_savedObjectPathInfo={pathInfo:r,parent:this.m_parentObjectPath}}return this.m_isInvalidAfterRequest=!1,this.m_isValid=!0,this.m_objectPathInfo.ObjectPathType=6,this.m_objectPathInfo.Name=n,this.m_objectPathInfo.ArgumentInfo={},this.m_parentObjectPath=null,void(this.m_argumentObjectPaths=null)}var i=this.parentObjectPath&&this.parentObjectPath.isCollection,o=this.getByIdMethodName;if(i||!H.isNullOrEmptyString(o)){var a=t[f.id];if(H.isNullOrUndefined(a)&&(a=t[f.idPrivate]),!H.isNullOrUndefined(a))return this.m_isInvalidAfterRequest=!1,this.m_isValid=!0,H.isNullOrEmptyString(o)?(this.m_objectPathInfo.ObjectPathType=5,this.m_objectPathInfo.Name=""):(this.m_objectPathInfo.ObjectPathType=3,this.m_objectPathInfo.Name=o,this.m_getByIdMethodName=null),this.isWriteOperation=!1,this.m_objectPathInfo.ArgumentInfo={},this.m_objectPathInfo.ArgumentInfo.Arguments=[a],void(this.m_argumentObjectPaths=null)}},e.isRestorableObjectPath=function(e){return 1===e||5===e||3===e||4===e},e.copyObjectPathInfo=function(e,t){t.Id=e.Id,t.ArgumentInfo=e.ArgumentInfo,t.Name=e.Name,t.ObjectPathType=e.ObjectPathType,t.ParentObjectPathId=e.ParentObjectPathId},e}();t.ObjectPath=N;var D=function(){function e(){}return e.createGlobalObjectObjectPath=function(e){var t={Id:e._nextId(),ObjectPathType:1,Name:""};return new N(t,null,!1,!1)},e.createNewObjectObjectPath=function(e,t,n,r){var i={Id:e._nextId(),ObjectPathType:2,Name:t},o=new N(i,null,n,!1);return o.isRestrictedResourceAccess=r,o},e.createPropertyObjectPath=function(e,t,n,r,i,o){var a={Id:e._nextId(),ObjectPathType:4,Name:n,ParentObjectPathId:t._objectPath.objectPathInfo.Id},s=new N(a,t._objectPath,r,i);return s.isRestrictedResourceAccess=o,s},e.createIndexerObjectPath=function(e,t,n){var r={Id:e._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}};return r.ArgumentInfo.Arguments=n,new N(r,t._objectPath,!1,!1)},e.createIndexerObjectPathUsingParentPath=function(e,t,n){var r={Id:e._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t.objectPathInfo.Id,ArgumentInfo:{}};return r.ArgumentInfo.Arguments=n,new N(r,t,!1,!1)},e.createMethodObjectPath=function(e,t,n,r,i,o,a,s,c){var l={Id:e._nextId(),ObjectPathType:3,Name:n,ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},u=H.setMethodArguments(e,l.ArgumentInfo,i),d=new N(l,t._objectPath,o,a);return d.argumentObjectPaths=u,d.isWriteOperation=1!=r,d.getByIdMethodName=s,d.isRestrictedResourceAccess=c,d},e.createReferenceIdObjectPath=function(e,t){var n={Id:e._nextId(),ObjectPathType:6,Name:t,ArgumentInfo:{}};return new N(n,null,!1,!1)},e.createChildItemObjectPathUsingIndexerOrGetItemAt=function(t,n,r,i,o){var a=i[f.id];return H.isNullOrUndefined(a)&&(a=i[f.idPrivate]),t&&!H.isNullOrUndefined(a)?e.createChildItemObjectPathUsingIndexer(n,r,i):e.createChildItemObjectPathUsingGetItemAt(n,r,i,o)},e.createChildItemObjectPathUsingIndexer=function(e,t,n){var r=n[f.id];H.isNullOrUndefined(r)&&(r=n[f.idPrivate]);var i=i={Id:e._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}};return i.ArgumentInfo.Arguments=[r],new N(i,t._objectPath,!1,!1)},e.createChildItemObjectPathUsingGetItemAt=function(e,t,n,r){var i=n[f.index];i&&(r=i);var o={Id:e._nextId(),ObjectPathType:3,Name:f.getItemAt,ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}};return o.ArgumentInfo.Arguments=[r],new N(o,t._objectPath,!1,!1)},e}();t.ObjectPathFactory=D;var F,k=function(){function e(e){this.m_context=e}return e.prototype.executeAsync=function(t,n,r){var i=this,o=U.buildMessageArrayForIRequestExecutor(t,n,r,e.SourceLibHeaderValue);return new F.OfficePromise((function(e,t){OSF.DDA.RichApi.executeRichApiRequestAsync(o,(function(t){var n;H.log("Response:"),H.log(JSON.stringify(t)),"succeeded"==t.status?n=U.buildResponseOnSuccess(U.getResponseBody(t),U.getResponseHeaders(t)):(n=U.buildResponseOnError(t.error.code,t.error.message),i.m_context._processOfficeJsErrorResponse(t.error.code,n)),e(n)}))}))},e.SourceLibHeaderValue="officejs",e}();t.OfficeJsRequestExecutor=k,function(e){e.OfficeRequire=null}(F=t._Internal||(t._Internal={})),function(t){!function(r){r.Init=function(){return function(){function r(e){return"function"==typeof e}var i,o=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=0,s=function(e,t){v[a]=e,v[a+1]=t,2===(a+=2)&&(i?i(_):f())};var c=("undefined"!=typeof window?window:void 0)||{},l=c.MutationObserver||c.WebKitMutationObserver,u=void 0!==e&&"[object process]"==={}.toString.call(e),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;var f,h,g,p,m,y,b,v=new Array(1e3);function _(){for(var e=0;e<a;e+=2){(0,v[e])(v[e+1]),v[e]=void 0,v[e+1]=void 0}a=0}function I(){}u?(y=e.nextTick,b=e.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/),Array.isArray(b)&&"0"===b[1]&&"10"===b[2]&&(y=n),f=function(){y(_)}):l?(g=0,p=new l(_),m=document.createTextNode(""),p.observe(m,{characterData:!0}),f=function(){m.data=g=++g%2}):d?((h=new MessageChannel).port1.onmessage=_,f=function(){h.port2.postMessage(0)}):f=function(){setTimeout(_,1)};var S=void 0,C=1,O=2,T=new N;function E(e,t){if(t.constructor===e.constructor)!function(e,t){t._state===C?j(e,t._result):t._state===O?R(e,t._result):x(t,void 0,(function(t){P(e,t)}),(function(t){R(e,t)}))}(e,t);else{var n=function(e){try{return e.then}catch(e){return T.error=e,T}}(t);n===T?R(e,T.error):void 0===n?j(e,t):r(n)?function(e,t,n){s((function(e){var r=!1,i=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,(function(n){r||(r=!0,t!==n?P(e,n):j(e,n))}),(function(t){r||(r=!0,R(e,t))}),e._label);!r&&i&&(r=!0,R(e,i))}),e)}(e,t,n):j(e,t)}}function P(e,t){var n;e===t?R(e,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(n=t)||"object"==typeof n&&null!==n?E(e,t):j(e,t)}function w(e){e._onerror&&e._onerror(e._result),A(e)}function j(e,t){e._state===S&&(e._result=t,e._state=C,0!==e._subscribers.length&&s(A,e))}function R(e,t){e._state===S&&(e._state=O,e._result=t,s(w,e))}function x(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+C]=n,i[o+O]=r,0===o&&e._state&&s(A,e)}function A(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r,i,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?F(n,r,i,o):i(o);e._subscribers.length=0}}function N(){this.error=null}var D=new N;function F(e,t,n,i){var o,a,s,c,l=r(n);if(l){if((o=function(e,t){try{return e(t)}catch(e){return D.error=e,D}}(n,i))===D?(c=!0,a=o.error,o=null):s=!0,t===o)return void R(t,new TypeError("A promises callback cannot return that same promise."))}else o=i,s=!0;t._state!==S||(l&&s?P(t,o):c?R(t,a):e===C?j(t,o):e===O&&R(t,o))}function k(e,t){this._instanceConstructor=e,this.promise=new e(I),this._validateInput(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._init(),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&j(this.promise,this._result))):R(this.promise,this._validationError())}k.prototype._validateInput=function(e){return o(e)},k.prototype._validationError=function(){return new t.Error("Array Methods must be provided an Array")},k.prototype._init=function(){this._result=new Array(this.length)};var M=k;k.prototype._enumerate=function(){for(var e=this.length,t=this.promise,n=this._input,r=0;t._state===S&&r<e;r++)this._eachEntry(n[r],r)},k.prototype._eachEntry=function(e,t){var n,r=this._instanceConstructor;"object"==typeof(n=e)&&null!==n?e.constructor===r&&e._state!==S?(e._onerror=null,this._settledAt(e._state,t,e._result)):this._willSettleAt(r.resolve(e),t):(this._remaining--,this._result[t]=e)},k.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===S&&(this._remaining--,e===O?R(r,n):this._result[t]=n),0===this._remaining&&j(r,this._result)},k.prototype._willSettleAt=function(e,t){var n=this;x(e,void 0,(function(e){n._settledAt(C,t,e)}),(function(e){n._settledAt(O,t,e)}))};var B=function(e){return new M(this,e).promise};var L=function(e){var t=new this(I);if(!o(e))return R(t,new TypeError("You must pass an array to race.")),t;var n=e.length;function r(e){P(t,e)}function i(e){R(t,e)}for(var a=0;t._state===S&&a<n;a++)x(this.resolve(e[a]),void 0,r,i);return t};var q=function(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(I);return P(t,e),t};var U=function(e){var t=new this(I);return R(t,e),t},H=0;var W=G;function G(e){this._id=H++,this._state=void 0,this._result=void 0,this._subscribers=[],I!==e&&(r(e)||function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof G||function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),function(e,t){try{t((function(t){P(e,t)}),(function(t){R(e,t)}))}catch(t){R(e,t)}}(this,e))}return G.all=B,G.race=L,G.resolve=q,G.reject=U,G._setScheduler=function(e){i=e},G._setAsap=function(e){s=e},G._asap=s,G.prototype={constructor:G,then:function(e,t){var n=this,r=n._state;if(r===C&&!e||r===O&&!t)return this;var i=new this.constructor(I),o=n._result;if(r){var a=arguments[r-1];s((function(){F(r,i,a,o)}))}else x(n,i,e,t);return i},catch:function(e){return this.then(null,e)}},W}.call(this)}}(t.PromiseImpl||(t.PromiseImpl={}))}(F=t._Internal||(t._Internal={})),function(e){e.OfficePromise="undefined"==typeof window&&"function"==typeof Promise?Promise:"undefined"!=typeof window&&window.Promise?window.Promise:e.PromiseImpl.Init()}(F=t._Internal||(t._Internal={}));var M=F.OfficePromise;t.Promise=M;var B=function(){function e(e){this._autoCleanupList={},this.m_context=e}return e.prototype.add=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return t._addCommon(e,!0)})):this._addCommon(e,!0)},e.prototype._autoAdd=function(e){this._addCommon(e,!1),this._autoCleanupList[e._objectPath.objectPathInfo.Id]=e},e.prototype._autoTrackIfNecessaryWhenHandleObjectResultValue=function(e,t){this.m_context._autoCleanup&&!e[f.isTracked]&&e!==this.m_context._rootObject&&t&&!H.isNullOrEmptyString(t[f.referenceId])&&(this._autoCleanupList[e._objectPath.objectPathInfo.Id]=e,e[f.isTracked]=!0)},e.prototype._addCommon=function(e,t){if(e[f.isTracked])t&&this.m_context._autoCleanup&&delete this._autoCleanupList[e._objectPath.objectPathInfo.Id];else{var n=e[f.referenceId];H.isNullOrEmptyString(n)&&e._KeepReference&&(e._KeepReference(),a.createInstantiateAction(this.m_context,e),t&&this.m_context._autoCleanup&&delete this._autoCleanupList[e._objectPath.objectPathInfo.Id],e[f.isTracked]=!0)}},e.prototype.remove=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return t._removeCommon(e)})):this._removeCommon(e)},e.prototype._removeCommon=function(e){var t=e[f.referenceId];if(!H.isNullOrEmptyString(t)){var n=this.m_context._rootObject;n._RemoveReference&&n._RemoveReference(t),delete e[f.isTracked]}},e.prototype._retrieveAndClearAutoCleanupList=function(){var e=this._autoCleanupList;return this._autoCleanupList={},e},e}();t.TrackedObjects=B;var L=function(){function e(){}return e.cannotRegisterEvent="CannotRegisterEvent",e.connectionFailureWithStatus="ConnectionFailureWithStatus",e.connectionFailureWithDetails="ConnectionFailureWithDetails",e.invalidObjectPath="InvalidObjectPath",e.invalidRequestContext="InvalidRequestContext",e.invalidArgument="InvalidArgument",e.invalidArgumentGeneric="InvalidArgumentGeneric",e.propertyNotLoaded="PropertyNotLoaded",e.runMustReturnPromise="RunMustReturnPromise",e.timeout="Timeout",e.propertyDoesNotExist="PropertyDoesNotExist",e.attemptingToSetReadOnlyProperty="AttemptingToSetReadOnlyProperty",e.moreInfoInnerError="MoreInfoInnerError",e.cannotApplyPropertyThroughSetMethod="CannotApplyPropertyThroughSetMethod",e.valueNotLoaded="ValueNotLoaded",e.invalidOrTimedOutSessionMessage="InvalidOrTimedOutSessionMessage",e.invalidOperationInCellEditMode="InvalidOperationInCellEditMode",e.customFunctionDefintionMissing="CustomFunctionDefintionMissing",e.customFunctionImplementationMissing="CustomFunctionImplementationMissing",e.customFunctionNameContainsBadChars="CustomFunctionNameContainsBadChars",e.customFunctionNameCannotSplit="CustomFunctionNameCannotSplit",e.apiNotFoundDetails="ApiNotFoundDetails",e}();t.ResourceStrings=L;var q=function(){function e(){}return e.CannotRegisterEvent="The event handler cannot be registered.",e.ConnectionFailureWithStatus="The request failed with status code of {0}.",e.ConnectionFailureWithDetails="The request failed with status code of {0}, error code {1} and the following error message: {2}",e.InvalidArgument="The argument '{0}' doesn't work for this situation, is missing, or isn't in the right format.",e.InvalidObjectPath='The object path \'{0}\' isn\'t working for what you\'re trying to do. If you\'re using the object across multiple "context.sync" calls and outside the sequential execution of a ".run" batch, please use the "context.trackedObjects.add()" and "context.trackedObjects.remove()" methods to manage the object\'s lifetime.',e.InvalidRequestContext="Cannot use the object across different request contexts.",e.PropertyNotLoaded="The property '{0}' is not available. Before reading the property's value, call the load method on the containing object and call \"context.sync()\" on the associated request context.",e.RunMustReturnPromise='The batch function passed to the ".run" method didn\'t return a promise. The function must return a promise, so that any automatically-tracked objects can be released at the completion of the batch operation. Typically, you return a promise by returning the response from "context.sync()".',e.Timeout="The operation has timed out.",e.ValueNotLoaded='The value of the result object has not been loaded yet. Before reading the value property, call "context.sync()" on the associated request context.',e.InvalidOrTimedOutSessionMessage="Your Office Online session has expired or is invalid. To continue, refresh the page.",e.InvalidOperationInCellEditMode="Excel is in cell-editing mode. Please exit the edit mode by pressing ENTER or TAB or selecting another cell, and then try again.",e.CustomFunctionDefintionMissing="A property with this name that represents the function's definition must exist on Excel.CustomFunctions.",e.CustomFunctionImplementationMissing="The property with this name on Excel.CustomFunctions that represents the function's definition must contain a 'call' property that implements the function.",e.CustomFunctionNameContainsBadChars="The function name may only contain letters, digits, underscores, and periods.",e.CustomFunctionNameCannotSplit="The function name must contain a non-empty namespace and a non-empty short name.",e.ApiNotFoundDetails="The method or property {0} is part of the {1} requirement set, which is not available in your version of {2}.",e}();t.ResourceStringValues=q;var U=function(){function e(){}return e.buildMessageArrayForIRequestExecutor=function(t,n,r,i){var o=JSON.stringify(r.Body);H.log("Request:"),H.log(o);var a={};return a[f.sourceLibHeader]=i,e.buildRequestMessageSafeArray(t,n,"POST","ProcessQuery",a,o)},e.buildResponseOnSuccess=function(e,t){var n={ErrorCode:"",ErrorMessage:"",Headers:null,Body:null};return n.Body=JSON.parse(e),n.Headers=t,n},e.buildResponseOnError=function(t,n){var r={ErrorCode:"",ErrorMessage:"",Headers:null,Body:null};return r.ErrorCode=_.generalException,r.ErrorMessage=n,t==e.OfficeJsErrorCode_ooeNoCapability?r.ErrorCode=_.accessDenied:t==e.OfficeJsErrorCode_ooeActivityLimitReached?r.ErrorCode=_.activityLimitReached:t==e.OfficeJsErrorCode_ooeInvalidOrTimedOutSession&&(r.ErrorCode=_.invalidOrTimedOutSession,r.ErrorMessage=H._getResourceString(L.invalidOrTimedOutSessionMessage)),r},e.buildHttpResponseFromOfficeJsError=function(t,n){var r=500,i={error:{}};return i.error.code=_.generalException,i.error.message=n,t===e.OfficeJsErrorCode_ooeNoCapability?(r=403,i.error.code=_.accessDenied):t===e.OfficeJsErrorCode_ooeActivityLimitReached&&(r=429,i.error.code=_.activityLimitReached),{statusCode:r,headers:{},body:JSON.stringify(i)}},e.buildRequestMessageSafeArray=function(e,t,n,r,i,o){var a=[];if(i)for(var s in i)a.push(s),a.push(i[s]);return[e,n,r,a,o,0,t,"","",""]},e.getResponseBody=function(t){return e.getResponseBodyFromSafeArray(t.value.data)},e.getResponseHeaders=function(t){return e.getResponseHeadersFromSafeArray(t.value.data)},e.getResponseBodyFromSafeArray=function(e){var t=e[2];return"string"==typeof t?t:t.join("")},e.getResponseHeadersFromSafeArray=function(e){var t=e[1];if(!t)return null;for(var n={},r=0;r<t.length-1;r+=2)n[t[r]]=t[r+1];return n},e.getResponseStatusCode=function(t){return e.getResponseStatusCodeFromSafeArray(t.value.data)},e.getResponseStatusCodeFromSafeArray=function(e){return e[0]},e.OfficeJsErrorCode_ooeInvalidOrTimedOutSession=5012,e.OfficeJsErrorCode_ooeActivityLimitReached=5102,e.OfficeJsErrorCode_ooeNoCapability=7e3,e}();t.RichApiMessageUtility=U;var H=function(){function e(){}return e.checkArgumentNull=function(t,n){if(e.isNullOrUndefined(t))throw F.RuntimeError._createInvalidArgError(n)},e.isNullOrUndefined=function(e){return null===e||void 0===e},e.isUndefined=function(e){return void 0===e},e.isNullOrEmptyString=function(e){return null===e||(void 0===e||0==e.length)},e.isPlainJsonObject=function(t){return!e.isNullOrUndefined(t)&&("object"==typeof t&&Object.getPrototypeOf(t)===Object.getPrototypeOf({}))},e.trim=function(e){return e.replace(new RegExp("^\\s+|\\s+$","g"),"")},e.caseInsensitiveCompareString=function(t,n){return e.isNullOrUndefined(t)?e.isNullOrUndefined(n):!e.isNullOrUndefined(n)&&t.toUpperCase()==n.toUpperCase()},e.adjustToDateTime=function(t){if(e.isNullOrUndefined(t))return null;if("string"==typeof t)return new Date(t);if(Array.isArray(t)){for(var n=t,r=0;r<n.length;r++)n[r]=e.adjustToDateTime(n[r]);return n}throw F.RuntimeError._createInvalidArgError("date")},e.isReadonlyRestRequest=function(t){return e.caseInsensitiveCompareString(t,"GET")},e.setMethodArguments=function(t,n,r){if(e.isNullOrUndefined(r))return null;var i=new Array,o=new Array,a=e.collectObjectPathInfos(t,r,i,o);return n.Arguments=r,a?(n.ReferencedObjectPathIds=o,i):null},e.collectObjectPathInfos=function(t,n,r,i){for(var o=!1,a=0;a<n.length;a++)if(n[a]instanceof s){var c=n[a];e.validateContext(t,c),n[a]=c._objectPath.objectPathInfo.Id,i.push(c._objectPath.objectPathInfo.Id),r.push(c._objectPath),o=!0}else if(Array.isArray(n[a])){var l=new Array;e.collectObjectPathInfos(t,n[a],r,l)?(i.push(l),o=!0):i.push(0)}else i.push(0);return o},e.fixObjectPathIfNecessary=function(e,t){e&&e._objectPath&&t&&e._objectPath.updateUsingObjectData(t)},e.validateObjectPath=function(t){for(var n=t._objectPath;n;){if(!n.isValid)throw new F.RuntimeError({code:_.invalidObjectPath,message:e._getResourceString(L.invalidObjectPath,e.getObjectPathExpression(n)),debugInfo:{errorLocation:e.getObjectPathExpression(n)}});n=n.parentObjectPath}},e.validateReferencedObjectPaths=function(t){if(t)for(var n=0;n<t.length;n++)for(var r=t[n];r;){if(!r.isValid)throw new F.RuntimeError({code:_.invalidObjectPath,message:e._getResourceString(L.invalidObjectPath,e.getObjectPathExpression(r))});r=r.parentObjectPath}},e.validateContext=function(t,n){if(n&&n.context!==t)throw new F.RuntimeError({code:_.invalidRequestContext,message:e._getResourceString(L.invalidRequestContext)})},e.log=function(t){e._logEnabled&&"undefined"!=typeof console&&console.log},e.load=function(e,t){e.context.load(e,t)},e._parseSelectExpand=function(t){var n=[];if(!e.isNullOrEmptyString(t))for(var r=t.split(","),i=0;i<r.length;i++){var o=r[i];(o=a(o.trim())).length>0&&n.push(o)}return n;function a(e){var t=e.toLowerCase();if("items"===t||"items/"===t)return"*";return"items/"===t.substr(0,6)&&(e=e.substr(6)),e.replace(new RegExp("/items/","gi"),"/")}},e.throwError=function(t,n,r){throw new F.RuntimeError({code:t,message:e._getResourceString(t,n),debugInfo:r?{errorLocation:r}:void 0})},e.createRuntimeError=function(e,t,n){return new F.RuntimeError({code:e,message:t,debugInfo:{errorLocation:n}})},e._getResourceString=function(t,n){var r;if("undefined"!=typeof window&&window.Strings&&window.Strings.OfficeOM){var i="L_"+t,o=window.Strings.OfficeOM[i];o&&(r=o)}if(r||(r=q[t]),r||(r=t),!e.isNullOrUndefined(n))if(Array.isArray(n)){var a=n;r=e._formatString(r,a)}else r=r.replace("{0}",n);return r},e._formatString=function(e,t){return e.replace(/\{\d\}/g,(function(e){var n=parseInt(e.substr(1,e.length-2));if(n<t.length)return t[n];throw F.RuntimeError._createInvalidArgError("format")}))},e.throwIfNotLoaded=function(t,n,r,i){if(!i&&e.isUndefined(n)&&t.charCodeAt(0)!=e.s_underscoreCharCode)throw new F.RuntimeError({code:_.propertyNotLoaded,message:e._getResourceString(L.propertyNotLoaded,t),debugInfo:r?{errorLocation:r+"."+t}:void 0})},e.throwIfApiNotSupported=function(t,n,r,i){if(e._doApiNotSupportedCheck&&"undefined"!=typeof window&&window.Office&&window.Office.context&&!window.Office.context.requirements.isSetSupported(n,r)){var o=e._getResourceString(L.apiNotFoundDetails,[t,n+" "+r,i]);throw new F.RuntimeError({code:_.apiNotFound,message:o,debugInfo:{errorLocation:t}})}},e.getObjectPathExpression=function(t){for(var n="";t;){switch(t.objectPathInfo.ObjectPathType){case 1:n=n;break;case 2:n="new()"+(n.length>0?".":"")+n;break;case 3:n=e.normalizeName(t.objectPathInfo.Name)+"()"+(n.length>0?".":"")+n;break;case 4:n=e.normalizeName(t.objectPathInfo.Name)+(n.length>0?".":"")+n;break;case 5:n="getItem()"+(n.length>0?".":"")+n;break;case 6:n="_reference()"+(n.length>0?".":"")+n}t=t.parentObjectPath}return n},e._createPromiseFromResult=function(e){return new F.OfficePromise((function(t,n){t(e)}))},e._createTimeoutPromise=function(e){return new F.OfficePromise((function(t,n){setTimeout((function(){t(null)}),e)}))},e.promisify=function(e){return new F.OfficePromise((function(t,n){e((function(e){"failed"==e.status?n(e.error):t(e.value)}))}))},e._addActionResultHandler=function(e,t,n){e.context._pendingRequest.addActionResultHandler(t,n)},e._handleNavigationPropertyResults=function(t,n,r){for(var i=0;i<r.length-1;i+=2)e.isUndefined(n[r[i+1]])||t[r[i]]._handleResult(n[r[i+1]])},e.normalizeName=function(e){return e.substr(0,1).toLowerCase()+e.substr(1)},e._isLocalDocumentUrl=function(t){return e._getLocalDocumentUrlPrefixLength(t)>0},e._getLocalDocumentUrlPrefixLength=function(e){for(var t=["http://document.localhost","https://document.localhost","//document.localhost"],n=e.toLowerCase().trim(),r=0;r<t.length;r++){if(n===t[r])return t[r].length;if(n.substr(0,t[r].length+1)===t[r]+"/")return t[r].length+1}return 0},e._validateLocalDocumentRequest=function(t){var n=e._getLocalDocumentUrlPrefixLength(t.url);if(n<=0)throw F.RuntimeError._createInvalidArgError({argumentName:"request"});var r=t.url.substr(n),i=r.toLowerCase();return"_api"===i?r="":"_api/"===i.substr(0,"_api/".length)&&(r=r.substr("_api/".length)),{method:t.method,url:r,headers:t.headers,body:t.body}},e._buildRequestMessageSafeArray=function(t){var n=0;if(e.isReadonlyRestRequest(t.method)||(n=1),t.url.substr(0,f.processQuery.length).toLowerCase()===f.processQuery.toLowerCase()){var r=t.url.indexOf("?");if(r>0)for(var i=t.url.substr(r+1).split("&"),o=0;o<i.length;o++){var a=i[o].split("=");if(a[0].toLowerCase()===f.flags){n=parseInt(a[1]),n&=1;break}}}return U.buildRequestMessageSafeArray("",n,t.method,t.url,t.headers,t.body)},e._parseHttpResponseHeaders=function(t){var n={};if(!e.isNullOrEmptyString(t))for(var r=new RegExp("\r?\n"),i=t.split(r),o=0;o<i.length;o++){var a=i[o];if(null!=a){var s=a.indexOf(":");if(s>0){var c=a.substr(0,s),l=a.substr(s+1);c=e.trim(c),l=e.trim(l),n[c.toUpperCase()]=l}}}return n},e._parseErrorResponse=function(t){var n,r,i=null;if(e.isPlainJsonObject(t.body))i=t.body;else if(!e.isNullOrEmptyString(t.body)){var o=e.trim(t.body);try{i=JSON.parse(o)}catch(t){e.log("Error when parse "+o)}}return!e.isNullOrUndefined(i)&&"object"==typeof i&&i.error?(r=i.error.code,n=e._getResourceString(L.connectionFailureWithDetails,[t.statusCode.toString(),i.error.code,i.error.message])):n=e._getResourceString(L.connectionFailureWithStatus,t.statusCode.toString()),e.isNullOrEmptyString(r)&&(r=_.connectionFailure),{errorCode:r,errorMessage:n}},e._copyHeaders=function(e,t){if(e&&t)for(var n in e)t[n]=e[n]},e._logEnabled=!1,e._synchronousCleanup=!1,e._doApiNotSupportedCheck=!1,e.s_underscoreCharCode="_".charCodeAt(0),e}();t.Utility=H}).call(this,n(136),n(1271).setImmediate)},15165:function(e,t,n){var r={"./am/messages.json":[16110,1451],"./ar/messages.json":[16111,1452],"./bg/messages.json":[16112,1453],"./ca/messages.json":[16113,1454],"./cs/messages.json":[16114,1455],"./da/messages.json":[16115,1456],"./de/messages.json":[16116,1457],"./el/messages.json":[16117,1458],"./en/messages.json":[16118,1459],"./en_gb/messages.json":[16119,1460],"./es/messages.json":[16120,1461],"./es_419/messages.json":[16121,1462],"./et/messages.json":[16122,1463],"./fa/messages.json":[16123,1464],"./fi/messages.json":[16124,1465],"./fil/messages.json":[16125,1466],"./fr-CA/messages.json":[16127,1467],"./fr/messages.json":[16126,1468],"./gu/messages.json":[16128,1469],"./he/messages.json":[16129,1470],"./hi/messages.json":[16130,1471],"./hr/messages.json":[16131,1472],"./hu/messages.json":[16132,1473],"./id/messages.json":[16133,1474],"./it/messages.json":[16134,1475],"./ja/messages.json":[16135,1476],"./kn/messages.json":[16136,1477],"./ko/messages.json":[16137,1478],"./lt/messages.json":[16138,1479],"./lv/messages.json":[16139,1480],"./ml/messages.json":[16140,1481],"./mr/messages.json":[16141,1482],"./ms/messages.json":[16142,1483],"./nl/messages.json":[16143,1484],"./no/messages.json":[16144,1485],"./pl/messages.json":[16145,1486],"./pt_br/messages.json":[16146,1487],"./pt_pt/messages.json":[16147,1488],"./ro/messages.json":[16148,1489],"./ru/messages.json":[16149,1490],"./sk/messages.json":[16150,1491],"./sl/messages.json":[16151,1492],"./sr/messages.json":[16152,1493],"./sv/messages.json":[16153,1494],"./ta/messages.json":[16154,1495],"./te/messages.json":[16155,1496],"./th/messages.json":[16156,1497],"./tr/messages.json":[16157,1498],"./uk/messages.json":[16158,1499],"./vi/messages.json":[16159,1500],"./zh_cn/messages.json":[16160,1501],"./zh_tw/messages.json":[16161,1502]};function i(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],i=t[0];return n.e(t[1]).then((function(){return n.t(i,3)}))}i.keys=function(){return Object.keys(r)},i.id=15165,e.exports=i},15220:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(15221),t),i(n(15222),t),i(n(15223),t),i(n(15224),t),i(n(15225),t),i(n(6878),t),i(n(15226),t),i(n(15227),t)},15221:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationState=void 0,function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(t.AnnotationState||(t.AnnotationState={}))},15222:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},15223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridConstants=t.OpenType=t.BlobRefType=void 0,function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl"}(t.BlobRefType||(t.BlobRefType={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(t.OpenType||(t.OpenType={}));var r=function(){function e(){}return e.lowerIndexBound=1,e.maxNumberOfRows=1048576,e.maxNumberOfColumns=16384,e.firstColumnName="A",e.lastColumnName="XFD",e}();t.GridConstants=r},15224:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryClassificationAnnotation=t.Annotation=void 0;var r=n(6878),i=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Annotation"},e.getBaseTypes=function(){return[]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.Annotation=i;var o=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_BinaryClassificationAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.BinaryClassificationAnnotation=o},15225:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignalOperation=t.MicroSyncOperation=t.DeltaUpdateOperation=t.VisibilityOperation=t.FocusOperation=t.PurgeOperation=t.DeleteOperation=t.UpdateOperation=t.UpdateAnnotationMetaDataOperation=t.MoveOperation=t.AddOperation=t.OperationWithSiblingContext=t.Operation=t.ItemDelta=void 0;var r=n(6878),i=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_ItemDelta"},e.getBaseTypes=function(){return[]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ItemDelta=i;var o=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Operation"},e.getBaseTypes=function(){return[]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.Operation=o;var a=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_OperationWithSiblingContext"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.OperationWithSiblingContext=a;var s=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_AddOperation"},e.getBaseTypes=function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.AddOperation=s;var c=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_MoveOperation"},e.getBaseTypes=function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.MoveOperation=c;var l=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UpdateAnnotationMetaDataOperation=l;var u=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_UpdateOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UpdateOperation=u;var d=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_DeleteOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.DeleteOperation=d;var f=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_PurgeOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.PurgeOperation=f;var h=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_FocusOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FocusOperation=h;var g=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_VisibilityOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.VisibilityOperation=g;var p=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_DeltaUpdateOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.DeltaUpdateOperation=p;var m=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_MicroSyncOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.MicroSyncOperation=m;var y=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Signals_SignalOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SignalOperation=y},15226:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Signal=void 0;var r=n(6878),i=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Signals_Signal"},e.getBaseTypes=function(){return[]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.Signal=i},15227:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridNeighborhoodContext=t.GridCell=t.Document=t.Session=t.TileGroup=t.Binary=t.Blob=void 0;var r=n(6878),i=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Blob"},e.getBaseTypes=function(){return[]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.Blob=i;var o=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Binary"},e.getBaseTypes=function(){return[]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.Binary=o;var a=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_TileGroup"},e.getBaseTypes=function(){return[]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.TileGroup=a;var s=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Session"},e.getBaseTypes=function(){return["AugLoop_Core_TileGroup"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.Session=s;var c=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Document"},e.getBaseTypes=function(){return["AugLoop_Core_TileGroup"]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.Document=c;var l=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_GridCell"},e.getBaseTypes=function(){return[]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.GridCell=l;var u=function(){function e(t){r.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_GridNeighborhoodContext"},e.getBaseTypes=function(){return[]},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.GridNeighborhoodContext=u},1569:function(e,t,n){"use strict";var r=n(469),i=n(969),o=n(0),a=n(12),s={root:"ms-Link"};n.d(t,"a",(function(){return c}));var c=Object(r.a)(i.a,(function(e){var t,n,r,i,c,l,u=e.className,d=e.isButton,f=e.isDisabled,h=e.theme,g=h.semanticColors,p=g.link,m=g.linkHovered,y=g.disabledText,b=g.focusBorder,v=Object(a.getGlobalClassNames)(s,h);return{root:[v.root,h.fonts.medium,{color:p,outline:"none",fontSize:"inherit",fontWeight:"inherit",textDecoration:"none",selectors:(t={".ms-Fabric--isFocusVisible &:focus":{boxShadow:"0 0 0 1px "+b+" inset",outline:"1px auto "+b,selectors:(n={},n[a.HighContrastSelector]={outline:"1px solid WindowText"},n)}},t[a.HighContrastSelector]={borderBottom:"none"},t)},d&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:Object(o.__assign)((r={},r[a.HighContrastSelector]={color:"LinkText"},r),Object(a.getEdgeChromiumNoHighContrastAdjustSelector)())},!d&&{selectors:(i={},i[a.HighContrastSelector]={MsHighContrastAdjust:"auto"},i)},f&&["is-disabled",{color:y,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!f&&{selectors:{"&:active, &:hover, &:active:hover":{color:m,textDecoration:"underline",selectors:(c={},c[a.HighContrastSelector]={color:"LinkText"},c)},"&:focus":{color:p,selectors:(l={},l[a.HighContrastSelector]={color:"LinkText"},l)}}},v.root,u]}}),void 0,{scope:"Link"})},1575:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),i=n(1),o=n(12),a=n(338),s=n(192),c=n(1011),l=n(714);function u(e,t){void 0===t&&(t={});var n=t.factoryOptions,u=(void 0===n?{}:n).defaultProp,d=function(n){var c,u,d,f=(c=t.displayName,u=i.useContext(a.a),d=t.fields,s.a.getSettings(d||["theme","styles","tokens"],c,u.customizations)),h=t.state;h&&(n=Object(r.__assign)(Object(r.__assign)({},n),h(n)));var g=n.theme||f.theme,p=function e(t,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];for(var a={},s=0,c=i;s<c.length;s++){var u=c[s];u&&(u="function"==typeof u?u(t,n):u,Array.isArray(u)&&(u=e.apply(void 0,Object(r.__spreadArrays)([t,n],u))),Object(l.a)(a,u))}return a}(n,g,t.tokens,f.tokens,n.tokens),m=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return o.concatStyleSets.apply(void 0,r.map((function(r){return"function"==typeof r?r(e,t,n):r})))}(n,g,p,t.styles,f.styles,n.styles),y=Object(r.__assign)(Object(r.__assign)({},n),{styles:m,tokens:p,_defaultStyles:m,theme:g});return e(y)};return d.displayName=t.displayName||e.name,u&&(d.create=Object(c.a)(d,{defaultProp:u})),Object(l.a)(d,t.statics),d}},1579:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(469),i=n(1031),o=n(828),a=Object(r.a)(i.a,o.a,void 0,{scope:"TeachingBubble"})},1681:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3061);t.METADATA_KEY=r;var i=n(15133);t.Container=i.Container;var o=n(4629);t.BindingScopeEnum=o.BindingScopeEnum,t.BindingTypeEnum=o.BindingTypeEnum,t.TargetTypeEnum=o.TargetTypeEnum;var a=n(15149);t.AsyncContainerModule=a.AsyncContainerModule,t.ContainerModule=a.ContainerModule;var s=n(15150);t.injectable=s.injectable;var c=n(15151);t.tagged=c.tagged;var l=n(15152);t.named=l.named;var u=n(10584);t.inject=u.inject,t.LazyServiceIdentifer=u.LazyServiceIdentifer;var d=n(15153);t.optional=d.optional;var f=n(15154);t.unmanaged=f.unmanaged;var h=n(15155);t.multiInject=h.multiInject;var g=n(15156);t.targetName=g.targetName;var p=n(15157);t.postConstruct=p.postConstruct;var m=n(10582);t.MetadataReader=m.MetadataReader;var y=n(5491);t.id=y.id;var b=n(4993);t.decorate=b.decorate;var v=n(10587);t.traverseAncerstors=v.traverseAncerstors,t.taggedConstraint=v.taggedConstraint,t.namedConstraint=v.namedConstraint,t.typeConstraint=v.typeConstraint;var _=n(6875);t.getServiceIdentifierAsString=_.getServiceIdentifierAsString;var I=n(15158);t.multiBindToService=I.multiBindToService},16947:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3234),i=n(4995);n(3853);const o={DictionaryCritiqueFilter:Symbol.for("DictionaryCritiqueFilter"),EnabledCritiqueTypesCritiqueFilter:Symbol.for("EnabledCritiqueTypesCritiqueFilter"),IConditionalAttributeFilterFactory:Symbol.for("IConditionalAttributeFilterFactory"),ICritiqueFilterer:Symbol.for("ICritiqueFilterer"),ICritiquesBrokerFactory:Symbol.for("ICritiquesBrokerFactory"),IDomFinderFactory:Symbol.for("IDomFinderFactory"),IElementsRetriever:Symbol.for("IElementsRetriever"),IEnabledCritiqueTypes:Symbol.for("IEnabledCritiqueTypes"),IE2eMetric:r.a.IE2eMetric,IFeatureFlagsReader:r.a.IFeatureFlagsReader,IGrammarRules:Symbol.for("IGrammarRules"),IGraphNodeBuilderFactory:Symbol.for("Factory<IGraphNodeBuilderFactory>"),IGraphNodeFactory:Symbol.for("IGraphNodeFactory"),IGuidGenerator:r.a.IGuidGenerator,IHostEmitter:r.a.IHostEmitter,IHostEmitterArray:r.a.IHostEmitterArray,IHostModelPersistedStore:Symbol.for("IHostModelPersistedStore"),IHostModelSettings:Symbol.for("IHostModelSettings"),IHostTilingEmitter:Symbol.for("IHostTilingEmitter"),IHostSettings:Symbol.for("IHostSettings"),IIndexReadjuster:i.a.IIndexReadjuster,ILocalizer:r.a.ILocalizer,ILogger:r.a.ILogger,IMutationObserverFactory:Symbol.for("Factory<MutationObserver>"),INodeObserverFactory:Symbol.for("Factory<INodeObserver>"),INodePoller:Symbol.for("INodePoller"),IParagraphNodesBuilderFactory:Symbol.for("IParagraphNodesBuilderFactory"),IParagraphNodeDictionary:Symbol.for("IParagraphNodeDictionary"),IParagraphNodeFactory:Symbol.for("IParagraphNodeFactory"),IProofingPersistedStore:r.a.IProofingPersistedStore,IPreOrderTraverser:Symbol.for("IPreOrderTraverser<NodeElementType>"),IProofingDom:Symbol.for("IProofingDom"),IProofingEmitter:r.a.IProofingEmitter,IShadowGraphFactory:Symbol.for("Factory<IShadowGraph>"),IsUpsellUser:r.a.IsUpsellUser,ITerminalNodeReader:Symbol.for("ITerminalNodeReader<NodeElementType>"),ITerminalNodeWriter:Symbol.for("ITerminalNodeWriter<NodeElementType>"),ITextExtractor:i.a.ITextExtractor,ITextUnitChunker:i.a.ITextUnitChunker,ITileNodeDictionary:Symbol.for("ITileNodeDictionary"),ITileNodeReader:Symbol.for("ITileNodeReader<NodeElementType>"),IUpsellStore:Symbol.for("IUpsellStore"),IWordCount:i.a.IWordCount,IWordDictionary:Symbol.for("IWordDictionary"),PremiumCritiqueFilter:Symbol.for("PremiumCritiqueFilter")}},17081:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"Descriptor",(function(){return Ri})),n.d(r,"LookupWords",(function(){return xi})),n.d(r,"LookupInput",(function(){return Ai})),n.d(r,"Synonym",(function(){return Ni})),n.d(r,"Meaning",(function(){return Di})),n.d(r,"LookupResult",(function(){return Fi})),n.d(r,"LookupOutput",(function(){return ki})),n.d(r,"CommonAppIdProperty",(function(){return Mi})),n.d(r,"CommonLanguageIdProperty",(function(){return Bi})),n.d(r,"CommonAppVersionProperty",(function(){return Li})),n.d(r,"CommonDescriptorsProperty",(function(){return qi})),n.d(r,"PostCheckHeaders",(function(){return Ui}));var i=n(0),o=n(3),a=Object(o.action)("premiumPreviewActions",(function(e,t,n,r,i){return{viewState:e,premiumPreviewType:t,numerOfDaysLeft:n,shouldUpdateOptionSettings:r,premiumSuggestionsCount:i}})),s=n(2699),c=n(3670),l=n(105);var u=Object(o.mutatorAction)("onUpdatePremiunSuggestionsDaysLeft",(function(e,t,n,r,i){e.premiumPreviewData.numberOfDaysLeftToUsePremiunSuggestions=t,e.premiumPreviewData.premiumPreviewStatus=n,e.premiumPreviewData.premiumPreviewType=r,e.premiumPreviewData.premiumSuggestionsCount=i})),d=n(3224);Object(o.orchestrator)(a,(function(e){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return e.shouldUpdateOptionSettings?e.premiumPreviewType!==s.b.TimeBased?[3,2]:[4,d.g.importAndExecute(e.numerOfDaysLeft)]:[3,5];case 1:n.sent(),n.label=2;case 2:return e.premiumPreviewType!==s.b.CountBased?[3,4]:[4,d.i.importAndExecute("premiumSuggestionsCount",e.premiumSuggestionsCount)];case 3:n.sent(),n.label=4;case 4:return t=s.a.Activated,[3,6];case 5:t=function(e,t,n){switch(e){case s.b.TimeBased:return n===c.b?s.a.New:n>0?s.a.Activated:s.a.Expired;case s.b.CountBased:return t===c.g?s.a.Expired:t>c.h?s.a.Activated:s.a.New;case s.b.TimeAndCountCombined:case s.b.None:case s.b.BasicSkittle:return s.a.Unknown;default:return Object(l.a)(e)}}(e.premiumPreviewType,e.premiumSuggestionsCount,e.numerOfDaysLeft),n.label=6;case 6:return u(e.viewState,e.numerOfDaysLeft,t,e.premiumPreviewType,e.premiumSuggestionsCount),[2]}}))}))}));var f=n(296),h=n(6844),g=n(7530);function p(){return Object(h.a)()?g.a.MSA:Object(f.a)()?g.a.MSA:g.a.AAD}var m=n(4227),y=n(15129),b=n(7),v=n(4992);var _=n(9179),I=n(10579),S=n(9180),C=n(10595),O=n(40),T="spelling",E="grammar",P="refinements";function w(e){switch(e){case I.b.Low:return P;case I.b.Medium:return E;case I.b.High:return T}return"callout_unknown"}var j=n(134),R=n(208),x=n(85),A=n(1),N=n(32),D=n(348),F=n(749),k=n(86),M=n(1567),B=n(613),L=n(883),q=n(521);function U(e,t,n){var r,i,o,a=e.premiumPreviewType;switch(a){case s.b.TimeBased:o=v.q,r=1===(i=t||e.numberOfDaysLeftToUsePremiunSuggestions)?v.e:v.c;break;case s.b.CountBased:o=v.a,r=1===(i=n||e.premiumSuggestionsCount)?v.f:v.g;break;case s.b.TimeAndCountCombined:case s.b.BasicSkittle:case s.b.None:break;default:return Object(l.a)(a)}return{stringToShowInSkittle:r,numberToShow:i,stringToShowOnPremiumPreviewCallout:o}}var H="https://go.microsoft.com/fwlink/?linkid=2146723",W="https://go.microsoft.com/fwlink/?linkid=2146721",G="https://go.microsoft.com/fwlink/?linkid=2146728",V="https://go.microsoft.com/fwlink/?linkid=2147013",z="https://go.microsoft.com/fwlink/?linkid=2146724",J="https://go.microsoft.com/fwlink/?linkid=2147012",$="https://go.microsoft.com/fwlink/?linkid=2147014",K="https://go.microsoft.com/fwlink/?linkid=2146726",Q="https://go.microsoft.com/fwlink/?linkid=2139290",Z="https://go.microsoft.com/fwlink/?linkid=2145120",Y="https://go.microsoft.com/fwlink/?linkid=2145204",X="https://go.microsoft.com/fwlink/?linkid=2125009",ee="https://go.microsoft.com/fwlink/?linkid=2125008",te="https://go.microsoft.com/fwlink/?linkid=2146725",ne="https://go.microsoft.com/fwlink/?linkid=2146722",re="https://go.microsoft.com/fwlink/?linkid=2146729",ie="https://go.microsoft.com/fwlink/?linkid=2146727";function oe(e,t,n){var r=ae(e,t,n,void 0);window.open(r,"_blank")}function ae(e,t,n,r){switch(e){case s.b.TimeBased:switch(t){case s.a.New:switch(n){case"Callout":return H;case"ContexualCard":return V;default:Object(l.a)(n)}break;case s.a.Activated:switch(n){case"Callout":return W;case"ContexualCard":return V;default:Object(l.a)(n)}break;case s.a.Expired:switch(n){case"Callout":return G;case"ContexualCard":return V;default:Object(l.a)(n)}break;case s.a.Unknown:break;default:Object(l.a)(t)}break;case s.b.CountBased:switch(t){case s.a.New:switch(n){case"Callout":return z;case"ContexualCard":return K;default:Object(l.a)(n)}break;case s.a.Activated:switch(n){case"Callout":return J;case"ContexualCard":return K;default:Object(l.a)(n)}break;case s.a.Expired:switch(n){case"Callout":return $;case"ContexualCard":return K;default:Object(l.a)(n)}break;case s.a.Unknown:break;default:Object(l.a)(t)}break;case s.b.TimeAndCountCombined:switch(t){case s.a.New:switch(n){case"Callout":return te;case"ContexualCard":return ie;default:Object(l.a)(n)}break;case s.a.Activated:switch(n){case"Callout":return ne;case"ContexualCard":return ie;default:Object(l.a)(n)}break;case s.a.Expired:switch(n){case"Callout":return re;case"ContexualCard":return ie;default:Object(l.a)(n)}break;case s.a.Unknown:break;default:Object(l.a)(t)}break;case s.b.BasicSkittle:switch(n){case"Callout":return Q;case"ContexualCard":return r?Z:Y;default:Object(l.a)(n)}break;case s.b.None:switch(n){case"Callout":return"";case"ContexualCard":return r?X:ee;default:Object(l.a)(n)}break;default:Object(l.a)(e)}return""}var se="EditorProofing_UpsellClicked",ce="ContextualUpsell_SkittleOpenUpsellCallout",le="PremiumPreview_SkittleOpenOpt-inDialog",ue="PremiumPreview_CCardOpenOpt-inDialog",de="PremiumPreview_SettingsOpenOpt-in",fe="PremiumPreview_SkittleCountdownCallout",he="PremiumPreview_SkittlePreviewEndCallout",ge="PremiumPreview_SettingsCountdown",pe="PremiumPreview_SettingsDialogAfter",me="PremiumPreview_CCardCountdown",ye="PremiumPreview_CCAfterPreviewEnd",be="Regular_SettingsDialog",ve="ContextualUpsell_CCard",_e="Regular_CCard";function Ie(e,t,n){var r=function(e,t,n){var r="";switch(e){case"PremiumPreview":switch(t){case"settings":r=de;break;case"skittle":r=le;break;case"contextualCard":r=ue;break;case"none":break;default:Object(l.a)(t)}break;case"Skittle":switch(n){case s.a.Activated:r=fe;break;case s.a.Expired:r=he;break;case s.a.New:break;case s.a.Unknown:r=ce;break;default:Object(l.a)(n)}break;case"ContexualCard":switch(n){case s.a.Activated:r=me;break;case s.a.Expired:r=ye;break;case s.a.New:r=ve;break;case s.a.Unknown:r=_e;break;default:Object(l.a)(n)}break;case"SettingsCompose":switch(n){case s.a.Activated:r=ge;break;case s.a.Expired:r=pe;break;case s.a.New:break;case s.a.Unknown:r=be;break;default:Object(l.a)(n)}break;default:Object(l.a)(e)}return r}(e,t.premiumPreviewSource,t.premiumPreviewStatus);Object(j.r)(se,{type:n,location:r},{isCore:!0,isCosmosDatapoint:!0})}var Se="EditorProofing_ContextualCardOpenPremiumPreviewOptInDialog ",Ce="EditorProofing_SettingsOpenPremiumPreviewOptInDialog ",Oe="EditorProofing_PremiumPreview_Try_Skittle",Te="EditorProofing_PremiumPreview_Try_CCard",Ee="EditorProofing_PremiumPreview_Try_Settings";function Pe(e,t){var n;(n=t?function(e){switch(e){case"contextualCard":return Se;case"settings":return Ce;case"skittle":case"none":return"";default:Object(l.a)(e)}}(e):function(e){switch(e){case"skittle":return Oe;case"contextualCard":return Te;case"settings":return Ee;case"none":return"";default:Object(l.a)(e)}}(e))&&Object(j.r)(n,null,{isCore:!0,isCosmosDatapoint:!0})}var we=n(5490),je=n(15131),Re=Object(N.a)((function(e){A.useEffect((function(){Pe(e.premiumPreviewData.premiumPreviewSource,!0)}),[]);var t=A.useCallback((function(){oe(e.premiumPreviewData.premiumPreviewType,e.premiumPreviewData.premiumPreviewStatus,"Callout"),Ie("PremiumPreview",e.premiumPreviewData,"")}),[e.premiumPreviewData.premiumPreviewType,e.premiumPreviewData.premiumPreviewStatus,e.premiumPreviewData]),n=A.useCallback((function(){e.onTryItNowClick(c.e,c.f)}),[]),r=U(e.premiumPreviewData,c.e,c.f),i=r.stringToShowOnPremiumPreviewCallout,o=r.numberToShow,a=Object(b.c)(Object(b.b)(i),o),s={flexContainer:we.goPremiumButoon},l=A.useCallback((function(){var t;null===(t=e.onHoverPremiumPreview)||void 0===t||t.call(e,!0)}),[e.onHoverPremiumPreview]),u=A.useCallback((function(){var t;null===(t=e.onHoverPremiumPreview)||void 0===t||t.call(e,!1)}),[e.onHoverPremiumPreview]),d="skittle"!==e.premiumPreviewData.premiumPreviewSource?we.editorPremPrevImageDialog:we.editorPremPrevImage;return A.createElement("div",{className:we.premPrevSkittleContainer,onMouseLeave:u,onMouseEnter:l},A.createElement("div",{className:d},A.createElement("img",{src:je,className:we.editorSVG})),A.createElement("span",{className:we.premPrevTitle}," ",Object(b.b)(v.r)," "),A.createElement("span",{className:we.editorPremPrevText},a),A.createElement("div",{className:we.premPrevbuttonsContainer},A.createElement(L.a,{onClick:n,text:Object(b.b)(v.s),className:we.goPremiumButoon}),A.createElement(q.a,{onClick:t,styles:s,text:Object(b.b)(v.t),className:we.goPremiumButoon},A.createElement(D.a,{iconName:"Diamond",className:we.premiumPreviewDiamonIcon}))))})),xe=n(5490),Ae=Object(N.a)((function(e){return A.createElement(M.a,{onDismiss:e.onDismiss,hidden:!1,dialogContentProps:{type:B.a.normal},containerClassName:xe.confirmation,modalProps:{isBlocking:!0,className:xe.dialogBox}},A.createElement(Re,{onTryItNowClick:e.onTryItNowClick,premiumPreviewData:e.premiumPreviewData,onHoverPremiumPreview:null}))})),Ne="EditorProofing_SkittleOpenUpsellCallout",De="EditorProofing_PremiumPreview_CountdownCalloutOpen",Fe="EditorProofing_PremiumPreview_EndCalloutOpen",ke="EditorProofing_SkittleOpenPremiumPreviewOptInDialog";var Me=n(913);var Be,Le,qe,Ue=Object(o.mutatorAction)("onHideSkittle",(function(e){e.skittleViewStatus="Hide"})),He=Object(o.mutatorAction)("onShowSkittle",(function(e){e.skittleViewStatus="Show"})),We=Object(o.mutatorAction)("onSkittleUpdate",(function(e,t,n){e.premimumFlagsFound=t,e.premiumCategories=n})),Ge=Object(o.mutatorAction)("onUpdateSkittleCallout",(function(e,t){e.skittleCalloutStatus=t})),Ve=Object(o.mutatorAction)("onUpdateSkittleCallout",(function(e,t){e.premiumPreviewData.premiumPreviewSource=t})),ze=Object(o.mutatorAction)("onProofingDisable",(function(e){e.isProofingDisabled=!0})),Je=n(5490),$e=Object(N.a)((function(e){var t=e.premimumFlagsFound,n=e.premiumCategories;if(t>0){var r=1===t?v.k:v.j,i=Object(b.c)(Object(b.b)(r),n);return A.createElement("div",{className:Je.skittleCalloutTextContainer},A.createElement("span",null,Object(b.b)(v.i)),A.createElement("span",{className:Je.premimumFlagsFound}," ",t," "),A.createElement("span",null,i))}return A.createElement("div",{className:Je.skittleCalloutTextContainer},A.createElement("div",null,Object(b.b)(v.o)))})),Ke=n(5490),Qe=Object(N.a)((function(e){var t=U(e.premiumPreviewData,null,null),n=t.stringToShowInSkittle,r=t.numberToShow;return A.createElement("div",{className:Ke.skittleCalloutTextContainer},A.createElement("span",{className:Ke.premimumFlagsFound},r),A.createElement("span",{className:Ke.premimumpreviewDaysText},Object(b.b)(n)))})),Ze=n(5490),Ye=Object(N.a)((function(e){var t=e.premimumFlagsFound,n=e.premiumCategories,r=e.premiumPreviewData,i=e.upsellClicked,o=r.premiumPreviewStatus;return o===s.a.Activated?A.createElement(Qe,{premiumPreviewData:r}):o===s.a.Expired?A.createElement("div",{className:Ze.skittleCalloutTextContainer},A.createElement("div",null,Object(b.b)(v.d))):A.createElement($e,{premimumFlagsFound:t,premiumCategories:n,upsellClicked:i})})),Xe=n(1569),et=n(5490),tt=n(15132),nt=Object(N.a)((function(e){var t=A.useCallback((function(){oe(i.premiumPreviewType,i.premiumPreviewStatus,"Callout"),Ie("Skittle",i,"")}),[]),n=e.premimumFlagsFound,r=e.premiumCategories,i=e.premiumPreviewData,o=i.premiumPreviewStatus,a=i.premiumPreviewType,c=o===s.a.Activated?v.b:v.p;return A.createElement("div",{className:et.skittleCalloutContainer},A.createElement("div",{className:et.skittleCountContainer},A.createElement("div",{className:et.editorImage},A.createElement("img",{src:tt,className:et.editorSVG})),A.createElement("div",{className:et.calloutTextContainer},A.createElement("span",{className:et.calloutTitle}," ",Object(b.b)(c)," "),A.createElement(Ye,{premimumFlagsFound:n,premiumCategories:r,premiumPreviewData:i,upsellClicked:t}))),A.createElement("div",{className:et.linkContainer},A.createElement("div",{className:et.linkInnerContainer},a!==s.b.BasicSkittle&&A.createElement("span",{className:et.goPremiumText},Object(b.b)(v.h)),A.createElement(Xe.a,{href:"javascript:void(0);",className:et.goPremiumLink,onClick:t},Object(b.b)(v.t)))))})),rt=n(7531),it=n(10592),ot=n(10593);!function(e){e[e.OutlineNode=0]="OutlineNode",e[e.TerminalNode=1]="TerminalNode",e[e.TileNode=2]="TileNode",e[e.ParagraphNode=3]="ParagraphNode"}(Be||(Be={})),function(e){e.DefaultOutlineNodeObserver="DefaultOutlineNodeObserver",e.TerminalNodeObserver="TerminalNodeObserver",e.InputNodeObserver="InputNodeObserver",e.AttributeObserver="AttributeObserver"}(Le||(Le={})),function(e){e.SelectorDomFinder="SelectorDomFinder",e.TextDomFinder="TextDomFinder"}(qe||(qe={}));n(3853);var at=n(10627),st=n(7532),ct=n(5843),lt=n(15220),ut=n(10599);class dt{constructor(e,t,n,r,i){this.initialize=()=>{if(this._sessionPromise)this._logger.info(588862478,"Skipping augloop initialization because another one is in progress");else if(this._alRuntimePromise)try{this._sessionPromise=this._alRuntimePromise.then(async e=>e.createSession({docSessionId:void 0!==this._sessionId?this._sessionId.toString():(new ut.a).generate()})),this._sessionPromise.catch(e=>{this._logger.error(588862480,`Failed to create AugLoop session: ${e}`)}),this._submitDocumentTile(),this._sessionPromise.then(e=>{e.activateAnnotation(ct.Critique.getTypeName(),{callback:this._onAnnotationResult})})}catch(e){this._logger.error(588862481,`Failed to create AugLoop session: ${e}`)}else this._logger.error(588862479,"Failed to initialize augloop, there is no runtime")},this.submitTileAdd=(e,t,n)=>{this._submitOperation(new lt.AddOperation({parentPath:["session","doc"],items:[{id:e,revId:`${n}`,body:t}]}))},this.submitTileDelete=e=>{this._submitOperation(new lt.DeleteOperation({parentPath:["session","doc"],items:[{id:e}]}))},this.submitTileUpdate=(e,t,n)=>{this._submitOperation(new lt.UpdateOperation({parentPath:["session","doc"],items:[{id:e,revId:`${n}`,body:t}]}))},this.submitDelta=(e,t,n)=>{this._submitOperation(new lt.DeltaUpdateOperation({parentPath:["session","doc",e],items:[{id:e,revId:`${n}`,body:t}]}))},this.getSessionId=()=>this._sessionId,this._onAnnotationResult=e=>{if(e&&e.items&&e.items.length>0){let t;const n=lt.SchemaObject.getTypeNameFor(e);switch(n){case lt.AddOperation.getTypeName():t=ot.a.NewData;break;case lt.UpdateOperation.getTypeName():t=ot.a.ChangeData;break;case lt.DeleteOperation.getTypeName():t=ot.a.RemoveData;break;default:return void this._logger.error(588862482,`Unexpected annotation operation: ${n}`)}for(const n of e.items)this._hostEmitter.emit(st.a.hostModelCritique,{address:this._sessionId,message:{messageType:t,data:{tileId:e.parentPath.length>0?e.parentPath[e.parentPath.length-1]:"",tileVersion:Number.parseInt(e.parentRevId||"0",10),annotationId:n.id,critique:n.body}}})}},this._submitDocumentTile=()=>{const e={id:"doc",body:new lt.Document({isReadonly:!1})},t=new lt.AddOperation({parentPath:["session"],items:[e]});this._sessionPromise&&this._sessionPromise.then(e=>{e.submitSeedOperations([t])})},this._submitOperation=e=>{this._sessionPromise&&this._sessionPromise.then(t=>{t.submitOperations([e])})},this._sessionId=e,this._hostEmitter=t,this._logger=n,r&&(this._sessionPromise=Promise.resolve(r),r.activateAnnotation(ct.Critique.getTypeName(),{callback:this._onAnnotationResult})),this._alRuntimePromise=i}}class ft{constructor(e,t,n){this._tiles=new Map,this._critiquesPerNode=new Map,this.initialize=()=>{},this.submitTileAdd=(e,t,n)=>{if(this._tiles.set(e,t.content),t.content){const r=t.content.indexOf("spell");-1!==r&&this._emitCritique(e,t.content,r,"spell".length,n)}},this.submitTileDelete=e=>{this._tiles.delete(e),this._deleteCritiques(e)},this.submitTileUpdate=(e,t)=>{this._tiles.set(e,t.content)},this.submitDelta=(e,t,n)=>{let r=this._tiles.get(e);if(void 0!==r){switch(t.deltaType){case ct.TextTileDeltaType.Add:t.position<r.length?r=`${r.slice(0,t.position)}${t.content}${r.slice(t.position,r.length)}`:r+=t.content;break;case ct.TextTileDeltaType.Update:r=`${r.slice(0,t.position)}${t.content}${r.slice(t.position+(t.length||0),r.length)}`;break;case ct.TextTileDeltaType.Delete:r=`${r.slice(0,t.position)}${r.slice(t.position+(t.length||0),r.length)}`}if(this._tiles.set(e,r),0===r.length&&this._deleteCritiques(e),t.unit===ct.TextTileDeltaUnit.Word||t.unit===ct.TextTileDeltaUnit.Sentence){let t=r.indexOf("spell");for(;-1!==t;)this._emitCritique(e,r,t,"spell".length,n),t=r.indexOf("spell",t+"spell".length)}}},this.getSessionId=()=>this._sessionId,this._deleteCritiques=e=>{const t=this._critiquesPerNode.get(e);if(void 0!==t){for(const n of t)setTimeout(()=>{this._hostEmitter.emit(st.a.hostModelCritique,{address:this._sessionId,message:{messageType:ot.a.RemoveData,data:{annotationId:"A1",tileId:e,critique:n,tileVersion:0}}})},ft._emitterDelayMs*Math.random());this._critiquesPerNode.delete(e)}},this._emitCritique=(e,t,n,r,i)=>{let o=this._critiquesPerNode.get(e);void 0===o&&(o=[]);const a=new ct.Critique({priority:ct.Priority.High,id:this._guidGenerator.generate(),context:t,startInContext:0,categoryName:"Spelling",language:"en-US",explanationTitle:"Spelling Mistake",explanationBody:"Stop making spelling mistakes.",bucketId:42,suggestions:[{text:"spell-better",description:"Spell better 1",suggestionActions:ct.SuggestionAction.ChangeOnce},{text:"spell-much-better",description:"Spell better 2",suggestionActions:ct.SuggestionAction.ChangeOnce},{text:"spel",description:"Spell better 3",suggestionActions:ct.SuggestionAction.ChangeOnce}],range:{start:n,length:r}});o.push(a),this._critiquesPerNode.set(e,o),setTimeout(()=>{this._hostEmitter.emit(st.a.hostModelCritique,{address:this._sessionId,message:{messageType:ot.a.NewData,data:{annotationId:"A1",tileId:e,tileVersion:i,critique:a}}})},ft._emitterDelayMs*Math.random())},this._sessionId=e,this._hostEmitter=t,this._guidGenerator=n}}ft._emitterDelayMs=2e3;class ht{constructor(e,t,n,r,i,o,a){this._hostEmitter=e,this._hostSettings=t,this._guidGenerator=n,this._descriptorManager=r,this._logger=i,this._e2eMetric=o,this._alSession=a,this._sessions=new Map,this.initialize=()=>{if(this._hostSettings.enableOrchestration&&(this._hostEmitter.on(st.a.hostModelDelta,this._handleDelta),this._hostEmitter.on(st.a.hostModelTextTile,this._handleTile),this._hostEmitter.on(st.a.hostModelMoveTextTile,this._handleMove),this._hostSettings.orchestratorSettings&&this._hostSettings.orchestratorSettings.enableAugLoop&&this._hostSettings.orchestratorSettings.augLoopEndpoint&&!this._alSession)){const e={appName:"EditorSDK",appPlatform:"Online"},t={onAnnotationResult:()=>{},isFeatureEnabled:async(e,t)=>Promise.resolve(!0),onResult:()=>{},executeLocalLambda:async()=>{},areLicenseFeaturesEnabled:async()=>Promise.resolve(!1),overrideSessionInitMessage:e=>e,requestAuthToken:async()=>{},sendTelemetryEvent:()=>{},setSessionData:()=>{}},n=this._hostSettings.orchestratorSettings.augLoopEndpoint,r=Object(at.createRuntime)();this._alRuntimePromise=this._descriptorManager.buildDescriptors().then(async i=>{const o=i.find(e=>"FlightIds"===e.name);return o&&(e.flights=o.value),r.init(n,e,t,{telemetryAggregationIntervalSec:100,initSession:!1}).then(()=>r)})}},this.shutDown=async()=>{this._hostSettings.enableOrchestration&&(this._hostEmitter.off(st.a.hostModelDelta,this._handleDelta),this._hostEmitter.off(st.a.hostModelTextTile,this._handleTile),this._hostEmitter.off(st.a.hostModelMoveTextTile,this._handleMove))},this._handleDelta=e=>{const t=this._getSession(e.address),n=e.message;n&&(this._e2eMetric.startEntry(`${n.tileId}--${n.tileVersion}`),t.submitDelta(n.tileId,n.delta,n.tileVersion))},this._handleTile=e=>{const t=this._getSession(e.address),n=e.message;if(n)switch(n.messageType){case ot.a.NewData:t.submitTileAdd(n.data.tileId,n.data.tile,n.data.tileVersion);break;case ot.a.RemoveData:t.submitTileDelete(n.data.tileId);break;case ot.a.ChangeData:t.submitTileUpdate(n.data.tileId,n.data.tile,n.data.tileVersion)}},this._handleMove=e=>{const t=this._getSession(e.address),n=e.message;t.submitTileDelete(n.oldTileId),t.submitTileAdd(n.newTileId,new ct.TextTile({content:n.content}),n.tileVersion)},this._getSession=e=>{let t=this._sessions.get(e);return t||(t=this._hostSettings.orchestratorSettings&&this._hostSettings.orchestratorSettings.enableAugLoop?new dt(e,this._hostEmitter,this._logger,this._alSession,this._alRuntimePromise):new ft(e,this._hostEmitter,this._guidGenerator),t.initialize(),this._sessions.set(e,t)),t}}}var gt,pt=n(16),mt=n(10590),yt=n(10591),bt=n(10597),vt=n(11209),_t=n(10611),It=n(10612),St=n(10613),Ct=n(10614),Ot=n(10615),Tt=n(10616),Et=n(10617),Pt=n(10618),wt=n(10596),jt=n(10621),Rt=n(10622),xt=n(1804),At=n(11210),Nt=n(10625),Dt=n(10626),Ft=n(4287),kt=n(1681),Mt=n(2342),Bt=function(e,t){return function(n,r){t(n,r,e)}};let Lt=gt=class{constructor(e,t){this._hostEmitters=e,this._proofingStore=t}emitTileEvent(e,t,n,r){this._hostEmitters.forEach(i=>{i.emit(st.a.hostModelTextTile,{address:void 0,message:{messageType:r,data:{tileId:e,tileVersion:n,tile:new ct.TextTile({content:t})}}})})}emitTileDiffEvent(e,t,n,r,i,o,a,s){const c=s&&s.some(e=>e.textUnit===Ft.c.TextUnit.Sentence)?ct.TextTileDeltaUnit.Sentence:i?ct.TextTileDeltaUnit.Word:ct.TextTileDeltaUnit.Chars,l=r.firstDiffLeft,u=t.length-r.firstDiffRight,d=n.length-r.firstDiffRight,f=t.length===n.length?ct.TextTileDeltaType.Update:u===l?ct.TextTileDeltaType.Add:d===l?ct.TextTileDeltaType.Delete:ct.TextTileDeltaType.Update;let h,g;switch(f){case ct.TextTileDeltaType.Update:h=u-l,g=n.substring(l,d);break;case ct.TextTileDeltaType.Add:h=0,g=n.substring(l,d);break;case ct.TextTileDeltaType.Delete:h=u-l,g=t.substring(l,u)}const p=this.getProofingLanguage();this._hostEmitters.forEach(t=>{t.emit(st.a.hostModelDelta,{address:void 0,message:{tileId:e,tileVersion:o,delta:new ct.TextTileDelta({deltaType:f,unit:c,position:l,length:h,content:g,wordCount:a,invalidationRanges:s?s.map(e=>({position:e.header.elementId.offset,length:e.header.elementId.span,unit:gt._convertTextUnit(e.textUnit),languageId:p})):void 0})}})})}emitMoveTileEvent(e,t,n,r){this._hostEmitters.forEach(i=>{i.emit(st.a.hostModelMoveTextTile,{address:void 0,message:{oldTileId:e,newTileId:t,tileVersion:r,content:n}})})}static _convertTextUnit(e){if(void 0===e)return ct.TextTileDeltaUnit.Sentence;switch(e){case Ft.c.TextUnit.Word:return ct.TextTileDeltaUnit.Word;case Ft.c.TextUnit.Sentence:default:return ct.TextTileDeltaUnit.Sentence}}getProofingLanguage(){return new it.a(this._proofingStore.getCachedEntry(rt.a.ProofingLanguages).storeEntryValue).defaultLanguageCode}};Lt=gt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Bt(0,Object(kt.multiInject)(Mt.a.IHostEmitterArray)),Bt(1,Object(kt.inject)(Mt.a.IProofingPersistedStore))],Lt);var qt,Ut=function(e,t){return function(n,r){t(n,r,e)}};let Ht=qt=class{constructor(e,t,n,r){this._preOrderTraverser=e,this._tileNodeDictionary=t,this._paragraphNodeDictionary=n,this._shadowGraphFactory=r}get shadowGraph(){return this._shadowGraph}registerNode(e){const t=this._selectDictionary(e.nodeType);t&&(t[e.id]=e)}unregisterNode(e){const t=this._selectDictionary(e.nodeType);t&&delete t[e.id]}findNode(e){return this.ensureCanFindNode()?this._iterateGraph(e):null}findNodeAtRoots(e,t){return this._preOrderTraverser.rootAtNodes(e),this._iterateGraph(t)}findTileNode(e){return this.ensureCanFindNode()?this._tileNodeDictionary[e]:null}get tileNodes(){return Object.values(this._tileNodeDictionary)}findParagraphNode(e){return this._paragraphNodeDictionary[e]}addNode(e){if(e.parent){const t=this.findNode(e.parent.id);t&&(t.children||(t.children=[]),t.children.push(e))}else this._shadowGraph||(this._shadowGraph=this._shadowGraphFactory()),this._shadowGraph.rootNodes.push(e)}removeNode(e){if(this.findNode(e.id)){let t;e.parent?t=e.parent.children:this._shadowGraph&&(t=this._shadowGraph.rootNodes),qt.removeElement(e,t),e.retire()}}cleanUp(){this.retireAllShadowGraphRootNodes()}_selectDictionary(e){switch(e){case Be.TileNode:return this._tileNodeDictionary;case Be.ParagraphNode:return this._paragraphNodeDictionary;default:return}}ensureCanFindNode(){return!!this._shadowGraph&&(this._preOrderTraverser.rootAtNodes(this._shadowGraph.rootNodes),!0)}retireAllShadowGraphRootNodes(){if(this._shadowGraph)for(const e of this._shadowGraph.rootNodes)e.retire()}_iterateGraph(e){const t=this._preOrderTraverser.getIterator();let n=t.next();for(;!n.done;){if(n.value&&n.value.id===e)return n.value;n=t.next()}return null}static removeElement(e,t){if(t){const n=t.indexOf(e);if(-1!==n)return t.splice(n,1),!0}return!1}};Ht=qt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Ut(0,Object(kt.inject)(Mt.a.IPreOrderTraverser)),Ut(1,Object(kt.inject)(Mt.a.ITileNodeDictionary)),Ut(2,Object(kt.inject)(Mt.a.IParagraphNodeDictionary)),Ut(3,Object(kt.inject)(Mt.a.IShadowGraphFactory))],Ht);var Wt,Gt,Vt=n(4994);!function(e){e.ReconcileTileNode="ReconcileTileNode",e.WebSiteProvedOnce="WebSiteProvedOnce"}(Wt||(Wt={})),function(e){e.MutationError="MutationError",e.UpdateCritiqueException="RunTimeErrors.UpdateCritiqueException"}(Gt||(Gt={}));var zt=function(e,t){return function(n,r){t(n,r,e)}};let Jt=class{constructor(e,t,n){this._mutationObserverFactory=e,this._logger=t,this.elementTransformers=n,this.connectMutationObserver=(e,t,n)=>{this._mutationObserver=this._mutationObserverFactory(e=>{e.forEach((e,t,r)=>this.handleMutation(e,n?n(e,t,r):void 0))}),this._mutationObserver.observe(e,t)},this.flushMutationObserver=e=>{this._mutationObserver&&this._mutationObserver.takeRecords().forEach((t,n,r)=>this.handleMutation(t,e?e(t,n,r):void 0))},this.handleMutation=(e,t)=>{try{const n=this.onElementRemoved,r=this.onElementAdded,i=this.onElementChanged;switch(e.type){case"childList":if(n){Array.from(e.removedNodes).forEach(e=>{n(e,t)})}if(r){Array.from(e.addedNodes).forEach(e=>{r(e,t)})}break;case"characterData":i&&i(e.target);break;case"attributes":this.handleAttributeChange(e,r,i,n)}}catch(e){this._logger.logEvent(591681236,Gt.MutationError,Vt.e.Error,"Error while processing a mutation.",Vt.f.CriticalBusinessImpact)}}}handleAttributeChange(e,t,n,r,i){const o=e.attributeName,a=e.target;this.elementTransformers&&o&&this.elementTransformers.forEach(e=>{e.attributeList.includes(o)&&e.transform(a)}),n&&n(a,i)}disconnect(){this._mutationObserver&&(this._mutationObserver.takeRecords(),this._mutationObserver.disconnect())}};Jt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),zt(0,Object(kt.inject)(Mt.a.IMutationObserverFactory)),zt(1,Object(kt.inject)(Mt.a.ILogger))],Jt);var $t=function(e,t){return function(n,r){t(n,r,e)}};let Kt=class extends Jt{constructor(e,t){super(e,t),this.mutationObserverFactory=e,this.logger=t}observe(e){this.connectMutationObserver(e,{attributes:!0,attributeFilter:["style"],characterData:!1,childList:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1})}};Kt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),$t(0,Object(kt.inject)(Mt.a.IMutationObserverFactory)),$t(1,Object(kt.inject)(Mt.a.ILogger))],Kt);var Qt=function(e,t){return function(n,r){t(n,r,e)}};let Zt=class{constructor(e,t,n,r,i,o){this._observerFactory=e,this._graphNodeFactory=t,this._graphNodeBuilderFactory=n,this._childElementsFinderFactory=r,this._logger=i,this._graphNodeBuilderNonTerminalRule=o,this.buildNode=(e,t)=>{const n=this._observerFactory(this._graphNodeBuilderNonTerminalRule.nodeMetaType.observerType,this._graphNodeBuilderNonTerminalRule.nodeMetaType),r=this._graphNodeFactory(this._graphNodeBuilderNonTerminalRule.nodeMetaType.nodeType,n,e,t),i=this._childElementsFinderFactory(this._graphNodeBuilderNonTerminalRule.nodeMetaType.elementsFinder);if(!this._graphNodeBuilderNonTerminalRule.childMetaType)return r;const o=this._graphNodeBuilderFactory(this._graphNodeBuilderNonTerminalRule.childMetaType),a=this._getElementsToBuildChildNodes(e,i,r).map(e=>o.buildNode(e,r));return r.children=a,n.onElementAdded=e=>{const t=this._getElementsToBuildChildNodes(e,i,r);r.children=r.children||[],r.children.push(...t.filter(e=>!r.children||!r.children.some(t=>t.element===e)).map(e=>o.buildNode(e,r))),this._logger.log(589844951,Vt.e.Debug,`OutlineNodeBuilder: add operation performed. There are currently ${r.children.length} nodes tracked`,{nodeId:r.id})},n.onElementChanged=this.setOnElementChangeCallback?this.setOnElementChangeCallback(n):void 0,n.onElementRemoved=e=>{const t=i.find(e);r.children=r.children||[],r.children=r.children.filter(n=>{for(const i of t){const t=n.element&&n.element===i&&e.contains(n.element);if(t)return n.retire(),this._logger.log(589844952,Vt.e.Debug,"OutlineNodeBuilder: Delete op performed.",{nodeId:r.id}),!t}return!0})},r},this._getElementsToBuildChildNodes=(e,t,n)=>t.find(e).filter(e=>this._graphNodeBuilderNonTerminalRule.nodeMetaType.filters.every(t=>t(e,n,this._graphNodeBuilderNonTerminalRule.nodeMetaType)))}};Zt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Qt(0,Object(kt.inject)(Mt.a.INodeObserverFactory)),Qt(1,Object(kt.inject)(Mt.a.IGraphNodeFactory)),Qt(3,Object(kt.inject)(Mt.a.IDomFinderFactory)),Qt(4,Object(kt.inject)(Mt.a.ILogger))],Zt);class Yt{constructor(e){this.filters=e,this.attributeList=Array.from(e.keys())}shouldProofElement(e){let t=!1;return this.filters.forEach(n=>{t=t||n(e)}),!t}}var Xt,en=n(10594),tn=n(3234),nn=function(e,t){return function(n,r){t(n,r,e)}};let rn=Xt=class{constructor(e,t,n,r,i,o,a){this._proofingEmitter=e,this._proofingDom=t,this._proofingPersistedStore=n,this._logger=r,this._tileNode=i,this._critiqueFilterer=o,this._upsellStore=a,this._actionCallback=(e,t)=>{switch(e){case en.a.IgnoreOnce:case en.a.ApplySuggestion:this._removeCritique(t);break;default:this._logger.error(591526047,"Unexpected and unhandled action type for callback",e)}},this._removeCritique=e=>{if(this._critiques.delete(e)){const e=new Map;this._critiques.forEach(t=>{this._addToActive(t,[e])}),this._sendCritiqueMessage(e,this._tileNode.id,void 0,ot.a.NewData)}},this._critiques=new Map}reconcile(e,t,n,r,i,o,a,s=!1,c){let l=s;const u=this._critiques.size,d=new Map,f=new Map,h=new Map,g=this._mergeCritiques(e,o,a);this._critiques.forEach(e=>{const o=t.length-e.start,a=n.length-o;a>n.length-i.firstDiffRight?(e.start=a,Xt._isInMonitoredTextRange(r,e)&&(this._addToActive(e,[f]),h.set(e.start,e),l=!0)):i.firstDiffRight?e.start+e.length>=i.firstDiffLeft?(l=!0,this._upsellStore.removePremiumCritique(e)):Xt._isInMonitoredTextRange(r,e)&&(this._addToActive(e,[f,d]),h.set(e.start,e)):e.start+e.length>=i.firstDiffLeft&&t.length!==n.length?(l=!0,this._upsellStore.removePremiumCritique(e)):Xt._isInMonitoredTextRange(r,e)&&(this._addToActive(e,[f,d]),h.set(e.start,e))}),this._critiques.size||u||d.size||(l=!1),l&&this._sendCritiqueMessage(f,this._tileNode.id,c,(g||this._critiques.size!==u||(f.size,d.size),ot.a.NewData)),this._critiques=h}move(e,t){this._critiques.forEach(e=>{e.tileId&&(e.tileId.nodeId=t)}),setTimeout(()=>{this._sendCritiqueMessage(new Map,e,void 0,ot.a.RemoveData)},0)}get critiques(){return Array.from(this._critiques.values())}_addToActive(e,t){this._critiqueIsVisible(e)&&(e.priority===I.b.High&&this._proofingPersistedStore.getCachedEntry(rt.a.EnableSpelling).storeEntryValue||e.priority===I.b.Medium&&(this._upsellStore.previewModeActive||this._proofingPersistedStore.getCachedEntry(rt.a.EnableGrammar).storeEntryValue)||e.priority===I.b.Low&&(this._upsellStore.previewModeActive||this._proofingPersistedStore.getCachedEntry(rt.a.EnableRefinements).storeEntryValue))&&t.forEach(t=>t.set(e.start,e))}_critiqueIsVisible(e){return this._critiqueFilterer.applyFilters([e]),!!e.isVisible}_mergeCritiques(e,t,n){if(e){const r=new Map,i=e.filter(e=>{if(e.tileId){const i=this._proofingDom.findParagraphNode(e.tileId.elementId.id);e.start=e.tileId.elementId.offset+e.start;const o=e.start<t.firstDiffLeft&&e.start+e.length<=t.firstDiffLeft,a=parseInt(e.tileId.seqId,10)===n;if(i||o&&a){const t=this._critiques.get(e.start);return t&&t.start===e.start&&t.length===e.length&&t.priority===e.priority&&(e.traceId=t.traceId),r.set(e.tileId.elementId.id,e.tileId.elementId),!0}}return!1});return this._critiques.forEach((e,t,n)=>{r.forEach(r=>{const i=r.offset,o=r.offset+r.span,a=e.start,s=e.start+e.length;((()=>a>=i&&a<o)()||(()=>s>i&&s<=o)()||(()=>a<i&&s>o)())&&n.delete(t)})}),i.forEach(e=>{e.length&&this._critiques.set(e.start,e)}),!!i.length}return!1}_sendCritiqueMessage(e,t,n,r=ot.a.NewData){n&&n.addDataField("Critique_Reflow",!0,Vt.a.EssentialServiceMetadata),this._proofingEmitter.emit("squiggleDataEvent",{messageType:r,data:{critiquesToElementsMap:[{elementId:t,element:this._tileNode.element,critiques:e}],actionCallback:this._actionCallback}})}static _isInMonitoredTextRange(e,t){if(!e)return!0;for(const n of e)if(n.offset<=t.start&&n.offset+n.span>=t.start+t.length)return!0;return!1}};var on;rn=Xt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),nn(0,Object(kt.inject)(Mt.a.IProofingEmitter)),nn(1,Object(kt.inject)(Mt.a.IProofingDom)),nn(2,Object(kt.inject)(tn.a.IProofingPersistedStore)),nn(3,Object(kt.inject)(Mt.a.ILogger)),nn(5,Object(kt.inject)(Mt.a.ICritiqueFilterer)),nn(6,Object(kt.inject)(Mt.a.IUpsellStore))],rn),function(e){e.CourtesyAttributes="CourtesyAttributes",e.RootContentMaxLengthInChars="RootContentMaxLengthInChars"}(on||(on={}));var an=function(e,t){return function(n,r){t(n,r,e)}};let sn=class extends Jt{constructor(e,t,n,r,i){super(n,r),this._persistedStore=e,this._settings=t,this.mutationObserverFactory=n,this.logger=r,this.conditionalAttributeFilter=i}observe(e){const t=this._persistedStore.getCachedEntry(on.CourtesyAttributes).storeEntryValue;this.connectMutationObserver(e,{attributes:!0,attributeFilter:this.conditionalAttributeFilter?[...t,...this.conditionalAttributeFilter.attributeList]:[...t],characterData:!1,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1})}handleAttributeChange(e,t,n,r){const i=e.attributeName,o=e.target,a=this.conditionalAttributeFilter&&this.conditionalAttributeFilter.shouldProofElement(o),s=o.hasAttribute(this._settings.editorSpellcheckAttribute);i&&(n&&this._persistedStore.getCachedEntry(on.CourtesyAttributes).storeEntryValue.includes(i)?n(o):a&&!s&&t?t(o):!a&&s&&r&&r(o))}};sn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),an(0,Object(kt.inject)(Mt.a.IHostModelPersistedStore)),an(1,Object(kt.inject)(Mt.a.IHostModelSettings)),an(2,Object(kt.inject)(Mt.a.IMutationObserverFactory)),an(3,Object(kt.inject)(Mt.a.ILogger))],sn);var cn=function(e,t){return function(n,r){t(n,r,e)}};let ln=class extends Jt{constructor(e,t){super(e,t),this.mutationObserverFactory=e,this.logger=t,this._onElementChangedEvent=e=>{const t=this.onElementChanged;e&&t&&this._element&&t(this._element)}}observe(e){(e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement||e instanceof HTMLDivElement)&&(this._element=e,this._element.addEventListener("input",this._onElementChangedEvent,{passive:!0}),this._element.addEventListener("BX-ForceReflow",this._onElementChangedEvent,{passive:!0}),this.connectMutationObserver(this._element,{attributes:!1,characterData:!1,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1}))}disconnect(){this._element&&(this._element.removeEventListener("input",this._onElementChangedEvent),this._element.removeEventListener("BX-ForceReflow",this._onElementChangedEvent)),super.disconnect(),this._element=void 0}};ln=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),cn(0,Object(kt.inject)(Mt.a.IMutationObserverFactory)),cn(1,Object(kt.inject)(Mt.a.ILogger))],ln);let un=class{constructor(e,t,n,r,i,o){this._guidGenerator=e,this._observer=n,this.nodeType=t,this.id=this._guidGenerator.generate(),this.children=r,this.element=i,this.parent=o}retire(){this._observer.disconnect(),this.children&&this.children.forEach(e=>e.retire()),this.children=void 0}move(e,t){return this._observer.disconnect(),this.id=this._guidGenerator.generate(),e&&(this.element=e),t&&(this.parent=t),this}resetState(){}};un=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([function(e,t){return function(n,r){t(n,r,e)}}(0,Object(kt.inject)(Mt.a.IGuidGenerator))],un);let dn=class extends un{constructor(e,t,n,r,i){super(e,Be.OutlineNode,t,n,r,i),this._guidGenerator=e,this._observer=t,this.element&&this._observer.observe(this.element)}move(e,t){return super.move(e,t),this.element&&this._observer.observe(this.element),this}};dn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([function(e,t){return function(n,r){t(n,r,e)}}(0,Object(kt.inject)(Mt.a.IGuidGenerator))],dn);var fn=function(e,t){return function(n,r){t(n,r,e)}};let hn=class{constructor(e,t,n,r){this._guidGenerator=e,this._proofingDom=t,this.nodeType=Be.ParagraphNode,this.id=this._guidGenerator.generate(),this.children=void 0,this.element=n,this.parent=r,this._proofingDom.registerNode(this)}retire(){this.parent=void 0,this._proofingDom.unregisterNode(this)}move(e,t){return this._proofingDom.unregisterNode(this),e&&(this.element=e),t&&(this.parent=t),this.id=this._guidGenerator.generate(),this._proofingDom.registerNode(this),this}resetState(){}};hn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([fn(0,Object(kt.inject)(Mt.a.IGuidGenerator)),fn(1,Object(kt.inject)(Mt.a.IProofingDom))],hn);var gn,pn=function(e,t){return function(n,r){t(n,r,e)}};let mn=gn=class{constructor(e,t,n,r,i,o=r.completeTileTextUnit,a=r.partialTileTextUnit){this._proofingPersistedStore=e,this._graphNodeFactory=t,this._textUnitChunker=n,this.settings=r,this.hostSettings=i,this._completeTileTextUnit=o,this._partialTileTextUnit=a}updateParagraphNodes(e,t,n,r,i,o){const a=this._updateExistingChildren(e,t,n,i);return this._addNewChildren(e,n,r,i,o,a)}_updateExistingChildren(e,t,n,r){if(e.children&&e.children.length){const i={firstDiffLeft:r.firstDiffLeft,firstDiffRight:r.firstDiffRight},o=t!==n;let a=e.children.length-1;for(;a>=0;){const s=e.children[a].element;if(s)if(s.offset<r.firstDiffLeft&&s.offset+s.span<r.firstDiffLeft||s.offset+s.span===r.firstDiffLeft&&s.validEndBoundary&&o);else if(t.length-s.offset<r.firstDiffRight)s.offset=n.length-t.length+s.offset;else{s.offset<r.firstDiffLeft&&(i.firstDiffLeft=Math.min(s.offset,i.firstDiffLeft));const n=t.length-s.offset-s.span;n<r.firstDiffRight&&(i.firstDiffRight=Math.min(n,i.firstDiffRight)),e.children.splice(a,1).forEach(e=>e.retire())}a-=1}return{offset:i.firstDiffLeft,span:n.length-i.firstDiffRight-i.firstDiffLeft,enforcedCompleteTileTextUnit:!o&&this.hostSettings.enableOptimizedCallingPattern}}}_addNewChildren(e,t,n,r,i,o){let a=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(t,r,this._completeTileTextUnit,o);if(n){const e=n[Symbol.iterator]();let t=e.next();a=a.filter(n=>{for(;!t.done&&n.offset>=t.value.offset+t.value.span;)t=e.next();return!t.done&&(t.value.offset>=n.offset&&t.value.offset<n.offset+n.span||t.value.offset<=n.offset&&t.value.offset+t.value.span>=n.offset)})}const s=[],c=a.map(n=>{const r=this._graphNodeFactory(n,e);return s.push(r),this._buildTile(e,r,t,i)});return gn._mergeChildrenToTileNode(e,s),c}static _mergeChildrenToTileNode(e,t){if(t.length&&e.children&&t[0].element){const n=t[0].element.offset;if(e.children.length){let r=e.children.length-1,i=t;for(;r>=0;){const t=e.children[r].element;if(t&&n>t.offset){e.children.splice(r,0,...i),i=[];break}r-=1}i.length&&e.children.splice(0,0,...i)}else e.children=t}}_buildTile(e,t,n,r){const i=t.element?t.element.offset:0,o=t.element?t.element.span:n.length,a=this.hostSettings.enableOptimizedCallingPattern?this._partialTileTextUnit:this._completeTileTextUnit;return{header:{nodeId:e.id,seqId:r.toString(),elementId:{id:t.id,offset:i,span:o},length:n.length},data:n.slice(i,i+o),proofingLanguages:this._proofingPersistedStore.getCachedEntry(rt.a.ProofingLanguages).storeEntryValue,textUnit:t.element?!1!==t.element.validEndBoundary||this.hostSettings.enableOptimizedCallingPattern&&!0===t.element.enforcedCompleteTileTextUnit?this._completeTileTextUnit:a:void 0}}};mn=gn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),pn(0,Object(kt.inject)(Mt.a.IProofingPersistedStore)),pn(1,Object(kt.inject)(Mt.a.IParagraphNodeFactory)),pn(2,Object(kt.inject)(Mt.a.ITextUnitChunker)),pn(3,Object(kt.inject)(Mt.a.IHostModelSettings)),pn(4,Object(kt.inject)(Mt.a.IHostSettings))],mn);var yn=function(e,t){return function(n,r){t(n,r,e)}};let bn=class{constructor(e,t){this._elementsRetriever=e,this._selectorsCb=t}find(e,t){if(!e)return[];if(!this._selectorsCb().length)return[e];const n=e.parentElement?e.parentElement:e;return this._elementsRetriever.retrieveElements(n,this._selectorsCb())}};bn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),yn(0,Object(kt.inject)(Mt.a.IElementsRetriever))],bn);let vn=class{constructor(){this._contexts=[]}get rootNodes(){return this._contexts}addRootNode(e){this._contexts.push(e)}};vn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)()],vn);var _n=function(e,t){return function(n,r){t(n,r,e)}};let In=class extends un{constructor(e,t,n,r,i){super(e,Be.TerminalNode,n,void 0,r,i),this._guidGenerator=e,this._settings=t,this._observer=n,this.element&&this._observer.observe(this.element)}retire(){this.element&&(this.element.removeAttribute(this._settings.editorSpellcheckAttribute),this.element.removeAttribute("spellcheck")),super.retire()}move(e,t){return super.move(e,t),this.element&&this._observer.observe(this.element),this}resetState(){this.contentRoot=void 0}};In=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([_n(0,Object(kt.inject)(Mt.a.IGuidGenerator)),_n(1,Object(kt.inject)(Mt.a.IHostModelSettings))],In);var Sn,Cn=function(e,t){return function(n,r){t(n,r,e)}};let On=Sn=class{constructor(e,t,n,r,i,o,a,s,c,l,u,d){this._observerFactory=e,this._graphNodeFactory=t,this._paragraphNodesBuilderFactory=n,this._nodePoller=r,this._terminalNodeReader=i,this._terminalNodeWriter=o,this._tileNodeReader=a,this._settings=s,this._hostSettings=c,this._childElementsFinderFactory=l,this._graphNodeBuilderTerminalRule=u,this._logger=d,this.buildNode=(e,t)=>{const n=this._observerFactory(this._graphNodeBuilderTerminalRule.observerType,this._graphNodeBuilderTerminalRule),r=this._graphNodeFactory(Be.TerminalNode,n,e,t),i=this._childElementsFinderFactory(this._graphNodeBuilderTerminalRule.elementsFinder),o=this._getNewTopology(r,i,r).map(e=>this._graphNodeFactory(Be.TileNode,this._observerFactory(Le.AttributeObserver),e,r,void 0,this._paragraphNodesBuilder));return r.children=o,this._disableNativeSpellcheck(e),n.onElementAdded=e=>{r.element&&!r.element.contains(e)||(this._hostSettings.simplifiedHostModelEnabled||this._reconcileTopology(r,i),this._nodePoller.pollNodes(ot.a.NewData,r.children||[]))},n.onElementChanged=e=>{let t=r.children||[];this._hostSettings.simplifiedHostModelEnabled||(r.element&&!r.element.contains(e)&&this._reconcileTopology(r,i),t=r.children?this._settings.narrowOnChangeReconciliation?[...(r.children||[]).filter(t=>t.element&&t.element.contains(e))]:[...(r.children||[]).filter(t=>t.element&&t.element.contains(e)||this._tileNodeReader.critiques(t).length)]:[]),this._nodePoller.pollNodes(ot.a.ChangeData,t)},n.onElementRemoved=(e,t)=>{!this._hostSettings.simplifiedHostModelEnabled&&r.element&&r.children&&!r.element.contains(e)&&r.children.forEach(n=>{if(n.element&&e.contains(n.element)&&t&&t.addedNodes.length===t.removedNodes.length)for(let r=0;r<t.removedNodes.length;r+=1){const i=t.addedNodes[r];t.removedNodes[r]===e&&i instanceof HTMLElement&&n.move(i)}}),this._hostSettings.simplifiedHostModelEnabled||this._reconcileTopology(r,i),this._nodePoller.pollNodes(ot.a.ChangeData,r.children||[])},this._nodePoller.pollNodes(ot.a.NewData,r.children),r},this._getNewTopology=(e,t,n)=>{if(e.element){if(this._hostSettings.simplifiedHostModelEnabled)return this._terminalNodeWriter.setContentRoot(e,e.element),this._disableNativeSpellcheck(e.element),t.find(e.element,this._graphNodeBuilderTerminalRule.filterSelector).filter(e=>this._graphNodeBuilderTerminalRule.filters.every(t=>t(e,n,this._graphNodeBuilderTerminalRule)));const r=Sn._findContentRoot(e.element,e.element.innerText);return this._prevContentRoot=this._terminalNodeReader.contentRoot(e),this._terminalNodeWriter.setContentRoot(e,r),r===this._prevContentRoot&&(this._prevContentRoot=void 0),this._disableNativeSpellcheck(e.element),t.find(r,this._graphNodeBuilderTerminalRule.filterSelector).filter(e=>this._graphNodeBuilderTerminalRule.filters.every(t=>t(e,n,this._graphNodeBuilderTerminalRule)))}return[]},this._paragraphNodesBuilder=this._paragraphNodesBuilderFactory(this._graphNodeBuilderTerminalRule.completeTileTextUnit,this._graphNodeBuilderTerminalRule.partialTileTextUnit)}_reconcileTopology(e,t){const n=this._getNewTopology(e,t,e);e.children=e.children||[],e.children=e.children.filter(t=>{for(const e of n)if(t.element===e){if(!this._prevContentRoot||t.element!==this._prevContentRoot)return!0;this._prevContentRoot=void 0}return t.retire(),this._logger.log(591661202,Vt.e.Debug,"TerminalNodeBuilder: Delete op performed.",{nodeId:e.id}),!1}),this._addChildren(e,n),this._logger.debug(591661203,`(TerminalNodeBuilder) Topology reconciled -> ${e.id}: ${e.children.length}`)}_addChildren(e,t){e.children=e.children||[],e.children.push(...t.filter(t=>!e.children||!e.children.some(n=>(n.element&&this._disableNativeSpellcheck(n.element),!!n.element&&(n.element!==this._terminalNodeReader.contentRoot(e)&&n.element.contains(t)||n.element===t)))).map(t=>this._graphNodeFactory(Be.TileNode,this._observerFactory(Le.AttributeObserver),t,e,void 0,this._paragraphNodesBuilderFactory(this._graphNodeBuilderTerminalRule.completeTileTextUnit,this._graphNodeBuilderTerminalRule.partialTileTextUnit)))),this._logger.log(591661204,Vt.e.Debug,`TerminalNodeBuilder: add operation performed. There are currently ${e.children.length} nodes tracked`,{nodeId:e.id})}_disableNativeSpellcheck(e){if(e.spellcheck){const t=e.closest("[contenteditable=true]");t?t.setAttribute("spellcheck","false"):t&&"true"!==e.getAttribute("spellcheck")||(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(t||e).setAttribute(this._settings.editorSpellcheckAttribute,"true")}else if(this._graphNodeBuilderTerminalRule.spellcheckOverrides&&this._graphNodeBuilderTerminalRule.spellcheckOverrides.some(t=>t(e))){(e.closest("[contenteditable=true]")||e).setAttribute(this._settings.editorSpellcheckAttribute,"true")}}static _findContentRoot(e,t){let n=e,r=e;for(;r;)r instanceof HTMLElement&&r.innerText===t?(r instanceof HTMLElement&&(n=r),r=r.firstChild):r=r.nextSibling;return n}};On=Sn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Cn(0,Object(kt.inject)(Mt.a.INodeObserverFactory)),Cn(1,Object(kt.inject)(Mt.a.IGraphNodeFactory)),Cn(2,Object(kt.inject)(Mt.a.IParagraphNodesBuilderFactory)),Cn(3,Object(kt.inject)(Mt.a.INodePoller)),Cn(4,Object(kt.inject)(Mt.a.ITerminalNodeReader)),Cn(5,Object(kt.inject)(Mt.a.ITerminalNodeWriter)),Cn(6,Object(kt.inject)(Mt.a.ITileNodeReader)),Cn(7,Object(kt.inject)(Mt.a.IHostModelSettings)),Cn(8,Object(kt.inject)(Mt.a.IHostSettings)),Cn(9,Object(kt.inject)(Mt.a.IDomFinderFactory))],On);var Tn=function(e,t){return function(n,r){t(n,r,e)}};let En=class extends Jt{constructor(e,t,n,r,i){super(e,n,i),this.mutationObserverFactory=e,this._hostSettings=t,this._logger=n,this._mutationContextBuilder=r,this.elementTransformers=i,this.connectMutationObserver=(e,t,n)=>{this._mutationObserver=this._mutationObserverFactory(e=>{let t=!1,r=!1;e.forEach((e,i,o)=>{try{const a=this.onElementRemoved,s=this.onElementAdded,c=this.onElementChanged;switch(e.type){case"childList":if(a){const t=Array.from(e.removedNodes);t.length&&!r&&(this._hostSettings.simplifiedHostModelEnabled?a(t.pop(),void 0):t.forEach(t=>{a(t,n?n(e,i,o):void 0)}),r=!0)}if(s){const r=Array.from(e.addedNodes);r.length&&!t&&(s(r.pop(),n?n(e,i,o):void 0),t=!0)}break;case"characterData":c&&c(e.target);break;case"attributes":this.handleAttributeChange(e,s,c,a)}}catch(e){this._logger.logEvent(591681235,Gt.MutationError,Vt.e.Error,"Error while processing a mutation.",Vt.f.CriticalBusinessImpact)}})}),this._mutationObserver.observe(e,t)}}observe(e){const t={attributes:!1,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1};if(this.elementTransformers){const e=new Set;for(const t of this.elementTransformers)t.attributeList.forEach(t=>{e.add(t)});e.size&&(t.attributes=!0,t.attributeFilter=Array.from(e.values()))}this.connectMutationObserver(e,t,this._mutationContextBuilder)}};En=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Tn(0,Object(kt.inject)(Mt.a.IMutationObserverFactory)),Tn(1,Object(kt.inject)(Mt.a.IHostSettings)),Tn(2,Object(kt.inject)(Mt.a.ILogger))],En);var Pn,wn=n(3855),jn=function(e,t){return function(n,r){t(n,r,e)}};let Rn=Pn=class{constructor(e){this._textUnitChunker=e}find(e,t){if(e instanceof Text&&e.parentElement)return[e.parentElement];const n=wn.a.extractTextContent(e,t),r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:e=>t&&e.parentElement&&e.parentElement.closest(t)?NodeFilter.FILTER_REJECT:e.length?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT});let i=[];n.forEach((e,t)=>{e&&(i=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(e,{firstDiffLeft:0,firstDiffRight:0},wn.b.TextUnit.Sentence).map(e=>(e.offset+=t,e)))});const o=[];let a=0,s=0,c=!1;r.nextNode();for(const t of i){let n=r.currentNode,i=n.textContent;const l={range:document.createRange(),ancestors:[]};for(l.range.setStart(n,s),c=Pn._addAncestor(e,l.ancestors,n)||c;i&&a+i.length<t.offset+t.span;)i&&(a+=i.length),r.nextNode(),n=r.currentNode,i=n.textContent,c=Pn._addAncestor(e,l.ancestors,n)||c;s=t.offset+t.span-a,l.range.setEnd(n,s),Pn._getLcas(e,l).forEach(e=>{Pn._addAndConsolidate(o,e)})}return c&&o.push(e),o}static _addAncestor(e,t,n){let r=!1;return n.parentElement&&(n.parentElement.contains(e)?r=!0:Pn._addAndConsolidate(t,n.parentElement)),r}static _addAndConsolidate(e,t){for(;0!==e.length;){const n=e[e.length-1],r=n.contains(t),i=t.contains(n);if(r||i){if(r)break;e.pop()}else e.push(t)}0===e.length&&e.push(t)}static _getLcas(e,t){const n=t.range;if(n){const r=n.commonAncestorContainer;if(t.ancestors.length)if(r.nodeType===r.TEXT_NODE){if(r.parentElement&&r.parentElement!==e)return[r.parentElement]}else{if(r instanceof HTMLElement&&r.contains(e))return t.ancestors;if(r instanceof HTMLElement)return[r]}else;}return[]}};Rn=Pn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),jn(0,Object(kt.inject)(Mt.a.ITextUnitChunker))],Rn);var xn=n(9178),An=function(e,t){return function(n,r){t(n,r,e)}};let Nn=class extends un{constructor(e,t,n,r,i,o,a,s,c,l,u,d,f,h,g,p,m,y){if(super(e,Be.TerminalNode,g,void 0,m,y),this._guidGenerator=e,this._logger=t,this._wordCount=n,this._persistedStore=r,this._settings=i,this._indexReadjuster=o,this._nodePoller=a,this._critiquesBrokerFactory=s,this._terminalNodeReader=c,this._proofingDom=l,this._textExtractor=u,this._hostSettings=d,this._hostTilingEmitter=f,this.nodeType=h,this._observer=g,this._paragraphNodesBuilder=p,this.element=m,this.parent=y,this._seqId=0,this._eventSeqId=0,this.id=this._guidGenerator.generate(),!this.element)throw Error("Cannot create TileNode without element");let b;this._cachedTiles=new Map,this._cachedText="",this._cachedWordCount=0,this.resetState(),this.children=[],this._hostSettings.enableOrchestration||(this._critiquesBroker=this._critiquesBrokerFactory(this)),this._observer.onElementChanged=e=>!b&&(this.element&&e.contains(this.element)&&(b=window.setTimeout(()=>{this.element&&this._nodePoller.pollNodes(ot.a.NewData,[this])},i.styleSampleTime),b=void 0),!0),this.element&&this._observer.observe(document.body),this._proofingDom.registerNode(this),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this.id,this._cachedText,this._eventSeqId,ot.a.NewData)}retire(){this._nodePoller.removeQueuedTiles(this.id),this._clearReconcileTimer(),this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this._critiquesBroker&&this._critiquesBroker.reconcile(void 0,this._cachedText,"",this._monitoredTextRanges,this._invalidationDiffBounds,this._invalidationDiffBounds,this._seqId),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this.id,"",this._eventSeqId,ot.a.RemoveData),this.parent=void 0,this._cachedText="",this._monitoredTextRanges=void 0,this._cachedWordCount=0,this._logger.debug(591661205,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}move(e,t){this._nodePoller.removeQueuedTiles(this.id),this._proofingDom.unregisterNode(this);const n=this.id;return super.move(e,t),this._critiquesBroker&&this._critiquesBroker.move(n,this.id),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitMoveTileEvent(n,this.id,this._cachedText,this._eventSeqId),this._proofingDom.registerNode(this),this._observer.observe(document.body),this}resetState(){if(!this.element)throw Error("Cannot create TileNode without element");this._cachedText="",this._cachedWordCount=0,this._cachedTiles&&this._cachedTiles.clear(),this._invalidationDiffBounds=void 0,this._monitoredTextRanges=this._hostSettings.simplifiedHostModelEnabled?void 0:[]}reconcile(e,t,n){if(this.parent&&this.element){const r=this._extractContent(this.element),i=wn.a.getMinimalDifferenceBounds(this._cachedText,r);return this._hostSettings.simplifiedHostModelEnabled||(n=this._computeMonitoredRanges(r)||n),r!==this._cachedText&&(this._invalidationDiffBounds||(this._invalidationDiffBounds={firstDiffLeft:i.firstDiffLeft,firstDiffRight:i.firstDiffRight}),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,i.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,i.firstDiffRight)),this._critiquesBroker&&this._critiquesBroker.reconcile(e,this._cachedText,r,this._monitoredTextRanges,i,this._invalidationDiffBounds||{firstDiffLeft:this._cachedText.length,firstDiffRight:0},this._seqId,t||void 0!==e,void 0),r!==this._cachedText||n?this._reconcileState(r,i,n||!1,void 0):(this._hostSettings.enableOrchestration&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this.id,this._cachedText,r,i,!1,this._eventSeqId,this._cachedWordCount,Array.from(this._cachedTiles.values()))),void this._endActivity(void 0,{isDirtyRangeCheckActivated:!1,isFastLane:!0,isReconciledTile:!0,newCritiquesDiscarded:!1,isSuccess:!0}))}return this._resetInvalidationStateAndReturnTiles(Array.from(this._cachedTiles.values()),this._seqId,void 0)}get critiques(){return this._critiquesBroker?this._critiquesBroker.critiques:[]}_reconcileState(e,t,n,r){const i=this._seqId+1,o=this._reconcileWordCount(t,e);if(this._reconcileParagraphs(t,e,i),this._hostSettings.enableOrchestration&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this.id,this._cachedText,e,t,o,this._eventSeqId,this._cachedWordCount,Array.from(this._cachedTiles.values()))),this._cachedText=e,n||o){const e=Array.from(this._cachedTiles.values());return this._cachedTiles.clear(),this._hostSettings.enableOptimizedCallingPattern&&this._tryScheduleReconcileTimer(),this._resetInvalidationStateAndReturnTiles(e,i,r)}return this._tryScheduleReconcileTimer(),void this._endActivity(r,{isDirtyRangeCheckActivated:!1,isFastLane:!1,isReconciledTile:!1,newCritiquesDiscarded:!1,isSuccess:!0})}_reconcileWordCount(e,t){let n=0;const r=this._wordCount.getBreaksForRange(t,0,t.length);r.splice(0,0,this._wordCount.getTextStartWordBreak(t)),n=this._wordCount.getWordCount(r,t),n>0&&r[r.length-1].wordBreakType!==xn.a.WhiteSpace&&(this._hostSettings.newLineSentenceSeparatorEnabled||r[r.length-1].wordBreakType!==xn.a.Punctuation)&&r[r.length-1].cp+1<=t.length&&(n-=1);let i=0;e&&e.firstDiffLeft<=t.length&&(i=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const o=n>0&&(n!==this._cachedWordCount||i>1);return this._cachedWordCount=n,o}_reconcileParagraphs(e,t,n){this._paragraphNodesBuilder.updateParagraphNodes(this,this._cachedText,t,this._monitoredTextRanges,e,n).forEach(e=>this._cachedTiles.set(e.header.elementId.id,e));const r=this._cachedTiles.entries();let i=r.next();for(;!i.done;){const e=i.value,t=e[0],o=e[1];this._proofingDom.findParagraphNode(t)?o.header.seqId=n.toString():this._cachedTiles.delete(t),i=r.next()}}_resetInvalidationStateAndReturnTiles(e,t,n){return this._hostSettings.enableOptimizedCallingPattern||this._clearReconcileTimer(),this._invalidationDiffBounds=void 0,this._seqId=t,this._endActivity(n,{isDirtyRangeCheckActivated:!1,isFastLane:!1,isReconciledTile:!1,newCritiquesDiscarded:!1,isSuccess:!0}),e}_tryScheduleReconcileTimer(){return!(!this._settings.enableTileNodeAutoReconciliation||!this._invalidationDiffBounds)&&(this._clearReconcileTimer(),this._reconcileCritiqueTimer=window.setTimeout(()=>{this._logger.debug(591661206,"Dirty range timer has fired."),this._nodePoller.pollNodes(ot.a.NewData,[this],void 0,!0),this._clearReconcileTimer()},this._settings.reconcileTileNodeTime),!0)}_clearReconcileTimer(){this._reconcileCritiqueTimer&&(clearTimeout(this._reconcileCritiqueTimer),this._reconcileCritiqueTimer=void 0,this._logger.debug(591661207,"Dirty range timer has been cleared."))}_endActivity(e,t){e&&(e.addDataField("Tile_Id",this.id,Vt.a.EssentialServiceMetadata),e.addDataField("Fast_Lane",t.isFastLane,Vt.a.EssentialServiceMetadata),e.addDataField("Reconciled_Tile",t.isReconciledTile,Vt.a.EssentialServiceMetadata),e.addDataField("Dirty_Range",t.isDirtyRangeCheckActivated,Vt.a.EssentialServiceMetadata),e.addDataField("New_Critiques_Discarded",t.newCritiquesDiscarded,Vt.a.EssentialServiceMetadata),e.setSuccess(t.isSuccess),e.endNow())}_computeMonitoredRanges(e){const t=this._monitoredTextRanges?this._monitoredTextRanges.length:0;if(this._monitoredTextRanges=void 0,!(this.element instanceof HTMLTextAreaElement||this.element instanceof HTMLInputElement)&&this.element&&this.parent&&this.parent.element)if(this._terminalNodeReader.contentRoot(this.parent)===this.element){this._monitoredTextRanges=[];let t=0,n=-1;const r=[],i=this.element.textContent;if(!(!!i&&i.length<this._persistedStore.getCachedEntry(on.RootContentMaxLengthInChars).storeEntryValue))return!1;this.element.childNodes.forEach(e=>{const i=e.textContent;i&&(e.nodeType===e.TEXT_NODE&&(-1!==n&&n===t?n+=i.length:(n>-1&&r.push(n),r.push(t),n=t+i.length)),t+=i.length)}),n>-1&&r.push(n);let o=this._indexReadjuster.getReadjustedIndices(this.element,r,e,!0);const a=[];for(let e=0;e<o.length;e+=1)e!==o.length-1&&o[e]===o[e+1]?e+=1:a.push(o[e]);o=a;for(let e=0;e<o.length;e+=2)this._monitoredTextRanges.push({offset:o[e],span:o[e+1]-o[e]})}else if(t)return!0;return!1}_extractContent(e){return this._textExtractor.extractElementText(e)}};Nn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([An(0,Object(kt.inject)(Mt.a.IGuidGenerator)),An(1,Object(kt.inject)(Mt.a.ILogger)),An(2,Object(kt.inject)(Mt.a.IWordCount)),An(3,Object(kt.inject)(Mt.a.IHostModelPersistedStore)),An(4,Object(kt.inject)(Mt.a.IHostModelSettings)),An(5,Object(kt.inject)(Mt.a.IIndexReadjuster)),An(6,Object(kt.inject)(Mt.a.INodePoller)),An(7,Object(kt.inject)(Mt.a.ICritiquesBrokerFactory)),An(8,Object(kt.inject)(Mt.a.ITerminalNodeReader)),An(9,Object(kt.inject)(Mt.a.IProofingDom)),An(10,Object(kt.inject)(Mt.a.ITextExtractor)),An(11,Object(kt.inject)(Mt.a.IHostSettings))],Nn);let Dn=class{retrieveElements(e,t){if(!e.querySelectorAll)return[];const n=t.join(",");return e.querySelector(n)?Array.from(e.querySelectorAll(n)):[]}};Dn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)()],Dn);let Fn=class{isTileNode(e){return e.nodeType===Be.TileNode}reconcile(e,t,n,r){return this.getTileNode(e).reconcile(t,n||!1,r||!1)}critiques(e){return this.getTileNode(e).critiques}getTileNode(e){if(this.isTileNode(e))return e;throw TypeError("Node is not a tile node")}};Fn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)()],Fn);let kn=class{isTerminalNode(e){return e.nodeType===Be.TerminalNode}contentRoot(e){return this.getTerminalNode(e).contentRoot}getTerminalNode(e){if(this.isTerminalNode(e))return e;throw TypeError("Node is not a terminal node")}};kn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)()],kn);var Mn=function(e,t){return function(n,r){t(n,r,e)}};let Bn=class{constructor(e){this._terminalNodeReader=e}setContentRoot(e,t){if(!this._terminalNodeReader.isTerminalNode(e))throw TypeError("Node is not a terminal node");e.contentRoot=t}};Bn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Mn(0,Object(kt.inject)(Mt.a.ITerminalNodeReader))],Bn);let Ln=class{constructor(){this._rootNodes=[]}rootAtNodes(e){this._rootNodes=e}*getIterator(){if(this._rootNodes.length){const e=[];for(e.push(...this._rootNodes);e.length;){const t=e.pop();yield t,t&&t.children&&t.children.length&&e.push(...t.children)}}yield}};Ln=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)()],Ln);var qn=function(e,t){return function(n,r){t(n,r,e)}};let Un=class{constructor(e,t,n,r,i,o,a,s,c,l){this._proofingNodeSubmitter=e,this._tileNodeReader=t,this._settings=n,this._hostSettings=r,this.featureFlagsReader=i,this._proofingStore=o,this._proofingDom=a,this._logger=s,this._languageDetector=c,this._e2eMetric=l,this._tiles=[]}pollNodes(e,t,n,r,i){const[o,a,s,c]=[this._settings.maxContentLengthInChars,this._settings.schedulerDefaultWaitingTime,this._settings.schedulerDefaultMaxTime,this._settings.schedulerDefaultWaitingTimeIncrement];this._timeout||(this._timeout=a);const l=this._pickMostRecentTiles();if(this._tiles.length){let e=this._tiles.length-1;for(;e>=0;){this._proofingDom.findParagraphNode(this._tiles[e].header.elementId.id)||this._tiles.splice(e,1),e-=1}}let u=0;for(const e of t)try{const t=this._tileNodeReader.reconcile(e,i?i.get(e.id):void 0,!0,r);t&&!this._hostSettings.enableOrchestration&&(u+=t.length,this._tiles.splice(this._tiles.length,0,...this._mergeTiles(t)))}catch(e){this._logger.log(591661199,Vt.e.Error,"NodePoller: Found children of unsupported type.")}if(!this._tiles.length&&l.length&&this._tiles.push(...l),this._tiles.length){this._timer&&(clearTimeout(this._timer),this._timer=void 0,u&&(this._timeout=Math.min(this._timeout+c,s)),this._logger.debug(591661200,`Scheduler timeout cleared, it was ${this._timeout}`));let t=this._timeout;n&&(t=Math.max(n,this._timeout)),this._timer=window.setTimeout(()=>{this._timeout=a;let t=0,n=0;for(;n<this._tiles.length;){const e=this._getTileContentLength(this._tiles[n]);if(e>=o)this._tiles.splice(n,1);else{if(t+e>=o)break;t+=e,n+=1}}const r=this._tiles.splice(0,n),i=new it.a(this._proofingStore.getCachedEntry(rt.a.ProofingLanguages).storeEntryValue),c=this.featureFlagsReader.flags.enableMultiLanguageSupport?this._languageDetector.getUILanguage():i.defaultLanguageCode,l={messageType:e,data:{tiles:this._buildTilesToSend(r,i),uxLanguage:c}};this._proofingNodeSubmitter.emit("tilesEvent",l),this._timer=void 0,this._tiles.length&&this.pollNodes(ot.a.NewData,[],s)},t),this._logger.debug(591661201,"Scheduler timeout set")}}removeQueuedTiles(e){this._tiles=this._tiles.filter(t=>t.header.nodeId!==e)}_mergeTiles(e){let t=e.filter(e=>e.data.trim().length);return this._tiles.forEach(e=>{t=t.filter(t=>!(t.header.nodeId===e.header.nodeId&&t.header.elementId.id===e.header.elementId.id&&t.header.elementId.offset===e.header.elementId.offset&&t.header.elementId.span===e.header.elementId.span))}),t}_pickMostRecentTiles(){const e=new Map;return this._tiles.forEach(t=>{const n=e[t.header.nodeId];n?parseInt(t.header.seqId,10)>parseInt(n.header.seqId,10)&&e.set(t.header.nodeId,t):e.set(t.header.nodeId,t)}),Array.from(e.values())}_getTileContentLength(e){return this.featureFlagsReader.flags.enableMultiLanguageSupport?e.data.length*e.proofingLanguages.length:e.data.length}_buildTilesToSend(e,t){const n=this.featureFlagsReader.flags.enableMultiLanguageSupport,r=[];for(const i of e)if(this._e2eMetric.startEntry(i.header.elementId.id),n)for(const e of t.codesList)r.push({header:i.header,data:i.data,proofingLanguages:[e],textUnit:i.textUnit});else r.push({header:i.header,data:i.data,proofingLanguages:[t.defaultLanguageCode],textUnit:i.textUnit});return r}};Un=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),qn(0,Object(kt.inject)(Mt.a.IProofingEmitter)),qn(1,Object(kt.inject)(Mt.a.ITileNodeReader)),qn(2,Object(kt.inject)(Mt.a.IHostModelSettings)),qn(3,Object(kt.inject)(Mt.a.IHostSettings)),qn(4,Object(kt.inject)(Mt.a.IFeatureFlagsReader)),qn(5,Object(kt.inject)(Mt.a.IProofingPersistedStore)),qn(6,Object(kt.inject)(Mt.a.IProofingDom)),qn(7,Object(kt.inject)(Mt.a.ILogger)),qn(8,Object(kt.inject)(tn.a.IUxLanguageDetector)),qn(9,Object(kt.inject)(Mt.a.IE2eMetric))],Un);let Hn=class{};Hn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)()],Hn);let Wn=class{};Wn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)()],Wn);var Gn=function(e,t){return function(n,r){t(n,r,e)}};let Vn=class{constructor(e,t,n,r,i){if(this._guidGenerator=e,this._proofingDom=t,this._nodePoller=n,this.hostSettings=r,this._roamingDictionaryFeature=i,this._ignoredWords=new Set,this.isWordIgnored=e=>{const t=e.trim();return!!this._ignoredWords.has(t)||!(!this._roamingDictionary||!this._roamingDictionary.testWord(t,!0))},this.clearIgnoredWords=()=>{this._ignoredWords.clear(),this._nodePoller.pollNodes(ot.a.ChangeData,this._proofingDom.tileNodes)},this.addWordToIgnoreList=e=>{e&&(this._ignoredWords.add(e.trim()),this._nodePoller.pollNodes(ot.a.ChangeData,this._proofingDom.tileNodes))},this.addWordToCustomDictionary=e=>{if(e){const t=e.trim();if(this._roamingDictionary&&this._roamingDictionaryFeature.isReady())return this._roamingDictionary.addWord(t),this._nodePoller.pollNodes(ot.a.ChangeData,this._proofingDom.tileNodes),!0}return!1},this.hostSettings.enableRoamingDictionary){this._roamingDictionaryFeature.emitAndEvaluate({eventId:C.a.ClientInitialized,sender:C.b.WordDictionaryInit})&&(this._roamingDictionary=this._roamingDictionaryFeature.getRoamingDictionary())}}};Vn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Gn(0,Object(kt.inject)(Mt.a.IGuidGenerator)),Gn(1,Object(kt.inject)(Mt.a.IProofingDom)),Gn(2,Object(kt.inject)(Mt.a.INodePoller)),Gn(3,Object(kt.inject)(Mt.a.IHostSettings)),Gn(4,Object(kt.inject)(tn.a.IRoamingDictionaryFeature))],Vn);var zn=function(e,t){return function(n,r){t(n,r,e)}};let Jn=class{constructor(e,t,n,r,i,o,a){this._proofingDom=e,this._proofingEmitter=t,this._nodePoller=n,this._proofingPersistedStore=r,this._hostSettings=i,this._logger=o,this._e2eMetric=a,this._websiteProvedOnce=!1,this.shutDown=async()=>{this._proofingEmitter.off("critiqueEvent")},this.cleanUp=()=>{this.shutDown()},this.onCritiqueEvent=e=>{try{this._detectWebSiteProved(e),this.updateCritiques(e)}catch(e){this._logger.logEvent(589947153,Gt.UpdateCritiqueException,Vt.e.Error,"Error while updating critiques on the shadow graph.",Vt.f.CriticalBusinessImpact)}},this.updateCritiques=e=>{const t=e.data,n=new Map,r=[],i=new Set;for(const e of t){if(!e.tileId)continue;const t=e.tileId.elementId.id;i.has(t)||(this._e2eMetric.commitEntry(t),i.add(t));const o=n.get(e.tileId.nodeId);if(o)o.push(e);else{n.set(e.tileId.nodeId,[e]);const t=this._proofingDom.findTileNode(e.tileId.nodeId);t&&r.push(t)}}r.length&&this._nodePoller.pollNodes(ot.a.NewData,r,void 0,!1,n)}}async initialize(){this._proofingEmitter.on("critiqueEvent",this.onCritiqueEvent)}_detectWebSiteProved(e){!this._websiteProvedOnce&&e.messageType===ot.a.NewData&&e.data&&e.data.length&&(this._websiteProvedOnce=!0,((e,t,n)=>{if(!e||!t)return;const r=e.getNewActivity(Wt.WebSiteProvedOnce,Vt.f.CriticalBusinessImpact),i=t.getCachedEntry(rt.a.ProofingLanguages).storeEntryValue;r&&(r.addDataField("Proofing_Languages",i.join(","),Vt.a.EssentialServiceMetadata),r.addDataField("IsAL",n&&!0===n.enableOrchestration&&n.orchestratorSettings&&!0===n.orchestratorSettings.enableAugLoop,Vt.a.EssentialServiceMetadata),r.setSuccess(!0),r.endNow())})(this._logger,this._proofingPersistedStore,this._hostSettings))}};Jn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),zn(0,Object(kt.inject)(Mt.a.IProofingDom)),zn(1,Object(kt.inject)(Mt.a.IProofingEmitter)),zn(2,Object(kt.inject)(Mt.a.INodePoller)),zn(3,Object(kt.inject)(Mt.a.IProofingPersistedStore)),zn(4,Object(kt.inject)(Mt.a.IHostSettings)),zn(5,Object(kt.inject)(Mt.a.ILogger)),zn(6,Object(kt.inject)(Mt.a.IE2eMetric))],Jn);var $n=function(e,t){return function(n,r){t(n,r,e)}};let Kn=class{constructor(e,t,n,r,i){this._proofingStore=e,this._emitter=t,this.nodePoller=n,this.proofingDom=r,this._logger=i,this._proofingLanguages=new it.a(this._proofingStore.getDefaultValue(rt.a.ProofingLanguages))}async initialize(){this._emitter.on("proofingLanguageChanged",async e=>{this.switchProofingLanguage(e.data)}),this._proofingLanguages=new it.a(await this._proofingStore.read(rt.a.ProofingLanguages))}async shutDown(){this._emitter.off("proofingLanguageChanged")}switchProofingLanguage(e){this._proofingLanguages.equalsTo(e.codesList)||(this._proofingLanguages=e,this._logger.debug(589968392,`Proofing languages list switched to ${e.codesList}`),this.proofingDom.tileNodes.map(e=>e.resetState()),this.nodePoller.pollNodes(ot.a.NewData,this.proofingDom.tileNodes,void 0,!0))}};Kn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),$n(0,Object(kt.inject)(Mt.a.IProofingPersistedStore)),$n(1,Object(kt.inject)(Mt.a.IProofingEmitter)),$n(2,Object(kt.inject)(Mt.a.INodePoller)),$n(3,Object(kt.inject)(Mt.a.IProofingDom)),$n(4,Object(kt.inject)(Mt.a.ILogger))],Kn);var Qn=function(e,t){return function(n,r){t(n,r,e)}};let Zn=class{constructor(e){this._wordDictionary=e}filter(e){return!(!e||!e.textInContext)&&!this._wordDictionary.isWordIgnored(e.textInContext)}};Zn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Qn(0,Object(kt.inject)(Mt.a.IWordDictionary))],Zn);var Yn=function(e,t){return function(n,r){t(n,r,e)}};let Xn=class{constructor(e,t,n,r){this._dictionaryCritiqueFilter=e,this._enabledCritiqueTypesCritiqueFilter=t,this._premiumCritiqueFilter=n,this._hostSettings=r,this._critiqueFilters=[]}async initialize(){this._hostSettings.enhancedUpsellEnabled&&this._critiqueFilters.push(this._premiumCritiqueFilter),this._critiqueFilters.push(this._dictionaryCritiqueFilter),this._hostSettings.enableOrchestration&&this._critiqueFilters.push(this._enabledCritiqueTypesCritiqueFilter)}async shutDown(){this._critiqueFilters.splice(0,this._critiqueFilters.length)}applyFilters(e){if(!e)return[];return e.filter(e=>{const t=e.isVisible;let n=!0;for(const t of this._critiqueFilters)if(n=t.filter(e),!n)break;return e.isVisible=n,e.isVisible!==t})}};function er(e,t,n){e.set(I.a.ContextualSpelling,1),e.set(I.a.WrongSpelling,1),n===g.b.Subscription&&t.some(e=>"mc-officeeditortonalenabled"===e.toLowerCase())&&e.set(I.a.TonalRewrite,1)}Xn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Yn(0,Object(kt.inject)(Mt.a.DictionaryCritiqueFilter)),Yn(1,Object(kt.inject)(Mt.a.EnabledCritiqueTypesCritiqueFilter)),Yn(2,Object(kt.inject)(Mt.a.PremiumCritiqueFilter)),Yn(3,Object(kt.inject)(Mt.a.IHostSettings))],Xn);var tr=function(e,t){return function(n,r){t(n,r,e)}};let nr=class{constructor(e,t){this._proofingPersistedStore=e,this._hostSettings=t,this._availableCritiqueTypes=new Map,this._overriddenCritiqueTypes=new Map;const n=this._proofingPersistedStore.getCachedEntry(rt.a.OverriddenCritiqueTypeOptions);er(this._availableCritiqueTypes,this._hostSettings.flightsToTrack||[],this._hostSettings.licenseType),this.setOverriddenCritiqueTypes(n.storeEntryValue),n.isSynced||this.readOverriddenCritiqueTypesFromStorage()}async readOverriddenCritiqueTypesFromStorage(){const e=await this._proofingPersistedStore.read(rt.a.OverriddenCritiqueTypeOptions);this.setOverriddenCritiqueTypes(e)}isCritiqueTypeEnabled(e){const t=this._availableCritiqueTypes.get(e);if(void 0===t)return!1;const n=this._overriddenCritiqueTypes.get(e);return void 0===n?1===t:"1"===n}isCritiqueTypePremium(e){if(e===I.a.TonalRewrite)return!0;return 1!==this._availableCritiqueTypes.get(e)}setOverriddenCritiqueTypes(e){e&&(this._overriddenCritiqueTypes.clear(),e.forEach(e=>{this._overriddenCritiqueTypes.set(e.id,e.value)}))}setAvailableCritiqueTypes(e){e&&(this._availableCritiqueTypes.clear(),er(this._availableCritiqueTypes,this._hostSettings.flightsToTrack||[],this._hostSettings.licenseType),e.forEach(e=>{this._availableCritiqueTypes.set(e.id,e.defaultCritiqueValue)}))}};nr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),tr(0,Object(kt.inject)(Mt.a.IProofingPersistedStore)),tr(1,Object(kt.inject)(Mt.a.IHostSettings))],nr);var rr=function(e,t){return function(n,r){t(n,r,e)}};let ir=class{constructor(e,t){this._enabledCritiqueTypes=e,this._upsellStore=t}filter(e){if(!e)return!1;let t=!0;if(this._upsellStore.isUpsellUser){const n=e.typeId||"";this._enabledCritiqueTypes.isCritiqueTypePremium(n)&&(this._upsellStore.addPremiumCritique(e),t=this._upsellStore.previewModeActive||this._upsellStore.isSquiggleBeingPreviewed(e))}return t}};ir=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),rr(0,Object(kt.inject)(Mt.a.IEnabledCritiqueTypes)),rr(1,Object(kt.inject)(Mt.a.IUpsellStore))],ir);var or=function(e,t){return function(n,r){t(n,r,e)}};let ar=class{constructor(e){this._enabledCritiqueTypes=e}filter(e){return!!e&&(void 0!==e.typeId&&this._enabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId))}};ar=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),or(0,Object(kt.inject)(Mt.a.IEnabledCritiqueTypes))],ar);var sr=n(15161),cr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},lr=function(e,t){return function(n,r){t(n,r,e)}};let ur=class{constructor(e,t,n,r,i){this._enabledCritiqueTypes=e,this._localizer=t,this._nodePoller=n,this._proofingDom=r,this._isUpsellUser=i,this._categoriesList=new Set,this._premiumCritiques=new Set,this._previouslyClickedCritiques=new Set,this._previewCount=3,this._previewUnit=sr.b.Suggestions,this._previewModeActive=!1,this._lightUpPremiumSquiggles=!1}get categoriesList(){let e="";const t=Array.from(this._categoriesList);for(let n=0;n<t.length;n+=1)e+=t[n],n<t.length-2?e+=this._localizer.getMessage("ebx_enhancedUpsellCategoriesComma"):n===t.length-2&&(e+=this._localizer.getMessage("ebx_enhancedUpsellCategoriesAnd"));return e}get isUpsellUser(){return this._isUpsellUser.check()}get premiumCount(){return this._premiumCritiques.size}get previewCount(){return this._previewCount}get previewUnit(){return this._previewUnit}get previewModeActive(){return this._previewModeActive}addPremiumCritique(e){e.traceId&&e.categoryTitle&&(this._premiumCritiques.has(e.traceId)||(this._premiumCritiques.add(e.traceId),this._categoriesList.has(e.categoryTitle)||this._categoriesList.add(e.categoryTitle),this._onPremiumCountChange&&this._onPremiumCountChange(this.premiumCount,this.categoriesList)))}removePremiumCritique(e){e.traceId&&e.categoryTitle&&this._premiumCritiques.has(e.traceId)&&(this._premiumCritiques.delete(e.traceId),this._categoriesList.delete(e.categoryTitle),this._onPremiumCountChange&&this._onPremiumCountChange(this.premiumCount,this.categoriesList))}setPreviewCount(e,t=!1){this._previewCount=e,!t&&this._onPreviewCountChange&&this._onPreviewCountChange(this._previewCount)}setPreviewUnit(e){this._previewUnit=e}setPreviewModeActive(e){e!==this._previewModeActive&&(this._previewModeActive=e,this._nodePoller.pollNodes(ot.a.ChangeData,this._proofingDom.tileNodes))}setLightUpPremiumSquiggles(e){e!==this._lightUpPremiumSquiggles&&(this._lightUpPremiumSquiggles=e,this._nodePoller.pollNodes(ot.a.ChangeData,this._proofingDom.tileNodes))}isSquiggleBeingPreviewed(e){return!!(this._lightUpPremiumSquiggles&&e&&e.typeId&&this._enabledCritiqueTypes.isCritiqueTypePremium(e.typeId))}reducePreviewCount(e){if(!this.isUpsellUser||!this.previewModeActive||this._previewUnit!==sr.b.Suggestions||!e.typeId||!this._enabledCritiqueTypes.isCritiqueTypePremium(e.typeId)||e.traceId&&this._previouslyClickedCritiques.has(e.traceId))return sr.a.Visible;let t=sr.a.Visible;if(this.previewCount>0){const t=this._previewCount-1;this.setPreviewCount(t),e.traceId&&this._previouslyClickedCritiques.add(e.traceId)}else t=sr.a.Hidden,this._previewModeActive=!1,this._nodePoller.pollNodes(ot.a.ChangeData,this._proofingDom.tileNodes),this._onPremiumPreviewExpired&&this._onPremiumPreviewExpired();return t}setOnPremiumCountChange(e){this._onPremiumCountChange=e}setOnPremiumPreviewExpired(e){this._onPremiumPreviewExpired=e}setOnPreviewCritiquesCountChange(e){this._onPreviewCountChange=e}setOnTryPremiumPreview(e){this._onTryPremiumPreview=e}tryPremiumPreview(e){this._onTryPremiumPreview&&this._onTryPremiumPreview({eventId:S.a.TryPremiumPreviewButtonClicked,sender:S.c.ShowCritiqueCallout,critique:e,location:S.b.PremiumPreview_CCard})}};cr([pt.observable],ur.prototype,"_categoriesList",void 0),cr([pt.observable],ur.prototype,"_premiumCritiques",void 0),cr([pt.observable],ur.prototype,"_previewCount",void 0),cr([pt.observable],ur.prototype,"_previewUnit",void 0),cr([pt.observable],ur.prototype,"_previewModeActive",void 0),cr([pt.observable],ur.prototype,"_lightUpPremiumSquiggles",void 0),cr([pt.computed],ur.prototype,"categoriesList",null),cr([pt.computed],ur.prototype,"isUpsellUser",null),cr([pt.computed],ur.prototype,"premiumCount",null),cr([pt.computed],ur.prototype,"previewCount",null),cr([pt.computed],ur.prototype,"previewUnit",null),cr([pt.computed],ur.prototype,"previewModeActive",null),cr([pt.action],ur.prototype,"addPremiumCritique",null),cr([pt.action],ur.prototype,"removePremiumCritique",null),cr([pt.action],ur.prototype,"setPreviewCount",null),cr([pt.action],ur.prototype,"setPreviewUnit",null),cr([pt.action],ur.prototype,"setPreviewModeActive",null),cr([pt.action],ur.prototype,"setLightUpPremiumSquiggles",null),ur=cr([Object(kt.injectable)(),lr(0,Object(kt.inject)(Mt.a.IEnabledCritiqueTypes)),lr(1,Object(kt.inject)(Mt.a.ILocalizer)),lr(2,Object(kt.inject)(Mt.a.INodePoller)),lr(3,Object(kt.inject)(Mt.a.IProofingDom)),lr(4,Object(kt.inject)(Mt.a.IsUpsellUser))],ur);var dr=n(4100);var fr=function(e,t){return function(n,r){t(n,r,e)}};let hr=class{constructor(e,t){this._submitter=e,this._logger=t}emitNew(e){return this.emitCritiques(ot.a.NewData,e)}emitRemoval(e){return this.emitCritiques(ot.a.RemoveData,(e=>{const t=[];for(const n of e){const e={tileId:n.header,supportedActions:0,suggestions:[],start:0,length:0,priority:0};t.push(e)}return t})(e))}emitCritiques(e,t){return!!this.canEmitCritiques(t)&&(this._logger.debug(589968355,`Publishing critique with message type = ${e}.`),this._submitter.emit("critiqueEvent",{data:t,messageType:e}),!0)}canEmitCritiques(e){return 0!==e.length}};hr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),fr(0,Object(kt.inject)(dr.a.IProofingEmitter)),fr(1,Object(kt.inject)(dr.a.ILogger))],hr);var gr,pr=function(e,t){return function(n,r){t(n,r,e)}};let mr=gr=class{constructor(e,t,n,r,i,o,a){this._uuidGenerator=e,this._orchestratorSettings=t,this._proofingStore=n,this._descriptorManager=r,this._featureFlagsReader=i,this._tileIdFormatter=o,this._unSignedInEditorFeature=a}async buildValidRequest(e){let t=0;const n=await this._proofingStore.read(rt.a.OverriddenCritiqueTypeOptions),r={appId:await this._proofingStore.read(rt.a.AppId),sessionId:this._uuidGenerator.generate(),languageUXId:e.data.uxLanguage,content:(()=>e.data.tiles.map(e=>{const n=e.data.length<this._orchestratorSettings.maxContentLengthInChars?gr._generateElements(e.data,e.proofingLanguages[0],e.textUnit):[];return n.length&&(t+=e.data.length),{tileId:this.buildTileId(e.header,e.proofingLanguages[0]),revisionId:"1",tileElements:n}}).filter(e=>e.tileElements&&e.tileElements.length>0))(),descriptors:await this._descriptorManager.buildDescriptors(),overriddenCritiqueTypeOptions:n.length>0?n:void 0};if(await this.unsignedInEditorFeatureEnabled()&&(r.runOnProfileId="50000000-0000-0000-0000-000000000000"),t<this._orchestratorSettings.maxContentLengthInChars&&r.content&&r.content.length>0)return r}async unsignedInEditorFeatureEnabled(){return this._unSignedInEditorFeature.emitAndEvaluateAsync({eventId:wt.a.PageContext,sender:wt.c.PageContext})}buildTileId(e,t){return this._featureFlagsReader.flags.enableMultiLanguageSupport?this._tileIdFormatter.format(JSON.stringify(e),t):JSON.stringify(e)}static _generateElements(e,t,n=Ft.c.TextUnit.Sentence){return 0===e.length?[]:[{text:e,languageId:t,textUnit:n}]}};var yr,br;mr=gr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),pr(0,Object(kt.inject)(dr.a.IGuidGenerator)),pr(1,Object(kt.inject)(dr.a.IOrchestratorSettings)),pr(2,Object(kt.inject)(dr.a.IProofingPersistedStore)),pr(3,Object(kt.inject)(dr.a.IDescriptorManager)),pr(4,Object(kt.inject)(tn.a.IFeatureFlagsReader)),pr(5,Object(kt.inject)(dr.a.ITileIdFormatter)),pr(6,Object(kt.inject)(tn.a.IUnsignedInEditorFeature))],mr),function(e){e.InstrumentationCall="InstrumentationCall"}(yr||(yr={})),function(e){e.TileIdParseException="RunTimeErrors.TileIdParseException",e.InvalidTileFormat="RunTimeErrors.InvalidTileFormat"}(br||(br={}));var vr=function(e,t){return function(n,r){t(n,r,e)}};let _r=class{constructor(e,t,n,r,i){this._receiver=e,this._hostEmitter=t,this._tileCheckRequestBuilder=n,this._critiquesMessageEmitter=r,this._logger=i,this.cleanUp=()=>{this.shutDown()},this.tilesEventListener=async e=>this.process(e),this.tileCheckResponseV1Listener=e=>this.handleResponse(e),this.clearTileCritiquesListener=e=>this._critiquesMessageEmitter.emitRemoval(e.message)}async initialize(){this._receiver.on("tilesEvent",this.tilesEventListener),this._hostEmitter.on(st.a.tileCheckResponseV1,this.tileCheckResponseV1Listener),this._hostEmitter.on(st.a.clearTileCritiques,this.clearTileCritiquesListener)}async shutDown(){this._receiver.off("tilesEvent"),this._hostEmitter.off(st.a.tileCheckResponseV1),this._hostEmitter.off(st.a.clearTileCritiques)}async process(e){if(e.data.tiles.length<=0)return!1;if(e.messageType===ot.a.RemoveData)return this._critiquesMessageEmitter.emitRemoval(e.data.tiles),!0;try{const t=await this._tileCheckRequestBuilder.buildValidRequest(e);return!!t&&(this._hostEmitter.emit(st.a.tileCheckRequestV1,{address:void 0,message:t}),this._logger.debug(589897998,"Sending Tile check API request to background script."),!0)}catch(e){this._logger.logEvent(589968387,br.InvalidTileFormat,Vt.e.Error,"Invalid input. Request not sent to the background script.",Vt.f.CriticalBusinessImpact)}return!1}handleResponse(e){this._critiquesMessageEmitter.emitNew(e.message)}};_r=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),vr(0,Object(kt.inject)(dr.a.IProofingEmitter)),vr(1,Object(kt.inject)(dr.a.IHostEmitter)),vr(2,Object(kt.inject)(dr.a.ITileCheckRequestBuilder)),vr(3,Object(kt.inject)(dr.a.ICritiquesMessageEmitter)),vr(4,Object(kt.inject)(dr.a.ILogger))],_r);var Ir=function(e,t){return function(n,r){t(n,r,e)}};let Sr=class{constructor(e,t,n){this._hostEmitter=e,this._proofingStore=t,this._descriptorManager=n}async process(e){if(e.critique.traceId&&e.critique.typeId&&e.critique.textInContext){const t=e.critique.suggestions.map(e=>e.text)[e.eventId-4],n={appId:await this._proofingStore.read(rt.a.AppId),descriptors:await this._descriptorManager.buildDescriptors(),languageId:new it.a(await this._proofingStore.read(rt.a.ProofingLanguages)).defaultLanguageCode,traceId:e.critique.traceId,critiquePriority:e.critique.priority,critiqueTypeId:e.critique.typeId,eventId:e.eventId,flaggedText:e.critique.textInContext,suggestions:e.critique.suggestions.map(e=>e.text),suggestionText:t};return this._hostEmitter.emit(st.a.instrumentationRequestV1,{address:void 0,message:n}),!0}return!1}};Sr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Ir(0,Object(kt.inject)(dr.a.IHostEmitter)),Ir(1,Object(kt.inject)(dr.a.IProofingPersistedStore)),Ir(2,Object(kt.inject)(dr.a.IDescriptorManager))],Sr);var Cr=function(e,t){return function(n,r){t(n,r,e)}};let Or=class{constructor(e,t,n){this._proofingStore=e,this._hostSettings=t,this._featureFlagsReader=n}async buildDescriptors(){let e;try{e=JSON.parse(await this._proofingStore.read(rt.a.Descriptors))}catch(t){e=JSON.parse(this._proofingStore.getDefaultValue(rt.a.Descriptors))}const t=this._proofingStore.getCachedEntry(rt.a.ProofingLanguages).storeEntryValue;let n="";if(this._featureFlagsReader.flags.enableAsyncSynonym&&this._featureFlagsReader.flags.enableMultiLanguageSupport&&t.length>1&&(n="DoNotAddSuggestionDescription;"),this._hostSettings.flightsToTrack&&this._hostSettings.flightsToTrack.length>0&&(n=`${n}${this._hostSettings.flightsToTrack.join(";")}`),""!==n){const t=e.find(e=>"FlightIds"===e.name);t?t.value=`${t.value};${n}`:e.push({name:"FlightIds",value:n})}return e}};Or=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Cr(0,Object(kt.inject)(dr.a.IProofingPersistedStore)),Cr(1,Object(kt.inject)(dr.a.IHostSettings)),Cr(2,Object(kt.inject)(dr.a.IFeatureFlagsReader))],Or);let Tr=class{format(e,t){const n={header:e,proofingLanguage:t};return JSON.stringify(n)}parse(e){if(e){const t=JSON.parse(e);if(t)return{tileId:t.header,languageCode:t.proofingLanguage}}return{tileId:e,languageCode:void 0}}};Tr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)()],Tr);var Er=function(e,t){return function(n,r){t(n,r,e)}};let Pr=class{constructor(e,t,n,r,i,o,a,s,c){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=n,this._settings=r,this._logger=i,this._featureFlagsReader=o,this._tileIdFormatter=a,this._transfomer=s,this._hostSettings=c}async initialize(){this._hostEmitter.on(st.a.tileCheckRequestV1,async e=>this.handleRequest(e))}async shutDown(){this._hostEmitter.off(st.a.tileCheckRequestV1)}async handleRequest(e){let t;try{t=await this._userInfoStrategy.executeAsync(!1),t&&(this._editorService.xUserId=t.userId)}catch(e){this._logger.error(589968384,"Get user info failed")}try{!function(e,t,n){if(e){for(const t of e)if("LicenseType"===t.name)return t.value}else e=[];let r=g.b.NoLicense;t?r=g.b.Subscription:n&&n.licenseType&&(r=n.licenseType),e.push({name:"LicenseType",value:r})}(e.message.descriptors,this._hostSettings.enhancedUpsellEnabled,t);const n=e.address,r=await this._editorService.postTileCheck(e.message);this._settings.emitRemoval&&this._tryEmitClearTileCritiques(e,r);const i=await this._transfomer.transform(r);this._hostEmitter.emit(st.a.tileCheckResponseV1,{address:n,message:i})}catch(e){this._logger.error(589968385,"Editor service call failed.")}return!1}_tryEmitClearTileCritiques(e,t){if(t.responseStatus!==Ft.c.ResponseStatus.Success&&t.responseStatus!==Ft.c.ResponseStatus.PartialSuccess)return;const n=e.address,r=e.message,i=new Set((r.content||[]).map(e=>e.tileId));if((t.critiques||[]).forEach(e=>{const t=this._featureFlagsReader.flags.enableMultiLanguageSupport?this._tileIdFormatter.parse(e.tileId).tileId:e.tileId;t&&i.delete(t)}),i.size>0){const e=[];Array.from(i).forEach(t=>{try{const n={header:JSON.parse(t),data:"",proofingLanguages:[]};e.push(n)}catch(e){}}),this._hostEmitter.emit(st.a.clearTileCritiques,{address:n,message:e})}}};Pr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Er(0,Object(kt.inject)(dr.a.IUserInfoStrategy)),Er(1,Object(kt.inject)(dr.a.IHostEmitter)),Er(2,Object(kt.inject)(dr.a.EditorService)),Er(3,Object(kt.inject)(dr.a.IOrchestratorSettings)),Er(4,Object(kt.inject)(dr.a.ILogger)),Er(5,Object(kt.inject)(dr.a.IFeatureFlagsReader)),Er(6,Object(kt.inject)(dr.a.ITileIdFormatter)),Er(7,Object(kt.inject)(dr.a.ITileCheckResponseTransformer)),Er(8,Object(kt.inject)(dr.a.IHostSettings))],Pr);var wr,jr=n(10619),Rr=function(e,t){return function(n,r){t(n,r,e)}};let xr=wr=class{constructor(e,t,n,r){this._tileIdFormatter=e,this._proofingPersistedStore=t,this._featureFlagsReader=n,this._settings=r,this.chineseAndJapaneseLanguageList=["ja-JP","zh-CN","zh-TW"],this.transform=e=>{if(!e||0===e.length)return[];if(!this._featureFlagsReader.flags.enableMultiLanguageSupport)return e.forEach(e=>e.suggestions=this.getSuggestionsWithLanguage(e)),e;const t=[],n=this.groupCritiquesByElementAndRestoreTileData(e);for(const e of n){const n=e[1],r=n.critiques.sort(this.compareCritiques);t.push(...this.findAndMergeOverlappingCritiques(r,n.detectedLanguages))}return t},this.groupCritiquesByElementAndRestoreTileData=e=>{const t=this._proofingPersistedStore.getCachedEntry(rt.a.ProofingLanguages).storeEntryValue,n=new Map,r=new Map;for(const i of e){const e=i,o=this._tileIdFormatter.parse(i.tileId);e.tileId=o.tileId,e.languageId=o.languageCode;const a=this.getTileElementId(o.tileId),{languageId:s,priority:c}=e,l=n.get(a);if(l){const t=r.get(a);l.critiques.push(e),this.setLanguageMapValueForCritique(t,s,c)}else{const i=this.initializeLanguagesMap(t,s,c);r.set(a,i),n.set(a,{critiques:[e],detectedLanguages:[]})}}for(const e of n.keys()){const t=n.get(e),i=r.get(e);t&&i&&(t.detectedLanguages=this.detectLanguages(i))}return n},this.detectLanguages=e=>{let t,n=[];for(const r of e){const e=r[0],i=r[1];void 0===t||t>i?(t=i,n=[e]):t===i&&n.push(e)}return n},this.findAndMergeOverlappingCritiques=(e,t)=>{let n=0,r=-1,i=0;const o=[];for(const a of e){const s=this.getValueOrZero(a.start);if(s===r||s<i)continue;r=s,i=s+this.getValueOrZero(a.length);const c=[];let l=I.b.High;for(let r=n;r<e.length;r+=1){n=r;const o=e[r],a=this.getValueOrZero(o.start);if(!(s<=a&&a<=i))break;{l=this.getTopPriority(l,o.priority),(o.priority===I.b.High||t.includes(o.languageId||""))&&c.push(o);const e=a+this.getValueOrZero(o.length);e>i&&(i=e)}}const u=this.decideWinner(c,l);u&&o.push(u)}return o},this.getTopPriority=(e,t)=>{const n=t||I.b.High;return n===I.b.Medium?I.b.Medium:n===I.b.Low&&e!==I.b.Medium?I.b.Low:e},this.decideWinner=(e,t)=>{if(0===e.length)return;const n=e.filter(e=>e.priority===t);if(0===n.length)return;const r=this._proofingPersistedStore.getCachedEntry(rt.a.ProofingLanguages).storeEntryValue;if(t===I.b.High)return this.getSpellingCritiqueWithMergedSuggestions(n,r);let i=n[0];if(n.length>1){const e=n.filter(e=>e.languageId===r[0]);e.length>0&&(i=e[0])}return i.suggestions=this.getSuggestionsWithLanguage(i),i},this.getSpellingCritiqueWithMergedSuggestions=(e,t)=>{let n;const r=e[0],i=[],o=new Map;let a=this._settings.maxSuggestionItemsDisplayNumber;for(const s of t){const t=e.filter(e=>e.languageId===s);if(this.chineseAndJapaneseLanguageList.includes(s)){if(wr.containsChineseOrJapaneseUnicode(Object(jr.c)(r.context,r.startInContext,r.length)))return;continue}if(!t||0===t.length)return;const c=t[0],l=c.suggestions,u=wr.isDeleteActionAvailable(c);u&&(r.supportedActions=1|(r.supportedActions||0));const d=this.processSuggestions(l,o,i,s,u,a);d.actionable.length>0?(i.length>0&&a===this._settings.maxSuggestionItemsDisplayNumber&&(a=this._settings.maxSuggestionDisplayPerLanguageNumber,i.splice(a),d.actionable.splice(a)),i.push(...d.actionable)):n||(n=d.nonActionable)}if(i.length>0){for(const e of i)e.languageIds=o.get(e.text);r.suggestions=this.sortSuggestionsByLanguages(i,t)}else r.suggestions=n?[n]:[];return r},this.processSuggestions=(e,t,n,r,i,o)=>{const a={actionable:[],nonActionable:void 0};if(!e)return a;for(let s=0;s<e.length;s+=1){const c=e[s];if(this.setLanguageToSuggestionMapEntry(t,c.text,r),s<o){wr.isSuggestionActionable(e[s])||i?n.every(e=>e.text!==c.text)&&a.actionable.push(c):a.nonActionable=e[s]}}return a},this.sortSuggestionsByLanguages=(e,t)=>e.sort((e,n)=>{if(!e.languageIds||!n.languageIds)return 0;const r=n.languageIds.length-e.languageIds.length;if(0!==r)return r;for(let r=0;r<e.languageIds.length;r+=1){const i=t.indexOf(e.languageIds[r])-t.indexOf(n.languageIds[r]);if(0!==i)return i}return 0}),this.getTileElementId=e=>{let t="";if(e)try{t=JSON.parse(e).elementId.id}catch(e){}return t},this.getSuggestionsWithLanguage=e=>{const t=e.suggestions&&e.suggestions.length>this._settings.maxSuggestionItemsDisplayNumber?e.suggestions.splice(0,this._settings.maxSuggestionItemsDisplayNumber):e.suggestions;if(t&&e.languageId)for(const n of t)n.languageIds=e.languageId?[e.languageId]:[];return t},this.initializeLanguagesMap=(e,t,n)=>{return new Map(e.map(e=>{return[e,n===I.b.High&&e===t?1:0]}))},this.setLanguageMapValueForCritique=(e,t,n)=>{if(e&&t&&n===I.b.High){const n=e.get(t)||0;e.set(t,n+1)}},this.compareCritiques=(e,t)=>{return this.getValueOrZero(e.start)-this.getValueOrZero(t.start)},this.getValueOrZero=e=>e||0,this.setLanguageToSuggestionMapEntry=(e,t,n)=>{const r=e.get(t);r?r.push(n):e.set(t,[n])}}static containsChineseOrJapaneseUnicode(e){return!!e&&/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/.test(e)}static isSuggestionActionable(e){return 1==(1&e.action)||2==(2&e.action)||4==(4&e.action)}static isDeleteActionAvailable(e){return void 0!==e.supportedActions&&1==(1&e.supportedActions)}};xr=wr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Rr(0,Object(kt.inject)(dr.a.ITileIdFormatter)),Rr(1,Object(kt.inject)(dr.a.IProofingPersistedStore)),Rr(2,Object(kt.inject)(dr.a.IFeatureFlagsReader)),Rr(3,Object(kt.inject)(dr.a.IHostSettings))],xr);var Ar=function(e,t){return function(n,r){t(n,r,e)}};let Nr=class{constructor(e,t,n,r){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=n,this._logger=r}async initialize(){this._hostEmitter.on(st.a.instrumentationRequestV1,async e=>this.handleRequest(e))}async shutDown(){this._hostEmitter.off(st.a.instrumentationRequestV1)}async handleRequest(e){const t=this._logger.getNewActivity(yr.InstrumentationCall,Vt.f.Measure);try{const n=await this._userInfoStrategy.executeAsync(!1);n&&(this._editorService.serverToServerId=JSON.stringify({puid:n.userId,identityProvider:n.identityProvider,tenantId:n.tenantId}));const r=await this._editorService.instrumentation(e.message);return t&&(e.message&&(t.addDataField("EventID",e.message.eventId,Vt.a.EssentialServiceMetadata),t.addDataField("CritiquePriority",e.message.critiquePriority,Vt.a.EssentialServiceMetadata)),r&&200===r._response.status?t.setSuccess(!0):t.setSuccess(!1),t.endNow()),!0}catch(e){t&&(t.addDataField("Instrumentation_Error_Response",e,Vt.a.EssentialServiceMetadata),t.setSuccess(!1),t.endNow())}return!1}};Nr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Ar(0,Object(kt.inject)(dr.a.IUserInfoStrategy)),Ar(1,Object(kt.inject)(dr.a.IHostEmitter)),Ar(2,Object(kt.inject)(dr.a.EditorService)),Ar(3,Object(kt.inject)(dr.a.ILogger))],Nr);var Dr=function(e,t){return function(n,r){t(n,r,e)}};let Fr=class{constructor(e,t,n,r){this._logger=e,this._multiLangTileCheckResponseTransformer=t,this._synonymFiller=n,this._featureFlagsReader=r,this.convertSuggestions=e=>e?e.map(e=>({text:e.text,description:e.description,confidenceLevel:e.confidenceLevel||Ft.c.ConfidenceLevel.High,source:e.source||Ft.c.Source.None,action:e.action,bucketId:e.bucketId,numberOfInstances:e.numberOfInstances,languages:e.languageIds})):[]}async transform(e){this._logger.debug(589968390,"Transforming response");const t=this._multiLangTileCheckResponseTransformer.transform(e.critiques);return await this.fillSuggestionWithDescription(t),Promise.all(t.map(async e=>({tileId:this.convertTileHeader(e.tileId),traceId:e.traceId,categoryTitle:e.categoryTitle,explanationTitle:e.explanationTitle,explanation:e.explanation,supportedActions:e.supportedActions||0,suggestions:this.convertSuggestions(e.suggestions),start:e.start||0,length:e.length||0,priority:e.priority||I.b.High,typeId:e.typeId,textInContext:Object(jr.c)(e.context,e.startInContext,e.length)})))}convertTileHeader(e){if(e)try{return JSON.parse(e)}catch(t){return void this._logger.logEvent(589968391,br.TileIdParseException,Vt.e.Error,`Parsing tile ID ${e} failed`,Vt.f.CriticalBusinessImpact)}}async fillSuggestionWithDescription(e){if(!this._featureFlagsReader.flags.enableAsyncSynonym||!this._featureFlagsReader.flags.enableMultiLanguageSupport)return;const t=e.reduce((e,t)=>(t.typeId!==I.a.ContextualSpelling&&t.typeId!==I.a.WrongSpelling||t.suggestions&&e.push(...t.suggestions),e),[]),n=new Map;for(const e of t){const t=e.languageIds;if(t&&0!==t.length){const r=t[0];r in n?n[r].push(e):n[r]=[e]}else;}await Promise.all(Object.entries(n).map(async([e,t])=>{await this._synonymFiller.fill(t,e)}))}};Fr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Dr(0,Object(kt.inject)(dr.a.ILogger)),Dr(1,Object(kt.inject)(dr.a.IMultiLangTileCheckResponseTransformer)),Dr(2,Object(kt.inject)(dr.a.ISynonymFiller)),Dr(3,Object(kt.inject)(dr.a.IFeatureFlagsReader))],Fr);var kr,Mr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Br=function(e,t){return function(n,r){t(n,r,e)}};let Lr=kr=class{constructor(e,t,n,r,i,o){this._userInfoStrategy=e,this._synonymService=t,this._logger=n,this._synonymRequestBuilder=r,this._featureFlagsReader=i,this._proofingStore=o}async fill(e,t){const n=this._proofingStore.getCachedEntry(rt.a.ProofingLanguages).storeEntryValue;if(!this._featureFlagsReader.flags.enableAsyncSynonym||!this._featureFlagsReader.flags.enableMultiLanguageSupport||n.length<=1)return;if(0===e.length)return;if(e.some(e=>!!e.description&&e.description.length>0))return;let r;try{r=await this._userInfoStrategy.executeAsync(!1)}catch(e){this._logger.error(587608863,"Get user info failed")}if(r&&r.licenseType&&r.licenseType===g.b.Subscription){this._synonymService.xUserId=r.userId;try{const n=await this._synonymRequestBuilder.buildValidRequest(e,t);if(!n)return;kr._addLicenseType(n,r);const i=await this._synonymService.postCheck(n);kr._processResponse(e,i.lookupResults)}catch(e){this._logger.error(587608864,"Synonym service call failed.")}}}static _processResponse(e,t){let n=0;for(const r of t){const t=[];for(const e of r.meanings){if(t.length>=kr.maxNumberOfSynonyms)break;t.includes(e.text)||t.push(e.text)}for(const e of r.meanings){if(t.length>=kr.maxNumberOfSynonyms)break;for(const n of e.synonyms){if(t.length>=kr.maxNumberOfSynonyms)break;t.includes(n.text)||t.push(n.text)}}e[n].description=t.join(", "),n+=1}}static _addLicenseType(e,t){if(e.descriptors){for(const t of e.descriptors)if("LicenseType"===t.name)return}else e.descriptors=[];let n=g.b.NoLicense;t&&t.licenseType&&(n=t.licenseType),e.descriptors.push({name:"LicenseType",value:n})}};Lr.maxNumberOfSynonyms=3,Lr=kr=Mr([Object(kt.injectable)(),Br(0,Object(kt.inject)(dr.a.IUserInfoStrategy)),Br(1,Object(kt.inject)(dr.a.SynonymService)),Br(2,Object(kt.inject)(dr.a.ILogger)),Br(3,Object(kt.inject)(dr.a.ISynonymRequestBuilder)),Br(4,Object(kt.inject)(dr.a.IFeatureFlagsReader)),Br(5,Object(kt.inject)(dr.a.IProofingPersistedStore))],Lr);var qr,Ur=function(e,t){return function(n,r){t(n,r,e)}};let Hr=qr=class{constructor(e,t){this._proofingStore=e,this._descriptorManager=t}async buildValidRequest(e,t){return{appId:await this._proofingStore.read(rt.a.AppId),languageId:t,descriptors:await this._descriptorManager.buildDescriptors(),lookupWords:qr.buildLookupWords(e),mode:0}}static buildLookupWords(e){const t=[];return e&&e.forEach(e=>{t.push({word:e.text})}),t}};Hr=qr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Ur(0,Object(kt.inject)(dr.a.IProofingPersistedStore)),Ur(1,Object(kt.inject)(dr.a.IDescriptorManager))],Hr);var Wr=n(16947),Gr=n(4099),Vr=function(e,t){return function(n,r){t(n,r,e)}};let zr=class{constructor(e,t,n){if(this._proofingEmitter=e,this.hostSettings=t,this._roamingDictionaryFeature=n,this._ignoredWords=new Set,this.isWordIgnored=e=>{const t=e.trim();return!!this._ignoredWords.has(t)||!(!this._roamingDictionary||!this._roamingDictionary.testWord(t,!0))},this.clearIgnoredWords=()=>{this._ignoredWords.clear(),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:ot.a.RemoveData})},this.addWordToIgnoreList=e=>{if(e){const t=e.trim();if(this._ignoredWords.has(t))return;this._ignoredWords.add(t),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:ot.a.NewData})}},this.addWordToCustomDictionary=e=>{if(e){const t=e.trim();if(this._roamingDictionary&&this._roamingDictionaryFeature.isReady())return this._roamingDictionary.addWord(t),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:ot.a.NewData}),!0}return!1},this.hostSettings.enableRoamingDictionary){this._roamingDictionaryFeature.emitAndEvaluate({eventId:C.a.ClientInitialized,sender:C.b.WordDictionaryInit})&&(this._roamingDictionary=this._roamingDictionaryFeature.getRoamingDictionary())}}};zr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Vr(0,Object(kt.inject)(Gr.a.IProofingEmitter)),Vr(1,Object(kt.inject)(Wr.a.IHostSettings)),Vr(2,Object(kt.inject)(tn.a.IRoamingDictionaryFeature))],zr);let Jr=class{isSpellingCritique(e){const t=[I.a.ContextualSpelling,I.a.WrongSpelling];return!!e&&(e.priority===I.b.High||!!e.typeId&&t.includes(e.typeId))}isDeleteActionAvailable(e){return 1==(1&e.supportedActions)}isChangeActionAvailable(e){return 1==(1&e.action)||2==(2&e.action)||4==(4&e.action)}};Jr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)()],Jr);var $r=function(e,t){return function(n,r){t(n,r,e)}};let Kr=class{constructor(e){this.presentationSettings=e}validate(e){return e?e.slice(0,this.presentationSettings.maxServiceContentLengthInChars):""}};Kr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),$r(0,Object(kt.inject)(Gr.a.IPresentationSettings))],Kr);var Qr=function(e,t){return function(n,r){t(n,r,e)}};let Zr=class{constructor(e,t,n,r,i,o,a,s){this._hostEmitters=e,this._proofingEmitter=t,this._critiqueEventHandler=n,this._filteringEventHandler=r,this._nodeEventHandler=i,this._spanEventHandler=o,this._hostSettings=a,this._logger=s,this.shutDown=()=>{this._proofingEmitter.off("enabledCritiqueTypesChanged",this.onEnabledCritiqueTypesChangedEvent),this._proofingEmitter.off("wordDictionaryEvent",this.onWordDictionaryEvent),this._hostEmitters.forEach(e=>{e.off(st.a.hostModelCritique,this.onHostModelCritiqueEvent),e.off(st.a.hostModelDelta,this.onHostModelDeltaEvent),e.off(st.a.hostModelTextTile,this.onHostModelTextTileEvent)})},this.onEnabledCritiqueTypesChangedEvent=e=>{if(!e)return void this._logger.log(587486303,Vt.e.Error,"Enabled CritiqueTypes message: Received undefined args.");if(e.messageType!==ot.a.ChangeData)return void this._logger.log(587486304,Vt.e.Warn,"Enabled CritiqueTypes message: Unexpected MessageType.");this._filteringEventHandler.onEvent({eventType:2})},this.onHostModelCritiqueEvent=e=>{if(!(e&&e.message&&e.message.data&&e.message.data.tileId))return void this._logger.log(589336976,Vt.e.Error,"IHostModelCritique message: Received undefined args.");const t=e.message.messageType;if(t===ot.a.ChangeData)return void this._logger.log(589169424,Vt.e.Warn,"IHostModelCritique message: Unexpected MessageType.");const n=e.message.data,r={annotationId:n.annotationId,critique:n.critique,eventType:t===ot.a.NewData?0:1,nodeId:n.tileId,nodeVersion:n.tileVersion};this._critiqueEventHandler.onEvent(r)},this.onHostModelDeltaEvent=e=>{if(!(e&&e.message&&e.message.delta&&e.message.tileId))return void this._logger.log(589336977,Vt.e.Error,"IHostModelDelta message: Received undefined args.");const t=e.message.delta,n=e.message.tileId,r=e.message.tileVersion,i={position:t.position,length:t.length,content:t.content,eventType:t.deltaType===ct.TextTileDeltaType.Add?0:t.deltaType===ct.TextTileDeltaType.Delete?1:2,nodeId:n,nodeVersion:r};this._spanEventHandler.onEvent(i)},this.onHostModelTextTileEvent=e=>{if(!(e&&e.message&&e.message.data&&e.message.data.tileId))return void this._logger.log(589336978,Vt.e.Error,"IHostModelTextTile message: Received undefined args.");const t=e.message.messageType;if(t===ot.a.ChangeData)return void this._logger.log(589169425,Vt.e.Warn,"IHostModelTextTile message: Unexpected MessageType.");const n=e.message.data,r=n.tileId,i=n.tileVersion,o={eventType:t===ot.a.NewData?0:1,nodeId:r,nodeVersion:i};this._nodeEventHandler.onEvent(o)},this.onWordDictionaryEvent=e=>{if(!e)return void this._logger.log(589336979,Vt.e.Error,"IWordDictionaryMessage message: Received undefined args.");const t=e.messageType;if(t===ot.a.ChangeData)return void this._logger.log(589169426,Vt.e.Warn,"IWordDictionaryMessage message: Unexpected MessageType.");const n={eventType:t===ot.a.NewData?0:1};this._filteringEventHandler.onEvent(n)}}async initialize(){this.initializeSynced()}initializeSynced(){this._hostSettings.enableOrchestration&&(this._proofingEmitter.on("enabledCritiqueTypesChanged",this.onEnabledCritiqueTypesChangedEvent),this._proofingEmitter.on("wordDictionaryEvent",this.onWordDictionaryEvent),this._hostEmitters.forEach(e=>{e.on(st.a.hostModelCritique,this.onHostModelCritiqueEvent),e.on(st.a.hostModelDelta,this.onHostModelDeltaEvent),e.on(st.a.hostModelTextTile,this.onHostModelTextTileEvent)}))}};var Yr,Xr;Zr=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),Qr(0,Object(kt.multiInject)(Gr.a.IHostEmitterArray)),Qr(1,Object(kt.inject)(Gr.a.IProofingEmitter)),Qr(2,Object(kt.inject)(Gr.a.CritiqueEventHandler)),Qr(3,Object(kt.inject)(Gr.a.FilteringEventHandler)),Qr(4,Object(kt.inject)(Gr.a.NodeEventHandler)),Qr(5,Object(kt.inject)(Gr.a.SpanEventHandler)),Qr(6,Object(kt.inject)(Gr.a.IHostSettings)),Qr(7,Object(kt.inject)(Gr.a.ILogger))],Zr),function(e){e.ReconcileTileNode="ReconcileTileNode",e.WebSiteProvedOnce="WebSiteProvedOnce"}(Yr||(Yr={})),function(e){e.MutationError="MutationError",e.UpdateCritiqueException="RunTimeErrors.UpdateCritiqueException"}(Xr||(Xr={}));const ei=(e,t)=>{const n=[];return e?(e.some(e=>(n.push({action:e.suggestionActions||0,confidenceLevel:Ft.c.ConfidenceLevel.High,description:e.description,source:Ft.c.Source.None,text:e.text}),n.length===t)),n):n};var ti=function(e,t){return function(n,r){t(n,r,e)}};let ni=class{constructor(e,t,n,r,i,o,a){this._critiqueStore=e,this._critiqueContextValidator=t,this._critiqueFilterer=n,this._logger=r,this._hostSettings=i,this._proofingPersistedStore=o,this._e2eMetric=a,this._websiteProvedOnce=!1}onEvent(e){if(!e)return void this._logger.log(589336982,Vt.e.Error,"CritiqueEventHandler: Received undefined event args.");const{annotationId:t,critique:n,nodeId:r,nodeVersion:i}=e;switch(e.eventType){case 0:this.onCritiqueAdded(n,t,r,i);break;case 1:this.onCritiqueRemoved(t,r)}}logWebsiteProvedOnce(){this._websiteProvedOnce||(this._websiteProvedOnce=!0,((e,t,n)=>{if(!e||!t)return;const r=e.getNewActivity(Yr.WebSiteProvedOnce,Vt.f.CriticalBusinessImpact),i=t.getCachedEntry(rt.a.ProofingLanguages).storeEntryValue;r&&(r.addDataField("Proofing_Languages",i.join(","),Vt.a.EssentialServiceMetadata),r.addDataField("IsAL",n&&!0===n.enableOrchestration&&n.orchestratorSettings&&!0===n.orchestratorSettings.enableAugLoop,Vt.a.EssentialServiceMetadata),r.setSuccess(!0),r.endNow())})(this._logger,this._proofingPersistedStore,this._hostSettings))}onCritiqueAdded(e,t,n,r){const i=this._critiqueStore.getCritiques(n);if(i){const o=((e,t,n,r,i=3)=>{if(e)return{annotationId:t,categoryTitle:e.categoryName,explanation:e.explanationBody,explanationTitle:e.explanationTitle,length:e.range?e.range.length:0,nodeId:n,nodeVersion:r,priority:e.priority,start:e.range?e.range.start:0,suggestions:ei(e.suggestions,i),supportedActions:e.critiqueActions||0,textInContext:e.context,traceId:e.id,typeId:e.typeId}})(e,t,n,r,this._hostSettings.maxSuggestionItemsDisplayNumber);if(o){const e=[];if(this._critiqueContextValidator.isValid(o)){const t=i.critiques;let a=!1;for(const n of t){const t=n[1];if(t&&Object(jr.b)(t,o)){if(Object(jr.a)(t,o)){t.annotationId=o.annotationId,e.push({critique:t,critiqueDiffType:2}),a=!0;break}e.push({critique:t,critiqueDiffType:4})}}a||(this._critiqueFilterer.applyFilters([o]),e.push({critique:o,critiqueDiffType:0}),this.logWebsiteProvedOnce()),this._critiqueStore.updateNode(e,n,r),this._e2eMetric.commitEntry(`${n}--${r}`)}}}}onCritiqueRemoved(e,t){const n=this._critiqueStore.getCritiques(t);if(n)for(const r of n.critiques){const i=r[1];if(i.annotationId===e){n.critiques.delete(i.start);const e={critique:i,critiqueDiffType:4};this._critiqueStore.updateNode([e],t,n.nodeVersion),this._e2eMetric.commitEntry(`${t}--${n.nodeVersion}`);break}}}};ni=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),ti(0,Object(kt.inject)(Gr.a.ICritiqueStore)),ti(1,Object(kt.inject)(Gr.a.ICritiqueContextValidator)),ti(2,Object(kt.inject)(Gr.a.ICritiqueFilterer)),ti(3,Object(kt.inject)(Gr.a.ILogger)),ti(4,Object(kt.inject)(Gr.a.IHostSettings)),ti(5,Object(kt.inject)(Gr.a.IProofingPersistedStore)),ti(6,Object(kt.inject)(Wr.a.IE2eMetric))],ni);var ri=function(e,t){return function(n,r){t(n,r,e)}};let ii=class{constructor(e,t){this._proofingDom=e,this._textExtractor=t}isValid(e){if(!e||!e.nodeId)return!1;const t=this._proofingDom.findTileNode(e.nodeId);if(!(t&&t.element&&t.element instanceof HTMLElement))return!1;const n=this._textExtractor.extractElementText(t.element),r=e.start,i=r+e.length;let o=e.textInContext;return o&&(o=o.replace(/\u00A0/g," ")),o===n.substring(r,i).replace(/\u00A0/g," ")}};ii=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),ri(0,Object(kt.inject)(Gr.a.IProofingDom)),ri(1,Object(kt.inject)(Gr.a.ITextExtractor))],ii);var oi=function(e,t){return function(n,r){t(n,r,e)}};let ai=class{constructor(e,t,n){this._critiqueStore=e,this._critiqueFilterer=t,this._logger=n}onEvent(e){e?this.filterCritiques():this._logger.log(588097543,Vt.e.Error,"FilteringEventHandler: Received undefined event args.")}filterCritiques(){const e=this._critiqueStore.getAllCritiques();e&&e.forEach(e=>{const t=this._critiqueFilterer.applyFilters(Array.from(e.critiques.values())).map(e=>({critique:e,critiqueDiffType:2}));t.length>0&&this._critiqueStore.updateNode(t,e.nodeId,e.nodeVersion)})}};ai=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),oi(0,Object(kt.inject)(Gr.a.ICritiqueStore)),oi(1,Object(kt.inject)(Gr.a.ICritiqueFilterer)),oi(2,Object(kt.inject)(Gr.a.ILogger))],ai);var si=function(e,t){return function(n,r){t(n,r,e)}};let ci=class{constructor(e,t){this._proofingDom=e,this._proofingEmitter=t}dispatchCritiques(e,t,n=(()=>{}),r=ot.a.NewData){const i=this._proofingDom.findTileNode(t);i&&this._proofingEmitter.emit("squiggleDataEvent",{messageType:r,data:{critiquesToElementsMap:[{elementId:t,element:i.element,critiques:e}],actionCallback:n}})}};ci=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),si(0,Object(kt.inject)(Gr.a.IProofingDom)),si(1,Object(kt.inject)(Gr.a.IProofingEmitter))],ci);var li=function(e,t){return function(n,r){t(n,r,e)}};let ui=class{constructor(e,t){this._critiqueDispatcher=e,this._logger=t,this._critiquesByNode=new Map,this._latestNodeVersion=new Map,this.actionCallback=(e,t,n)=>{if(n)switch(e){case en.a.IgnoreOnce:case en.a.ApplySuggestion:this.removeCritique(t,n);break;default:this._logger.log(589336983,Vt.e.Error,"CritiqueStore: Received unexpected actionType.")}},this.dispatchAllCritiques=()=>{this._critiquesByNode.forEach((e,t)=>{this.dispatchCritiquesForNode(e,t)})},this.dispatchCritiquesForNode=(e,t)=>{const n=this.getCritiquesToDispatch(e);this._critiqueDispatcher.dispatchCritiques(n,t,this.actionCallback)},this.getCritiquesToDispatch=e=>{const t=new Map;return e.forEach((e,n)=>{e.isVisible&&t.set(n,e)}),t},this.removeCritique=(e,t)=>{const n=this._critiquesByNode.get(t)||new Map;n.delete(e)&&this.dispatchCritiquesForNode(n,t)}}clearNode(e,t){let n=!1;this._critiquesByNode.has(e)&&(this._critiquesByNode.delete(e),this._latestNodeVersion.has(e)&&this._latestNodeVersion.delete(e),n=!0),n&&this._critiqueDispatcher.dispatchCritiques(new Map,e,()=>{}),t&&this.dispatchAllCritiques()}getAllCritiques(){const e=[];return this._critiquesByNode.forEach((t,n)=>{const r=this.getCritiques(n);r&&e.push(r)}),e}getCritiques(e){const t=this._critiquesByNode.get(e);if(t){return{critiques:t,nodeId:e,nodeVersion:this._latestNodeVersion.get(e)||0}}}updateNode(e,t,n,r=!1){n>=(this._latestNodeVersion.get(t)||0)&&this._latestNodeVersion.set(t,n);const i=this._critiquesByNode.get(t);if(i){const n=e.length>0;e.forEach(e=>{switch(e.critiqueDiffType){case 0:case 2:i.set(e.critique.start,e.critique);break;case 4:i.delete(e.critique.start);break;case 1:e.oldStart&&i.delete(e.oldStart),i.set(e.critique.start,e.critique)}}),r?this.dispatchAllCritiques():n&&this.dispatchCritiquesForNode(i,t)}else this._critiquesByNode.set(t,new Map)}};ui=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),li(0,Object(kt.inject)(Gr.a.ICritiqueDispatcher)),li(1,Object(kt.inject)(Gr.a.ILogger))],ui);var di=function(e,t){return function(n,r){t(n,r,e)}};let fi=class{constructor(e,t){this._critiqueStore=e,this._logger=t}onEvent(e){if(e)switch(e.eventType){case 0:this._critiqueStore.updateNode([],e.nodeId,e.nodeVersion,!0);break;case 1:this._critiqueStore.clearNode(e.nodeId,!0)}else this._logger.log(589336981,Vt.e.Error,"NodeEventHandler: Received undefined event args.")}};fi=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),di(0,Object(kt.inject)(Gr.a.ICritiqueStore)),di(1,Object(kt.inject)(Gr.a.ILogger))],fi);var hi=n(10620);var gi=function(e,t){return function(n,r){t(n,r,e)}};let pi=class{constructor(e,t){this._critiqueStore=e,this._logger=t,this.calcLengths=e=>{let t=e.length||0,n=0,r=!1;switch(e.eventType){case 0:t=e.content?e.content.length:t,n=t;break;case 1:n=-t;break;case 2:n=e.content?e.content.length-t:n,r=0===t&&""===e.content}return{length:t,lengthDiff:n,forceReflow:r}},this.deletedDiff=(e,t,n,r=!1)=>{const i={offset:e.start,span:e.length},o={offset:t,span:n};if(Object(hi.b)(i,o)||r&&Object(hi.a)(i,o))return{critique:e,critiqueDiffType:4}}}onEvent(e){if(!e)return void this._logger.log(589336980,Vt.e.Error,"SpanEventHandler: Received undefined event args.");const t=this._critiqueStore.getCritiques(e.nodeId);if(t&&function(e,t){return e.critiques&&t>=e.nodeVersion}(t,e.nodeVersion)){const{length:n,lengthDiff:r,forceReflow:i}=this.calcLengths(e),o=[];t.critiques.forEach(t=>{const i=this.deletedDiff(t,e.position,n,2!==e.eventType);if(i)o.push(i);else if(t.start>=e.position&&0!==r){const e=t.start;t.start+=r,o.push({critique:t,critiqueDiffType:1,oldStart:e})}}),this._critiqueStore.updateNode(o,e.nodeId,e.nodeVersion,i)}}};pi=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(kt.injectable)(),gi(0,Object(kt.inject)(Gr.a.ICritiqueStore)),gi(1,Object(kt.inject)(Gr.a.ILogger))],pi);var mi=n(7690),yi=n(10598),bi=n(10600),vi=n(10601),_i=n(10602),Ii=n(10603),Si=n(10604),Ci=n(10605),Oi=n(10606),Ti=n(10607),Ei=n(10608),Pi=n(10609),wi=n(10610),ji=n(7798);const Ri={serializedName:"Descriptor",type:{name:"Composite",className:"Descriptor",modelProperties:{name:{required:!0,serializedName:"Name",type:{name:"String"}},value:{required:!0,serializedName:"Value",type:{name:"String"}}}}},xi={serializedName:"LookupWords",type:{name:"Composite",className:"LookupWords",modelProperties:{word:{required:!0,serializedName:"Word",defaultValue:"test",type:{name:"String"}},preContextText:{serializedName:"PreContextText",defaultValue:"",type:{name:"String"}},postContextText:{serializedName:"PostContextText",defaultValue:"",type:{name:"String"}}}}},Ai={serializedName:"LookupInput",type:{name:"Composite",className:"LookupInput",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},appVersion:{serializedName:"AppVersion",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},lookupWords:{required:!0,serializedName:"LookupWords",type:{name:"Sequence",element:{type:{name:"Composite",className:"LookupWords"}}}},mode:{required:!0,serializedName:"Mode",defaultValue:2,type:{name:"Number"}}}}},Ni={serializedName:"Synonym",type:{name:"Composite",className:"Synonym",modelProperties:{text:{required:!0,serializedName:"Text",defaultValue:"",type:{name:"String"}},tag:{serializedName:"Tag",defaultValue:"",type:{name:"String"}},tagInt:{serializedName:"TagInt",defaultValue:0,type:{name:"Number"}}}}},Di={serializedName:"Meaning",type:{name:"Composite",className:"Meaning",modelProperties:{text:{required:!0,serializedName:"Text",defaultValue:"",type:{name:"String"}},tag:{serializedName:"Tag",defaultValue:"",type:{name:"String"}},tagInt:{serializedName:"TagInt",defaultValue:0,type:{name:"Number"}},synonyms:{required:!0,serializedName:"Synonyms",type:{name:"Sequence",element:{type:{name:"Composite",className:"Synonym"}}}}}}},Fi={serializedName:"LookupResult",type:{name:"Composite",className:"LookupResult",modelProperties:{word:{required:!0,serializedName:"Word",defaultValue:"",type:{name:"String"}},meanings:{required:!0,serializedName:"Meanings",type:{name:"Sequence",element:{type:{name:"Composite",className:"Meaning"}}}}}}},ki={serializedName:"LookupOutput",type:{name:"Composite",className:"LookupOutput",modelProperties:{lookupResults:{required:!0,serializedName:"LookupResults",type:{name:"Sequence",element:{type:{name:"Composite",className:"LookupResult"}}}}}}},Mi={serializedName:"CommonAppIdProperty",type:{name:"Composite",className:"CommonAppIdProperty",modelProperties:{appId:{serializedName:"AppId",type:{name:"String"}}}}},Bi={serializedName:"CommonLanguageIdProperty",type:{name:"Composite",className:"CommonLanguageIdProperty",modelProperties:{languageId:{serializedName:"LanguageId",type:{name:"String"}}}}},Li={serializedName:"CommonAppVersionProperty",type:{name:"Composite",className:"CommonAppVersionProperty",modelProperties:{appVersion:{serializedName:"AppVersion",type:{name:"String"}}}}},qi={serializedName:"CommonDescriptorsProperty",type:{name:"Composite",className:"CommonDescriptorsProperty",modelProperties:{descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}}}}},Ui={serializedName:"postcheck-headers",type:{name:"Composite",className:"PostCheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}};var Hi=n(17179),Wi=n(16711);const Gi="@editor/synonym-client-rest-api",Vi="1.0.0";class zi extends Hi.a{constructor(e){if(e||(e={}),!e.userAgent){const t=Wi.b();e.userAgent=`${Gi}/${Vi} ${t}`}super(void 0,e),this.baseUri=e.baseUri||this.baseUri||"https://nlsynonymservice.osi.officeppe.net/",this.requestContentType="application/json; charset=utf-8",null!==e.xCorrelationId&&void 0!==e.xCorrelationId&&(this.xCorrelationId=e.xCorrelationId),null!==e.xUserSessionId&&void 0!==e.xUserSessionId&&(this.xUserSessionId=e.xUserSessionId),null!==e.xUserId&&void 0!==e.xUserId&&(this.xUserId=e.xUserId)}}class Ji extends zi{constructor(e){super(e)}postCheck(e,t,n){return this.sendOperationRequest({body:e,options:t},Ki,n)}}const $i=new ji.b(r),Ki={httpMethod:"POST",path:"NLSynonym/Lookup/V1",headerParameters:[{parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},{parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}},{parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}}],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},Ai),{required:!0})},responses:{200:{bodyMapper:ki,headersMapper:Ui},400:{headersMapper:Ui},500:{headersMapper:Ui},default:{}},serializer:$i};var Qi=n(15159),Zi=n(10623),Yi=n(3854);let Xi=class extends Zi.a{constructor(e){super(),this._hostSettings=e}update(e){this._updatedUserInfo=e}execute(e=!0,t){this._updatedUserInfo?this.userInfo=this._updatedUserInfo:this._hostSettings.userId&&(this.userInfo={userId:this._hostSettings.userId.puid,tenantId:this._hostSettings.userId.tenantId,email:void 0,licenseType:this._hostSettings.licenseType,identityProvider:this._hostSettings.userId.identityProvider}),this.triggerCallback(t)}};Xi=Object(i.__decorate)([Object(kt.injectable)(),Object(i.__param)(0,Object(kt.inject)(Yi.a.IHostSettings)),Object(i.__metadata)("design:paramtypes",[Object])],Xi);var eo=n(10589),to=n(9175);let no=class{constructor(e,t,n,r,i){this._guidGenerator=e,this._registrar=t,this._proofingPersistedStore=n,this._logger=r,this._featureFlagsReader=i}async initializeComponent(){this._featureFlagsReader.refreshFlags(),await this._logger.initialize(this._proofingPersistedStore),this._logger.debug(575930400,"Logger initialized"),eo.a.addUnhandledExceptionsListeners(this._logger,to.a.UnhandledContentError,"Unhandled async content script error"),this._logger.debug(575930401,"Initializing telemetry");const e=this._guidGenerator.generate();this._logger.addCorrelationID(e),this._logger.debug(575930402,"Registering listeners"),await this._registrar.initialize()}};no=Object(i.__decorate)([Object(kt.injectable)(),Object(i.__param)(0,Object(kt.inject)(Yi.a.IGuidGenerator)),Object(i.__param)(1,Object(kt.inject)(Yi.a.IRegistrar)),Object(i.__param)(2,Object(kt.inject)(Yi.a.IProofingPersistedStore)),Object(i.__param)(3,Object(kt.inject)(Yi.a.ILogger)),Object(i.__param)(4,Object(kt.inject)(Yi.a.IFeatureFlagsReader)),Object(i.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object])],no);let ro=class{constructor(e,t){this._proofingEmitter=e,this._localizationFileImporter=t}getMessage(e,t){return this._strings&&this._strings[e]?this._strings[e].message:""}async initialize(){this._proofingEmitter.on("proofingLanguageChanged",async e=>{this._strings=await this._localizationFileImporter.importStrings(e.data.defaultLanguageCode)})}async shutDown(){this._proofingEmitter.off("proofingLanguageChanged")}};var io;ro=Object(i.__decorate)([Object(kt.injectable)(),Object(i.__param)(0,Object(kt.inject)(Yi.a.IProofingEmitter)),Object(i.__param)(1,Object(kt.inject)(Yi.a.ILocalizationStringsImporter)),Object(i.__metadata)("design:paramtypes",[Object,Object])],ro),function(e){e.ImportLocalizationStringsFailed="ImportLocalizationStringsFailed",e.ImportLocalizationMappingStringsFailed="ImportLocalizationMappingStringsFailed"}(io||(io={}));let oo=class{constructor(e){this.logger=e}async importStrings(e){const t=await n.e(1450).then(n.t.bind(null,17065,3)).then(async e=>e.cultures).catch(()=>{this.logger.logEvent(589312539,io.ImportLocalizationMappingStringsFailed,Vt.e.Error,e,Vt.f.CriticalExperimentation)});let r=t&&t[e];return r||(r="en"),n(15165)(`./${r}/messages.json`).then(e=>e).catch(()=>{this.logger.logEvent(589312540,io.ImportLocalizationStringsFailed,Vt.e.Error,e,Vt.f.CriticalExperimentation)})}};oo=Object(i.__decorate)([Object(kt.injectable)(),Object(i.__param)(0,Object(kt.inject)(Yi.a.ILogger)),Object(i.__metadata)("design:paramtypes",[Object])],oo);var ao,so=n(6874);let co=ao=class extends mi.a{constructor(e,t,n,r){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=n,this._hostSettings=r,this.write(rt.a.AppId,this._hostSettings.appId)}populateStoreEntryMap(){const e=new Map;return e.set(rt.a.AppId,{storeEntry:Object(so.d)(rt.a.AppId,"EditorBX_Online")}),e.set(rt.a.EnableSpelling,{storeEntry:Object(so.d)(rt.a.EnableSpelling,!0),isSynced:!0}),e.set(rt.a.EnableGrammar,{storeEntry:Object(so.d)(rt.a.EnableGrammar,!0),isSynced:!0}),e.set(rt.a.EnableRefinements,{storeEntry:Object(so.d)(rt.a.EnableRefinements,!0),isSynced:!0}),e.set(rt.a.Descriptors,{storeEntry:Object(so.d)(rt.a.Descriptors,JSON.stringify([{name:"FlightIds",value:"Wac-WordEditorServiceSuggestionDescriptionsNoReferenceInformation-Treatment;Wac-WordEditorServiceMultipleGrammarCritiquesPerSentence-Treatment"}]))}),e.set(rt.a.ProofingLanguages,{storeEntry:Object(so.d)(rt.a.ProofingLanguages,["en-US"])}),e.set(rt.a.DefaultProofingLanguageInitialized,{storeEntry:Object(so.d)(rt.a.DefaultProofingLanguageInitialized,!1)}),e.set(rt.a.ProofingLanguageListInitialized,{storeEntry:Object(so.d)(rt.a.ProofingLanguageListInitialized,!1)}),e.set(rt.a.EnableEditor,{storeEntry:Object(so.d)(rt.a.EnableEditor,!0)}),e.set(rt.a.OverriddenCritiqueTypeOptions,{storeEntry:Object(so.d)(rt.a.OverriddenCritiqueTypeOptions,[])}),e.set(rt.a.ShowSynonyms,{storeEntry:Object(so.d)(rt.a.ShowSynonyms,!1)}),e.set(rt.a.TelemetryTenant,{storeEntry:Object(so.b)(rt.a.TelemetryTenant,JSON.stringify({tenantName:"NaturalLanguage",ariaTenantToken:ao.ARIA_TENANT_UUID,nexusTenantToken:1733}))}),e.set(rt.a.LogGroupName,{storeEntry:Object(so.b)(rt.a.LogGroupName,"EditorBx")}),e.set(rt.a.SendToAria,{storeEntry:Object(so.b)(rt.a.SendToAria,!0)}),e.set(rt.a.DefaultEventName,{storeEntry:Object(so.b)(rt.a.DefaultEventName,to.b.Diagnostics)}),e.set(rt.a.DefaultLoggingLevel,{storeEntry:Object(so.c)(rt.a.DefaultLoggingLevel,Vt.e.Info)}),e.set(rt.a.EnableTelemetry,{storeEntry:Object(so.d)(rt.a.EnableTelemetry,!0),isSynced:!0}),e.set(rt.a.DebugMode,{storeEntry:Object(so.c)(rt.a.DebugMode,!1)}),e.set(rt.a.ConfigurationId,{storeEntry:Object(so.b)(rt.a.ConfigurationId,"")}),e.set(rt.a.ClientId,{storeEntry:Object(so.d)(rt.a.ClientId,""),isSynced:!1}),e}async initialize(){await this.read(rt.a.EnableSpelling),await this.read(rt.a.EnableGrammar),await this.read(rt.a.EnableRefinements),await this.read(rt.a.EnableTelemetry),await this.read(rt.a.ConfigurationId),this._emitter.on(rt.a.EnableSpelling,async()=>{await this.read(rt.a.EnableSpelling)}),this._emitter.on(rt.a.EnableGrammar,async()=>{await this.read(rt.a.EnableGrammar)}),this._emitter.on(rt.a.EnableRefinements,async()=>{await this.read(rt.a.EnableRefinements)}),this._emitter.on(rt.a.EnableTelemetry,async()=>{await this.read(rt.a.EnableTelemetry)}),this._emitter.on(rt.a.ConfigurationId,async()=>{await this.read(rt.a.ConfigurationId)}),this._emitter.on(rt.a.OverriddenCritiqueTypeOptions,async()=>{await this.read(rt.a.OverriddenCritiqueTypeOptions)}),this._emitter.on(rt.a.ProofingLanguages,async()=>{await this.read(rt.a.ProofingLanguages)})}async shutDown(){this._emitter.off(rt.a.EnableSpelling),this._emitter.off(rt.a.EnableGrammar),this._emitter.off(rt.a.EnableRefinements),this._emitter.off(rt.a.EnableTelemetry),this._emitter.off(rt.a.ConfigurationId),this._emitter.off(rt.a.OverriddenCritiqueTypeOptions),this._emitter.off(rt.a.ProofingLanguages)}};co.ARIA_TENANT_UUID="71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",co=ao=Object(i.__decorate)([Object(kt.injectable)(),Object(i.__param)(0,Object(kt.inject)(Yi.a.IStoreEntryReader)),Object(i.__param)(1,Object(kt.inject)(Yi.a.IStoreEntryWriter)),Object(i.__param)(2,Object(kt.inject)(Yi.a.ISettingsEmitter)),Object(i.__param)(3,Object(kt.inject)(Yi.a.IHostSettings)),Object(i.__metadata)("design:paramtypes",[Object,Object,Object,Object])],co);let lo=class extends mi.a{constructor(e,t,n){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=n}populateStoreEntryMap(){const e=new Map;return e.set(on.CourtesyAttributes,{storeEntry:Object(so.b)(on.CourtesyAttributes,["data-gramm"]),isSynced:!1}),e.set(on.RootContentMaxLengthInChars,{storeEntry:Object(so.b)(on.RootContentMaxLengthInChars,2e3),isSynced:!1}),e}async initialize(){await this.read(on.CourtesyAttributes),await this.read(on.RootContentMaxLengthInChars),this._emitter.on(on.CourtesyAttributes,async()=>{await this.read(on.CourtesyAttributes)}),this._emitter.on(on.RootContentMaxLengthInChars,async()=>{await this.read(on.RootContentMaxLengthInChars)})}async shutDown(){this._emitter.off(on.RootContentMaxLengthInChars),this._emitter.off(on.CourtesyAttributes)}};lo=Object(i.__decorate)([Object(kt.injectable)(),Object(i.__param)(0,Object(kt.inject)(Yi.a.IStoreEntryReader)),Object(i.__param)(1,Object(kt.inject)(Yi.a.IStoreEntryWriter)),Object(i.__param)(2,Object(kt.inject)(Yi.a.ISettingsEmitter)),Object(i.__metadata)("design:paramtypes",[Object,Object,Object])],lo);let uo=class{constructor(e){this._container=e,this._initialized=!1}initializeComponent(){this._initialized||(Promise.all([n.e(26),n.e(1318)]).then(n.bind(null,17086)).then(e=>{e.createReactAppDIContainer(this._container),e.createReactApp(this._container.get(Yi.a.ILogger),this._container.get(Yi.a.IAppStateStore),this._container.get(Yi.a.IResourceUrlFormatter))}),this._initialized=!0)}};uo=Object(i.__decorate)([Object(kt.injectable)(),Object(i.__param)(0,Object(kt.inject)(Yi.a.Container)),Object(i.__metadata)("design:paramtypes",[kt.Container])],uo);let fo=class{constructor(){this.defaultUxLanguage="en-US",this.editorSpellcheckAttribute="data-ms-editor",this.completeTileTextUnit=wn.b.TextUnit.Sentence,this.partialTileTextUnit=wn.b.TextUnit.Phrase,this.emitRemoval=!0,this.styleObserverIntervalTime=1,this.styleSampleTime=10,this.reconcileTileNodeTime=3e3,this.enableTileNodeAutoReconciliation=!0,this.maxSuggestionItemsDisplayNumber=3,this.maxSuggestionDisplayPerLanguageNumber=2,this.maxProofingLanguages=3,this.fabricFontsDefinitionPath="fonts/fabric-icons.css",this.enableSplitSuggestionButton=!1,this.narrowOnChangeReconciliation=!1,this.schedulerDefaultWaitingTime=50,this.schedulerDefaultMaxTime=2e3,this.schedulerDefaultWaitingTimeIncrement=400,this.maxServiceContentLengthInChars=350,this.maxContentLengthInChars=2e4}};fo=Object(i.__decorate)([Object(kt.injectable)()],fo),Object(kt.decorate)(Object(kt.injectable)(),Qi.EventEmitter);const ho=e=>{const t=new kt.Container({defaultScope:"Singleton"});t.bind(Yi.a.Container).toConstantValue(t),t.bind(Yi.a.IComponentInitializer).to(no),t.bind(Yi.a.IReactComponentInitializer).to(uo),t.bind(Yi.a.IRegistrar).to(mt.a),t.bind(Yi.a.IDisabler).to(yt.a),t.bind(Yi.a.IEditorClientSettings).to(fo),Object(kt.multiBindToService)(t)(Yi.a.IEditorClientSettings)(Yi.a.IHostModelSettings,Yi.a.IPresentationSettings,Yi.a.IPresentationDomSettings,dr.a.IOrchestratorSettings),t.bind(Yi.a.IHostSettings).toConstantValue(e),t.bind(Yi.a.IFeatureFlagsReader).to(mi.c),t.bind(mi.g.IExtensionStorage).to(mi.b),t.bind(Yi.a.IStoreEntryReader).to(mi.h),t.bind(Yi.a.IStoreEntryWriter).to(mi.i),t.bind(Yi.a.ISystemPersistedStore).to(lo),Object(kt.multiBindToService)(t)(Yi.a.ISystemPersistedStore)(Yi.a.IHostModelPersistedStore),t.bind(Yi.a.IProofingPersistedStore).to(co),t.bind(Yi.a.IHostEmitter).to(Qi.EventEmitter),t.bind(Yi.b.IHostEmitterArray).toService(Yi.a.IHostEmitter),t.bind(Yi.a.IHostTilingEmitter).to(Lt),t.bind(Yi.a.ISettingsEmitter).to(mi.f),Object(kt.multiBindToService)(t)(Yi.a.ISettingsEmitter)(Yi.a.ISettingsEmitterBase),t.bind(Yi.a.IProofingEmitter).to(Qi.EventEmitter),t.bind(Yi.a.IProofingDom).to(Ht),(e=>{e.bind(Mt.a.IGraphNodeBuilderFactory).toFactory(e=>t=>{const n=e.container.get(Mt.a.INodeObserverFactory),r=e.container.get(Mt.a.IGraphNodeFactory),i=e.container.get(Mt.a.IDomFinderFactory),o=e.container.get(Mt.a.IParagraphNodesBuilderFactory);switch(t.nodeMetaType.nodeType){case Be.OutlineNode:return new Zt(n,r,e.container.get(Mt.a.IGraphNodeBuilderFactory),i,e.container.get(Mt.a.ILogger),t);case Be.TerminalNode:return new On(n,r,o,e.container.get(Mt.a.INodePoller),e.container.get(Mt.a.ITerminalNodeReader),e.container.get(Mt.a.ITerminalNodeWriter),e.container.get(Mt.a.ITileNodeReader),e.container.get(Mt.a.IHostModelSettings),e.container.get(Mt.a.IHostSettings),i,t.nodeMetaType,e.container.get(Mt.a.ILogger));case Be.TileNode:throw Error("Tile nodes don't need a builder.");case Be.ParagraphNode:throw Error("Paragraph nodes don't need a builder.")}})})(t),(e=>{e.bind(Mt.a.IShadowGraphFactory).toFactory(()=>()=>new vn)})(t),(e=>{e.bind(Mt.a.INodeObserverFactory).toFactory(e=>(t,n)=>{switch(t){case Le.DefaultOutlineNodeObserver:return new sn(e.container.get(Mt.a.IHostModelPersistedStore),e.container.get(Mt.a.IHostModelSettings),e.container.get(Mt.a.IMutationObserverFactory),e.container.get(Mt.a.ILogger),n?n.conditionalAttributeFilter:void 0);case Le.InputNodeObserver:return new ln(e.container.get(Mt.a.IMutationObserverFactory),e.container.get(Mt.a.ILogger));case Le.TerminalNodeObserver:return new En(e.container.get(Mt.a.IMutationObserverFactory),e.container.get(Mt.a.IHostSettings),e.container.get(Mt.a.ILogger),n?n.mutationContextBuilder:void 0,n?n.elementTransformers:void 0);case Le.AttributeObserver:return new Kt(e.container.get(Mt.a.IMutationObserverFactory),e.container.get(Mt.a.ILogger))}})})(t),(e=>{e.bind(Mt.a.IMutationObserverFactory).toFactory(()=>e=>new MutationObserver(e))})(t),(e=>{e.bind(Mt.a.IGraphNodeFactory).toFactory(e=>(t,n,r,i,o,a)=>{switch(t){case Be.OutlineNode:return new dn(e.container.get(Mt.a.IGuidGenerator),n,o,r,i);case Be.TerminalNode:return new In(e.container.get(Mt.a.IGuidGenerator),e.container.get(Mt.a.IHostModelSettings),n,r,i);case Be.TileNode:return new Nn(e.container.get(Mt.a.IGuidGenerator),e.container.get(Mt.a.ILogger),e.container.get(Mt.a.IWordCount),e.container.get(Mt.a.IHostModelPersistedStore),e.container.get(Mt.a.IHostModelSettings),e.container.get(Mt.a.IIndexReadjuster),e.container.get(Mt.a.INodePoller),e.container.get(Mt.a.ICritiquesBrokerFactory),e.container.get(Mt.a.ITerminalNodeReader),e.container.get(Mt.a.IProofingDom),e.container.get(Mt.a.ITextExtractor),e.container.get(Mt.a.IHostSettings),e.container.get(Mt.a.IHostTilingEmitter),t,n,a||e.container.get(Mt.a.IParagraphNodesBuilderFactory),r,i);case Be.ParagraphNode:throw Error("This factory cannot build Paragraph nodes.")}})})(t),(e=>{e.bind(Mt.a.IParagraphNodeFactory).toFactory(e=>(t,n)=>new hn(e.container.get(Mt.a.IGuidGenerator),e.container.get(Mt.a.IProofingDom),t,n))})(t),(e=>{e.bind(Mt.a.IParagraphNodesBuilderFactory).toFactory(e=>(t,n)=>new mn(e.container.get(Mt.a.IProofingPersistedStore),e.container.get(Mt.a.IParagraphNodeFactory),e.container.get(Mt.a.ITextUnitChunker),e.container.get(Mt.a.IHostModelSettings),e.container.get(Mt.a.IHostSettings),t,n))})(t),(e=>{e.bind(Mt.a.IDomFinderFactory).toFactory(e=>t=>{switch(t.finderId()){case qe.SelectorDomFinder:return new bn(e.container.get(Mt.a.IElementsRetriever),t.selectorsCb);case qe.TextDomFinder:return new Rn(e.container.get(Mt.a.ITextUnitChunker))}})})(t),(e=>{e.bind(Mt.a.ICritiquesBrokerFactory).toFactory(e=>t=>new rn(e.container.get(Mt.a.IProofingEmitter),e.container.get(Mt.a.IProofingDom),e.container.get(Mt.a.IProofingPersistedStore),e.container.get(Mt.a.ILogger),t,e.container.get(Mt.a.ICritiqueFilterer),e.container.get(Mt.a.IUpsellStore)))})(t),(e=>{e.bind(Mt.a.IConditionalAttributeFilterFactory).toFactory(()=>e=>new Yt(e))})(t),t.bind(Yi.a.IElementsRetriever).to(Dn),t.bind(Yi.a.ITileNodeReader).to(Fn),t.bind(Yi.a.ITerminalNodeReader).to(kn),t.bind(Yi.a.ITerminalNodeWriter).to(Bn),t.bind(Yi.a.IPreOrderTraverser).to(Ln),t.bind(Yi.a.INodePoller).to(Un),t.bind(Yi.a.IParagraphNodesBuilder).to(mn),t.bind(Yi.a.ITileNodeDictionary).to(Hn).inTransientScope(),t.bind(Yi.a.IParagraphNodeDictionary).to(Wn).inTransientScope(),t.bind(Yi.a.IWordDictionary).toDynamicValue(e=>{const t=e.container.get(Yi.a.IHostSettings);return t&&t.enableOrchestration?new zr(e.container.get(Yi.a.IProofingEmitter),t,e.container.get(Yi.a.IRoamingDictionaryFeature)):new Vn(e.container.get(Yi.a.IGuidGenerator),e.container.get(Yi.a.IProofingDom),e.container.get(Yi.a.INodePoller),t,e.container.get(Yi.a.IRoamingDictionaryFeature))}),t.bind(Yi.a.ICritiquesMessageEmitter).to(hr),t.bind(Yi.a.ITileCheckRequestBuilder).to(mr),t.bind(Yi.a.ITextTilesMessageProcessor).to(_r),t.bind(Yi.a.IInstrumentationMessageProcessor).to(Sr),t.bind(Yi.a.IDescriptorManager).to(Or),t.bind(Yi.a.ITileIdFormatter).to(Tr),t.bind(Yi.a.IBackgroundActivityFactory).toFactory(e=>t=>{const n=e.container.get(Yi.a.IHostEmitter);return new bt.a(t,n)}),t.bind(Yi.a.ILogger).to(vt.a),t.bind(Yi.a.IWordCount).to(yi.a),t.bind(Yi.a.IGuidGenerator).to(ut.a),t.bind(Yi.a.ITextNodeRangeBuilder).to(bi.a),t.bind(Yi.a.ITextExtractor).to(vi.a),t.bind(Yi.a.IIndexReadjuster).to(_i.a),t.bind(Yi.b.ITextUnitSeparator).to(Ii.a).whenTargetNamed(wn.b.TextUnit.Sentence),t.bind(Yi.b.ITextUnitSeparator).to(Si.a).whenTargetNamed(wn.b.TextUnit.Document),t.bind(Yi.b.ITextUnitSeparator).to(Si.a).whenTargetNamed(wn.b.TextUnit.Default),t.bind(Yi.a.ITextUnitChunker).to(Ci.a),t.bind(Yi.a.ICritiqueInterpreter).to(Jr),t.bind(Yi.a.IContentValidator).to(Kr),t.bind(Yi.b.ITextProcessor).to(Oi.a).inTransientScope().whenTargetNamed(Ti.a.HtmlEditTextProcessor),t.bind(Yi.b.ITextProcessor).to(Ei.a).inTransientScope().whenTargetNamed(Ti.a.ContentEditableTextProcessor),t.bind(Yi.a.ITextRetrieverFactory).toFactory(()=>e=>{let t;return t=e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement?new Pi.a(e):new wi.a(e),t}),t.bind(Yi.b.ICleanable).toService(Yi.a.ITextTilesMessageProcessor),t.bind(Yi.b.ICleanable).toService(Yi.a.IProofingDom),t.bind(Yi.b.ICleanable).to(Jn),t.bind(Yi.b.IRegistrable).toService(Yi.a.ISettingsEmitter),t.bind(Yi.b.IRegistrable).toService(Yi.a.ITextTilesMessageProcessor),t.bind(Yi.b.IRegistrable).to(Jn),t.bind(Yi.b.IRegistrable).to(Kn),t.bind(Yi.b.IRegistrable).toService(Yi.a.ISystemPersistedStore),t.bind(Yi.b.IRegistrable).toService(Yi.a.IProofingPersistedStore),t.bind(Yi.b.IRegistrable).toService(Yi.a.IFeatureFlagsReader),t.bind(Yi.a.IsUpsellUser).to(_t.a),t.bind(Yi.a.IsPremiumUser).to(It.a),t.bind(Yi.a.IsSignedInUser).to(St.a),t.bind(Yi.a.IUpsellFeature).to(Ct.a),t.bind(Yi.a.IExternalSettingsFeature).to(Ot.a),t.bind(Yi.a.IShowSynonymsFeature).to(Tt.b),t.bind(Yi.a.ICheckRefinementsFeature).to(Et.a),t.bind(Yi.a.IRoamingDictionaryFeature).to(Pt.a),t.bind(Yi.a.IUnsignedInEditorFeature).to(wt.b),e&&e.enableOrchestration&&(t.bind(Yi.b.EventHub).to(Zr),t.bind(Yi.b.IRegistrable).toService(Yi.b.EventHub),t.bind(Yi.a.CritiqueEventHandler).to(ni),t.bind(Yi.a.ICritiqueContextValidator).to(ii),t.bind(Yi.a.FilteringEventHandler).to(ai),t.bind(Yi.a.ICritiqueDispatcher).to(ci),t.bind(Yi.a.ICritiqueStore).to(ui),t.bind(Yi.a.NodeEventHandler).to(fi),t.bind(Yi.a.SpanEventHandler).to(pi)),t.bind(Yi.b.IRegistrable).toService(Yi.a.ICritiqueFilterer),t.bind(Yi.a.DictionaryCritiqueFilter).to(Zn),t.bind(Yi.a.ICritiqueFilterer).to(Xn),t.bind(Yi.a.IEnabledCritiqueTypes).to(nr),t.bind(Yi.a.PremiumCritiqueFilter).to(ir),t.bind(Yi.a.EnabledCritiqueTypesCritiqueFilter).to(ar),t.bind(Yi.a.IUpsellStore).to(ur),t.bind(Yi.a.IE2eMetric).to(jt.a),t.bind(Yi.b.IRegistrable).to(Rt.a),t.bind(Yi.b.IRegistrable).to(Pr),t.bind(Yi.a.IMultiLangTileCheckResponseTransformer).to(xr),t.bind(Yi.b.IRegistrable).to(Nr),t.bind(Yi.a.EditorService).toDynamicValue(e=>{const t=e.container.get(Yi.a.IHostSettings);return new Ft.a({baseUri:`https://nleditor.osi.${t.editorEndPoint}.net`})}),t.bind(Yi.a.SynonymService).toDynamicValue(e=>{const t=e.container.get(Yi.a.IHostSettings);return new Ji({baseUri:`https://nlsynonymservice.osi.${t.editorEndPoint}.net`})}),t.bind(Yi.a.ITileCheckResponseTransformer).to(Fr),t.bind(Yi.a.ISynonymFiller).to(Lr),t.bind(Yi.a.ISynonymRequestBuilder).to(Hr),t.bind(Yi.a.IRemoteSettingsSyncer).to(mi.e),t.bind(Yi.a.IUserInfoStrategy).to(Xi).inSingletonScope();const n=t.get(Yi.a.IUserInfoStrategy);return t.bind(Yi.a.IUserInfoUpdater).toConstantValue(n),t.bind(Yi.a.ISessionContextProvider).toProvider(e=>async()=>new Promise(e=>{const t=xt.a.detectBrowser();e({os:void 0,arch:void 0,browserType:t?t.name:"",browserVersion:t?t.version:null,extensionStoreId:"",languageUxId:"",extensionVersion:"",extensionVersionName:""})})),t.bind(mi.g.IBrowserStorageApi).to(mi.d),t.bind(Yi.a.ITransportLogger).to(At.a),t.bind(Yi.a.ITransportActivity).to(At.a),t.bind(Yi.a.ILocalizationStringsImporter).to(oo),t.bind(Yi.a.ILocalizer).to(ro),t.bind(Yi.b.IRegistrable).toService(Yi.a.ILocalizer),t.bind(Yi.a.IResourceUrlFormatter).to(Nt.a),t.bind(Yi.a.IUxLanguageDetector).to(Dt.a),t};class go{constructor(e,t){this.diContainer=ho(e),this.upsellFeatureObj=this.diContainer.get(Yi.a.IUpsellFeature),this.roamingDictionaryFeatureObj=this.diContainer.get(Yi.a.IRoamingDictionaryFeature),this.externalSettingsFeatureObj=this.diContainer.get(Yi.a.IExternalSettingsFeature),this.userInfoUpdater=this.diContainer.get(Yi.a.IUserInfoUpdater),this.isPremiumUser=this.diContainer.get(Yi.a.IsPremiumUser),this.logger=this.diContainer.get(Yi.a.ILogger),this.orchestrator=new ht(this.diContainer.get(Yi.a.IHostEmitter),this.diContainer.get(Yi.a.IHostSettings),this.diContainer.get(Yi.a.IGuidGenerator),this.diContainer.get(Yi.a.IDescriptorManager),this.logger,this.diContainer.get(Yi.a.IE2eMetric),t),e&&!0===e.enableOrchestration&&(this.eventHub=this.diContainer.get(Yi.b.EventHub)),this.init()}spellCheck(e,t){const n=this.diContainer.get(Yi.a.IGraphNodeBuilderFactory),r=this.diContainer.get(Yi.a.IProofingDom),i=n({ruleName:"",nodeMetaType:{nodeType:Be.TerminalNode,observerType:Le.TerminalNodeObserver,mutationContextBuilder:void 0,elementsFinder:{finderId:()=>qe.TextDomFinder,selectorsCb:()=>[]},filters:[],filterSelector:t},childMetaType:null}).buildNode(e,void 0);return r.addNode(i),i}detach(e){this.diContainer.get(Yi.a.IWordDictionary).clearIgnoredWords(),this.diContainer.get(Yi.a.IProofingDom).removeNode(e)}async setLocale(e){this.diContainer.get(Yi.a.IProofingPersistedStore).write(rt.a.ProofingLanguages,[e]),this.diContainer.get(Yi.a.IProofingEmitter).emit("proofingLanguageChanged",{data:new it.a([e]),messageType:ot.a.ChangeData})}async setMultiLingualProofingLocales(e){this.diContainer.get(Yi.a.IProofingPersistedStore).write(rt.a.ProofingLanguages,e),this.diContainer.get(Yi.a.IProofingEmitter).emit("proofingLanguageChanged",{data:new it.a(e),messageType:ot.a.ChangeData})}async enableSpelling(){await this._enableDisableSpelling(!0)}async disableSpelling(){await this._enableDisableSpelling(!1)}async enableGrammar(){await this._enableDisableGrammar(!0)}async enableRefinements(){await this._enableDisableRefinements(!0)}async setOverriddenCritiqueTypeOptions(e){await this.diContainer.get(Yi.a.IProofingPersistedStore).write(rt.a.OverriddenCritiqueTypeOptions,e),this.diContainer.get(Yi.a.IEnabledCritiqueTypes).setOverriddenCritiqueTypes(e),this.diContainer.get(Yi.a.IProofingEmitter).emit("enabledCritiqueTypesChanged",{messageType:ot.a.ChangeData}),this._refreshTileNodes()}async disableGrammar(){await this._enableDisableGrammar(!1)}async disableRefinements(){await this._enableDisableRefinements(!1)}async isSpellingEnabled(){return this.diContainer.get(Yi.a.IProofingPersistedStore).read(rt.a.EnableSpelling)}async isGrammarEnabled(){return this.diContainer.get(Yi.a.IProofingPersistedStore).read(rt.a.EnableGrammar)}async areRefinementsEnabled(){return this.diContainer.get(Yi.a.IProofingPersistedStore).read(rt.a.EnableRefinements)}async _enableDisableSpelling(e){await this.diContainer.get(Yi.a.IProofingPersistedStore).write(rt.a.EnableSpelling,e),this._refreshTileNodes()}async _enableDisableGrammar(e){await this.diContainer.get(Yi.a.IProofingPersistedStore).write(rt.a.EnableGrammar,e),this._refreshTileNodes()}async _enableDisableRefinements(e){await this.diContainer.get(Yi.a.IProofingPersistedStore).write(rt.a.EnableRefinements,e),this._refreshTileNodes()}_refreshTileNodes(){const e=this.diContainer.get(Yi.a.IProofingDom);this.diContainer.get(Yi.a.INodePoller).pollNodes(ot.a.ChangeData,e.tileNodes)}shutDown(){try{this.orchestrator.shutDown(),this.eventHub&&this.eventHub.shutDown();const e=document.querySelectorAll("editor-card");Array.from(e).forEach(e=>{e.remove()}),this.diContainer.get(Yi.a.IDisabler).disableContentScript()}catch(e){this.logger.error(575930397,"error while removing the editor-card from the DOM.")}}get upsellFeature(){return this.upsellFeatureObj}get roamingDictionaryFeature(){return this.roamingDictionaryFeatureObj}get externalSettingsFeature(){return this.externalSettingsFeatureObj}enablePremiumUntil(e){this.isPremiumUser.setGracePeriodUntil(e)}updateUserInfo(e){this.userInfoUpdater.update(e)}async init(){Object(pt.configure)({enforceActions:"observed"}),this.orchestrator.initialize(),this.eventHub&&await this.eventHub.initialize();this.diContainer.get(Yi.a.IRemoteSettingsSyncer).schedule(1e3,3e5);const e=this.diContainer.get(Yi.a.IComponentInitializer);await e.initializeComponent();const t=this.diContainer.get(Yi.a.IHostSettings);await this.setLocale(t.defaultLocale);const n=this.diContainer.get(Yi.a.IUserInfoStrategy);try{await n.executeAsync(!0),this.diContainer.get(Yi.a.IReactComponentInitializer).initializeComponent()}catch(e){}}setAvailableCritiqueTypes(e){this.diContainer.get(Yi.a.IEnabledCritiqueTypes).setAvailableCritiqueTypes(e),this.diContainer.get(Yi.a.IProofingEmitter).emit("enabledCritiqueTypesChanged",{messageType:ot.a.ChangeData})}setPreviewCritiquesCount(e,t){const n=this.diContainer.get(Yi.a.IUpsellStore);n.setPreviewModeActive(!0),n.setPreviewCount(e,!0),n.setPreviewUnit(t)}setPremiumPreviewActive(e){this.diContainer.get(Yi.a.IUpsellStore).setPreviewModeActive(e)}setLightUpPremiumSquiggles(e){this.diContainer.get(Yi.a.IUpsellStore).setLightUpPremiumSquiggles(e)}onPremiumCountChange(e){this.diContainer.get(Yi.a.IUpsellStore).setOnPremiumCountChange(e)}onPreviewCritiquesCountChange(e){this.diContainer.get(Yi.a.IUpsellStore).setOnPreviewCritiquesCountChange(e)}onTryPremiumPreview(e){this.diContainer.get(Yi.a.IUpsellStore).setOnTryPremiumPreview(e)}onPremiumPreviewExpired(e){this.diContainer.get(Yi.a.IUpsellStore).setOnPremiumPreviewExpired(e)}}var po=n(10640),mo=n(10580),yo=n(9053),bo=n(1073),vo=n(10581),_o={},Io="https://go.microsoft.com/fwlink/?linkid=2125008";function So(e,t,n,r,i){return _o[e]?_o[e]:function(e,t,n,r,i){var o,a,c=Object(x.h)(),l=Object(O.i)("mc-officeEditorALEnabled"),u=Object(vo.a)(),d=r===s.a.New&&(Object(O.i)("mc-officeEditorUpsellSkittleBasedOnDate")||Object(O.i)("mc-officeEditorUpsellSkittleBasedOnCount"));l&&(i||Object(j.r)("ProofingALSessionNull"));return _o[e]=new go({enableOrchestration:l,orchestratorSettings:{enableAugLoop:l,augLoopEndpoint:Object(mo.a)()},useShadowDom:!1,appId:"Outlook_Online",defaultLocale:t,controlIconSetName:bo.a.fontFileName,showOptionsButton:!1,showCalloutBranding:!1,editorEndPoint:Object(O.i)("ring-dogfood")?Ft.b.Staging:Ft.b.Prod,ignoreAllEnabled:!0,ignoreOnceEnabled:!0,sessionType:"Edit"===n?po.a.OWA_Draft_Email:po.a.OWA_New_Email,enableUrlClassifier:!0,userId:{identityProvider:p(),puid:null===(o=c.SessionSettings)||void 0===o?void 0:o.UserPuid,tenantId:null===(a=c.SessionSettings)||void 0===a?void 0:a.ExternalDirectoryTenantGuid},showTeachingUi:!1,showSquiggleTooltip:Object(O.i)("mc-officeEditorBXTooltip"),licenseType:Object(yo.b)(),upsellLink:Io,manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enableOptimizedCallingPattern:!0,flightsToTrack:u,enableRoamingDictionary:!0,enhancedUpsellEnabled:!0,premiumPreviewEnabled:d,maxSuggestionDisplayPerLanguageNumber:2,maxSuggestionItemsDisplayNumber:3,newLineSentenceSeparatorEnabled:Object(O.i)("mc-officeEditorNewSentenceSeparator"),simplifiedHostModelEnabled:Object(O.i)("mc-officeEditorSimplifiedHostModel"),enableE2eMetric:Object(O.i)("mc-officeEditorE2eMetric")},i),_o[e]}(e,t||Object(x.j)(),n,r,i)}function Co(e,t,n,r){var i,o,a=So(e,null,null,t.premiumPreviewStatus,null);t.premiumPreviewType===s.b.TimeBased?(i=sr.b.Days,o=n):t.premiumPreviewType===s.b.CountBased&&(i=sr.b.Suggestions,o=r),a.setPremiumPreviewActive(!0),a.setPreviewCritiquesCount(o,i)}var Oo=n(5490),To=n(213),Eo=Object(N.a)((function(e){var t,n=e.viewState,r=n.skittleViewStatus,i=n.premimumFlagsFound,o=n.premiumCategories,u=n.skittleCalloutStatus,d=n.premiumPreviewData,f=n.editorProofingId,h=A.useRef(),g=A.useRef(),p="Show"===r,y=d.premiumPreviewStatus===s.a.Activated,_=d.premiumPreviewStatus===s.a.New,I=function(t){Ge(e.viewState,t)},S=A.useCallback((function(e){y||So(f,null,null,d.premiumPreviewStatus,null).setLightUpPremiumSquiggles(e)}),[d.premiumPreviewStatus]),C=y?null:i,O=A.useCallback((function(){!function(e){var t;switch(e){case s.a.Activated:t=De;break;case s.a.Expired:t=Fe;break;case s.a.Unknown:t=Ne;break;case s.a.New:t=ke;break;default:Object(l.a)(e)}t&&Object(j.r)(t,null,{isCore:!0,isCosmosDatapoint:!0})}(d.premiumPreviewStatus),I(m.a.ShowCallout),Ve(e.viewState,"skittle"),_&&S(!0),g.current.focus()}),[d.premiumPreviewStatus,e.viewState]),T=A.useCallback((function(){_&&S(!1)}),[d.premiumPreviewStatus]),E=A.useCallback((function(t,n){a(e.viewState,d.premiumPreviewType,t,!0,n),Co(f,d,c.e,c.f),I(m.a.Hide),Pe(d.premiumPreviewSource,!1)}),[]),P=A.useCallback((function(){I(m.a.Hide)}),[]),w=1===(t=i)?Object(b.b)(v.m):t>1?Object(b.c)(Object(b.b)(v.n),t.toString()):Object(b.b)(v.l),R=_?A.createElement(Re,{onTryItNowClick:E,premiumPreviewData:d,onHoverPremiumPreview:S}):A.createElement(nt,{premiumCategories:o,premimumFlagsFound:i,premiumPreviewData:d});return p?A.createElement("div",{className:Oo.skittleContainer},A.createElement("div",{ref:h},A.createElement(q.a,{"aria-label":w,className:Oo.skittleInfo,onMouseEnter:O,onMouseLeave:T,onClick:O},A.createElement("span",{className:To([Oo.skittleCount,0==i&&Oo.hideCount])},C),A.createElement(D.a,{iconName:"Diamond",className:Oo.skittleDiamonIcon}))),A.createElement(F.a,{hidden:u!==m.a.ShowCallout,className:Oo.reservationStatusCallout,gapSpace:3,onDismiss:P,directionalHint:k.DirectionalHint.topRightEdge,isBeakVisible:!1,target:h.current},A.createElement(Me.a,{ref:function(e){return g.current=e},shouldFocusInnerElementWhenReceivedFocus:!0,"data-is-focusable":!0},R)),u===m.a.ShowDialog&&A.createElement(Ae,{onDismiss:P,onTryItNowClick:E,premiumPreviewData:d})):null})),Po=n(34),wo=n(750),jo=n(9057);function Ro(e,t){return t?Object(jo.a)()&&((null==e?void 0:e.spellCheckEnabled)||(null==e?void 0:e.grammarEnabled))&&Object(d.a)(null==e?void 0:e.proofingLocale):Object(jo.a)()}var xo=n(3169),Ao=n(1678),No=n(9056),Do=n(7056),Fo=[{id:"818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",name:"Frequently confused words",defaultCritiqueValue:1},{id:"5cb7fc16-cd78-449c-86d9-5d047be21ac4",name:"Adjective Used instead of Adverb",defaultCritiqueValue:1},{id:"f57c12d6-03e4-4f48-9b7b-f95802a6c669",name:"Agreement within Noun Phrases",defaultCritiqueValue:1},{id:"63e72d3d-62d7-4e73-8d66-c137d8841121",name:"Capitalization",defaultCritiqueValue:1},{id:"fd8f4ff7-fa09-492c-9c74-1a6b9f71e488",name:"Comma Missing after Introductory Phrase",defaultCritiqueValue:1},{id:"72e604b0-a185-413b-bd45-ad555288c746",name:"Comma Splice",defaultCritiqueValue:1},{id:"aea1e72a-abf4-4cc8-8b7a-43d15be8fc55",name:"Commonly Confused Words",defaultCritiqueValue:1},{id:"02c15397-df70-4f00-aa4d-7269e6d4e712",name:"Comparative Use",defaultCritiqueValue:1},{id:"84275a90-df79-4b9e-a208-9ec8b5e59622",name:"Hyphenation",defaultCritiqueValue:1},{id:"7c2ff4d7-41a9-4310-949b-863a0dfa4257",name:"Incorrect Verb Form after Auxiliary",defaultCritiqueValue:1},{id:"6dbfae4c-9818-4dec-a769-2595168927f2",name:"Indefinite Article",defaultCritiqueValue:1},{id:"f1a2ad0b-0b26-4bb5-aede-e88c9fe47492",name:"Possessive and Plural Forms",defaultCritiqueValue:1},{id:"3f2eda01-e8a5-4ed9-9494-6de566bc5333",name:"Punctuation",defaultCritiqueValue:1},{id:"76e3d0aa-bb80-461e-89c3-9fa640190616",name:"Question Mark Missing",defaultCritiqueValue:1},{id:"6d1d8c3d-62d5-45d1-b850-d8a98a24964b",name:"Spacing",defaultCritiqueValue:1},{id:"d7746119-e7e5-4e97-9979-bcd2114f9fe9",name:"Subject-Verb Agreement",defaultCritiqueValue:1},{id:"27783a58-c44f-4778-9856-36d9eab63693",name:"Too Many Determiners",defaultCritiqueValue:1},{id:"352579fc-6ae6-4eb1-8d3b-895ab239714e",name:"Verb Use",defaultCritiqueValue:1}];function ko(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return Object(h.a)()?[2,Fo]:[2,d.c.importAndExecute()]}))}))}var Mo=n(2226),Bo=n(8424),Lo=n(1864),qo=15e4;function Uo(e,t){var n=(null==e?void 0:e.content.length)>qo;return n&&Object(Lo.a)(t,"proofingDiabledDueToSize"),n}var Ho=n(5);function Wo(e){if(!e)return c.b;var t=function(e){var t=new Date(e);return Object(Ho.Qb)(Object(x.h)().UserOptions.TimeZone,t.getFullYear(),t.getMonth(),t.getDate())}(e);return Object(Ho.Gb)(Object(Ho.Pb)(),t)?Object(Ho.u)(t,Object(Ho.Pb)())+1:c.a}function Go(e,t,n){var r=Object(O.i)("mc-officeEditorUpsellSkittleBasedOnDate")?s.b.TimeBased:Object(O.i)("mc-officeEditorUpsellSkittleBasedOnCount")?s.b.CountBased:s.b.BasicSkittle;if(r!==s.b.None){var i=Wo(e);a(n,r,i,!1,t)}}var Vo=n(10578),zo="EditorProofing_CritiqueClicked",Jo=1e3,$o=function(){function e(e,t,n,r,o,a){var c=this;this.adapter=e,this.editorAdapter=t,this.augloopSessionAdapter=n,this.composeOperation=r,this.isCalendar=o,this.infoBarViewState=a,this.getOptionsAndUpdateEditorClient=function(){d.d.importAndExecute((function(e){c.proofingOptions=e,Object(d.a)(e.proofingLocale)?(c.updateEditorProofingOptionsBasedOnSettings(),c.proofingOptions.spellCheckEnabled||c.proofingOptions.grammarEnabled?c.nodeBeingChecked?(c.stopProofing(),c.startProofing()):c.startProofing():c.stopProofing(),c.reProofDocument()):(Object(j.r)("LocaleProofingNotSupported",{locale:e.proofingLocale}),c.stopProofing())}))},this.onSettingsDialogButtonClicked=function(){var e=c.adapter().premiumPreviewData;e.premiumPreviewStatus===s.a.New?(Ve(c.adapter(),"settings"),Ge(c.adapter(),m.a.ShowDialog)):(d.e.importAndExecute(),Ie("SettingsCompose",e,""))},this.reactToRoamingDictionaryInitialized=function(e){return Po.g.info("[roamingDictionary] reactToRoamingDictionaryInitialized"),c.roamingDictionary?(Po.g.info("[roamingDictionary] reactToRoamingDictionaryInitialized: enabling feature"),[_.a.EnableFeature,{roamingDictionary:c.roamingDictionary}]):(Po.g.info("[roamingDictionary] reactToRoamingDictionaryInitialized: roamingDictionary not created disabling feature"),[_.a.DisableFeature,{roamingDictionary:void 0}])},this.reactToCritiqueClicked=function(e){Po.g.info("[ProofingPlugin] reactToCritiqueClicked");var t=c.adapter().premiumPreviewData;if(!e.critique)return[_.a.NoReaction,{upsellLink:void 0}];e.critique.priority===I.b.Low&&(Po.g.info("[ProofingPlugin] triggering floodgate survey in 1 second"),setTimeout((function(){Mo.b.import().then((function(e){e("ProofingRefinementClicked")}))}),Jo));var n=ae(t.premiumPreviewType,t.premiumPreviewStatus,"ContexualCard",e.critique.priority===I.b.High);return Object(j.r)(zo,{type:w(e.critique.priority),showUpsell:Object(jo.a)()},{isCosmosDatapoint:!0}),[_.a.EnableFeature,{upsellLink:n}]},this.reactToUpsellClicked=function(e){var t;Po.g.info("[ProofingPlugin] reactToUpsellClicked");var n=c.adapter().premiumPreviewData;Ie("ContexualCard",n,w(null===(t=e.critique)||void 0===t?void 0:t.priority)),c.tryStartTrial();var r=e.sender===S.c.Outlook?void 0:ae(n.premiumPreviewType,n.premiumPreviewStatus,"ContexualCard",e.critique.priority===I.b.High);return[_.a.EnableFeature,{upsellLink:r}]},this.tryStartTrial=function(){d.h.importAndExecute((function(){var e,t,n=Object(x.h)();c.editorClient.updateUserInfo({userId:null===(e=n.SessionSettings)||void 0===e?void 0:e.UserPuid,tenantId:null===(t=n.SessionSettings)||void 0===t?void 0:t.ExternalDirectoryTenantGuid,email:void 0,identityProvider:p(),licenseType:g.b.Subscription}),c.getOptionsAndUpdateEditorClient()}))},this.updateEditorProofingOptionsBasedOnSettings=function(){return Object(i.__awaiter)(c,void 0,void 0,(function(){var e,t,n,r,o,a,s,c;return Object(i.__generator)(this,(function(l){switch(l.label){case 0:return e=this.proofingOptions,t=e.spellCheckEnabled,n=e.grammarEnabled,r=e.writingRefinementsEnabled,o=e.proofingLocale,this.editorClient?(t?this.editorClient.enableSpelling():this.editorClient.disableSpelling(),n?this.editorClient.enableGrammar():this.editorClient.disableGrammar(),r&&Object(Do.a)()?this.editorClient.enableRefinements():this.editorClient.disableRefinements(),[4,ko()]):[2];case 1:return a=l.sent(),[4,d.b.importAndExecute()];case 2:return s=l.sent(),a&&this.editorClient.setAvailableCritiqueTypes(a),s&&(c=Object(i.__spread)(s.values()),this.editorClient.setOverriddenCritiqueTypeOptions(c)),this.editorClient.setLocale(o),[2]}}))}))},this.handleProofingCreateUndoCheckpointEvent=function(e){c.editor.addUndoSnapshot()},this.sessionId=Object(R.a)()}return e.prototype.getName=function(){return"Proofing"},e.prototype.initialize=function(e){this.editor=e,Po.g.info("[ProofingPlugin] initialize: "+this.editor),Uo(this.editorAdapter(),this.infoBarViewState)?this.temporarilyDisableProofing():this.initializeProofingEditorClient()},e.prototype.dispose=function(){var e,t=this.adapter();t.premiumPreviewData.premiumPreviewType===s.b.CountBased&&d.i.importAndExecute("premiumSuggestionsCount",t.premiumPreviewData.premiumSuggestionsCount),this.editorClient&&(this.roamingDictionary&&Bo.c.importAndExecute(),this.stopProofing(),this.editorClient.shutDown(),this.editorClient=null),this.editor=null,e=t.editorProofingId,delete _o[e],Object(O.i)("mc-officeEditorALEnabled")&&Vo.a.importAndExecute(this.augloopSessionAdapter().sessionId)},e.prototype.setPluginUtils=function(e){this.utils=e},e.prototype.onPluginEvent=function(e){if(7==e.eventType)switch(e.source){case"UpgradeCompose":Uo(this.editorAdapter(),this.infoBarViewState)&&this.temporarilyDisableProofing();break;case"_ShowEditorSettingsSource":this.showEditorSettings(e.data)}},e.prototype.getUIComponentClass=function(){return Eo},e.prototype.showEditorSettings=function(e){var t=function(e){var t,n,r=e.premiumPreviewData,i=r.premiumPreviewStatus;if(i===s.a.New)0===e.premimumFlagsFound?t=Object(b.b)(y.d):1===e.premimumFlagsFound?t=Object(b.b)(y.a):e.premimumFlagsFound>1&&(t=Object(b.c)(Object(b.b)(y.b),e.premimumFlagsFound.toString())),n=Object(b.b)(y.k);else if(i===s.a.Activated){if(r.premiumPreviewType===s.b.TimeBased){var o=void 0;o=1===r.numberOfDaysLeftToUsePremiunSuggestions?y.f:y.e,t=Object(b.c)(Object(b.b)(o),r.numberOfDaysLeftToUsePremiunSuggestions)}else if(r.premiumPreviewType===s.b.CountBased){var a=void 0;a=1===r.premiumSuggestionsCount?y.g:y.h,t=Object(b.c)(Object(b.b)(a),r.premiumSuggestionsCount)}n=Object(b.b)(y.j)}else i!==s.a.Expired&&r.premiumPreviewType!==s.b.BasicSkittle||(e.premimumFlagsFound>0&&(t=Object(b.c)(Object(b.b)(y.c),e.premimumFlagsFound.toString())),n=Object(b.b)(v.t));return{upsellString:t=t||Object(b.b)(y.i),buttonString:n}}(this.adapter()),n=t.upsellString,r=t.buttonString;Po.g.info("[ProofingPlugin] showEditorSettings"),d.f.importAndExecute(e,this.isCalendar?No.a.CalendarComposeToolbar:No.a.MailComposeToolbar,this.getOptionsAndUpdateEditorClient,this.onSettingsDialogButtonClicked,n,r)},e.prototype.temporarilyDisableProofing=function(){var e;ze(this.adapter()),null===(e=this.editor)||void 0===e||e.setEditorDomAttribute("spellCheck","true"),this.stopProofing()},e.prototype.setEditorClientData=function(e){var t=this;d.d.importAndExecute((function(n){t.proofingOptions=n,t.editor&&(Ro(n,!0)&&He(t.adapter()),Go(n.finalDatePremiumDemo,n.premiumSuggestionsCount,t.adapter()),t.editorClient=So(t.adapter().editorProofingId,t.getDefaultProofingLocale(),t.composeOperation,t.adapter().premiumPreviewData.premiumPreviewStatus,e),t.attachUpsellCallbacks(),t.getOptionsAndUpdateEditorClient())}))},e.prototype.initializeProofingEditorClient=function(){var e=this;if(Object(xo.a)())if(Object(O.i)("mc-officeEditorALEnabled")){var t=this.augloopSessionAdapter().sessionId;Vo.b.import().then((function(n){n(t).then((function(n){e.editor&&(Po.g.info("[augloopSession]. Proofing plugin with Id:"+t),e.setEditorClientData(n))})).then((function(){e.editorClient&&e.editor&&e.getOptionsAndUpdateEditorClient()}))}))}else this.setEditorClientData(null)},e.prototype.attachUpsellCallbacks=function(){var e=this,t=this.adapter().premiumPreviewData;Ro(void 0,!1)&&this.editorClient.onPremiumCountChange((function(t,n){We(e.adapter(),t,n),!e.loggedPremiumSuggestionsFound&&t>0&&(Object(j.r)(c.c,null,{isCore:!0,isCosmosDatapoint:!0}),e.loggedPremiumSuggestionsFound=!0)})),t.premiumPreviewStatus===s.a.New&&this.editorClient.onTryPremiumPreview((function(t){Ve(e.adapter(),"contextualCard"),Ge(e.adapter(),m.a.ShowDialog)})),t.premiumPreviewType===s.b.CountBased&&t.premiumPreviewStatus!==s.a.Expired&&(this.editorClient.onPremiumPreviewExpired((function(){Ge(e.adapter(),m.a.ShowCallout),u(e.adapter(),t.numberOfDaysLeftToUsePremiunSuggestions,s.a.Expired,s.b.CountBased,c.g)})),this.editorClient.onPreviewCritiquesCountChange((function(n){u(e.adapter(),t.numberOfDaysLeftToUsePremiunSuggestions,s.a.Activated,s.b.CountBased,n)})));var n=this.editorClient.upsellFeature;n.ignoreDisablers=!0,n.addListener(S.a.CritiqueClicked,this.reactToCritiqueClicked),n.addListener(S.a.UpsellButtonClicked,this.reactToUpsellClicked),this.editorClient.roamingDictionaryFeature.addListener(C.a.ClientInitialized,this.reactToRoamingDictionaryInitialized)},e.prototype.startProofing=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,o,a=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.editorClient?(this.updateEditorProofingOptionsBasedOnSettings(),this.logEvent("EditorProofing_SessionStart"),e=this.adapter(),t=this.adapter().premiumPreviewData,Ro(this.proofingOptions,!0)?(He(e),Object(j.r)(c.d)):Ue(e),t.premiumPreviewStatus===s.a.Activated&&Co(e.editorProofingId,t,t.numberOfDaysLeftToUsePremiunSuggestions,t.premiumSuggestionsCount),this.roamingDictionary?[3,3]:(Po.g.info("[roamingDictionary] startProofing: getting roaming dictionary"),[4,Bo.a.import()])):[3,4];case 1:return n=i.sent(),r=this,[4,n()];case 2:r.roamingDictionary=i.sent(),Po.g.info("[roamingDictionary]startProofing: got roaming dictionary"),i.label=3;case 3:this.editor&&(this.editor.setEditorDomAttribute("spellCheck","false"),o=Object(Ao.getEntitySelector)("WATERMARK_WRAPPER"),this.nodeBeingChecked=this.utils.spellCheck(this.editorClient,".suggestedCompletion, .SonoraInlineHint, a, blockquote, "+o),document.addEventListener("createUndoCheckpoint",this.handleProofingCreateUndoCheckpointEvent),this.resizeObserver=new wo.default((function(e){a.reProofDocument()})),this.utils.observeResize(this.resizeObserver,{box:"border-box"})),i.label=4;case 4:return[2]}}))}))},e.prototype.reProofDocument=function(){var e,t;null===(t=null===(e=this.nodeBeingChecked)||void 0===e?void 0:e.children)||void 0===t||t.forEach((function(e){e.reconcile(void 0,!0)}))},e.prototype.logEvent=function(e){var t=this.proofingOptions,n=t.spellCheckEnabled,r=t.grammarEnabled,i=t.writingRefinementsEnabled;Object(j.r)(e,{sessionId:this.sessionId,spelling:n,grammar:r,refinements:i})},e.prototype.stopProofing=function(){var e;this.editorClient&&this.nodeBeingChecked&&(this.logEvent("EditorProofing_SessionEnd"),null===(e=this.editor)||void 0===e||e.setEditorDomAttribute("spellCheck","true"),this.editorClient.detach(this.nodeBeingChecked),this.nodeBeingChecked=null,document.removeEventListener("createUndoCheckpoint",this.handleProofingCreateUndoCheckpointEvent)),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)},e.prototype.getDefaultProofingLocale=function(){var e,t;return(null===(e=this.proofingOptions)||void 0===e?void 0:e.proofingLocale)?null===(t=this.proofingOptions)||void 0===t?void 0:t.proofingLocale:Object(x.j)()},e}(),Ko=n(2337),Qo=n(1579),Zo=n(882),Yo=n(10641),Xo=Object(N.a)((function(e){var t=Zo.b.ProofingTeachingFreeUserFRE,n=Object(b.b)(Yo.d),r=Object(b.b)(Yo.a),i=Object(b.b)(Yo.c),o=function(){Object(Zo.e)(t)};return A.createElement(Zo.a,{lid:Zo.b.ProofingTeachingFreeUserFRE,when:function(e){setTimeout(e,1500)}},A.createElement(Qo.a,{calloutProps:{beakWidth:12,directionalHint:k.DirectionalHint.topCenter},targetElement:e.target(),hasCloseIcon:!0,onDismiss:o,hasSmallHeadline:!0,headline:n,primaryButtonProps:{buttonType:Ko.a.primary,children:i,onClick:o}},r))})),ea=Object(N.a)((function(e){var t=Zo.b.ProofingTeachingPremiumUserFRE,n=Object(b.b)(Yo.e),r=Object(b.b)(Yo.b),i=Object(b.b)(Yo.c),o=function(){Object(Zo.e)(t)};return A.createElement(Zo.a,{lid:Zo.b.ProofingTeachingPremiumUserFRE,when:function(e){setTimeout(e,1500)}},A.createElement(Qo.a,{calloutProps:{beakWidth:12,directionalHint:k.DirectionalHint.topCenter},targetElement:e.target(),hasCloseIcon:!0,onDismiss:o,hasSmallHeadline:!0,headline:n,primaryButtonProps:{buttonType:Ko.a.primary,children:i,onClick:o}},r))})),ta=Object(N.a)((function(e){var t=e.target,n=Object(Do.a)();return A.createElement(A.Fragment,null,!n&&A.createElement(Xo,{target:t}),n&&A.createElement(ea,{target:t}))}));n.d(t,"ProofingPlugin",(function(){return $o})),n.d(t,"ProofingTeachingCallout",(function(){return ta}))},1804:function(e,t,n){"use strict";var r=n(10624);n.d(t,"a",(function(){return r}))},2337:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.button=0]="button",e[e.anchor=1]="anchor"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.primary=1]="primary",e[e.hero=2]="hero",e[e.compound=3]="compound",e[e.command=4]="command",e[e.icon=5]="icon",e[e.default=6]="default"}(i||(i={}))},2342:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3234),i=n(4995);n(3853);const o={DictionaryCritiqueFilter:Symbol.for("DictionaryCritiqueFilter"),EnabledCritiqueTypesCritiqueFilter:Symbol.for("EnabledCritiqueTypesCritiqueFilter"),IConditionalAttributeFilterFactory:Symbol.for("IConditionalAttributeFilterFactory"),ICritiqueFilterer:Symbol.for("ICritiqueFilterer"),ICritiquesBrokerFactory:Symbol.for("ICritiquesBrokerFactory"),IDomFinderFactory:Symbol.for("IDomFinderFactory"),IElementsRetriever:Symbol.for("IElementsRetriever"),IEnabledCritiqueTypes:Symbol.for("IEnabledCritiqueTypes"),IE2eMetric:r.a.IE2eMetric,IFeatureFlagsReader:r.a.IFeatureFlagsReader,IGrammarRules:Symbol.for("IGrammarRules"),IGraphNodeBuilderFactory:Symbol.for("Factory<IGraphNodeBuilderFactory>"),IGraphNodeFactory:Symbol.for("IGraphNodeFactory"),IGuidGenerator:r.a.IGuidGenerator,IHostEmitter:r.a.IHostEmitter,IHostEmitterArray:r.a.IHostEmitterArray,IHostModelPersistedStore:Symbol.for("IHostModelPersistedStore"),IHostModelSettings:Symbol.for("IHostModelSettings"),IHostTilingEmitter:Symbol.for("IHostTilingEmitter"),IHostSettings:Symbol.for("IHostSettings"),IIndexReadjuster:i.a.IIndexReadjuster,ILocalizer:r.a.ILocalizer,ILogger:r.a.ILogger,IMutationObserverFactory:Symbol.for("Factory<MutationObserver>"),INodeObserverFactory:Symbol.for("Factory<INodeObserver>"),INodePoller:Symbol.for("INodePoller"),IParagraphNodesBuilderFactory:Symbol.for("IParagraphNodesBuilderFactory"),IParagraphNodeDictionary:Symbol.for("IParagraphNodeDictionary"),IParagraphNodeFactory:Symbol.for("IParagraphNodeFactory"),IProofingPersistedStore:r.a.IProofingPersistedStore,IPreOrderTraverser:Symbol.for("IPreOrderTraverser<NodeElementType>"),IProofingDom:Symbol.for("IProofingDom"),IProofingEmitter:r.a.IProofingEmitter,IShadowGraphFactory:Symbol.for("Factory<IShadowGraph>"),IsUpsellUser:r.a.IsUpsellUser,ITerminalNodeReader:Symbol.for("ITerminalNodeReader<NodeElementType>"),ITerminalNodeWriter:Symbol.for("ITerminalNodeWriter<NodeElementType>"),ITextExtractor:i.a.ITextExtractor,ITextUnitChunker:i.a.ITextUnitChunker,ITileNodeDictionary:Symbol.for("ITileNodeDictionary"),ITileNodeReader:Symbol.for("ITileNodeReader<NodeElementType>"),IUpsellStore:Symbol.for("IUpsellStore"),IWordCount:i.a.IWordCount,IWordDictionary:Symbol.for("IWordDictionary"),PremiumCritiqueFilter:Symbol.for("PremiumCritiqueFilter")}},2699:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.TimeBased=0]="TimeBased",e[e.CountBased=1]="CountBased",e[e.TimeAndCountCombined=2]="TimeAndCountCombined",e[e.BasicSkittle=3]="BasicSkittle",e[e.None=4]="None"}(r||(r={})),function(e){e[e.New=0]="New",e[e.Activated=1]="Activated",e[e.Expired=2]="Expired",e[e.Unknown=3]="Unknown"}(i||(i={}))},3061:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NAMED_TAG="named",t.NAME_TAG="name",t.UNMANAGED_TAG="unmanaged",t.OPTIONAL_TAG="optional",t.INJECT_TAG="inject",t.MULTI_INJECT_TAG="multi_inject",t.TAGGED="inversify:tagged",t.TAGGED_PROP="inversify:tagged_props",t.PARAM_TYPES="inversify:paramtypes",t.DESIGN_PARAM_TYPES="design:paramtypes",t.POST_CONSTRUCT="post_construct"},3199:function(e,t,n){var r=n(3967),i=n(3435),o=i;o.v1=r,o.v4=i,e.exports=o},3234:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(3853);const r={IGuidGenerator:Symbol.for("IGuidGenerator"),ICleanable:Symbol.for("ICleanable"),IUserInfoStrategy:Symbol.for("IUserInfoStrategy"),IsPremiumUser:Symbol.for("IsPremiumUser"),IsUpsellUser:Symbol.for("IsUpsellUser"),IsSignedInUser:Symbol.for("IsSignedInUser"),IUpsellFeature:Symbol.for("IUpsellFeature"),IRoamingDictionaryFeature:Symbol.for("IRoamingDictionaryFeature"),IExternalSettingsFeature:Symbol.for("IExternalSettingsFeature"),IFeatureFlagsReader:Symbol.for("IFeatureFlagsReader"),IRegistrable:Symbol.for("IRegistrable"),IProofingEmitter:Symbol.for("IProofingEmitter"),IHostSettings:Symbol.for("IHostSettings"),ISessionContextProvider:Symbol.for("ISessionContextProvider"),EditorService:Symbol.for("EditorService"),SynonymService:Symbol.for("SynonymService"),IResourceUrlFormatter:Symbol.for("IResourceUrlFormatter"),IShowSynonymsFeature:Symbol.for("IShowSynonymsFeature"),IUnsignedInEditorFeature:Symbol.for("IUnsignedInEditorFeature"),IE2eMetric:Symbol.for("IE2eMetric"),ILanguageMapper:Symbol.for("ILanguageMapper"),ILanguageRetriever:Symbol.for("ILanguageRetriever"),ILanguageScriptDirectionDetector:Symbol.for("ILanguageScriptDirectionDetector"),IUxLanguageDetector:Symbol.for("IUxLanguageDetector"),ILocalizationStringsImporter:Symbol.for("ILocalizationStringsImporter"),ILocalizer:Symbol.for("ILocalizer"),ILogger:Symbol.for("ILogger"),ITransportActivity:Symbol.for("ITransportActivity"),ITransportLogger:Symbol.for("ITransportLogger"),IInstrumentationMessageProcessor:Symbol.for("IInstrumentationMessageProcessor"),IHostEmitter:Symbol.for("IHostEmitter"),IHostEmitterArray:Symbol.for("IHostEmitterArray"),IProofingPersistedStore:Symbol.for("IProofingPersistedStore")}},358:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(3),i=n(16),o=Object(r.createStore)("lightningState",{unseenItems:new i.ObservableMap,lightedCount:0,lastShownId:null}),a=o()},3670:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return u}));var r=-1,i=0,o=-1,a=0,s="EditorProofing_SkittleVisible",c="EditorProofing_SkittleValueNonZero",l=15,u=20},3703:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",t.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",t.NULL_ARGUMENT="NULL argument",t.KEY_NOT_FOUND="Key Not Found",t.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",t.CANNOT_UNBIND="Could not unbind serviceIdentifier:",t.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",t.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",t.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",t.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},t.CIRCULAR_DEPENDENCY="Circular dependency found:",t.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",t.INVALID_BINDING_TYPE="Invalid binding type:",t.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",t.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",t.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",t.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",t.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",t.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",t.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",t.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]},t.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},t.STACK_OVERFLOW="Maximum call stack size exceeded"},3853:function(e,t,n){(function(e,t){
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n;!function(n){!function(r){var i="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=a(n);function a(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===i.Reflect?i.Reflect=n:o=a(i.Reflect,o),function(t){var n=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,s={__proto__:[]}instanceof Array,c=!a&&!s,l={create:a?function(){return N(Object.create(null))}:s?function(){return N({__proto__:null})}:function(){return N({})},has:c?function(e,t){return n.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return n.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),d="object"==typeof e&&e.env&&"true"===e.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function a(e,t){return[e,t]}}():Map,h=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}():Set,g=new(d||"function"!=typeof WeakMap?function(){var e=16,t=l.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+s()}while(l.has(t,e));return t[e]=!0,e}function o(e,t){if(!n.call(e,r)){if(!t)return;Object.defineProperty(e,r,{value:l.create()})}return e[r]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(){var t,n=(t=e,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t):a(new Array(t),t));n[6]=79&n[6]|64,n[8]=191&n[8]|128;for(var r="",i=0;i<e;++i){var o=n[i];4!==i&&6!==i&&8!==i||(r+="-"),o<16&&(r+="0"),r+=o.toString(16).toLowerCase()}return r}}():WeakMap);function p(e,t,n){var r=g.get(e);if(I(r)){if(!n)return;r=new f,g.set(e,r)}var i=r.get(t);if(I(i)){if(!n)return;i=new f,r.set(t,i)}return i}function m(e,t,n){var r=p(t,n,!1);return!I(r)&&!!r.has(e)}function y(e,t,n){var r=p(t,n,!1);if(!I(r))return r.get(e)}function b(e,t,n,r){p(n,r,!0).set(e,t)}function v(e,t){var n=[],r=p(e,t,!1);if(I(r))return n;for(var i=function(e){var t=j(e,o);if(!P(t))throw new TypeError;var n=t.call(e);if(!C(n))throw new TypeError;return n}(r.keys()),a=0;;){var s=R(i);if(!s)return n.length=a,n;var c=s.value;try{n[a]=c}catch(e){try{x(i)}finally{throw e}}a++}}function _(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function I(e){return void 0===e}function S(e){return null===e}function C(e){return"object"==typeof e?null!==e:"function"==typeof e}function O(e,t){switch(_(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",r=j(e,i);if(void 0!==r){var o=r.call(e,n);if(C(o))throw new TypeError;return o}return function(e,t){if("string"===t){var n=e.toString;if(P(n))if(!C(i=n.call(e)))return i;if(P(r=e.valueOf))if(!C(i=r.call(e)))return i}else{var r;if(P(r=e.valueOf))if(!C(i=r.call(e)))return i;var i,o=e.toString;if(P(o))if(!C(i=o.call(e)))return i}throw new TypeError}(e,"default"===n?"number":n)}function T(e){var t=O(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function E(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function P(e){return"function"==typeof e}function w(e){return"function"==typeof e}function j(e,t){var n=e[t];if(null!=n){if(!P(n))throw new TypeError;return n}}function R(e){var t=e.next();return!t.done&&t}function x(e){var t=e.return;t&&t.call(e)}function A(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i?t:i===e?t:i}function N(e){return e.__=void 0,delete e.__,e}t("decorate",(function(e,t,n,r){if(I(n)){if(!E(e))throw new TypeError;if(!w(t))throw new TypeError;return function(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!I(r)&&!S(r)){if(!w(r))throw new TypeError;t=r}}return t}(e,t)}if(!E(e))throw new TypeError;if(!C(t))throw new TypeError;if(!C(r)&&!I(r)&&!S(r))throw new TypeError;return S(r)&&(r=void 0),function(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!I(o)&&!S(o)){if(!C(o))throw new TypeError;r=o}}return r}(e,t,n=T(n),r)})),t("metadata",(function(e,t){return function(n,r){if(!C(n))throw new TypeError;if(!I(r)&&!function(e){switch(_(e)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;b(e,t,n,r)}})),t("defineMetadata",(function(e,t,n,r){if(!C(n))throw new TypeError;return I(r)||(r=T(r)),b(e,t,n,r)})),t("hasMetadata",(function(e,t,n){if(!C(t))throw new TypeError;return I(n)||(n=T(n)),function e(t,n,r){if(m(t,n,r))return!0;var i=A(n);return!S(i)&&e(t,i,r)}(e,t,n)})),t("hasOwnMetadata",(function(e,t,n){if(!C(t))throw new TypeError;return I(n)||(n=T(n)),m(e,t,n)})),t("getMetadata",(function(e,t,n){if(!C(t))throw new TypeError;return I(n)||(n=T(n)),function e(t,n,r){if(m(t,n,r))return y(t,n,r);var i=A(n);return S(i)?void 0:e(t,i,r)}(e,t,n)})),t("getOwnMetadata",(function(e,t,n){if(!C(t))throw new TypeError;return I(n)||(n=T(n)),y(e,t,n)})),t("getMetadataKeys",(function(e,t){if(!C(e))throw new TypeError;return I(t)||(t=T(t)),function e(t,n){var r=v(t,n),i=A(t);if(null===i)return r;var o=e(i,n);if(o.length<=0)return r;if(r.length<=0)return o;for(var a=new h,s=[],c=0,l=r;c<l.length;c++){var u=l[c];a.has(u)||(a.add(u),s.push(u))}for(var d=0,f=o;d<f.length;d++){u=f[d];a.has(u)||(a.add(u),s.push(u))}return s}(e,t)})),t("getOwnMetadataKeys",(function(e,t){if(!C(e))throw new TypeError;return I(t)||(t=T(t)),v(e,t)})),t("deleteMetadata",(function(e,t,n){if(!C(t))throw new TypeError;I(n)||(n=T(n));var r=p(t,n,!1);if(I(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=g.get(t);return i.delete(n),i.size>0||(g.delete(t),!0)}))}(o)}()}(n||(n={}))}).call(this,n(136),n(122))},3854:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n(3234),i=n(2342),o=n(4100),a=n(4099),s=n(11212),c=n(7690),l=n(4995);n(3853);const u={Container:Symbol.for("Container"),CritiqueEventHandler:a.a.CritiqueEventHandler,DictionaryCritiqueFilter:a.a.DictionaryCritiqueFilter,EditorService:r.a.EditorService,FilteringEventHandler:a.a.FilteringEventHandler,NodeEventHandler:a.a.NodeEventHandler,IAppStateStore:Symbol.for("IAppStateStore"),IBackgroundActivityFactory:Symbol.for("IBackgroundActivityFactory"),ICalloutFocusManager:s.a.ICalloutFocusManager,ICheckRefinementsFeature:Symbol.for("ICheckRefinementsFeature"),IComponentInitializer:Symbol.for("IComponentInitializer"),IContentValidator:a.a.IContentValidator,ICritiqueCalloutStateStore:s.a.ICritiqueCalloutStateStore,ICritiqueContextValidator:a.a.ICritiqueContextValidator,ICritiqueDispatcher:a.a.ICritiqueDispatcher,ICritiqueFilterer:a.a.ICritiqueFilterer,ICritiqueInterpreter:a.a.ICritiqueInterpreter,ICritiquesMessageEmitter:o.a.ICritiquesMessageEmitter,ICritiqueStore:a.a.ICritiqueStore,IDescriptorManager:o.a.IDescriptorManager,IDisabler:Symbol.for("IDisabler"),IDefaultStyleDefinitionsFactory:Symbol.for("IDefaultStyleDefinitionsFactory"),IDropdownStateStoreFactory:s.a.IDropdownStateStoreFactory,IEditorClientSettings:Symbol.for("IEditorClientSettings"),IElementsRetriever:i.a.IElementsRetriever,IExternalSettingsFeature:r.a.IExternalSettingsFeature,IFeatureFlagsReader:r.a.IFeatureFlagsReader,IGraphNodeBuilderFactory:i.a.IGraphNodeBuilderFactory,IGuidGenerator:r.a.IGuidGenerator,IHighContrastModeDetector:a.a.IHighContrastModeDetector,IHostEmitter:r.a.IHostEmitter,IHostModelPersistedStore:i.a.IHostModelPersistedStore,IHostModelSettings:i.a.IHostModelSettings,IHostSettings:r.a.IHostSettings,IHostTilingEmitter:i.a.IHostTilingEmitter,IIndexReadjuster:l.a.IIndexReadjuster,IInstrumentationMessageProcessor:r.a.IInstrumentationMessageProcessor,ILanguageRetriever:r.a.ILanguageRetriever,ILanguageScriptDirectionDetector:a.a.ILanguageScriptDirectionDetector,ILocalizationStringsImporter:r.a.ILocalizationStringsImporter,ILocalizer:r.a.ILocalizer,ILogger:r.a.ILogger,IMultiLangTileCheckResponseTransformer:o.a.IMultiLangTileCheckResponseTransformer,INodePoller:i.a.INodePoller,IParagraphNodesBuilder:Symbol.for("IParagraphNodesBuilder"),IParagraphNodeDictionary:i.a.IParagraphNodeDictionary,IPreOrderTraverser:i.a.IPreOrderTraverser,IPresentationDomSettings:s.a.IPresentationDomSettings,IPresentationDomStyleDefinitions:s.a.IStyleDefinitions,IPresentationSettings:a.a.IPresentationSettings,IProofingDom:i.a.IProofingDom,IProofingEmitter:r.a.IProofingEmitter,IProofingPersistedStore:r.a.IProofingPersistedStore,IRangeBoundariesChecker:Symbol.for("IRangeBoundariesChecker"),IReactComponentInitializer:Symbol.for("IReactComponentInitializer"),IRegistrar:Symbol.for("IRegistrar"),IRemoteSettingsSyncer:Symbol.for("IRemoteSettingsSyncer"),IResourceUrlFormatter:r.a.IResourceUrlFormatter,IRoamingDictionaryFeature:r.a.IRoamingDictionaryFeature,IsPremiumUser:r.a.IsPremiumUser,IsUpsellUser:r.a.IsUpsellUser,ISessionContextProvider:r.a.ISessionContextProvider,ISettingsEmitter:Symbol.for("ISettingsEmitter"),ISettingsEmitterBase:c.g.ISettingsEmitterBase,IShadowElementPropsFactory:s.a.IShadowElementPropsFactory,IShadowElementStateFactory:s.a.IShadowElementStateFactory,IShowSynonymsFeature:Symbol.for("IShowSynonymsFeature"),ISquigglerStateStoreFactory:s.a.ISquigglerStateStoreFactory,ISquiggleStateStoreFactory:s.a.ISquiggleStateStoreFactory,ISquiggleTooltipStateStore:s.a.ISquiggleTooltipStateStore,ISquiggleTooltipStateStoreFactory:s.a.ISquiggleTooltipStateStoreFactory,IStoreEntryReader:c.g.IStoreEntryReader,IStoreEntryWriter:c.g.IStoreEntryWriter,IStyleDefinitions:s.a.IStyleDefinitions,ISuggestionButtonStateStoreFactory:s.a.ISuggestionButtonStateStoreFactory,ISynonymFiller:o.a.ISynonymFiller,ISynonymRequestBuilder:o.a.ISynonymRequestBuilder,ISystemPersistedStore:Symbol.for("ISystemPersistedStore"),ITextExtractor:l.a.ITextExtractor,ITextNodeRangeBuilder:l.a.ITextNodeRangeBuilder,ITextProcessorFactory:Symbol.for("ITextProcessorFactory"),ITextRetrieverFactory:l.a.ITextRetrieverFactory,ITextTilesMessageProcessor:Symbol.for("ITextTilesMessageProcessor"),ITextUnitChunker:l.a.ITextUnitChunker,ITileCheckRequestBuilder:o.a.ITileCheckRequestBuilder,ITileCheckResponseTransformer:o.a.ITileCheckResponseTransformer,ITileIdFormatter:o.a.ITileIdFormatter,ITileNodeDictionary:i.a.ITileNodeDictionary,ITileNodeReader:i.a.ITileNodeReader,ITerminalNodeReader:i.a.ITerminalNodeReader,ITerminalNodeWriter:i.a.ITerminalNodeWriter,ITransportActivity:r.a.ITransportActivity,ITransportLogger:r.a.ITransportLogger,IUpsellFeature:r.a.IUpsellFeature,IUpsellStore:i.a.IUpsellStore,IUserInfoStrategy:r.a.IUserInfoStrategy,IUserInfoUpdater:Symbol.for("IUserInfoUpdater"),IUxLanguageDetector:r.a.IUxLanguageDetector,IWordCount:l.a.IWordCount,IWordDictionary:a.a.IWordDictionary,PremiumCritiqueFilter:i.a.PremiumCritiqueFilter,SpanEventHandler:a.a.SpanEventHandler,SynonymService:r.a.SynonymService,IE2eMetric:r.a.IE2eMetric,IEnabledCritiqueTypes:i.a.IEnabledCritiqueTypes,EnabledCritiqueTypesCritiqueFilter:i.a.EnabledCritiqueTypesCritiqueFilter,IUnsignedInEditorFeature:Symbol.for("IUnsignedInEditorFeature"),IsSignedInUser:r.a.IsSignedInUser},d={ICleanable:r.a.ICleanable,IRegistrable:r.a.IRegistrable,IStyleOverrides:Symbol.for("IStyleOverrides"),ITextProcessor:Symbol.for("ITextProcessor"),IHostEmitterArray:r.a.IHostEmitterArray,ITextUnitSeparator:l.a.ITextUnitSeparator,EventHub:a.a.EventHub}},3855:function(e,t,n){"use strict";var r=n(9176);n.d(t,"a",(function(){return r}));var i=n(9177);n.d(t,"b",(function(){return i}))},3967:function(e,t,n){var r,i,o=n(2936),a=n(2937),s=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],d=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==f){var h=o();null==d&&(d=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==f&&(f=i=16383&(h[6]<<8|h[7]))}var g=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:c+1,m=g-s+(p-c)/1e4;if(m<0&&void 0===e.clockseq&&(f=f+1&16383),(m<0||g>s)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=g,c=p,i=f;var y=(1e4*(268435455&(g+=122192928e5))+p)%4294967296;u[l++]=y>>>24&255,u[l++]=y>>>16&255,u[l++]=y>>>8&255,u[l++]=255&y;var b=g/4294967296*1e4&268435455;u[l++]=b>>>8&255,u[l++]=255&b,u[l++]=b>>>24&15|16,u[l++]=b>>>16&255,u[l++]=f>>>8|128,u[l++]=255&f;for(var v=0;v<6;++v)u[l+v]=d[v];return t||a(u)}},4098:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3061),i=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();t.Metadata=i},4099:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3234),i=n(16947),o=n(4995);n(3853);const a={IContentValidator:Symbol.for("IContentValidator"),ILanguageRetriever:r.a.ILanguageRetriever,ILogger:r.a.ILogger,CritiqueEventHandler:Symbol.for("CritiqueEventHandler"),DictionaryCritiqueFilter:Symbol.for("DictionaryCritiqueFilter"),EventHub:Symbol.for("EventHub"),FilteringEventHandler:Symbol.for("FilteringEventHandler"),ICritiqueActionHandler:Symbol.for("ICritiqueActionHandler"),ICritiqueContextValidator:Symbol.for("ICritiqueContextValidator"),ICritiqueDispatcher:Symbol.for("ICritiqueDispatcher"),ICritiqueInterpreter:Symbol.for("ICritiqueInterpreter"),ICritiqueStore:Symbol.for("ICritiqueStore"),ICritiquesBrokerFactory:Symbol.for("ICritiquesBrokerFactory"),IProofingPersistedStore:r.a.IProofingPersistedStore,ITextExtractor:o.a.ITextExtractor,NodeEventHandler:Symbol.for("NodeEventHandler"),SpanEventHandler:Symbol.for("SpanEventHandler"),IHighContrastModeDetector:Symbol.for("IHighContrastModeDetector"),ILanguageScriptDirectionDetector:Symbol.for("ILanguageScriptDirectionDetector"),IUxLanguageDetector:Symbol.for("IUxLanguageDetector"),IHostEmitterArray:r.a.IHostEmitterArray,IProofingEmitter:r.a.IProofingEmitter,IHostSettings:i.a.IHostSettings,IProofingDom:i.a.IProofingDom,IPresentationSettings:Symbol.for("IPresentationSettings"),IWordDictionary:i.a.IWordDictionary,ICritiqueFilterer:i.a.ICritiqueFilterer}},4100:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3234);n(3853);const i={IGuidGenerator:r.a.IGuidGenerator,IProofingPersistedStore:r.a.IProofingPersistedStore,IProofingEmitter:r.a.IProofingEmitter,IFeatureFlagsReader:r.a.IFeatureFlagsReader,IUserInfoStrategy:r.a.IUserInfoStrategy,EditorService:r.a.EditorService,SynonymService:r.a.SynonymService,ICritiquesMessageEmitter:Symbol.for("ICritiquesMessageEmitter"),IDescriptorManager:Symbol.for("IDescriptorManager"),ITileCheckRequestBuilder:Symbol.for("ITileCheckRequestBuilder"),ITileCheckResponseTransformer:Symbol.for("ITileCheckResponseTransformer"),IMultiLangTileCheckResponseTransformer:Symbol.for("IMultiLangTileCheckResponseTransformer"),ITileIdFormatter:Symbol.for("ITileIdFormatter"),ISynonymRequestBuilder:Symbol.for("ISynonymRequestBuilder"),ISynonymFiller:Symbol.for("ISynonymFiller"),IOrchestratorSettings:Symbol.for("IOrchestratorSettings"),IHostSettings:r.a.IHostSettings,ILogger:r.a.ILogger,IHostEmitter:r.a.IHostEmitter}},4227:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Hide=0]="Hide",e[e.ShowCallout=1]="ShowCallout",e[e.ShowDialog=2]="ShowDialog"}(r||(r={}))},4629:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};t.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};t.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},4992:function(e){e.exports=JSON.parse('{"i":"Odc","j":"Pdc","k":"Qdc","t":"Rdc","p":"Sdc","o":"Tdc","n":"Udc","m":"Vdc","l":"Wdc","r":"Xdc","q":"Ydc","s":"Zdc","b":"_dc","c":"$dc","e":"aec","d":"bec","g":"cec","f":"dec","a":"eec","h":"fec"}')},4993:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3703),i=n(3061);function o(e,t,n,i,o){var a={},s="number"==typeof o,c=void 0!==o&&s?o.toString():n;if(s&&void 0!==n)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(a=Reflect.getMetadata(e,t));var l=a[c];if(Array.isArray(l))for(var u=0,d=l;u<d.length;u++){var f=d[u];if(f.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+f.key.toString())}else l=[];l.push(i),a[c]=l,Reflect.defineMetadata(e,a,t)}function a(e,t){Reflect.decorate(e,t)}function s(e,t){return function(n,r){t(n,r,e)}}t.tagParameter=function(e,t,n,r){o(i.TAGGED,e,t,r,n)},t.tagProperty=function(e,t,n){o(i.TAGGED_PROP,e.constructor,t,n)},t.decorate=function(e,t,n){"number"==typeof n?a([s(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):a([e],t)}},4994:function(e,t,n){"use strict";var r,i,o,a,s,c;n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),function(e){e[e.Error=0]="Error",e[e.Warn=1]="Warn",e[e.Info=2]="Info",e[e.Debug=3]="Debug"}(r||(r={})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(i||(i={})),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(o||(o={})),function(e){e[e.Seen=0]="Seen",e[e.Tried=1]="Tried",e[e.Kept=2]="Kept"}(a||(a={})),function(e){e.ActionHideSynonymsFromCallout="ActionHideSynonymsFromCallout",e.ActionShowCallout="ActionShowCallout",e.ActionShowSynonymsFromCallout="ActionShowSynonymsFromCallout",e.ActionUpsellButtonClicked="ActionUpsellButtonClicked",e.SignInInitialized="SignInInitialized"}(s||(s={})),function(e){e.AriaError="RunTimeErrors.AriaError",e.GetNewActivityError="RunTimeErrors.GetNewActivityError",e.EnvelopeFormatError="RunTimeErrors.EnvelopeFormatError",e.TelemetryError="RunTimeErrors.TelemetryError"}(c||(c={}))},4995:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3234);n(3853);const i={IFeatureFlagsReader:r.a.IFeatureFlagsReader,IHostSettings:r.a.IHostSettings,IIndexReadjuster:Symbol.for("IIndexReadjuster"),ITextExtractor:Symbol.for("ITextExtractor"),ITextNodeRangeBuilder:Symbol.for("ITextNodeRangeBuilder"),ITextRetrieverFactory:Symbol.for("ITextRetrieverFactory"),ITextUnitChunker:Symbol.for("ITextUnitChunker"),ITextUnitSeparator:Symbol.for("ITextUnitSeparator"),IWordCount:Symbol.for("IWordCount")}},4996:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1681),i=n(9179);let o=class{constructor(){this._listenerId=0,this._callbacks=new Map,this.ignoreDisablers=!1,this.disablers=[],this.enablers=[]}triggerListeners(e){const t=this._callbacks.get(e.eventId);if(!t||0===t.length)return;let n=!0;return t.forEach(t=>{const[r,i]=t.callback(e);n=this.processCallBackResult(n,r,i)}),n}processCallBackResult(e,t,n){return t!==i.a.NoReaction?e&&t===i.a.EnableFeature:e}nextListenerId(){return this._listenerId+=1,this._listenerId}addListener(e,t){const n={callback:t,id:this.nextListenerId()};let r=this._callbacks.get(e);return r||(r=[],this._callbacks.set(e,r)),r.push(n),n.id}removeListener(e){e&&this._callbacks.forEach((t,n,r)=>{if(t){if(-1!==t.findIndex(t=>t.id===e))return void r.set(n,t.filter(t=>t.id!==e))}})}emitAndEvaluate(e){const t=this.triggerListeners(e);if(!this.ignoreDisablers)for(const e of this.disablers){if(!0===e)return!1;if(!1!==e&&e.check())return!1}let n=!1;for(const e of this.enablers)if(!0===e||!1!==e&&e.check()){n=!0;break}return void 0===t?n:n&&t}};o=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)()],o)},526:function(e,t,n){"use strict";var r=n(44),i=n(358),o=n(34),a=n(0),s=n(4),c=n(16),l=n(3),u=Object(l.mutatorAction)("initializeLightning",(function(e){var t,n;if(o.g.info("initialize lightning store"),Object(i.a)().lastShownId=null,Object(i.a)().lightedCount=0,Object(i.a)().unseenItems=new c.ObservableMap,e)try{for(var r=Object(a.__values)(e),s=r.next();!s.done;s=r.next()){var l=s.value;Object(i.a)().unseenItems.set(l.identity,l)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}));var d=n(178),f="ows/v1.0/lightning/items/unseen";function h(){return o.g.info("initialize lightning from server"),Object(d.b)(f).then((function(e){var t=e.map(g);u(t)}))}function g(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var p,m=n(25),y=n(40),b="lightning",v="UnseenLightening";function _(){var e,t,n;if(!p){var r=Object(s.a)(b);if(r)p=function(e){o.g.info("initialize lightning from override query parameter");var t=e.split(",").map((function(e){return{identity:e,visible:!1}}));return u(t),Promise.resolve()}(r);else{var i=Object(m.a)().PrimeSettings;if(Object(y.i)("lightning-initFromSD")&&i&&i.Items)try{for(var c=Object(a.__values)(i.Items),l=c.next();!l.done;l=c.next()){var d=l.value;if(d.Id===v&&d.Value){n=d.Value,o.g.info("initialize lightning from session data"),u(n.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),p=Promise.resolve();break}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}p||(p=h())}}return p}var I=n(1015),S=Object(l.action)("lightup",(function(e){return{id:e}})),C=S;Object(l.mutator)(S,(function(e){o.g.info("lightup - id:"+e.id),Object(i.a)().lastShownId=e.id,Object(i.a)().lightedCount++;var t=Object(i.a)().unseenItems.get(e.id);t&&(t.visible=!0)})),Object(l.orchestrator)(S,(function(e){Object(I.a)("LIGHTUP",e.id)}));var O,T=n(495);function E(e,t){(o.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+t+", lightedCount:"+Object(i.a)().lightedCount+", lastShown:"+Object(i.a)().lastShownId),Object(T.v)())?o.g.info("lightning is disabled for deeplink"):Object(i.a)().unseenItems.has(e)&&(!Object(i.a)().lastShownId||function(e,t){var n=!1,r=Object(i.a)().lastShownId;if(r&&t&&!function(){var e=Object(i.a)(),t=e.lastShownId,n=e.unseenItems;return t&&n.has(t)&&n.get(t).visible}()){var o=t.indexOf(r),a=t.indexOf(e);o>=0&&o+1==a&&(n=!0)}return n}(e,t)||function(e){var t=Object(i.a)().unseenItems.get(e);return!!t&&t.category==O.UIFeatureDiscovery}(e)||function(e){var t=Object(i.a)().unseenItems.get(e);return!!t&&t.category==O.Compliance}(e))&&C(e)}function P(e,t,n){o.g.info("beginLightning - id:"+e),t((function(){_().then((function(){return E(e,n)})).catch((function(t){o.g.warn("something is wrong, lightning id:"+e+", reason:"+t)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(O||(O={}));var w=n(707);n.d(t,"c",(function(){return R})),n.d(t,"d",(function(){return i.b})),n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return w.a}));var j=new r.c((function(){return n.e(456).then(n.bind(null,17421))})),R=new r.a(j,(function(e){return e.endLightningImp}))},5490:function(e,t,n){var r=n(15130),i=n(107);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},5491:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=0;t.id=function(){return r++}},6874:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(9171),i=n(9172);const o=(e,t)=>new i.a(e,r.a.Remote,t),a=(e,t)=>new i.a(e,r.a.User,t),s=(e,t)=>new i.a(e,r.a.System,t);var c;!function(e){e.FeatureFlags="featureFlags"}(c||(c={}))},6875:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3703);function i(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function o(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}t.getServiceIdentifierAsString=i,t.listRegisteredBindingsForServiceIdentifier=function(e,t,n){var r="",i=n(e,t);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=o(e.implementationType)),r=r+"\n "+t,e.constraint.metaData&&(r=r+" - "+e.constraint.metaData)}))),r},t.circularDependencyToException=function e(t){t.childRequests.forEach((function(t){if(function e(t,n){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===n||e(t.parentRequest,n))}(t,t.serviceIdentifier)){var n=function(e){return function e(t,n){void 0===n&&(n=[]);var r=i(t.serviceIdentifier);return n.push(r),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(t);throw new Error(r.CIRCULAR_DEPENDENCY+" "+n)}e(t)}))},t.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e},t.getFunctionName=o},6876:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1681),i=n(3234),o=function(e,t){return function(n,r){t(n,r,e)}};let a=class{constructor(e){this._userInfoStrategy=e}check(){return this._userInfoStrategy.execute(!1,e=>(this.setUserInfo(e),e)),this.checkUserInfo()}setUserInfo(e){e&&(this.licenseType=e.licenseType,this.identityProvider=e.identityProvider),this.isLoggedIn=!!e}};a=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)(),o(0,Object(r.inject)(i.a.IUserInfoStrategy))],a)},6878:function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaObject=void 0;var i=function(){function e(t){e.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_SchemaObject"},e.getBaseTypes=function(){return[]},e.getTypeNameFor=function(e){return e&&e.H_?e.H_.T_:void 0},e.getBaseTypesFor=function(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]},e.getAllTypesFor=function(t){var n=e.getTypeNameFor(t);return n?r([n],e.getBaseTypesFor(t)):[]},e.matchesTypesFor=function(t,n){if(!Array.isArray(n)||0===n.length)return!0;for(var r=e.getTypeNameFor(t),i=t&&t.H_&&t.H_.B_?t.H_.B_:void 0,o=0,a=n;o<a.length;o++){var s=a[o];if(s===r)return!0;if(i&&i.indexOf(s)>=0)return!0}return!1},e.assign=function(e,t,n){if(n)for(var r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];t[o]=n[o]}return t.H_=e.H_,t},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SchemaObject=i},707:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.InsertLinkTeachingMomentOpenCompose="68",e.InsertLinkTeachingMomentAfterAttach="69",e.ShortenEventsDurationSetting="70",e.HoneybeeClipboard="71",e.AttachmentSaveToCloudOpenAndEdit="72",e.GdprAdsEPrivacy="73",e.AdminInstalledNewAddinsFRE="75",e.InsertLinkFREOpenCompose="76",e.InsertLinkFREAfterAttach="77",e.SpotlightFre="78",e.OverlayFolderPaneFre="79",e.SpotlightPropertyIcon="80",e.GdprAdsV3ClearNull="81"}(r||(r={}))},714:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=n(0).__assign},7530:function(e,t,n){"use strict";var r,i,o,a;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(r||(r={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(i||(i={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(o||(o={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription"}(a||(a={}))},7531:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.AppId="appId",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.TelemetryTenant="telemetryTenant",e.LogGroupName="logGroupName",e.DefaultEventName="defaultEventName",e.DefaultLoggingLevel="defaultLoggingLevel",e.SendToAria="sendToAria",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId"}(r||(r={}))},7532:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.tileCheckRequestV1="tileCheckRequestV1",e.configRequestV2="configRequestV2",e.hostModelDelta="hostModelDelta",e.hostModelTextTile="hostModelTextTile",e.hostModelMoveTextTile="hostModelMoveTextTile",e.hostModelCritique="hostModelCritique",e.instrumentationRequestV1="instrumentationRequestV1",e.tileCheckResponseV1="tileCheckResponseV1",e.configResponseV2="configResponseV2",e.clearTileCritiques="clearTileCritiques",e.otelClientIdRequest="otelClientIdRequest",e.otelClientIdResponse="otelClientIdResponse",e.telemetryEvent="telemetryEvent",e.newActivityTelemetryEvent="newActivityTelemetryEvent",e.activitySetSuccessTelemetryEvent="activitySetSuccessTelemetryEvent",e.activitySetResultTelemetryEvent="activitySetResultTelemetryEvent",e.activityAddDataFieldTelemetryEvent="activityAddDataFieldTelemetryEvent",e.activityEndNowTelemetryEvent="activityEndNowTelemetryEvent"}(r||(r={}))},7533:function(e,t,n){"use strict";function r(){return 1e3*(new Date).getTime()}n.d(t,"a",(function(){return r}))},7534:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1681),i=n(4995),o=function(e,t){return function(n,r){t(n,r,e)}};let a=class{constructor(e){this.textRetrieverFactory=e}setHtmlElement(e){this.element!==e&&(this.element=e,this.textRetriever=this.textRetrieverFactory(this.element))}getText(){return this.textRetriever?this.textRetriever.retrieve():""}dispatchInputEvent(){if(this.element){const e=new Event("input",{bubbles:!0});this.element.dispatchEvent(e)}}};a=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(r.injectable)(),o(0,Object(r.inject)(i.a.ITextRetrieverFactory))],a)},7690:function(e,t,n){"use strict";var r=n(3234);const i={IStorage:Symbol.for("IStorage"),IBrowserStorageApi:Symbol.for("IBrowserStorageApi"),IExtensionStorage:Symbol.for("IExtensionStorage"),IStoreEntryReader:Symbol.for("IStoreEntryReader"),IStoreEntryWriter:Symbol.for("IStoreEntryWriter"),IProofingPersistedStore:r.a.IProofingPersistedStore,ILogger:r.a.ILogger,IUserInfoStrategy:r.a.IUserInfoStrategy,ISessionContextProvider:r.a.ISessionContextProvider,ISettingsEmitterBase:Symbol.for("ISettingsEmitterBase<ISettingsEmissionsBase>"),EditorService:r.a.EditorService,SynonymService:r.a.SynonymService,IGuidGenerator:r.a.IGuidGenerator};n(9171),n(9172);var o,a,s=n(6874),c=n(4994),l=n(1681);o||(o={}),function(e){e.SettingsSyncWriteError="RunTimeErrors.SettingSyncWriteError",e.SettingsSyncEditorServiceError="RunTimeErrors.SettingSyncEditorServiceError",e.SettingsSyncReadOverrideError="RunTimeErrors.SettingSyncReadOverrideError",e.SettingReadError="RunTimeErrors.SettingReadError",e.SettingInitializeError="RunTimeErrors.SettingInitializeError",e.SettingManualOverrideWarning="RunTimeErrors.SettingManualOverrideWarning",e.SettingWriteError="RunTimeErrors.SettingWriteError",e.FeatureFlagParsingError="RunTimeErrors.FeatureFlagParsingError"}(a||(a={}));var u=function(e,t){return function(n,r){t(n,r,e)}};const d=e=>"string"==typeof e?"true"===e.toLowerCase():!0===e;let f=class{constructor(e,t,n){this._emitter=e,this._storeEntryReader=t,this._logger=n,this._defaultFeatureFlags={disableRemoteLanguageInfo:!1,enableConflictDetectionAnnouncement:!1,enableSquiggleTooltipFeature:!0,enableCaretPositionRestore:!1,enableUpsellFeature:!1,enableLicenseRefresh:!0,enableLicenseRefreshForUndef:!0,enableLicenseResponseRetry:!0,enableIFrame:!1,enableMultiLanguageSupport:!1,enableMultiLanguageAnnouncement:!1,enableIgnoreAll:!1,enableIgnoreOnce:!1,enableNotifications:!1,enableOptimizedCallingPattern:!1,enableV2InputSquiggles:!1,enablePostUpsellAnnouncement:!1,enableInternalMailFeedback:!1,enableOrchestration:!1,enableRoamingDictionary:!1,enableSignInAnnouncement:!1,enableSignInAnnouncementAlternativeText:!1,enableRateExtensionPrompt:!1,enableRateExtensionPromptEdge:!1,enableAsyncSynonym:!1,enableEnhancedUpsell:!1,enablePremiumPreview:!1,enableUnsignedInEditor:!1,enableSuppressUnsignedInEditorForMultiLang:!1,enableCritiqueSettings:!1,enableSimplifiedHost:!1,enableOcvIntEndpoint:!1,enableOcvFeedbackUi:!1,enableConfigV2Calls:!1,enableSpellcheckOverride:!1,enableNewLineSentenceSeparator:!1,enableE2eMetric:!1,disableSquigglesCacheInUpdateRanges:!1},this._featureFlags=Object(s.b)(s.a.FeatureFlags,this._defaultFeatureFlags),this._localFlags=this._defaultFeatureFlags}get flags(){return this._localFlags}async refreshFlags(){return await this.updateFlags(),this.flags}async initialize(){this._emitter.on(s.a.FeatureFlags,()=>{this.updateFlags()}),await this.updateFlags()}async shutDown(){this._emitter.off(s.a.FeatureFlags)}async updateFlags(){try{const e=await this._storeEntryReader.readOrInitialize(this._featureFlags);this._localFlags=Object.assign(this._localFlags,...Object.entries(e).map(([e,t])=>({[e]:d(t)})))}catch(e){this._logger.logEvent(589857761,a.FeatureFlagParsingError,c.e.Error,void 0,c.f.Diagnostics)}}};f=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)(),u(0,Object(l.inject)(i.ISettingsEmitterBase)),u(1,Object(l.inject)(i.IStoreEntryReader)),u(2,Object(l.inject)(i.ILogger))],f);var h=function(e,t){return function(n,r){t(n,r,e)}};let g=class{constructor(e){this._extensionStorage=e}getLastError(){return this._lastError}setLastError(e){this._lastError=e}async writeSetting(e,t){const n={value:JSON.stringify(t),lastUpdated:Date.now(),manualOverride:!1};await this._extensionStorage.setItem(e,JSON.stringify(n))}};g=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)(),h(0,Object(l.inject)(i.IExtensionStorage))],g);var p=function(e,t){return function(n,r){t(n,r,e)}};let m=class extends g{constructor(e,t){super(e),this._logger=t}async readOrInitialize(e){try{const t=await this.readStoredSetting(e);if(t){if(t.value){const n=JSON.parse(t.value);return t.manualOverride&&void 0!==n?n:(e.lastValueFromStorage=n,void 0!==n?n:e.defaultValue)}}else try{return await this.writeSetting(e.name,e.defaultValue),e.defaultValue}catch(e){this._logger.logEvent(589857759,a.SettingInitializeError,c.e.Error,void 0,c.f.CriticalBusinessImpact),this.setLastError(e)}}catch(e){this._logger.logEvent(589857760,a.SettingReadError,c.e.Error,void 0,c.f.CriticalBusinessImpact),this.setLastError(e)}return void 0!==e.lastValueFromStorage?e.lastValueFromStorage:e.defaultValue}async readLastUpdatedTimestamp(e){try{const t=await this.readStoredSetting(e);if(t)return t.lastUpdated}catch(e){this._logger.logEvent(589080397,a.SettingReadError,c.e.Error,void 0,c.f.CriticalBusinessImpact),this.setLastError(e)}}async readStoredSetting(e){const t=await this._extensionStorage.getItems(e.name);if(t[e.name]){return JSON.parse(t[e.name])}}};m=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)(),p(0,Object(l.inject)(i.IExtensionStorage)),p(1,Object(l.inject)(i.ILogger))],m);var y=function(e,t){return function(n,r){t(n,r,e)}};let b=class extends g{constructor(e,t){super(e),this._logger=t}async write(e,t){try{let n=!1;const r=await this._extensionStorage.getItems(e.name);if(r[e.name]){n=JSON.parse(r[e.name]).manualOverride}n?this._logger.logEvent(589857757,a.SettingManualOverrideWarning,c.e.Warn,`manual override for store entry ${e.name} - writing skipped`,c.f.Measure):await this.writeSetting(e.name,t)}catch(e){this._logger.logEvent(589857758,a.SettingWriteError,c.e.Error,void 0,c.f.CriticalBusinessImpact),this.setLastError(e)}}};b=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)(),y(0,Object(l.inject)(i.IExtensionStorage)),y(1,Object(l.inject)(i.ILogger))],b);var v=n(10588),_=function(e,t){return function(n,r){t(n,r,e)}};let I=class{constructor(e){this._browserStorage=e,this.registrations={},this._storageChangeDispatcherCallback=async(e,t)=>this._storageChangeDispatcher(e,t)}safelyGetRegistration(e){return this.registrations[e]||(this.registrations[e]=Object(v.a)()),this.registrations[e]}on(e,t){this.safelyGetRegistration(e).listeners.push(t)}async initialize(){this._browserStorage.addChangeListener(this._storageChangeDispatcherCallback)}async shutDown(){this._browserStorage.removeEventListener(this._storageChangeDispatcherCallback)}_storageChangeDispatcher(e,t){Object.keys(e).forEach(e=>{this.callListeners(e)})}callListeners(e){const t=e,n=this.safelyGetRegistration(t);for(const e of n.listeners)e()}onFirst(e,t){throw Error("onFirst is not implemented for SettingsEmitter")}onAny(e){throw Error("onAny is not implemented for SettingsEmitter")}async waitFor(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}async waitForFirst(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}off(e,t){if(void 0===e)return void(this.registrations={});if(void 0===t)return void(this.registrations[e]=Object(v.a)());const n=this.safelyGetRegistration(e);if(!Object(v.b)(n.listeners,t))throw new Error(`Tried to remove a non-existent listener for event name '${e}'.`)}emit(e,...t){const n=this.safelyGetRegistration(e);for(const e of n.listeners)e(...t)}};I=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)(),_(0,Object(l.inject)(i.IBrowserStorageApi))],I);var S=function(e,t){return function(n,r){t(n,r,e)}};let C=class{constructor(e,t){this._storeEntryReader=e,this._storeEntryWriter=t,this._storeEntryMap=this.populateStoreEntryMap()}_fetchStoreEntry(e){const t=this._storeEntryMap.get(e);if(!t)throw Error("Cannot find the entry key.");return t}async read(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readOrInitialize(t)}async write(e,t){await this._storeEntryWriter.write(this._fetchStoreEntry(e).storeEntry,t)}async getLastUpdatedTimestamp(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readLastUpdatedTimestamp(t)}getCachedEntry(e){const t=this._fetchStoreEntry(e),n=t.storeEntry;return{storeEntryValue:void 0===n.lastValueFromStorage?n.defaultValue:n.lastValueFromStorage,isSynced:!!t.isSynced}}getDefaultValue(e){return this._fetchStoreEntry(e).storeEntry.defaultValue}};C=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)(),S(0,Object(l.inject)(i.IStoreEntryReader)),S(1,Object(l.inject)(i.IStoreEntryWriter))],C);var O=n(7531),T=n(4287),E=function(e,t){return function(n,r){t(n,r,e)}};function P(e){const t={value:JSON.stringify(e),lastUpdated:Date.now(),manualOverride:!1};return JSON.stringify(t)}let w=class extends g{constructor(e,t,n,r,i,o,a){super(e),this._editorService=t,this._proofingStore=n,this._logger=r,this._userInfoStrategy=i,this._sessionContextProvider=o,this._guidGenerator=a}schedule(e,t){this._timer&&window.clearTimeout(this._timer),this._timer=window.setTimeout(async()=>{await this.sync(),this.schedule(t,t)},e)}async sync(){this._logger.debug(589857750,"Starting remote settings sync");const e=await this.fetchRemoteSettings();if(e&&e.responseStatus===T.c.ResponseStatus.Success){const t=function(e){return{descriptors:P(e.descriptors),disabledWebSites:P(e.disabledWebSites),allowedUrls:P(e.allowedUrls),disabledGrammars:P(e.disabledGrammars),editorClientState:P(e.editorClientState),configurationId:P(e.configurationId),featureFlags:P(e.featureFlags),intervalForActivityCleanup:P(e.intervalForActivityCleanup),logGroupName:P(e.logGroupName),sendToAria:P(e.sendToAria),conflictingElements:P(e.conflictingElements),telemetryTenant:P(e.telemetryTenant)}}(e),n=await this.removeManualOverrides(t);if(n)return this._logger.debug(589857751,"Writing remote settings to local storage"),this.writeSettings(n)}return this._logger.debug(589857752,"No remote settings were synced"),!1}async writeSettings(e){try{return await this._extensionStorage.setItems(e),!0}catch(e){this._logger.logEvent(589857753,a.SettingsSyncWriteError,c.e.Error,void 0,c.f.CriticalBusinessImpact),this.setLastError(e)}return!1}async fetchClientId(){try{const e=await this._proofingStore.read(O.a.ClientId);if(!e||""===e){const e=this._guidGenerator.generate();return await this._proofingStore.write(O.a.ClientId,e),e}return e}catch(e){return""}}async fetchRemoteSettings(){try{const e=await this._sessionContextProvider();let t,n;const r=await this.fetchClientId();this._userInfoStrategy.execute(!1,e=>(e&&e.userId?(this._editorService.xUserId=e.userId,t=e.tenantId,n=e.email):this._editorService.xUserId=r,e));const i={appId:await this._proofingStore.read(O.a.AppId),browser:e.browserType,browserVersion:e.browserVersion||"",email:n,extensionId:e.extensionVersion,languageUxId:e.languageUxId,storeId:e.extensionStoreId,tenantId:t,firstInstallVersion:void 0};return await this._editorService.browserextension(i)}catch(e){this._logger.logEvent(589857754,a.SettingsSyncEditorServiceError,c.e.Error,void 0,c.f.CriticalBusinessImpact),this.setLastError(e)}}async removeManualOverrides(e){const t={};try{const n=await this._extensionStorage.getItems(e);for(const r of Object.keys(n)){const i=JSON.parse(n[r]);i&&i.manualOverride?this._logger.debug(589857755,"Manual override for remote setting",r):t[r]=e[r]}}catch(e){return this._logger.logEvent(589857756,a.SettingsSyncReadOverrideError,c.e.Error,void 0,c.f.CriticalBusinessImpact),void this.setLastError(e)}return t}};w=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)(),E(0,Object(l.inject)(i.IExtensionStorage)),E(1,Object(l.inject)(i.EditorService)),E(2,Object(l.inject)(i.IProofingPersistedStore)),E(3,Object(l.inject)(i.ILogger)),E(4,Object(l.inject)(i.IUserInfoStrategy)),E(5,Object(l.inject)(i.ISessionContextProvider)),E(6,Object(l.inject)(i.IGuidGenerator))],w);var j=function(e,t){return function(n,r){t(n,r,e)}};let R=class{constructor(e){this._local=e}async getItems(e){return new Promise((t,n)=>{this._local.get(e,e=>{const r=this._local.getLastError();r?n(r):t(e)})})}async setItems(e){return new Promise((t,n)=>{this._local.set(e,()=>{const e=this._local.getLastError();e?n(e):t()})})}async setItem(e,t){const n={};return n[e]=t,this.setItems(n)}async removeItems(e){return new Promise((t,n)=>{this._local.remove(e,()=>{const e=this._local.getLastError();e?n(e):t()})})}};var x;R=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)(),j(0,Object(l.inject)(i.IBrowserStorageApi))],R),function(e){e.ChromeBrowserStorageApi="ChromeBrowserStorageApi",e.LocalStorageApi="LocalStorageApi"}(x||(x={}));let A=class{set(e,t){chrome.storage.local.set(e,t)}remove(e,t){chrome.storage.local.remove(e,t)}get(e,t){chrome.storage.local.get(e,t)}getLastError(){if(chrome.runtime.lastError)return chrome.runtime.lastError.message}addChangeListener(e){browser.storage.onChanged.addListener(e)}removeEventListener(e){browser.storage.onChanged.removeListener(e)}};var N;A=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)()],A);let D=N=class{constructor(){this._listeners=[]}set(e,t){const n=Object.keys(e),r={};n.forEach(t=>{const n=e[t];r[t]={oldValue:localStorage.getItem(t),newValue:n};try{localStorage.setItem(t,n)}catch(e){this._lastError=e}});const i=new CustomEvent("storageItemInserted",{detail:r});document.dispatchEvent(i),t&&t()}remove(e,t){if("string"==typeof e)localStorage.removeItem(e);else if(Array.isArray(e))for(const t of e)localStorage.removeItem(t);t&&t()}get(e,t){const n={};if("string"==typeof e)n[e]=N._getItem(e);else if(Array.isArray(e))for(const t of e)n[t]=N._getItem(t);else if(e instanceof Object){Object.keys(e).forEach(t=>{const r=N._getItem(t);n[t]=r||e[t]})}t(n)}getLastError(){return this._lastError}addChangeListener(e){const t=t=>{t.detail&&e(t.detail,"")};document.addEventListener("storageItemInserted",t),this._listeners.push(t)}removeEventListener(e){this._listeners.forEach(e=>{document.removeEventListener("storageItemInserted",e)}),this._listeners.splice(0,this._listeners.length-1)}static _getItem(e){const t=localStorage.getItem(e);if(t)try{const e=JSON.parse(t);return void 0!==e.value&&e.lastUpdated&&void 0!==e.manualOverride?t:e}catch(e){return t}return null}};D=N=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)()],D);let F=class{getItem(e){const t=localStorage.getItem(e);if(t)return t}setItem(e,t){localStorage.setItem(e,t)}clearItem(e){localStorage.removeItem(e)}};F=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([Object(l.injectable)()],F),n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"f",(function(){return I})),n.d(t,"a",(function(){return C})),n.d(t,"e",(function(){return w})),n.d(t,"b",(function(){return R})),n.d(t,"d",(function(){return D}))},828:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),i=n(12),o=n(220),a={root:"ms-TeachingBubble",body:"ms-TeachingBubble-body",bodyContent:"ms-TeachingBubble-bodycontent",closeButton:"ms-TeachingBubble-closebutton",content:"ms-TeachingBubble-content",footer:"ms-TeachingBubble-footer",header:"ms-TeachingBubble-header",headerIsCondensed:"ms-TeachingBubble-header--condensed",headerIsSmall:"ms-TeachingBubble-header--small",headerIsLarge:"ms-TeachingBubble-header--large",headline:"ms-TeachingBubble-headline",image:"ms-TeachingBubble-image",primaryButton:"ms-TeachingBubble-primaryButton",secondaryButton:"ms-TeachingBubble-secondaryButton",subText:"ms-TeachingBubble-subText",button:"ms-Button",buttonLabel:"ms-Button-label"},s=Object(o.c)((function(){return Object(i.keyframes)({"0%":{opacity:0,animationTimingFunction:i.AnimationVariables.easeFunction1,transform:"scale3d(.90,.90,.90)"},"100%":{opacity:1,transform:"scale3d(1,1,1)"}})})),c=function(e,t){var n=t||{},r=n.calloutWidth,i=n.calloutMaxWidth;return[{display:"block",maxWidth:364,border:0,outline:"transparent",width:r||"calc(100% + 1px)",animationName:""+s(),animationDuration:"300ms",animationTimingFunction:"linear",animationFillMode:"both"},e&&{maxWidth:i||456}]},l=function(e,t,n){return t?[e.headerIsCondensed,{marginBottom:14}]:[n&&e.headerIsSmall,!n&&e.headerIsLarge,{selectors:{":not(:last-child)":{marginBottom:14}}}]},u=function(e){var t,n,o,s=e.hasCondensedHeadline,u=e.hasSmallHeadline,d=e.hasCloseButton,f=e.hasHeadline,h=e.isWide,g=e.primaryButtonClassName,p=e.secondaryButtonClassName,m=e.theme,y=e.calloutProps,b=void 0===y?{className:void 0,theme:m}:y,v=!s&&!u,_=m.palette,I=m.semanticColors,S=m.fonts,C=Object(i.getGlobalClassNames)(a,m);return{root:[C.root,S.medium,b.className],body:[C.body,d&&!f&&{marginRight:24},{selectors:{":not(:last-child)":{marginBottom:20}}}],bodyContent:[C.bodyContent,{padding:"20px 24px 20px 24px"}],closeButton:[C.closeButton,{position:"absolute",right:0,top:0,margin:"15px 15px 0 0",borderRadius:0,color:_.white,fontSize:S.small.fontSize,selectors:{":hover":{background:_.themeDarkAlt,color:_.white},":active":{background:_.themeDark,color:_.white},":focus":{border:"1px solid "+I.variantBorder}}}],content:Object(r.__spreadArrays)([C.content],c(h),[h&&{display:"flex"}]),footer:[C.footer,{display:"flex",flex:"auto",alignItems:"center",color:_.white,selectors:(t={},t["."+C.button+":not(:first-child)"]={marginLeft:10},t)}],header:Object(r.__spreadArrays)([C.header],l(C,s,u),[d&&{marginRight:24},(s||u)&&[S.medium,{fontWeight:i.FontWeights.semibold}]]),headline:[C.headline,{margin:0,color:_.white,fontWeight:i.FontWeights.semibold},v&&[{fontSize:S.xLarge.fontSize}]],imageContent:[C.header,C.image,h&&{display:"flex",alignItems:"center",maxWidth:154}],primaryButton:[C.primaryButton,g,{backgroundColor:_.white,borderColor:_.white,color:_.themePrimary,whiteSpace:"nowrap",selectors:(n={},n["."+C.buttonLabel]=S.medium,n[":hover"]={backgroundColor:_.themeLighter,borderColor:_.themeLighter,color:_.themePrimary},n[":focus"]={backgroundColor:_.themeLighter,borderColor:_.white},n[":active"]={backgroundColor:_.white,borderColor:_.white,color:_.themePrimary},n)}],secondaryButton:[C.secondaryButton,p,{backgroundColor:_.themePrimary,borderColor:_.white,whiteSpace:"nowrap",selectors:(o={},o["."+C.buttonLabel]=[S.medium,{color:_.white}],o["&:hover, &:focus"]={backgroundColor:_.themeDarkAlt,borderColor:_.white},o[":active"]={backgroundColor:_.themePrimary,borderColor:_.white},o)}],subText:[C.subText,{margin:0,fontSize:S.medium.fontSize,color:_.white,fontWeight:i.FontWeights.regular}],subComponentStyles:{callout:{root:Object(r.__spreadArrays)(c(h,b),[S.medium]),beak:[{background:_.themePrimary}],calloutMain:[{background:_.themePrimary}]}}}}},8424:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(12),n.e(265),n.e(874)]).then(n.bind(null,11160))})),o=new r.a(i,(function(e){return e.preloadRoamingDictionary})),a=new r.a(i,(function(e){return e.saveRoamingDictionary})),s=new r.b(i,(function(e){return e.getRoamingDictionary}))},882:function(e,t,n){"use strict";var r=n(0),i=n(32),o=n(526),a=n(1),s=n.n(a);function c(e,t){var n=function(t,n){return s.a.createElement(l,Object(r.__assign)({},t),s.a.createElement(e,Object(r.__assign)({},t)))};return n.displayName=e.displayName,t?s.a.forwardRef(n):n}var l=Object(i.a)((function(e){var t=e.lid,n=e.when,r=e.series,i=e.children,a=e.disposeOnUnmount,c=void 0===a||a;return s.a.useEffect((function(){return Object(o.b)(t,n,r),function(){c&&o.c.importAndExecute(t)}}),[]),i&&d(t)?s.a.createElement(s.a.Fragment,null,i):null}));function u(e,t){o.c.importAndExecute(e,t)}function d(e){if(o.d.unseenItems){var t=o.d.unseenItems.get(e);if(null==t?void 0:t.visible)return!0}return!1}function f(e){var t;return null===(t=o.d.unseenItems)||void 0===t?void 0:t.has(e)}n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return o.a}))},883:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1),o=n(517),a=n(516),s=n(521),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){return i.createElement(s.a,Object(r.__assign)({},this.props,{primary:!0,onRenderDescription:o.b}))},t=Object(r.__decorate)([Object(a.a)("PrimaryButton",["theme","styles"],!0)],t)}(i.Component)},896:function(e,t,n){"use strict";var r=n(1),i=n(1011),o=n(1575),a=n(12),s={root:"ms-StackItem"},c={start:"flex-start",end:"flex-end"};n.d(t,"a",(function(){return l}));var l=Object(o.a)((function(e){var t=e.children;if(r.Children.count(t)<1)return null;var n=Object(i.b)(e,{root:"div"});return Object(i.c)(n.root,null,t)}),{displayName:"StackItem",styles:function(e,t,n){var r=e.grow,i=e.shrink,o=e.disableShrink,l=e.align,u=e.verticalFill,d=e.order,f=e.className,h=Object(a.getGlobalClassNames)(s,t);return{root:[t.fonts.medium,h.root,{margin:n.margin,padding:n.padding,height:u?"100%":"auto",width:"auto"},r&&{flexGrow:!0===r?1:r},(o||!r&&!i)&&{flexShrink:0},i&&!o&&{flexShrink:1},l&&{alignSelf:c[l]||l},d&&{order:d},f]}}})},903:function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(1011),a=n(1575),s=n(445),c=n(55),l=function(e,t){return t.spacing.hasOwnProperty(e)?t.spacing[e]:e},u=function(e){var t=parseFloat(e),n=isNaN(t)?0:t,r=isNaN(t)?"":t.toString();return{value:n,unit:e.substring(r.toString().length)||"px"}},d=function(e,t){if(void 0===e||"number"==typeof e||""===e)return e;var n=e.split(" ");return n.length<2?l(e,t):n.reduce((function(e,n){return l(e,t)+" "+l(n,t)}))},f=n(12),h={start:"flex-start",end:"flex-end"},g={root:"ms-Stack",inner:"ms-Stack-inner"},p=n(896);n.d(t,"a",(function(){return y}));var m={Item:p.a},y=Object(a.a)((function(e){var t=e.as,n=void 0===t?"div":t,a=e.disableShrink,l=e.wrap,u=Object(r.__rest)(e,["as","disableShrink","wrap"]);Object(s.a)("Stack",e,{gap:"tokens.childrenGap",maxHeight:"tokens.maxHeight",maxWidth:"tokens.maxWidth",padding:"tokens.padding"});var d=i.Children.map(e.children,(function(e,t){if(!e)return null;if((o=e)&&"object"==typeof o&&o.type&&o.type.displayName===p.a.displayName){var n={shrink:!a};return i.cloneElement(e,Object(r.__assign)(Object(r.__assign)({},n),e.props))}var o;return e})),f=Object(c.j)(u,c.k),h=Object(o.b)(e,{root:n,inner:"div"});return l?Object(o.c)(h.root,Object(r.__assign)({},f),Object(o.c)(h.inner,null,d)):Object(o.c)(h.root,Object(r.__assign)({},f),d)}),{displayName:"Stack",styles:function(e,t,n){var i,o,a,s,c,p,m,y=e.verticalFill,b=e.horizontal,v=e.reversed,_=e.grow,I=e.wrap,S=e.horizontalAlign,C=e.verticalAlign,O=e.disableShrink,T=e.className,E=Object(f.getGlobalClassNames)(g,t),P=n&&n.childrenGap?n.childrenGap:e.gap,w=n&&n.maxHeight?n.maxHeight:e.maxHeight,j=n&&n.maxWidth?n.maxWidth:e.maxWidth,R=n&&n.padding?n.padding:e.padding,x=function(e,t){if(void 0===e||""===e)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof e)return{rowGap:{value:e,unit:"px"},columnGap:{value:e,unit:"px"}};var n=e.split(" ");if(n.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===n.length)return{rowGap:u(l(n[0],t)),columnGap:u(l(n[1],t))};var r=u(l(e,t));return{rowGap:r,columnGap:r}}(P,t),A=x.rowGap,N=x.columnGap,D=""+-.5*N.value+N.unit,F=""+-.5*A.value+A.unit,k={textOverflow:"ellipsis"},M={"> *:not(.ms-StackItem)":{flexShrink:O?0:1}};return I?{root:[E.root,{flexWrap:"wrap",maxWidth:j,maxHeight:w,width:"auto",overflow:"visible",height:"100%"},S&&(i={},i[b?"justifyContent":"alignItems"]=h[S]||S,i),C&&(o={},o[b?"alignItems":"justifyContent"]=h[C]||C,o),T,{display:"flex"},b&&{height:y?"100%":"auto"}],inner:[E.inner,{display:"flex",flexWrap:"wrap",marginLeft:D,marginRight:D,marginTop:F,marginBottom:F,overflow:"visible",boxSizing:"border-box",padding:d(R,t),width:0===N.value?"100%":"calc(100% + "+N.value+N.unit+")",maxWidth:"100vw",selectors:Object(r.__assign)({"> *":Object(r.__assign)({margin:""+.5*A.value+A.unit+" "+.5*N.value+N.unit},k)},M)},S&&(a={},a[b?"justifyContent":"alignItems"]=h[S]||S,a),C&&(s={},s[b?"alignItems":"justifyContent"]=h[C]||C,s),b&&{flexDirection:v?"row-reverse":"row",height:0===A.value?"100%":"calc(100% + "+A.value+A.unit+")",selectors:{"> *":{maxWidth:0===N.value?"100%":"calc(100% - "+N.value+N.unit+")"}}},!b&&{flexDirection:v?"column-reverse":"column",height:"calc(100% + "+A.value+A.unit+")",selectors:{"> *":{maxHeight:0===A.value?"100%":"calc(100% - "+A.value+A.unit+")"}}}]}:{root:[E.root,{display:"flex",flexDirection:b?v?"row-reverse":"row":v?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:y?"100%":"auto",maxWidth:j,maxHeight:w,padding:d(R,t),boxSizing:"border-box",selectors:Object(r.__assign)((c={"> *":k},c[v?"> *:not(:last-child)":"> *:not(:first-child)"]=[b&&{marginLeft:""+N.value+N.unit},!b&&{marginTop:""+A.value+A.unit}],c),M)},_&&{flexGrow:!0===_?1:_},S&&(p={},p[b?"justifyContent":"alignItems"]=h[S]||S,p),C&&(m={},m[b?"alignItems":"justifyContent"]=h[C]||C,m),T]}},statics:m})},9171:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Remote=0]="Remote",e[e.System=1]="System",e[e.User=2]="User"}(r||(r={}))},9172:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n){this.name=e,this.storeEntryType=t,this.defaultValue=n,this.name=e,this.storeEntryType=t,this.defaultValue=n}}},9173:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9174),i=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new r.BindingWhenSyntax(this._binding)},e}();t.BindingOnSyntax=i},9174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9173),i=n(10587),o=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=i.namedConstraint(e),new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=i.taggedConstraint(e)(t),new r.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return i.typeConstraint(e)(t.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return i.namedConstraint(e)(t.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return i.taggedConstraint(e)(t)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,i.typeConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,i.typeConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,i.namedConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,i.namedConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.taggedConstraint(e)(t))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.taggedConstraint(e)(t))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,e)},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,e)},new r.BindingOnSyntax(this._binding)},e}();t.BindingWhenSyntax=o},9175:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e.Diagnostics="Diagnostics"}(r||(r={})),function(e){e.UnhandledContentError="RunTimeErrors.UnhandledContentError",e.UnhandledBackgroundError="RunTimeErrors.UnhandledBackgroundError",e.UnhandledOptionsPageError="RunTimeErrors.UnhandledOptionsPageError"}(i||(i={}))},9176:function(e,t,n){"use strict";function r(e,t){const n=new Map;let r,i=0,o=0;if(!t)return e.textContent&&n.set(i,e.textContent),n;const a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:e=>(o+=e.length,t&&e.parentElement&&e.parentElement.closest(t)?(r&&(n.set(i,r),r=void 0),i=o,NodeFilter.FILTER_REJECT):e.length?(r||(r=""),r+=e.nodeValue,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT)});for(;a.nextNode(););return r&&n.set(i,r),n}function i(e,t){let n,r,i={firstDiffLeft:0,firstDiffRight:t.length};e.length<t.length?(n=e,r=t):(n=t,r=e),r.startsWith(n)?(i.firstDiffLeft=n.length,i.firstDiffRight=0):r.endsWith(n)?(i.firstDiffLeft=0,i.firstDiffRight=n.length):(i=a(e,t),i.firstDiffLeft+i.firstDiffRight>n.length&&(i.firstDiffRight=n.length-i.firstDiffLeft)),o(i,e,t);i.firstDiffLeft<e.length&&c(e,i.firstDiffLeft)||i.firstDiffLeft<t.length&&c(t,i.firstDiffLeft),i.firstDiffRight>0&&(i.firstDiffRight<e.length&&c(e,e.length-i.firstDiffRight)||i.firstDiffRight<t.length&&c(t,t.length-i.firstDiffRight));return i}function o(e,t,n){if(e.firstDiffLeft>0){const r=e.firstDiffLeft<t.length&&c(t,e.firstDiffLeft),i=e.firstDiffLeft<n.length&&c(n,e.firstDiffLeft);(r||i)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const r=e.firstDiffRight<t.length&&c(t,t.length-e.firstDiffRight),i=e.firstDiffRight<n.length&&c(n,n.length-e.firstDiffRight);(r||i)&&(e.firstDiffRight-=1)}}function a(e,t){const n={firstDiffLeft:0,firstDiffRight:t.length};let r;for(r=0;r<e.length&&r<t.length;r+=1){const n=e.charCodeAt(r),i=t.charCodeAt(r);if(!(n===i||s(n)&&s(i)))break}for(n.firstDiffLeft=r,r=0;r<e.length&&r<t.length;r+=1){const n=e.charCodeAt(e.length-r-1),i=t.charCodeAt(t.length-r-1);if(!(n===i||s(n)&&s(i)))break}return n.firstDiffRight=r,n}function s(e){switch(e){case 12288:case 8197:case 32:case 13:case 10:case 65532:case 11:case 9:case 160:return!0}return!1}function c(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}function l(e,t){return e.charCodeAt(t)>=55296&&e.charCodeAt(t)<=56319}function u(e){const t=e.toString();return t.toLowerCase()!==t.toUpperCase()}n.r(t),n.d(t,"extractTextContent",(function(){return r})),n.d(t,"getMinimalDifferenceBounds",(function(){return i})),n.d(t,"trimDifferenceBounds",(function(){return o})),n.d(t,"getDifferenceBounds",(function(){return a})),n.d(t,"isWhitespace",(function(){return s})),n.d(t,"isLowSurrogateCharAt",(function(){return c})),n.d(t,"isHighSurrogateCharAt",(function(){return l})),n.d(t,"isAlpha",(function(){return u})),n.d(t,"numbers",(function(){return d})),n.d(t,"isNumeric",(function(){return f})),n.d(t,"isAlphaNum",(function(){return h}));const d="0123456789";function f(e){return d.indexOf(e)>=0}function h(e){return u(e)||f(e)}},9177:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"TextUnit",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=4]="Sentence",e[e.Paragraph=8]="Paragraph",e[e.Page=16]="Page",e[e.Section=32]="Section",e[e.Chapter=64]="Chapter",e[e.Document=256]="Document",e[e.RawChars=16384]="RawChars"}(r||(r={}))},9178:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=-1]="Unknown",e[e.WhiteSpace=0]="WhiteSpace",e[e.Punctuation=1]="Punctuation",e[e.Undetermined=2]="Undetermined",e[e.AlphaNumeric=3]="AlphaNumeric",e[e.Invalid=4]="Invalid",e[e.PuncuationWithoutBreak=5]="PuncuationWithoutBreak",e[e.FootnoteEndnotePunctuation=6]="FootnoteEndnotePunctuation"}(r||(r={}))},9179:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoReaction=0]="NoReaction",e[e.EnableFeature=1]="EnableFeature",e[e.DisableFeature=2]="DisableFeature"}(r||(r={}))},9180:function(e,t,n){"use strict";var r,i,o;n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),function(e){e[e.CritiqueClicked=0]="CritiqueClicked",e[e.UpsellButtonClicked=1]="UpsellButtonClicked",e[e.ShowPage=2]="ShowPage",e[e.TryPremiumPreviewButtonClicked=3]="TryPremiumPreviewButtonClicked"}(r||(r={})),function(e){e[e.ShowCritiqueCallout=0]="ShowCritiqueCallout",e[e.SettingsPage=1]="SettingsPage",e[e.Outlook=2]="Outlook"}(i||(i={})),function(e){e.Regular_CCard="Regular_CCard",e.ContextualUpsell_CCard="ContextualUpsell_CCard",e.ContextualUpsell_SkittleOpenUpsellCallout="ContextualUpsell_SkittleOpenUpsellCallout",e.PremiumPreview_CCard="PremiumPreview_CCard",e.PremiumPreview_SkittleOpenOptInDialog="PremiumPreview_SkittleOpenOptInDialog",e.PremiumPreview_CCardOpenOptInDialog="PremiumPreview_CCardOpenOptInDialog",e.PremiumPreview_SkittleOpenPreviewEndCallout="PremiumPreview_SkittleOpenPreviewEndCallout",e.PremiumPreview_CCardOpenPreviewEndCallout="PremiumPreview_CCardOpenPreviewEndCallout",e.PremiumPreview_CountdownCallout="PremiumPreview_CountdownCallout",e.Regular_SettingsDialog="Regular_SettingsDialog",e.ContextualUpsell_SettingsDialog="ContextualUpsell_SettingsDialog",e.PremiumPreview_SettingsDialog="PremiumPreview_SettingsDialog"}(o||(o={}))},9181:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9182);function i(e,t=""){window.open(Object(r.a)(e,t),"_blank","noopener,noreferrer")}},9182:function(e,t,n){"use strict";function r(e,t){if(!function(e){if(0===e.trim().length)return!1;try{return new URL(e),!0}catch(e){return!1}}(e))return e;const n=new URL(e),r=t.trim();return n.pathname.endsWith("/")?n.pathname+=r:n.pathname=`${n.pathname}/${r}`,n.toString()}n.d(t,"a",(function(){return r}))},9183:function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e[e.SettingsClicked=0]="SettingsClicked"}(r||(r={})),function(e){e[e.dropdown=0]="dropdown"}(i||(i={}))},969:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),i=n(1),o=n(209),a=n(310),s=n(465),c=Object(o.a)(),l=function(e){function t(t){var n=e.call(this,t)||this;return n._link=i.createRef(),n._renderContent=function(e){void 0===e&&(e={});var t=n.props,o=t.disabled,a=t.children,s=t.className,l=t.href,u=t.theme,d=t.styles,f=c(d,{className:s,isButton:!l,isDisabled:o,theme:u}),h=n._getRootType(n.props);return i.createElement(h,Object(r.__assign)({},e,n._adjustPropsForRootType(h,n.props),{className:f.root,onClick:n._onClick,ref:n._link,"aria-disabled":o}),a)},n._onClick=function(e){var t=n.props,r=t.onClick;t.disabled?e.preventDefault():r&&r(e)},Object(a.a)(n),n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.disabled,r=t.keytipProps;return r?i.createElement(s.a,{keytipProps:r,ariaDescribedBy:this.props["aria-describedby"],disabled:n},(function(t){return e._renderContent(t)})):this._renderContent()},t.prototype.focus=function(){var e=this._link.current;e&&e.focus&&e.focus()},t.prototype._adjustPropsForRootType=function(e,t){t.children,t.as;var n=t.disabled,i=t.target,o=t.href,a=(t.theme,t.getStyles,t.styles,t.componentRef,t.keytipProps,Object(r.__rest)(t,["children","as","disabled","target","href","theme","getStyles","styles","componentRef","keytipProps"]));return"string"==typeof e?"a"===e?Object(r.__assign)({target:i,href:n?void 0:o},a):"button"===e?Object(r.__assign)({type:"button",disabled:n},a):Object(r.__assign)(Object(r.__assign)({},a),{disabled:n}):Object(r.__assign)({target:i,href:o,disabled:n},a)},t.prototype._getRootType=function(e){return e.as?e.as:e.href?"a":"button"},t}(i.Component)}}]);
//# sourceMappingURL=owa.MailBoot~ProofingPlugin.js.map
self.scriptsLoaded['owa.MailBoot~ProofingPlugin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ProofingPlugin.js'] = (new Date()).getTime();