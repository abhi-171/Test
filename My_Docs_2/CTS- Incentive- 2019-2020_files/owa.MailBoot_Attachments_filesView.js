self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~filesView.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[210],{1040:function(t,e,n){"use strict";var r=function(){function t(){this.eventDictionary={}}return t.prototype.on=function(t,e,n){return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:e,callbackThis:n}),this},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=(this.eventDictionary[t]||[]).slice();return r.forEach((function(t){return t.callback.apply(t.callbackThis,e)})),this},t.prototype.off=function(t,e){var n=this.eventDictionary[t];if(n){var r=n.filter((function(t){return t.callback!==e}));r.length?this.eventDictionary[t]=r:delete this.eventDictionary[t]}return this},t.prototype.once=function(t,e,n){var r=this,a=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return r.off(t,a),e.apply(n,i)};return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:a,callbackThis:n}),this},t}();e.a=r},13575:function(t){t.exports=JSON.parse('{"a":"Q7a"}')},13578:function(t){t.exports=JSON.parse('{"a":"b8a"}')},13579:function(t){t.exports=JSON.parse('{"b":"R7a","d":"S7a","e":"T7a","c":"U7a","f":"V7a","a":"W7a"}')},1641:function(t,e,n){"use strict";function r(t){if(!t)return null;var e=t.lastIndexOf(".");return e>0?t.substr(e).toLowerCase():null}function a(t){var e=r(t);return e?e.replace(".",""):null}function i(t){var e;return(null===(e=a(t))||void 0===e?void 0:e.substring(0,4))||""}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i}))},1669:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),a=n(16),i=Object(r.createStore)("groupsStore",{groups:new a.ObservableMap})},1674:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(331);function a(t){var e;return null===(e=Object(r.a)(t))||void 0===e?void 0:e.AttachmentPolicy}},1682:function(t,e,n){"use strict";var r,a,i;n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return i})),function(t){t[t.Compose=0]="Compose",t[t.Extensibility=1]="Extensibility",t[t.ReadingPane=2]="ReadingPane",t[t.Fileshub=3]="Fileshub",t[t.Txp=4]="Txp",t[t.Peek=5]="Peek",t[t.CalendarCard=6]="CalendarCard"}(r||(r={})),function(t){t[t.SmimeSignature=0]="SmimeSignature",t[t.Safety=1]="Safety",t[t.Error=2]="Error",t[t.Info=3]="Info",t[t.Encryption=4]="Encryption",t[t.Translation=5]="Translation",t[t.Sensitivity=6]="Sensitivity",t[t.InsightMessage=7]="InsightMessage",t[t.External=8]="External",t[t.Spotlight=9]="Spotlight"}(a||(a={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow",t[t.Orange=4]="Orange",t[t.Green20=5]="Green20"}(i||(i={}))},1683:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1669);function a(t){var e=Object(r.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},1684:function(t,e,n){"use strict";var r=n(3),a=n(16),i=(Object(r.createStore)("personaPhotoStore",{personaPhotoUrls:new a.ObservableMap})(),n(1811),n(1732),n(1669)),o=n(1685),c=n(1683);function u(t){var e=Object(i.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}var s=n(1754),l=n(1787),d=function(){return Object(l.a)().smtpAddress},f=n(1723),h=Object(r.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,n,r){if(2==e){var a=Object(c.a)(t);Object(s.a)(a,"Site")[0].Url=n,Object(s.a)(a,"Files")[0].Url=r}})),m=n(1847);function p(t){return t=t.toLocaleLowerCase(),Object(f.a)().groupSiteStatus.has(t)?Object(f.a)().groupSiteStatus.get(t):0}var b=function(t){var e="string"==typeof t?Object(c.a)(t):t;return e?e.ExternalDirectoryObjectId:null},v=(n(1695),n(1840),n(1831),n(1848),n(1841),n(2107)),g=n(2108),I=n(2132),O=n(2083),A=n(2084),j=n(7);function _(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(j.b)(O.a);if(3===e)return Object(j.b)(A.a)}return""}function C(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(j.b)(I.b);if(3===e)return Object(j.b)(I.c)}return""}function y(t){var e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(j.c)(Object(j.b)(g.a),e.toString()):Object(j.c)(Object(j.b)(v.a),e.toString()):Object(j.b)(I.a)}n.d(e,"j",(function(){return i.a})),n.d(e,"l",(function(){return o.a})),n.d(e,"d",(function(){return c.a})),n.d(e,"m",(function(){return u})),n.d(e,"f",(function(){return s.a})),n.d(e,"g",(function(){return s.b})),n.d(e,"c",(function(){return d})),n.d(e,"i",(function(){return f.a})),n.d(e,"o",(function(){return h})),n.d(e,"n",(function(){return m.b})),n.d(e,"h",(function(){return p})),n.d(e,"e",(function(){return b})),n.d(e,"a",(function(){return _})),n.d(e,"b",(function(){return C})),n.d(e,"k",(function(){return y}))},1685:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),a=n(1732),i=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:a.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1695:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(r||(r={})),e.a=r},1704:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return l}));var r=n(3),a=Object(r.action)("ADD_SHARING_LINK",(function(t,e,n,r,a,i,o,c){return{linkId:t,url:e,sharingLinkIds:n,response:r,source:a,providerType:i,unwrappedUrl:o,creationDateTime:c}})),i=Object(r.action)("SHARING_LINK_REMOVED",(function(t,e){return{linkId:t,sharingLinkIds:e}})),o=Object(r.action)("DELETE_LINK",(function(t,e){return{linkId:t,targetWindow:e}})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(function(t,e,n,r){return{linkId:t,providerId:e,isTryAgain:n,targetWindow:r}})),u=Object(r.action)("ON_LINK_HAS_CHANGED",(function(t,e,n,r){return{linkId:t,recipientInfos:e,composeId:n,isCalendar:r}})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(function(t,e){return{linkId:t,linkIdContainer:e}})),l=Object(r.action)("ON_FLUID_LINK_CREATED",(function(t,e,n,r){return{linkId:t,containerId:e,owaSource:n,url:r}}))},1723:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),a=n(16),i=Object(r.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new a.ObservableMap})},1729:function(t,e,n){"use strict";n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return s})),n.d(e,"d",(function(){return l}));var r=n(3),a=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(function(t,e){return{linkId:t,sharingDialogResponse:e}})),i=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(function(t,e){return{linkId:t,newPermission:e}})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(function(t,e,n,r){return{linkId:t,newLinkUrl:e,oldLinkUrl:n,expirationDate:r}})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(function(t,e){return{linkId:t,actionStatus:e}})),u=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(function(t,e,n,r,a,i,o,c,u){return{linkId:t,sharingUrl:e,currentUrl:n,canonicalUrl:r,newPermissionLevel:a,providerType:i,composeId:o,recipientInfos:c,isCalendar:u}})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(function(t,e){return{linkId:t,linkModel:e}})),l=Object(r.action)("TOKEN_UNAVAILABLE",(function(t){return{linkId:t}}))},1732:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(r||(r={}))},1754:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n(1683),a=function(t,e){var n="string"==typeof t?Object(r.a)(t):t;if(!n||!n.GroupResources)return null;var a=n.GroupResources.filter((function(t){return t.Name===e}));return!a||a.length<1?null:a},i=function(t,e){var n=a(t,e);return n&&0!=n.length?n[0].Url:null}},1760:function(t,e,n){"use strict";n.d(e,"n",(function(){return c})),n.d(e,"q",(function(){return u})),n.d(e,"r",(function(){return s})),n.d(e,"a",(function(){return l})),n.d(e,"p",(function(){return d})),n.d(e,"f",(function(){return f})),n.d(e,"u",(function(){return h})),n.d(e,"g",(function(){return m})),n.d(e,"d",(function(){return p})),n.d(e,"e",(function(){return b})),n.d(e,"j",(function(){return v})),n.d(e,"i",(function(){return g})),n.d(e,"l",(function(){return I})),n.d(e,"k",(function(){return O})),n.d(e,"c",(function(){return A})),n.d(e,"o",(function(){return j})),n.d(e,"s",(function(){return _})),n.d(e,"b",(function(){return C})),n.d(e,"m",(function(){return y})),n.d(e,"h",(function(){return S})),n.d(e,"t",(function(){return w}));var r=n(44),a=n(1923);n.d(e,"v",(function(){return a.a}));var i=n(1924);n.d(e,"w",(function(){return i.a}));var o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(20),n.e(23),n.e(27),n.e(30),n.e(32),n.e(36),n.e(41),n.e(44),n.e(55),n.e(63),n.e(64),n.e(68),n.e(92),n.e(104),n.e(147),n.e(148),n.e(210),n.e(209),n.e(208),n.e(211),n.e(315)]).then(n.bind(null,2981))})),c=new r.a(o,(function(t){return t.initializeAttachments})),u=new r.a(o,(function(t){return t.reinitializeAttachments})),s=new r.a(o,(function(t){return t.setInlineAttachmentStatus})),l=new r.a(o,(function(t){return t.addAttachmentIntoWellBeforeUpload})),d=new r.b(o,(function(t){return t.refreshSharingTipsAttachmentWell})),f=new r.b(o,(function(t){return t.createAttachmentsViaQueueManager})),h=new r.b(o,(function(t){return t.createAttachmentsFromRecentAttachments})),m=new r.a(o,(function(t){return t.deleteAttachmentViaQueueManager})),p=new r.b(o,(function(t){return t.createAttachmentFullViewStateAndStoreBackingModel})),b=new r.b(o,(function(t){return t.createAttachmentFullViewState})),v=new r.b(o,(function(t){return t.getAttachmentWellInitialValue})),g=new r.b(o,(function(t){return t.getAttachmentWellForCompose})),I=new r.b(o,(function(t){return t.getConversationAttachmentWellInitialValue})),O=(new r.b(o,(function(t){return t.getMaxClassicAttachmentsSize})),new r.b(o,(function(t){return t.getAvailableLocalAttachmentSize}))),A=new r.b(o,(function(t){return t.createAttachmentFileFromExistingMailboxAttachment})),j=new r.a(o,(function(t){return t.mergeToConversationAttachmentWell})),_=new r.a(o,(function(t){return t.sortConversationAttachmentWell})),C=new r.a(o,(function(t){return t.convertImageViewAttachmentToInlineAttachment})),y=new r.b(o,(function(t){return t.getLastCloudyAttachmentsSharingIssueForBlockOnSend})),S=new r.b(o,(function(t){return t.getAllValidAttachments})),w=new r.b(o,(function(t){return t.uploadLocalFile}))},1771:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2153),a=n(1817);function i(t){var e=Object(r.a)(),n=Object(a.b)(t);return e.sharingLinks.get(n)}},1773:function(t,e,n){"use strict";var r,a=n(44),i=n(1704),o=n(1729),c=n(2195);!function(t){t.PasteHtml="PasteHtml",t.InsertLinkFromToolbar="InsertLinkFromToolbar",t.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",t.AutoLink="AutoLink",t.ReplyOrForward="ReplyOrForward",t.LinkContextMenu="LinkContextMenu",t.Undo="Undo",t.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",t.RestoreCursor="RestoreCursor",t.ShareLinkCompose="ShareLinkCompose",t.NewFluidFile="NewFluidFile",t.Unknown="Unknown"}(r||(r={}));var u=n(2054),s=n(1817),l=n(1771),d=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function f(t){var e=Object(l.a)(t);return e&&-1!==d.indexOf(e.source)}var h=n(2092);function m(t){var e=Object(l.a)(t);return e?{id:e.linkId,name:e.fileName,supportsDownsell:!1,currentPermissionLevel:e.permissionLevel,sharingInfo:e.sharingInfo,sharingTipsIgnored:e.sharingTipsIgnored,sharingRecipientsInfo:e.sharingRecipientsInfo,typeOfLink:f(t)?"newLink":"oldLink"}:null}var p=n(2153);function b(){return Object(p.a)().sharingLinks.size}var v=n(2196);n.d(e,"q",(function(){return I})),n.d(e,"u",(function(){return O})),n.d(e,"y",(function(){return A})),n.d(e,"w",(function(){return j})),n.d(e,"v",(function(){return _})),n.d(e,"t",(function(){return C})),n.d(e,"x",(function(){return y})),n.d(e,"s",(function(){return S})),n.d(e,"r",(function(){return w})),n.d(e,"B",(function(){return g})),n.d(e,"c",(function(){return i.a})),n.d(e,"d",(function(){return i.b})),n.d(e,"e",(function(){return i.c})),n.d(e,"g",(function(){return i.d})),n.d(e,"E",(function(){return i.g})),n.d(e,"z",(function(){return i.e})),n.d(e,"A",(function(){return i.f})),n.d(e,"F",(function(){return o.e})),n.d(e,"G",(function(){return o.f})),n.d(e,"H",(function(){return o.g})),n.d(e,"D",(function(){return o.c})),n.d(e,"f",(function(){return o.b})),n.d(e,"C",(function(){return c.b})),n.d(e,"a",(function(){return r})),n.d(e,"n",(function(){return u.a})),n.d(e,"h",(function(){return s.a})),n.d(e,"i",(function(){return s.b})),n.d(e,"p",(function(){return s.c})),n.d(e,"o",(function(){return f})),n.d(e,"b",(function(){return h.a})),n.d(e,"l",(function(){return l.a})),n.d(e,"k",(function(){return m})),n.d(e,"j",(function(){return b})),n.d(e,"m",(function(){return v.a}));var g=new a.c((function(){return Promise.all([n.e(3),n.e(32),n.e(67),n.e(626)]).then(n.bind(null,17119))})),I=new a.b(g,(function(t){return t.addRecipientsIntoLink})),O=new a.b(g,(function(t){return t.removeRecipientsFromLink})),A=new a.b(g,(function(t){return t.updateRecipientPermissionInfos})),j=new a.b(g,(function(t){return t.setGetPermissionInfoFailure})),_=new a.b(g,(function(t){return t.resetSharingRecipientsInfo})),C=new a.b(g,(function(t){return t.ignoreSharingTip})),y=new a.b(g,(function(t){return t.setLinkActionStatus})),S=new a.b(g,(function(t){return t.getSharingTipRecipientInfo})),w=new a.b(g,(function(t){return t.createCloudFileFromSharingLink}))},1811:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(40),a=n(1685),i=n(85);function o(){return(Object(r.i)("grp-shareable-crud")||Object(a.a)().isSensitivityLabelsEnabled)&&!Object(i.s)()}},1817:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return c}));var r=n(40),a="_ODSPPSL";function i(t){return Object(r.i)("doc-link-savePermission")&&t&&-1!==t.indexOf(a)?t.substring(0,t.length-a.length):t}function o(t){return!!Object(r.i)("doc-link-savePermission")&&t.lastIndexOf(a)===t.length-a.length}function c(t,e){return!Object(r.i)("doc-link-savePermission")||2!==e&&1!==e?t:t+a}},1831:function(t,e,n){"use strict";var r=n(3),a=n(1885),i=Object(r.mutatorAction)("setJoinButtonState",(function(t,e){a.a.groupActionState.set(t.toLowerCase(),e)}));e.a=i},1840:function(t,e,n){"use strict";var r=n(3),a=n(1884),i=Object(r.mutatorAction)("setFollowButtonState",(function(t,e){a.a.groupActionState.set(t.toLowerCase(),e)}));e.a=i},1841:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1695),a=n(1885);function i(t){t=t.toLowerCase();var e=a.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1847:function(t,e,n){"use strict";n.d(e,"b",(function(){return i}));var r=n(3),a=n(1723),i=Object(r.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(a.a)().groupSiteStatus.has(t)&&e==Object(a.a)().groupSiteStatus.get(t)||Object(a.a)().groupSiteStatus.set(t,e)}));e.a=i},1848:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1695),a=n(1884);function i(t){t=t.toLowerCase();var e=a.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1860:function(t,e,n){"use strict";var r=n(0),a=n(2302),i=n(3);var o=Object(i.mutatorAction)("removeInfoBarMessages",(function(t,e){t&&(Array.isArray(e)?e:e?[e]:t.infoBarIds?Object(r.__spread)(t.infoBarIds):[]).forEach((function(e){return function(t,e){var n=t.infoBarIds&&t.infoBarIds.indexOf(e);n>=0&&t.infoBarIds.splice(n,1);var r=t.infoBarHostKey;a.b[r]&&(delete a.b[r][e],0===Object.keys(a.b[r]).length&&delete a.b[r])}(t,e)}))}));e.a=o},1864:function(t,e,n){"use strict";var r=n(0),a=n(2302),i=n(188),o=Object(i.action)("addInfoBarMessage")((function(t,e,n){if(t){-1==t.infoBarIds.indexOf(e)?t.infoBarIds.push(e):t.infoBarIds=Object(r.__spread)(t.infoBarIds);var i=t.infoBarHostKey;n&&(a.b[i]||(a.b[i]={}),a.b[i][e]=n)}}));e.a=o},1884:function(t,e,n){"use strict";var r=n(3),a=n(16);e.a=Object(r.createStore)("followButtonStore",{groupActionState:new a.ObservableMap})()},1885:function(t,e,n){"use strict";var r=n(3),a=n(16);e.a=Object(r.createStore)("joinButtonStore",{groupActionState:new a.ObservableMap})()},1923:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("ON_ATTACHMENT_CREATED",(function(t,e,n){return{parentItemId:t,attachmentId:e,attachment:n}}))},1924:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("ON_ATTACHMENT_DELETED",(function(t,e,n){return{parentItemId:t,attachmentId:e,attachment:n}}))},2054:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1641);function a(t){var e=(Object(r.a)(t)||"").toLowerCase();return!!t&&".fluid"===e}},2083:function(t){t.exports=JSON.parse('{"a":"eva"}')},2084:function(t){t.exports=JSON.parse('{"a":"dva"}')},2092:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.none=0]="none",t[t.refreshing=1]="refreshing",t[t.refreshFailed=2]="refreshFailed",t[t.refreshSucceeded=3]="refreshSucceeded",t[t.attachingAsACopy=4]="attachingAsACopy",t[t.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2093:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"d",(function(){return s})),n.d(e,"b",(function(){return l}));var r=n(44),a=new r.c((function(){return n.e(916).then(n.bind(null,2984))})),i=new r.b(a,(function(t){return t.extractFileUrlFromOfficeSharePointLink})),o=new r.b(a,(function(t){return t.isLinkPrefixedWithBaseUrl})),c=new r.b(a,(function(t){return t.isSharePointLink})),u=new r.b(a,(function(t){return t.isSharePointServiceGeneratedLink})),s=new r.b(a,(function(t){return t.isOfficeSharePointLink})),l=new r.b(a,(function(t){return t.getParsedQueryStringFromUrl}))},2107:function(t){t.exports=JSON.parse('{"a":"cva"}')},2108:function(t){t.exports=JSON.parse('{"a":"iva"}')},213:function(t,e,n){var r;
/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var i=typeof r;if("string"===i||"number"===i)t.push(r);else if(Array.isArray(r))t.push(a.apply(null,r));else if("object"===i)for(var o in r)n.call(r,o)&&r[o]&&t.push(o)}}return t.join(" ")}t.exports?t.exports=a:void 0===(r=function(){return a}.apply(e,[]))||(t.exports=r)}()},2132:function(t){t.exports=JSON.parse('{"b":"fva","c":"gva","a":"hva"}')},2153:function(t,e,n){"use strict";var r=n(16),a=n(3),i={sharingLinks:new r.ObservableMap({})},o=Object(a.createStore)("sharingLinkStore",i);e.a=o},2166:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Initial=0]="Initial",t[t.Adaptive=1]="Adaptive",t[t.Show=2]="Show",t[t.Hide=3]="Hide",t[t.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},2187:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Blank=0]="Blank",t[t.Loading=1]="Loading",t[t.Error=2]="Error",t[t.Custom=3]="Custom",t[t.Image=4]="Image",t[t.Wac=5]="Wac",t[t.Audio=6]="Audio",t[t.Video=7]="Video",t[t.Text=8]="Text",t[t.NativePdf=9]="NativePdf",t[t.PdfJs=10]="PdfJs",t[t.IFrame=11]="IFrame"}(r||(r={}))},2195:function(t,e,n){"use strict";function r(t){return void 0!==t.recipients}function a(t){return void 0!==t.length}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}))},2196:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0),a=n(2093),i=n(80),o=n(316);function c(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,a.b.import()];case 1:return e=n.sent(),[2,u(e(t))]}}))}))}function u(t){if(!Object(i.b)(null==t?void 0:t.nav)){var e={nav:t.nav};return Object(o.stringify)(e)}return null}},2302:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}));var r={};function a(t,e){var n,a=t.infoBarHostKey;return null===(n=r[a])||void 0===n?void 0:n[e]}},2981:function(t,e,n){"use strict";n.r(e);var r=n(1773),a=n(3);function i(t,e){e&&!t.includes(e)&&t.push(e)}Object(a.mutator)(r.c,(function(t){i(t.sharingLinkIds,t.linkId)})),Object(a.mutator)(r.E,(function(t){var e,n,r;e=t.sharingLinkIds,n=t.linkId,-1!==(r=e.indexOf(n))&&e.splice(r,1)})),Object(a.mutator)(r.d,(function(t){i(t.linkIdContainer,t.linkId)}));var o=n(6510);Object(a.mutator)(o.a,(function(t){var e=t.attachmentWell,n=t.message;e.announcedComponentMessage=n}));var c=n(0),u=n(13575),s=n(7),l=Object(a.action)("REFRESH_SHARING_TIPS_ATTACHMENT_WELL",(function(t,e,n,r,a){return{attachmentWellViewState:t,parentItemId:e,recipientInfo:n,infoBarIds:r,infoBar:a}})),d=n(5801),f=n(7782),h=n(1675);function m(t){var e,n=t.docViewAttachments.concat(t.imageViewAttachments);return(e=n,e.filter((function(t){return t.isCloudy})).map((function(t){return function(t,e){if(1!==t.type)return null;var n=t.model;return{id:t.id,name:n.Name,supportsDownsell:e,currentPermissionLevel:n.PermissionType,sharingInfo:t.info.sharingInfo,sharingRecipientsInfo:{recipientPermissionInfos:[]},sharingTipsIgnored:[],typeOfLink:"referenceAttachment"}}(Object(h.a)(t.attachmentId),t.strategy.isConvertCloudyToClassicSupported)}))).filter((function(t){var e;return null===(e=t.sharingInfo)||void 0===e?void 0:e.getSharingInfoSucceeded}))}var p=n(134),b=n(1864),v=n(1860),g=n(1953),I=n(2055);function O(t,e,n,r){return A(t,m(e),n,[],null,r,!0,null)}function A(t,e,n,r,a,i,o,c){for(var u,s=0;s<t.length;s++){var l=j(t[s],e,n,r,a,i,o,c);l&&(u=l)}if("function"==typeof u){var d=u(null);if((null==d?void 0:d.messageParts)&&d.messageParts.length>0&&"string"==typeof d.messageParts[0])return d.messageParts[0]}else if("object"==typeof u&&u.length>0)return u[0];return null}function j(t,e,n,r,a,i,o,c){var u=i(e,t,n,o,c);return Object(v.a)(a,[t]),u&&(Object(b.a)(a,t,u),r.push(t)),u}Object(a.orchestrator)(l,(function(t){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var e,n,r,a,i,o,l,b,v,O,j;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return e=t.attachmentWellViewState,n=t.parentItemId,r=t.recipientInfo,a=t.infoBarIds,i=t.infoBar,o=m(e),l=new p.b("AttachmentRefreshSharingTips"),b=function(t){var r=Object(d.a)(e,t);if(r){var a=Object(h.a)(r.attachmentId);return{text:Object(s.b)(u.a),action:function(){var t=a.model;Object(p.r)("SharingTipsConvertToClassic"),Object(g.f)(r,n.Id,t.AttachLongPathName,t.PermissionType,(function(t,n,r,a){Object(f.a)(e,t,n,r,a)}),1)}}}return null},v=Object(I.d)(),O=[],[4,I.f.import()];case 1:return j=c.sent(),A(v,o,r,O,i,j,!1,b),function(t,e){var n=Object(I.d)(),r=t.filter((function(t){return-1!==n.indexOf(t)})),a=e.filter((function(t){return-1===r.indexOf(t)})),i=r.filter((function(t){return-1===e.indexOf(t)}));0!==a.length&&Object(p.r)("AttachmentSharingTipAdded",a);0!==i.length&&Object(p.r)("AttachmentSharingTipsRemoved",i)}(a,O),Promise.resolve().then((function(){return l.end()})),[2]}}))}))}));Object(a.orchestrator)(o.a,(function(t){var e=t.attachmentWell;null!==t.message&&setTimeout((function(){Object(o.a)(e,null)}),2e3)}));var _=n(8731),C=n(52),y=n(2062),S=n(2036);var w=n(5330),T=n(3183),F=n(5802),k=n(3311),E=n(4542);var P=Object(C.d)("initializeAttachments",F.a.AttachmentWellInitialization)((function(t,e,n,r,a,i,o,u,s){if(t){var l=function(t){return t?Object(g.o)().filter((function(e){return!t.includes(e)})):null}(i);u&&n.docViewAttachments.length>0&&n.docViewAttachments.forEach((function(t){var e;(function(t){var e=Object(h.a)(t);if(null==e?void 0:e.model){return"IPM.Appointment"===e.model.EmbeddedItemClass}return!1})(t.attachmentId)&&((e=t.strategy).previewMethod=S.a.Unsupported,e.supportedOpenActions=e.supportedOpenActions.filter((function(t){return t!==y.a.Preview})))})),n.isInitialized||t.forEach((function(t){!function(t,e,n,r,a,i,o){if(!("application/x-sharing-metadata-xml"===t.ContentType||o&&Object(T.a)(t))){var u=Object(g.h)(Object(c.__assign)(Object(c.__assign)({},t.AttachmentId),{mailboxInfo:e}),t,n.isReadOnly,!0,r,o,null,a,!0),s=!!n.parentItemIdMap;if(t.IsInline&&t.__type!==k.d&&t.ContentId&&""!=t.ContentId&&"unknown"!=t.ContentId.toLowerCase()?n.inlineAttachments.push(Object(g.i)(t.AttachmentId,t.AttachmentId.Id,!0,4)):Object(w.a)(t)&&!s?n.imageViewAttachments.push(u):n.docViewAttachments.push(u),u.isCloudy){var l=Object(h.a)(u.attachmentId);l.requiresFetchingSharingInformation&&i&&Object(g.m)(l)}else Object(E.a)(n,t.Size,t.AttachmentId)}}(t,e,n,r,l,o,s)})),n.supportedMenuActions=l,n.isInitialized=!0}}));var x=n(188),B=Object(x.action)("reinitializeAttachments")((function(t,e,n,r,a){t&&(n.docViewAttachments=[],n.imageViewAttachments=[],n.inlineAttachments=[],n.isInitialized=!1,P(t,e,n,r,!1,a))})),N=n(4892);function D(t,e){var n=Object(N.a)(!1,void 0===e,t);if(e){var r=e.attachments,a=e.mailboxInfo,i=e.parentItemId;P(r,a,n,!0,!0,null,i)}return n}var R=n(8732);function L(t,e){var n=Object(N.a)(!0,!1,"");return Object(c.__assign)(Object(c.__assign)({},n),{parentItemIdMap:t,itemReceivedTimeMap:e,isVisible:!1,maxHeight:0})}var U=n(4174),M=n(1913),H=n(2447),W=function(t,e,n,r){if(t){var a=t.docViewAttachments,i=t.imageViewAttachments,o=t.inlineAttachments.filter((function(t){var r=Object(h.a)(t.attachmentId);if((null==r?void 0:r.model)&&"HTML"===n){var a=e;return a&&!Object(H.l)(a,r.model)}return!1})),u=Object(c.__spread)(a,i,o);return r?u.filter((function(t){return Object(M.b)(t.attachmentId.Id)})):u.filter((function(t){return!Object(M.b)(t.attachmentId.Id)}))}return[]},z=n(5329),V=n(4232),G=n(4550),q=n(7675),Q=n(1715),K=n(1760),J=n(1793);function Z(t,e,n,r,a,i){return Object(c.__awaiter)(this,void 0,void 0,(function(){var o,u,s,l;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return[4,K.c.import()];case 1:return o=c.sent(),u=n.filter((function(t){return e=t,!(Object(J.a)(e)&&e.IsInline);var e})).map(o),s=u.filter((function(t){return t.fileType===Q.a.Cloud})),(l=u.filter((function(t){return t.fileType===Q.a.AttachmentItem}))).length>0&&X(e,t,l,r,!1,!1,a,i),s.length>0&&X(e,t,s,r,!1,!0,a,i),[2]}}))}))}function X(t,e,n,r,a,i,o,u){var s={isInline:a,isHiddenInline:!1},l=i?Object(c.__assign)(Object(c.__assign)({},s),{shouldShare:!0}):Object(c.__assign)(Object(c.__assign)({},s),{shouldShare:!1});K.f.import().then((function(a){a(t,e,n,r,l,null,o,u)}))}var Y=n(6559),$=Object(a.mutatorAction)("mergeToConversationAttachmentWell",(function(t,e,n,r){t&&(t.docViewAttachments.forEach((function(t){tt(t,e,n,r)})),t.imageViewAttachments.forEach((function(t){tt(t,e,n,r)})))}));function tt(t,e,n,r){e.parentItemIdMap[t.attachmentId.Id]||(e.docViewAttachments.push(Object(c.__assign)({},t)),e.parentItemIdMap[t.attachmentId.Id]=n,e.itemReceivedTimeMap[t.attachmentId.Id]=r)}var et=Object(a.mutatorAction)("sortConversationAttachmentWell",(function(t,e){t.docViewAttachments=t.docViewAttachments.sort((function(n,r){return(e?1:-1)*(new Date(t.itemReceivedTimeMap[n.attachmentId.Id]).getTime()-new Date(t.itemReceivedTimeMap[r.attachmentId.Id]).getTime())}))})),nt=n(2393),rt=Object(a.mutatorAction)("convertImageViewAttachmentToInlineAttachment",(function(t,e,n){var r=Object(h.a)(e.attachmentId);if(r){var a=t.imageViewAttachments,i=t.inlineAttachments,o=a.indexOf(e);if(o>=0){a.splice(o,1),r.model.ContentId=n,r.model.IsInline=!0,r.model.AttachmentOriginalUrl=Object(nt.b)(e.attachmentId,1);var c=Object(g.i)(e.attachmentId,e.attachmentId.Id,!1);c.status=3,i.push(c)}}})),at=n(8734);n.d(e,"refreshSharingTipsAttachmentWell",(function(){return l})),n.d(e,"addAttachmentIntoWellBeforeUpload",(function(){return _.a})),n.d(e,"initializeAttachments",(function(){return P})),n.d(e,"reinitializeAttachments",(function(){return B})),n.d(e,"getAttachmentWellForCompose",(function(){return D})),n.d(e,"getAttachmentWellInitialValue",(function(){return N.a})),n.d(e,"getAvailableLocalAttachmentSize",(function(){return R.a})),n.d(e,"getConversationAttachmentWellInitialValue",(function(){return L})),n.d(e,"getMaxClassicAttachmentsSize",(function(){return U.a})),n.d(e,"getAllValidAttachments",(function(){return W})),n.d(e,"createAttachmentFullViewStateAndStoreBackingModel",(function(){return z.a})),n.d(e,"setInlineAttachmentStatus",(function(){return V.a})),n.d(e,"createAttachmentFullViewState",(function(){return G.a})),n.d(e,"createAttachmentsViaQueueManager",(function(){return q.a})),n.d(e,"deleteAttachmentViaQueueManager",(function(){return q.b})),n.d(e,"createAttachmentsFromRecentAttachments",(function(){return Z})),n.d(e,"createAttachmentFileFromExistingMailboxAttachment",(function(){return Y.a})),n.d(e,"mergeToConversationAttachmentWell",(function(){return $})),n.d(e,"sortConversationAttachmentWell",(function(){return et})),n.d(e,"convertImageViewAttachmentToInlineAttachment",(function(){return rt})),n.d(e,"getLastCloudyAttachmentsSharingIssueForBlockOnSend",(function(){return O})),n.d(e,"uploadLocalFile",(function(){return at.a}))},299:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(4),a=n(37);function i(){var t,e=Object(a.a)("DefaultAnchorMailbox");return null==e||0==e.trim().length||(t=Object(r.b)(window.location),Object.keys(t).indexOf("anonRetry")>=0)}function o(){var t=Object(r.b)(window.location);return Object.keys(t).indexOf("anonymous")>=0}},3529:function(t,e,n){"use strict";var r,a=n(3),i={uploadFolders:new(n(16).ObservableMap)},o=Object(a.createStore)("attachmentsUploadFolderStore",i),c=n(85);!function(t){t.User="User",t.Group="Group"}(r||(r={}));var u=Object(a.action)("preloadUploadFolder",(function(t,e){return void 0===t&&(t=Object(c.h)().SessionSettings.UserEmailAddress),void 0===e&&(e=r.User),{mailboxId:t,uploadFolderMailboxType:e}})),s=Object(a.action)("uploadFolderLoaded",(function(t,e){return{mailboxId:t,uploadFolder:e}}));Object(a.mutator)(s,(function(t){var e=t.mailboxId,n=t.uploadFolder;o().uploadFolders.set(e,n)}));var l=n(0),d=n(4223),f=n(7),h=n(105),m=n(80),p="Email attachments";function b(t){switch(t){case r.Group:return p;case r.User:return Object(f.b)(d.a);default:return Object(h.a)(t)}}var v=n(28);var g=n(1701);function I(t,e){switch(e){case r.Group:var n=new Headers;return Object(g.f)(t,n),n;case r.User:return null;default:return Object(h.a)(e)}}function O(t){return void 0===t&&(t=Object(c.h)().SessionSettings.UserEmailAddress),o().uploadFolders.get(t)||null}var A=n(34);function j(t,e){return void 0===t&&(t=null),void 0===e&&(e=r.User),Object(l.__awaiter)(this,void 0,void 0,(function(){var n,r,a,i;return Object(l.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=t||Object(c.h)().SessionSettings.UserEmailAddress,(n=O(t))?[2,n]:[4,(u={},l={headers:I(t,e)},Object(v.a)("GetAttachmentDataProviderUploadFolderProps",u,l))];case 1:return r=o.sent(),a=function(t,e,n){return{mailboxId:t,folderId:n.FolderId,folderName:Object(m.b)(n.FolderName)?b(e):n.FolderName}}(t,e,r),s(t,a),[2,a];case 2:return i=o.sent(),A.g.warn("fetchUploadFolder got error: "+i.message),[2,null];case 3:return[2]}var u,l}))}))}Object(a.orchestrator)(u,(function(t){return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e,n;return Object(l.__generator)(this,(function(r){switch(r.label){case 0:return e=t.mailboxId,n=t.uploadFolderMailboxType,O(e)?[3,2]:[4,j(e,n)];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return O})),n.d(e,"a",(function(){return r}))},4171:function(t){t.exports=JSON.parse('{"a":"Bpa"}')},4174:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(3311),a=n(16),i=n(25),o=25*r.b;function c(){return u.get()}var u=Object(a.computed)((function(){var t=Object(i.a)();return t&&t.SessionSettings?(t.SessionSettings.MaxMessageSizeInKb-2048)*r.a:o}))},4223:function(t){t.exports=JSON.parse('{"a":"c8a"}')},457:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u}));var r=n(0),a=n(12),i=n(382),o=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(t){var e,n,i,c,u,s=t.semanticColors,l=t.palette,d=s.buttonBackground,f=s.buttonBackgroundPressed,h=s.buttonBackgroundHovered,m=s.buttonText,p=s.buttonTextHovered,b=s.buttonTextChecked,v=s.buttonTextCheckedHovered;return{root:{backgroundColor:d,color:m},rootHovered:{backgroundColor:h,color:p,selectors:(e={},e[a.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},e)},rootPressed:{backgroundColor:f,color:b},rootExpanded:{backgroundColor:f,color:b},rootChecked:{backgroundColor:f,color:b},rootCheckedHovered:{backgroundColor:f,color:v},rootDisabled:{selectors:(n={},n[a.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},n)},splitButtonContainer:{selectors:(i={},i[a.HighContrastSelector]={border:"none"},i)},splitButtonMenuButton:{color:l.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:l.neutralLight,selectors:(c={},c[a.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:s.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:s.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},o()),{backgroundColor:l.neutralTertiaryAlt,selectors:(u={},u[a.HighContrastSelector]={backgroundColor:"WindowText"},u)}),splitButtonDividerDisabled:{backgroundColor:t.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:s.buttonText},splitButtonMenuIconDisabled:{color:s.buttonTextDisabled}}}function u(t){var e,n,c,u,s,l,d,f,h,m=t.palette,p=t.semanticColors;return{root:{backgroundColor:p.primaryButtonBackground,border:"1px solid "+p.primaryButtonBackground,color:p.primaryButtonText,selectors:(e={},e[a.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},e["."+i.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:m.white}}},e)},rootHovered:{backgroundColor:p.primaryButtonBackgroundHovered,border:"1px solid "+p.primaryButtonBackgroundHovered,color:p.primaryButtonTextHovered,selectors:(n={},n[a.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},n)},rootPressed:{backgroundColor:p.primaryButtonBackgroundPressed,border:"1px solid "+p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed,selectors:(c={},c[a.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},c)},rootExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootChecked:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootDisabled:{selectors:(u={},u[a.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},u)},splitButtonContainer:{selectors:(s={},s[a.HighContrastSelector]={border:"none"},s)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},o()),{backgroundColor:m.white,selectors:(l={},l[a.HighContrastSelector]={backgroundColor:"Window"},l)}),splitButtonMenuButton:{backgroundColor:p.primaryButtonBackground,color:p.primaryButtonText,selectors:(d={},d[a.HighContrastSelector]={backgroundColor:"WindowText"},d[":hover"]={backgroundColor:p.primaryButtonBackgroundHovered,selectors:(f={},f[a.HighContrastSelector]={color:"Highlight"},f)},d)},splitButtonMenuButtonDisabled:{backgroundColor:p.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:p.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:p.primaryButtonText},splitButtonMenuIconDisabled:{color:m.neutralTertiary,selectors:(h={},h[a.HighContrastSelector]={color:"GrayText"},h)}}}},4593:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"CreateAttachmentJsonRequest:#Exchange"},t)}},4678:function(t,e,n){"use strict";var r=n(28),a=n(0);function i(t,e){var n;return void 0===t||t.__type||(n=t,t=Object(a.__assign)({__type:"DeleteAttachmentJsonRequest:#Exchange"},n)),Object(r.a)("DeleteAttachment",t,e)}n.d(e,"a",(function(){return i}))},4892:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r,a=n(4174);function i(t,e,n){return r||(r=Object(a.a)()),{composeId:n,allowShowMultipleRows:!t,didViewOverflowOneRow:!1,canOverrideAllowShowMultipleRows:!0,docViewAttachments:[],imageViewAttachments:[],inlineAttachments:[],isInitialized:e,isReadOnly:t,groupId:null,maxTotalClassicAttachmentSize:r,totalClassicAttachmentSize:0,saveAllToCloudStatus:0,supportedMenuActions:null,sharingLinkIds:[],announcedComponentMessage:null}}},4950:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"CreateAttachmentRequest:#Exchange"},t)}},509:function(t,e,n){"use strict";var r,a=n(0),i=n(1),o=n(692),c=n(34);!function(t){t[t.Full=0]="Full",t[t.Simple=1]="Simple",t[t.None=2]="None"}(r||(r={}));var u=function(t){function e(e){var n=t.call(this,e)||this;return n.state={},n}return Object(a.__extends)(e,t),e.prototype.componentDidCatch=function(t,e){var n,r;null===(r=(n=this.props).onError)||void 0===r||r.call(n,t,e),this.props.suppressErrorReport||(t.component=!0,t.diagnosticInfo=(t.diagnosticInfo||"")+e.componentStack,Object(c.d)(t)),this.setState({error:t})},e.prototype.render=function(){var t=this.state.error,e=this.props,n=e.children,o=e.type,c=e.windowIcons;if(t){if(o==r.None)return null;if(o==r.Simple||!this.props.fullErrorComponent)return i.createElement("div",null,t);var u=this.props.fullErrorComponent;return i.createElement(u,Object(a.__assign)({error:t,windowIcons:c},this.props.fullErrorComponentProps))}return n},e=Object(a.__decorate)([o.observer],e)}(i.Component);n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return r}))},521:function(t,e,n){"use strict";var r=n(0),a=n(1),i=n(396),o=n(517),c=n(516),u=n(12),s=n(220),l=n(397),d=n(453),f=n(457),h=Object(s.c)((function(t,e,n){var r=Object(l.a)(t),a=Object(d.a)(t),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:u.FontWeights.semibold}};return Object(u.concatStyleSets)(r,i,n?Object(f.a)(t):Object(f.b)(t),a,e)}));n.d(e,"a",(function(){return m}));var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.__extends)(e,t),e.prototype.render=function(){var t=this.props,e=t.primary,n=void 0!==e&&e,c=t.styles,u=t.theme;return a.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:h(u,c,n),onRenderDescription:o.b}))},e=Object(r.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],e)}(a.Component)},5801:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(214);function a(t,e){var n=t.docViewAttachments.filter((function(t){return Object(r.e)(t.attachmentId,e)}));return 0===n.length&&(n=t.imageViewAttachments.filter((function(t){return Object(r.e)(t.attachmentId,e)}))),0===n.length?null:n[0]}},5802:function(t,e,n){"use strict";e.a={AttachmentCreationClassicFromLocalFile:{name:"AttachmentCreationClassicFromLocalFile",customData:function(t,e,n,r,a){return r?[r.size]:[0]}},AttachmentCreationFromRecentAttachment:{name:"AttachmentCreationFromRecentAttachment",customData:function(t,e,n,r,a,i){return[(null==r?void 0:r.size)||0,null==r?void 0:r.fileType]}},AttachmentCreationCloudyFromAttachmentDataProvider:{name:"AttachmentCreationCloudyFromAttachmentDataProvider",customData:function(t,e,n,r){return[n.providerType,n.fileType]}},AttachmentCreationCloudyFromLocalFile:{name:"AttachmentCreationCloudyFromLocalFile"},AttachmentDeletionAction:{name:"AttachmentDeletionAction",customData:function(t,e,n,r){return{generatedAttachmentId:e.attachmentId.Id}},cosmosOnlyData:function(t,e,n,r){return JSON.stringify({attachmentId:e.attachmentId.Id,fileType:r})},options:{isCore:!0}},AttachmentWellInitialization:{name:"AttachmentWellInitialization",customData:function(t,e,n,r,a,i,o){return{hasAttachments:t&&t.length>0,isCompose:a}},options:{sessionSampleRate:1}}}},6510:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(3),a=Object(r.action)("setAnnouncedComponentMessage",(function(t,e){return{attachmentWell:t,message:e}}))},6526:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"ReferenceAttachment:#Exchange"},t)}},6559:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1715),a=n(1793),i=n(1743);function o(t){if(Object(a.a)(t)){var e=t;return{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:"",providerType:4,location:e.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:e.AttachmentThumbnailUrl,previewUrl:e.AttachmentPreviewUrl,fileId:e.AttachmentId.Id,fileParentId:"",type:e.ContentType}}return{attachmentItemId:t.AttachmentId.Id,name:t.Name,size:t.Size,fileType:r.a.AttachmentItem,type:i.c,EmbeddedItemClass:t.EmbeddedItemClass,ContentType:t.ContentType}}},713:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(125);function a(t){for(var e,n=[],a=Object(r.a)(t)||document;t!==a.body;){for(var i=0,o=t.parentElement.children;i<o.length;i++){var c=o[i];c!==t&&"true"!==(null===(e=c.getAttribute("aria-hidden"))||void 0===e?void 0:e.toLowerCase())&&n.push(c)}if(!t.parentElement)break;t=t.parentElement}return n.forEach((function(t){t.setAttribute("aria-hidden","true")})),function(){!function(t){t.forEach((function(t){t.setAttribute("aria-hidden","false")}))}(n),n=[]}}},717:function(t,e,n){"use strict";var r,a=n(720),i=n(3),o=Object(i.createStore)("nonBootUserConfiguration",{nonBootUserConfiguration:null})(),c=n(299),u=Object(i.mutatorAction)("setNonBootUserConfiguration",(function(t){o.nonBootUserConfiguration=t}));function s(){return Object(c.b)()?Promise.resolve({}):o.nonBootUserConfiguration?Promise.resolve(o.nonBootUserConfiguration):(r||(r=Object(a.a)().then((function(t){return u(t),t})).catch((function(t){throw r=void 0,t}))),r)}var l=s;function d(){return o.nonBootUserConfiguration||s(),o.nonBootUserConfiguration}function f(){var t=(d()||{}).IsEdu;return void 0!==t&&t}function h(){var t=(d()||{}).ExternalInOutlookEnabled;return void 0!==t&&t}n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return h}))},720:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(28);function a(t){return Object(r.a)("GetOwaNonBootUserConfiguration",{},t)}},7201:function(t,e,n){"use strict";var r=n(0),a=n(1675),i=n(1922),o=n(4850),c=n(1985),u=n(2393),s=n(188);e.a=Object(s.action)("refreshThumbnailImageUrl")((function(t,e,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(s=Object(a.a)(t),!Object(c.b)(s.model))return[3,7];switch(s.model.ProviderType){case i.e:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(s.model)];case 2:return l=r.sent(),s.thumbnailImage.url=l,[3,4];case 3:return r.sent(),s.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:l=Object(u.a)(t,s.model,2,Object(c.b)(s.model),e,n),s.thumbnailImage.url=l,r.label=8;case 8:return[2]}}))}))}))},7291:function(t){t.exports=JSON.parse('{"a":"X7a"}')},7293:function(t,e,n){"use strict";var r=n(188);e.a=Object(r.action)("updateChangeKeyOnItemId")((function(t,e){t.ChangeKey=e}))},7421:function(t,e,n){"use strict";var r=n(2063),a=n(1675),i=n(6531),o=n(40),c=n(188);e.a=Object(c.action)("setAttachmentPermissionLevel")((function(t,e,n,c){var u=Object(a.a)(t),s=u.model;s.PermissionType=e,n&&(s.AttachLongPathName=n,u.openUrl=Object(i.a)(s)),Object(o.i)("doc-attachment-referenceAttachmentExpiration")&&u.info&&u.info.sharingInfo&&(u.info.sharingInfo.expirationDate=c),Object(r.a)(t)}))},7675:function(t,e,n){"use strict";var r=n(10387),a=n(7),i=n(1923),o=n(1924),c=n(5577),u=n(134),s=n(105),l=n(1675),d=n(1662),f=n(0),h=n(10388),m=n(10389);var p=n(8731),b=n(1953),v=n(34),g=n(188),I=n(706),O=n(1726),A=n(7421),j=n(3530);var _=n(4541),C=n(6510),y=n(7293),S=n(13578);function w(t,e,n,r,i,o,c){Object(C.a)(c,Object(a.b)(S.a)),Object(b.E)(t,e,n,r,o),Object(y.a)(i,r.AttachmentId.RootItemChangeKey),function(t,e,n){n&&0===n.ResultCode&&0===t.attachmentType&&(n.CanShareInternally||Object(j.f)(e.PermissionType)||(Object(u.r)("AttachmentsCanNotShareInternally"),Object(A.a)(t.attachmentId,0)),Object(O.o)(e.AttachmentId))}(t,n,o)}function T(t,e,n,r){1===t.attachmentType&&Object(b.z)(t,2),e&&Object(_.a)(e,t),n&&r&&I.g.importAndExecute(n,r)}var F=Object(g.action)("handleCreateAttachmentNotification")((function(t,e,n,r,a,i,o,c){var u=t;try{if(0!==u.ResultCode)throw new Error("ResultCode:"+u.ResultCode+", Id:"+u.Id+", Exception: "+u.Exception);var s=u.Response.ResponseMessages.Items[0];if(s&&s.Attachments.length>0)return Object(b.C)(a.attachmentId,!0),i(s.Attachments[0]),void w(a,n,r,s.Attachments[0],e,u.Response.SharingInformation,c.attachmentWellViewState)}catch(t){v.d("Error handling the create attachment notification: "+t)}Object(b.C)(a.attachmentId,!1),o(new Error(u.Exception)),T(a,c.attachmentWellViewState,null,null)})),k=n(208);function E(t,e){return Object(f.__awaiter)(this,void 0,void 0,(function(){var n,r,a,i;return Object(f.__generator)(this,(function(o){switch(o.label){case 0:return n=Object(k.a)(),r={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null},a=function(t){e(t),I.g.importAndExecute(r,a)},[4,I.f.import()];case 1:return o.sent()(r,a),[4,I.b.import()];case 2:return i=o.sent()(),t(n,r,i,a),[2]}}))}))}var P=n(28),x=n(374);var B=n(347);function N(t,e,n,r,a,i){var o,c,u=Object(B.a)(t.mailboxInfo)||{};return o={itemId:t,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",subscriptionId:r,channelId:a,dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:e,isInline:i},c=u,void 0===o.itemId||o.itemId.__type||(o.itemId=Object(x.a)(o.itemId)),Object(P.a)("CreateAttachmentFromAttachmentDataProvider",o,c)}var D=n(3311),R=Object(g.action)("createAttachmentFromAttachmentDataProvider")((function(t,e,n,r,a,i,o,c,s){var l=this,d=new u.b("AttachmentCreationClassicFromAttachmentDataProvider");d.addCustomData([a.providerType]);var h=function(t){o(t),d.end()},m=function(t){c(),d.endWithError("ServerError",t)};E((function(e,n,o,u){return Object(f.__awaiter)(l,void 0,void 0,(function(){var l;return Object(f.__generator)(this,(function(d){switch(d.label){case 0:if(d.trys.push([0,2,,3]),0===a.providerType&&(f=a.name,-1!==f.indexOf("%")||-1!==f.indexOf("#")))throw new Error(D.c);return 0===i.attachmentType&&Object(b.B)(Object(b.k)(a.size),.05,(function(t){Object(b.x)(i,t)}),i.attachmentId),[4,N(t,r,a,e,o,!1)];case 1:if(!d.sent())throw new Error("Empty response for createAttachmentFromAttachmentDataProvider request");return[3,3];case 2:return l=d.sent(),Object(b.C)(i.attachmentId,!1),c(l),T(i,s.attachmentWellViewState,n,u),[2];case 3:return[2]}var f}))}))}),(function(r){F(r,t,e,n,i,h,m,s)}))}));var L=n(5802),U=n(1701);function M(t,e,n,r,a,i){var o=this;return new Promise((function(c,u){return Object(f.__awaiter)(o,void 0,void 0,(function(){var o,s,l;return Object(f.__generator)(this,(function(d){switch(d.label){case 0:return(o=new XMLHttpRequest).onreadystatechange=function(){if(4===o.readyState)if(200===o.status){var t=void 0;try{t=JSON.parse(o.responseText)}catch(t){v.d("Attachment: Deserialize response failed with error: "+t.Message),v.d("Attachment: Deserialize response Failure Stack Trace: "+t.stack),u(t)}c(t)}else u(new Error("Request failed with status "+o.status+". Message: "+o.responseText))},o.ontimeout=function(){u(new Error("Request timed out"))},i&&(o.upload.onprogress=i),o.open("POST",t,!0),o.setRequestHeader("X-OWA-Action",n),[4,Object(U.d)(r)];case 1:return(s=d.sent())&&Object.keys(s).forEach((function(t){o.setRequestHeader(t,s[t])})),l=JSON.stringify(e),a?(o.setRequestHeader("X-OWA-UrlPostData",encodeURI(l)),o.send(a)):o.send(l),[2]}}))}))}))}var H=n(8);function W(t){var e=Object(H.a)();return e.baseUrl?""+e.baseUrl+t:"/owa"+t}var z=n(4593),V=n(4950),G=n(197),q=n(380),Q={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddAttachmentToDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AddAttachmentToDraftOptions"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addAttachmentToDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attachments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OwsTypeName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"AttachmentId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"RootItemId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"RootItemChangeKey"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"isCancelled"},arguments:[],directives:[]}]}}]}}]},K=n(40),J=W("/service.svc/CreateAttachmentFromLocalFile");function Z(t,e,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o,c,u,s,l,d;return Object(f.__generator)(this,(function(h){switch(h.label){case 0:return v.g.info("Attachment: createAttachment Id: "+t.Id+", ChangeKey: "+t.ChangeKey),Object(K.i)("mon-cmp-graphQLAttachments")?(o=function(t){var e=Object(f.__assign)(Object(f.__assign)({},t),{OwsTypeName:t.__type});return delete e.__type,e}(e),[4,Object(q.a)()]):[3,3];case 1:return[4,h.sent().mutate({variables:{options:{ParentItemId:t,Attachments:[o],CancellationId:n,attachmentType:"LocalFile",fileBlob:r,mailboxInfo:t.mailboxInfo,isInline:e.IsInline,sliceInformation:i}},mutation:Q})];case 2:return c=h.sent(),u=c.data.addAttachmentToDraft,[2,{ResponseMessages:{Items:[{Attachments:u.attachments,IsCancelled:u.isCancelled,ResponseClass:"Success",ResponseCode:"NoError"}]}}];case 3:return s=Object(V.a)({ParentItemId:t,Attachments:[e],RequireImageType:e.IsInline,IncludeContentIdInResponse:e.IsInline,ClientSupportsIrm:!0,CancellationId:n}),i&&(s.SliceNumber=i.sliceNumber,s.TotalSlices=i.totalSlices),l=Object(z.a)({Header:Object(G.b)(),Body:s}),d=e,[4,M(J,l,"CreateAttachmentFromLocalFile",t.mailboxInfo,d&&r?r:null,a)];case 4:return[2,h.sent().Body]}}))}))}function X(t,e){var n="Attachment: createAttachment failed",r=null!=e?e:"genericError";return(null==t?void 0:t.MessageText)&&(n+=" with MessageText: "+t.MessageText),v.g.warn(n),(null==t?void 0:t.ResponseCode)&&(r=t.ResponseCode),{errorMessage:n,errorCode:r}}function Y(t){var e=Object(f.__assign)({},t);return Object.keys(e).forEach((function(t,n){null===e[t]&&(e[t]=void 0)})),e}var $=n(52),tt=Object($.d)("createAttachmentFromLocalFile",L.a.AttachmentCreationClassicFromLocalFile)((function(t,e,n,r,a){return Object(f.__awaiter)(this,void 0,void 0,(function(){var i,o,c,u;return Object(f.__generator)(this,(function(s){switch(s.label){case 0:return i=null,0===a.attachmentType&&(i=function(t){var e=t.loaded/t.total;Object(b.x)(a,e)}),o=Y(e),[4,Z(t,o,n,r,i)];case 1:if(c=s.sent(),(u=c.ResponseMessages.Items[0])&&u.Attachments.length>0&&u.Attachments[0])return[2,{attachment:u.Attachments[0],sharingInfo:null}];throw X(u)}}))}))})),et=n(6713),nt=Object($.d)("createAttachmentFromMailboxFile",L.a.AttachmentCreationFromRecentAttachment)((function(t,e,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o,c,u,s;return Object(f.__generator)(this,(function(l){switch(l.label){case 0:return o=null,0===a.attachmentType&&(o=function(t){var e=t.loaded/t.total;Object(b.x)(a,e)}),c=Y(e),i&&(c=function(t,e){return Object(et.a)({AttachmentId:t.AttachmentId,AttachmentIdToAttach:e,ContentType:t.ContentType,Name:t.Name,Size:t.Size,Thumbnail:t.Thumbnail,ThumbnailMimeType:t.ThumbnailMimeType,CreateAttachmentInlineType:2})}(c,r.fileId)),[4,Z(t,c,n,null,o)];case 1:if(u=l.sent(),(s=u.ResponseMessages.Items[0])&&s.Attachments.length>0&&s.Attachments[0])return[2,{attachment:s.Attachments[0],sharingInfo:u.SharingInformation}];throw X(s)}}))}))}));function rt(t,e,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o;return Object(f.__generator)(this,(function(c){switch(c.label){case 0:return o=Object(B.a)(t.mailboxInfo)||{},[4,(u={itemId:t,uri:e,name:n,subscriptionId:r,isInline:a,contentId:i},s=o,void 0===u.itemId||u.itemId.__type||(u.itemId=Object(x.a)(u.itemId)),Object(P.a)("CreateAttachmentFromUri",u,s))];case 1:return[2,c.sent()]}var u,s}))}))}var at=Object(g.action)("createAttachmentFromUri")((function(t,e,n,r,a,i,o,c,s){var l=this,d=new u.b("AttachmentCreationFromUri");d.addCustomData({size:a?a.size:0});var h=function(t){o(t),d.end()},m=function(t){c(),d.endWithError("ServerError",t)};E((function(e,r,o,u){return Object(f.__awaiter)(l,void 0,void 0,(function(){return Object(f.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),0===i.attachmentType&&Object(b.B)(Object(b.l)(a.size),.05,(function(t){Object(b.x)(i,t)}),i.attachmentId),[4,rt(t,a.uri,a.name,e,n.IsInline,null)];case 1:if(!o.sent())throw new Error("Empty response for createAttachmentFromUriProvider request");return[3,3];case 2:return o.sent(),Object(b.C)(i.attachmentId,!1),c(),T(i,s.attachmentWellViewState,r,u),[3,3];case 3:return[2]}}))}))}),(function(r){F(r,t,e,n,i,h,m,s)}))})),it=n(8733);function ot(t,e,n){return Object(f.__awaiter)(this,void 0,void 0,(function(){var r;return Object(f.__generator)(this,(function(a){switch(a.label){case 0:return r=Object(B.a)(t.mailboxInfo)||{},[4,Object(it.a)({itemId:t,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:e,thumbnailUrl:n.thumbnailUrl,previewUrl:n.previewUrl,isFolder:n.isFolder,mimeType:n.type},r)];case 1:return[2,a.sent()]}}))}))}var ct=n(7194),ut=Object($.d)("createReferenceAttachmentFromAttachmentDataProvider",L.a.AttachmentCreationCloudyFromAttachmentDataProvider)((function(t,e,n,r){return Object(f.__awaiter)(this,void 0,void 0,(function(){var i=this;return Object(f.__generator)(this,(function(o){return 0===r.attachmentType&&Object(b.B)(4e3,.05,(function(t){Object(b.x)(r,t)}),r.attachmentId),[2,ot(t,e,n).then((function(t){return Object(f.__awaiter)(i,void 0,void 0,(function(){var e,n;return Object(f.__generator)(this,(function(i){switch(i.label){case 0:return(e=t.ResponseMessages.Items.length>0?t.ResponseMessages.Items[0]:null)&&e.Attachments.length>0?(Object(b.C)(r.attachmentId,!0),[2,{attachment:e.Attachments[0],sharingInfo:t.SharingInformation}]):[3,1];case 1:return Object(b.C)(r.attachmentId,!1),Object(K.i)("doc-authContext")?!t.SharingInformation||Object(a.f)(t.SharingInformation.ClaimsChallenge)?[3,4]:(n=t.SharingInformation.ClaimsChallenge,[4,ct.a.import()]):[3,4];case 2:return[4,i.sent()(n)];case 3:throw i.sent(),X(e,t.SharingInformation.ResultCode.toString());case 4:throw X(e)}}))}))}))]}))}))}));var st=W("/service.svc/CreateReferenceAttachmentFromLocalFile");function lt(t,e,n,r,a,i,o,c,u,s){return Object(f.__awaiter)(this,void 0,void 0,(function(){var l;return Object(f.__generator)(this,(function(d){switch(d.label){case 0:return h={ParentItemId:t,FileName:e.Name,SubscriptionId:a,ChannelId:i,FileSizeInBytes:e.Size,SliceNumber:o,TotalSlices:c,CancellationId:n,FileContentToUpload:"",GroupSmtpAddress:u,UploadFolderId:s},l=Object(f.__assign)({__type:"CreateReferenceAttachmentFromLocalFileRequest:#Exchange"},h),[4,M(st,{requestObject:l},"CreateReferenceAttachmentFromLocalFile",t.mailboxInfo,r,void 0)];case 1:return[2,d.sent()]}var h}))}))}var dt=n(3529),ft=Object($.d)("createReferenceAttachmentFromLocalFile",L.a.AttachmentCreationCloudyFromLocalFile)((function(t,e,n,r,a,i,o,c,u){E((function(e,o,s,l){!function(t,e,n,r,a,i,o,c,u,s,l,d){var h;Object(f.__awaiter)(this,void 0,void 0,(function(){var m,p,v,g,I,O,A,j;return Object(f.__generator)(this,(function(f){switch(f.label){case 0:return m=Math.ceil(r.size/s),Object(b.B)(Object(b.q)(r.size),.05,(function(t){Object(b.x)(a,t)}),a.attachmentId),p=null,(v=null===(h=null==d?void 0:d.attachmentWellViewState)||void 0===h?void 0:h.groupId)?(p=Object(dt.c)(v)?Object(dt.c)(v).folderId:null)?[3,2]:[4,Object(dt.b)(v,dt.a.Group)]:[3,2];case 1:(j=f.sent())&&(p=j.folderId),f.label=2;case 2:g=0,f.label=3;case 3:if(!(g<m))return[3,8];I=0+g*s,O=Math.min(I+s,r.size),A=r.slice(I,O),f.label=4;case 4:return f.trys.push([4,6,,7]),[4,lt(t,e,n,A,i,c,g,m,v,p)];case 5:if(!(j=f.sent()))throw new Error("Empty response for createReferenceAttachmentFromLocalFile request");return[3,7];case 6:return f.sent(),Object(b.C)(a.attachmentId,!1),l(),T(a,d.attachmentWellViewState,o,u),[2];case 7:return g++,[3,3];case 8:return[2]}}))}))}(t,n,r,a,i,e,o,s,l,10485760,c,u)}),(function(r){F(r,t,e,n,i,o,c,u)}))}));var ht=n(1715),mt=n(5023),pt=n(326),bt=n(8734);function vt(t,e,n,r,a,i,o,c){var s=this,l=new u.b("UploadLocalFileAndCreateCloudyAttachment",{timeout:3e5}),d=Object(f.__read)(Object(bt.a)(n.Name,i,a,(function(t){var e=t.loaded/t.total;Object(b.x)(o,e)})),2),h=d[0],m=h.uploadPromise,p=h.cancel,v=d[1].model,g=v.Id,I=v.EndPointUrl,O=v.Type,A=!1;return{onCompletePromise:Object(f.__awaiter)(s,void 0,void 0,(function(){var a,i,s,d,h,p,v,j,_,C;return Object(f.__generator)(this,(function(f){switch(f.label){case 0:a=null,f.label=1;case 1:return f.trys.push([1,6,7,8]),[4,m];case 2:return i=f.sent(),s=i.errorResponse,d=i.result,s?[4,s.text()]:[3,4];case 3:throw h=f.sent(),new Error("Unable to upload file with status code: "+s.status+"; response: "+h);case 4:return p=function(t,e,n,r){return{fileType:ht.a.Cloud,name:t.name,size:t.size,providerId:e,providerType:n,location:gt(t,n),providerEndpointUrl:r,isFolder:!1,fileId:t.id,fileParentId:t.parentReference.id,thumbnailUrl:"",previewUrl:"",type:Object(mt.c)(t)}}(d,g,O,I),[4,ot(t,r,p)];case 5:if(v=f.sent(),(j=v.ResponseMessages.Items[0])&&j.Attachments.length>0)return Object(b.C)(o.attachmentId,!0),_=j.Attachments[0],w(o,e,n,_,t,v.SharingInformation,c.attachmentWellViewState),[2,_];throw new Error(j.MessageText);case 6:if(C=f.sent(),Object(b.C)(o.attachmentId,!1),T(o,c.attachmentWellViewState),A)return[2,null];throw a=C,C;case 7:return a?(new u.b("UploadLocalFileAndCreateCloudyAttachmentError",{isCore:!0}).endWithError(a),l.endWithError(a)):l.end(),[7];case 8:return[2]}}))})),cancel:function(){A=!0,p()}}}function gt(t,e){return 1===e?t.parentReference.path+"/"+t.name:Object(pt.parse)(t.webUrl).path}var It=n(11121),Ot=14680064;function At(t,e,n,r){t.addCustomData([e]),n?t.end():t.endWithError("ServerError",r)}function jt(t,e,n,r,a,i){void 0===i&&(i={}),i.sliceSizeInBytes=i.sliceSizeInBytes||Ot;var o=new u.b("AttachmentCreationClassicFromLocalFileSliced",{timeout:3e5}),c=function(t,e,n,r,a){var i=this,o=null,c=!1,u=null;return{action:function(s,l,d){return Object(f.__awaiter)(i,void 0,void 0,(function(){var i,h,m;return Object(f.__generator)(this,(function(p){switch(p.label){case 0:return u||(u=function(t){for(var e=[],n=0;n<t;n++)e[n]=0;return e}(d)),i=null,0===a.attachmentType&&(i=function(t){u[l]=t.loaded;var e=u.reduce((function(t,e){return t+e}),0)/r.size;Object(b.x)(a,e)}),h=Y(e),[4,Z(t,h,n,s,i,{sliceNumber:l,totalSlices:d})];case 1:if(m=p.sent(),!function(t){return t&&t.Attachments.length>0&&t.Attachments[0]}(o=m.ResponseMessages.Items[0]))throw X(o);return c||(e=Object(f.__assign)(Object(f.__assign)({},e),{AttachmentId:o.Attachments[0].AttachmentId}),c=!0),[2]}}))}))},getLastResponseMessage:function(){return o}}}(t,e,n,r,a),l=c.action,d=c.getLastResponseMessage,h=Object(It.a)(r,l,{sliceSize:i.sliceSizeInBytes,numberOfSlicesToParallelize:1}),m=h.onCompletePromise,p=h.cancel,v=!1;return{onCompletePromise:m.then((function(t){switch(t){case 0:return At(o,r.size,!0),{status:0,attachment:d().Attachments[0]};case 1:return{status:1};default:return Object(s.a)(t)}})).catch((function(t){if(v)return{status:1};throw At(o,r.size,!1,t),t})),cancel:function(){v=!0,p()}}}function _t(t,e,n,r,a,i,o){void 0===o&&(o={shouldShare:!1});var c,u=r&&(r.fileType===ht.a.Cloud||r.fileType===ht.a.CloudSuggestion||r.fileType===ht.a.ContextualSuggestion),l=null,d=Object(f.__assign)(Object(f.__assign)({},e.AttachmentId),{mailboxInfo:t.mailboxInfo}),h=o.shouldShare,m=function(){};if((c=r).fileType===ht.a.AttachmentItem||c.fileType===ht.a.AttachmentItemSuggestion||(c.fileType===ht.a.Cloud||c.fileType===ht.a.CloudSuggestion||c.fileType===ht.a.ContextualSuggestion)&&4===c.providerType)l=nt(t,e,n,r,a,u).then((function(t){return t}));else if(h||u){if(!h&&u)return{createAttachmentPromise:new Promise((function(o,c){R(t,d,e,n,r,a,o,c,i)})),cancelCreateAttachment:m};if(!h||!u){if(o.shouldShare&&o.shareProperties&&!o.shareProperties.groupMailboxId){var p=vt(t,d,e,n,o.shareProperties.folderInfo,r.fileObject,a,i);return{createAttachmentPromise:v=p.onCompletePromise,cancelCreateAttachment:p.cancel}}return{createAttachmentPromise:new Promise((function(o,c){return ft(t,d,e,n,r.fileObject,a,o,c,i),e})),cancelCreateAttachment:m}}l=ut(t,n,r,a)}else if(r&&r.fileType===ht.a.Local&&r.fileObject){var b=jt(t,e,n,r.fileObject,a),v=b.onCompletePromise;m=b.cancel,l=v.then((function(t){switch(t.status){case 0:return{attachment:t.attachment,sharingInfo:null};case 1:return null;default:return Object(s.a)(t)}}))}else{if(r&&r.fileType===ht.a.Uri)return{createAttachmentPromise:new Promise((function(o,c){at(t,d,e,n,r,a,o,c,i)})),cancelCreateAttachment:m};l=tt(t,e,n,r&&r.fileType===ht.a.Local?r.fileObject:null,a)}return function(t,e,n,r,a,i,o){return{createAttachmentPromise:i.then((function(i){return i?(w(r,e,n,i.attachment,t,i.sharingInfo,a.attachmentWellViewState),i.attachment):null})).catch((function(t){throw T(r,a.attachmentWellViewState,null,null),t})),cancelCreateAttachment:o}}(t,d,e,a,i,l,m)}var Ct=n(7766),yt=Object($.d)("deleteAttachment",L.a.AttachmentDeletionAction)((function(t,e,n,r){return Object(Ct.a)(e.attachmentId).then((function(r){var a=r.ResponseMessages.Items[0];"Success"===a.ResponseClass?(Object(_.a)(t,e),Object(y.a)(n,a.RootItemId.RootItemChangeKey)):v.g.warn("Attachment: Failed to delete attachment with ResponseClass= "+a.ResponseClass+", ResponseCode="+a.ResponseCode)})).catch((function(t){throw v.g.warn("Attachment: deleteAttachment got error: "+t.message),t}))}));function St(t){return e={cancellationId:t},Object(P.a)("CancelAttachment",e,n);var e,n}var wt=n(1922);function Tt(t){if(null==t)return null;switch(t){case 0:return wt.i;case 5:return wt.e;case 1:return wt.h;case 2:return wt.c;case 3:return wt.b;case 7:return wt.j;case 9:return wt.k;case 8:return wt.l;case 4:return wt.f;case 6:return wt.d;case 10:return wt.g;default:return Object(s.a)(t)}}var Ft=n(4552),kt=n(5325),Et=n(8735),Pt=n(8736),xt=n(6526),Bt=n(7291),Nt=n(1864);function Dt(t,e){var n=Object(l.a)(t.item.attachmentId);if(n){!function(t,e,n){Object(Nt.a)(n,t,[e])}("WarningAttachmentsCanNotBeDeleted",Object(a.c)(Object(a.b)(Bt.a),n.model.Name),e)}}var Rt=n(13579),Lt=n(1682),Ut=4;function Mt(t,e,n){Object(Nt.a)(n,t,[e])}function Ht(t,e){var n,r=(n=function(t){return t.reason},t.reduce((function(t,e){var r=n(e);return t[r]?t[r].push(e):t[r]=[e],t}),{}));Object.keys(r).forEach((function(t){var n=r[t];switch(parseInt(t)){case 0:!function(t,e){var n=null,r=null;if(1===t.length&&null!==t[0].item.tryAgainCallback){var i=t[0],o=i.item.file.name,c=Object(a.c)(Object(a.b)(Rt.e),o),u={key:"WarningFilesCanNotBeAttachedWithNamesGenericError",source:Lt.c.Compose,rank:Lt.b.Info,message:c,messageParts:[c]},s={text:Object(a.b)(Rt.a),action:function(){return i.item.tryAgainCallback()}};return u.messageParts.push(s),void Object(Nt.a)(e,"WarningFilesCanNotBeAttachedWithNamesGenericError",(function(t){return u}))}if(t.length<Ut){var l=t.map((function(t){return t.item.file.name})).join(", ");r="WarningFilesCanNotBeAttachedWithNamesGenericError",n=Object(a.c)(Object(a.b)(Rt.b),l)}else r="WarningSeveralFilesCanNotBeAttachedGenericError",n=Object(a.c)(Object(a.b)(Rt.d),t.length);Mt(r,n,e)}(n,e);break;case 1:!function(t,e){Mt("WarningFilesCannotBeAttachedFromOtherMailboxes",Object(a.b)(Rt.c),e)}(0,e);break;case 2:!function(t,e){Mt("WarningSpecialCharactersAreNotSupported",Object(a.b)(Rt.f),e)}(0,e)}}))}var Wt=function(){function t(t,e,n,r,a){var i=this;void 0===r&&(r=null),void 0===a&&(a=null),this.attachmentWellViewState=t,this.parentItemId=e,this.infoBar=n,this.onAnyAttachmentCreatedInParentItemCallback=r,this.onAnyAttachmentDeletedInParentItemCallback=a,this.uploadQueue=[],this.deleteQueue=[],this.uploadFailures=[],this.onFinishPromise=new Promise((function(t,e){i.onFinish=function(e){t(e)}}))}return t.prototype.enqueueAttachmentCreation=function(t,e,n,r,a){void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=null);var i=e.isInline,o=e.shouldShare,u=e.isHiddenInline,s=e.skipProcessInlineImage;if(Object(c.a)(this.infoBar),!o&&Object(m.a)(t,this.infoBar,this.attachmentWellViewState))return[];t=Object(h.a)(t,i,this.infoBar);for(var l=0,d=void 0;d=t[l];l++){var g=void 0,I=null,O={Name:null,ContentType:null,ContentId:null,ContentLocation:null,AttachmentOriginalUrl:null,Size:0,LastModifiedTime:null,IsInline:!1,IsInlineToUniqueBody:!1,IsInlineToNormalBody:!1,ThumbnailMimeType:null,Thumbnail:null};if(o){var A=d;g=Object(xt.a)(Object(f.__assign)(Object(f.__assign)({},O),{Name:A.name,Size:A.size,ContentType:A.type,ProviderType:Tt(A.providerType),AttachmentIsFolder:A.isFolder,IsInline:!1,PermissionType:0,AttachLongPathName:null,ProviderEndpointUrl:null,AttachmentThumbnailUrl:null,AttachmentPreviewUrl:null,OriginalPermissionType:0}))}else if(d.fileType===ht.a.Base64InlineImage||d.fileType===ht.a.ExpirableBase64InlineImage){var j=d;g=Object(Ft.a)(Object(f.__assign)(Object(f.__assign)({},O),{Name:j.name,Size:j.size,ContentType:j.type,IsInline:!0,Content:j.dataUri,IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})),I=j.tempId}else if(d.fileType===ht.a.MailItem){var _=d;if(_.mimeContent)g=Object(Et.a)(Object(f.__assign)(Object(f.__assign)({},O),{Name:d.name,Size:d.size,IsInline:!1,Item:Object(kt.a)({MimeContent:Object(Pt.a)({Value:_.mimeContent})}),ContentType:"message/rfc822"}));else{var C=Object(x.a)({Id:_.itemId});g=Object(et.a)(Object(f.__assign)(Object(f.__assign)({},O),{Name:d.name,IsInline:!1,ItemId:C,Size:d.size,AttachmentIdToAttach:null,CreateAttachmentInlineType:0}))}}else if(d.fileType===ht.a.AttachmentItem||d.fileType===ht.a.AttachmentItemSuggestion){var y=d;g=Object(et.a)(Object(f.__assign)(Object(f.__assign)({},O),{Name:y.name,AttachmentIdToAttach:y.attachmentItemId,__type:y.type,Size:d.size,ItemId:null,CreateAttachmentInlineType:0}))}else d.fileType===ht.a.Uri?g=Object(Ft.a)(Object(f.__assign)(Object(f.__assign)({},O),{Name:d.name,AttachmentOriginalUrl:d.uri,Size:d.size,ContentType:d.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})):(g=Object(Ft.a)(Object(f.__assign)(Object(f.__assign)({},O),{Name:d.name,Size:d.size,ContentType:d.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})),I=d.tempId);var S={Id:I||Object(k.a)(),mailboxInfo:this.parentItemId.mailboxInfo},w=void 0;i?w=Object(b.i)(S,S.Id,u,0,s):(w=Object(b.g)(S,!1,!1,o,d.fileType,!0),e.isAddedFromSmartDoc&&(w.fileType=ht.a.SmartDoc),this.attachmentWellViewState.supportedMenuActions&&(w.strategy.supportedMenuActions=this.attachmentWellViewState.supportedMenuActions),e.downsellFromLink&&Object(b.A)(w,6,11)),Object(p.a)(w,this.attachmentWellViewState,g,S);var T={attachmentState:w,file:d,attachment:g,shouldShareInfo:e,cancelPendingUpload:function(){},onAttachmentCreatedCallback:n,onAttachmentCanceledOrFailedCallback:r,tryAgainCallback:a};v.g.info("Attachment: UploadQueue enqueue attachment: Name="+d.name),this.uploadQueue.push(T)}return this.startProcessIfNotStarted(),t},t.prototype.deleteAttachment=function(t,e){var n=this;void 0===e&&(e=null),Object(c.a)(this.infoBar);var r=1===t.attachmentType,a=r?0===t.status:t.actionCompletePercent<=1;if(r||Object(b.A)(t,3,a?10:6),a&&this.currentUploadItem)if(this.currentUploadItem.attachmentState.attachmentId===t.attachmentId){v.g.info("Attachment: Cancelling attachment: TempId="+t.attachmentId);var i=this.currentUploadItem;if(i.cancelPendingUpload(),0===t.attachmentType&&t.isCloudy){if(v.g.info("Attachment: Put attachment: Id= "+t.attachmentId+" into deleteQueue"),0===this.deleteQueue.filter((function(e){return e.attachmentState.attachmentId===t.attachmentId})).length){var o={attachmentState:t,onAttachmentDeletedCallback:e};this.deleteQueue.push(o)}this.startProcessIfNotStarted()}else this.isCancelling||(this.isCancelling=!0,St(t.attachmentId.Id).then((function(e){n.isCancelling=!1,e?(Object(_.a)(n.attachmentWellViewState,t),i.onAttachmentCanceledOrFailedCallback&&i.onAttachmentCanceledOrFailedCallback(!0)):n.onAttachmentDeleteFailure(t)})))}else v.g.info("Attachment: Removing attachment: TempId= "+t.attachmentId+" from queue"),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.attachmentState.attachmentId===t.attachmentId&&(r.onAttachmentCanceledOrFailedCallback&&r.onAttachmentCanceledOrFailedCallback(!0),e.splice(n,1))}}(t,this.uploadQueue),Object(_.a)(this.attachmentWellViewState,t);else{if(v.g.info("Attachment: Put attachment: Id= "+t.attachmentId+" into deleteQueue"),0===this.deleteQueue.filter((function(e){return e.attachmentState.attachmentId===t.attachmentId})).length){o={attachmentState:t,onAttachmentDeletedCallback:e};this.deleteQueue.push(o)}this.startProcessIfNotStarted()}},t.prototype.onAttachmentDeleteFailure=function(t){var e,n;e={item:t,reason:0},n=this.infoBar,Object(c.a)(n),Dt(e,n),1!==t.attachmentType&&Object(b.A)(t,0,0),v.g.warn("Attachment: Failed to cancel attachment: TempId="+t.attachmentId)},t.prototype.startProcessIfNotStarted=function(){this.isInProgress||(this.datapoint=new u.b("AttachmentQueueManager"),this.isInProgress=!0,this.processNextAttachment("NewProcess"))},t.prototype.processNextAttachment=function(t){var e=this;if(v.g.info("Attachment: Invoking processNextAttachment from: "+t),0!==this.deleteQueue.length){var n=this.deleteQueue[0],r=n.attachmentState,a=n.onAttachmentDeletedCallback,i=Object(l.a)(r.attachmentId);v.g.info("Attachment: Deleting attachment: Id= "+r.attachmentId),yt(this.attachmentWellViewState,r,this.parentItemId,r.fileType).then((function(){e.deleteQueue.shift(),zt(a,e.parentItemId,r.attachmentId,i.model),zt(e.onAnyAttachmentDeletedInParentItemCallback,e.parentItemId,r.attachmentId,i.model),e.processNextAttachment("DeleteAttachmentFinish")})).catch((function(t){e.deleteQueue.shift(),e.onAttachmentDeleteFailure(r),e.logDeletionFailure(t.message,r),e.processNextAttachment("DeleteAttachmentFinish")}))}else if(0!==this.uploadQueue.length){this.currentUploadItem=this.uploadQueue.shift();var o=this.currentUploadItem.onAttachmentCreatedCallback,c={attachmentWellViewState:this.attachmentWellViewState,parentItemId:this.parentItemId,infoBar:this.infoBar},u=_t(this.parentItemId,this.currentUploadItem.attachment,this.currentUploadItem.attachmentState.attachmentId.Id,this.currentUploadItem.file,this.currentUploadItem.attachmentState,c,this.currentUploadItem.shouldShareInfo),s=u.createAttachmentPromise,d=u.cancelCreateAttachment;this.currentUploadItem.cancelPendingUpload=d,s.then((function(t){if(t){var n=Object(f.__assign)(Object(f.__assign)({},t.AttachmentId),{mailboxInfo:e.parentItemId.mailboxInfo});zt(o,e.parentItemId,n,t),zt(e.onAnyAttachmentCreatedInParentItemCallback,e.parentItemId,n,t)}e.processNextAttachment("CreateAttachmentFinish")})).catch((function(t){var n=0;(null==t?void 0:t.message)===D.c&&(n=2),t&&"ErrorNonExistentMailbox"===t.errorCode&&(n=1),e.uploadFailures.push({item:e.currentUploadItem,reason:n}),e.currentUploadItem.onAttachmentCanceledOrFailedCallback&&e.currentUploadItem.onAttachmentCanceledOrFailedCallback(!1),e.logCreationFailure(),e.processNextAttachment("CreateAttachmentFinish")}))}else this.finishProcess()},t.prototype.finishProcess=function(){v.g.info("Attachment: AttachmentQueueManager: finishProcess"),this.isInProgress=!1;var t=this.currentUploadItem&&this.currentUploadItem.attachmentState?this.currentUploadItem.attachmentState.attachmentId:null;this.currentUploadItem=null,this.onFinish(t),this.datapoint.end(),this.datapoint=null,Ht(this.uploadFailures,this.infoBar),this.uploadFailures=[]},t.prototype.logCreationFailure=function(){Object(u.r)("AttachmentCreationFailure")},t.prototype.logDeletionFailure=function(t,e){Object(u.r)("AttachmentDeletionFailure",[t],{cosmosOnlyData:JSON.stringify({attachmentId:e.attachmentId.Id})})},t}();function zt(t,e,n,r){t&&t(e,n,r)}n.d(e,"a",(function(){return Gt})),n.d(e,"b",(function(){return qt}));var Vt={};function Gt(t,e,n,i,o,s,l,f,h){if(void 0===o&&(o={isInline:!1,isHiddenInline:!1,shouldShare:!1,skipProcessInlineImage:!1}),!e)return Object(c.a)(i),Object(Nt.a)(i,"WarningFilesCanNotBeAttachedGenericError",[Object(a.b)(r.a)]),[];var m=Qt(t,e,i,s);return function(t,e,n){for(var r=0;r<t.length;r++){var a=t[r];Object(u.r)("AttachmentCreation",[e,n],{cosmosOnlyData:JSON.stringify({fileType:a.fileType,size:a.size,ext:Object(d.d)(a.name)||""})})}}(n,o.isInline,o.shouldShare),m.enqueueAttachmentCreation(n,o,l,f,h)}function qt(t,e,n,r,a){var i=Qt(t,n,r);!function(t){var e=t.attachmentType;switch(e){case 1:Object(u.r)("AttachmentDeletion",[!0,!1,0]);break;case 0:var n=Object(l.a)(t.attachmentId);Object(u.r)("AttachmentDeletion",[!1,t.isCloudy],{cosmosOnlyData:JSON.stringify({size:n.model.Size})});break;default:Object(s.a)(e)}}(e),i.deleteAttachment(e,a)}function Qt(t,e,n,r){var a=Vt[e.Id];return a||(a=function(t,e,n,r,a){return void 0===r&&(r=null),void 0===a&&(a=null),new Wt(t,e,n,r,a)}(t,e,n,i.a,o.a),Vt[e.Id]=a,a.onFinishPromise.then((function(t){delete Vt[e.Id],r&&r(t)}))),a}},7725:function(t,e,n){"use strict";var r=n(0),a=n(188),i=n(5),o=n(7421);function c(t){return Object(r.__assign)({__type:"SetAttachmentPermissionsRequest:#Exchange"},t)}var u=n(28);function s(t,e,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var a,i,o=function(t,e,n,r){return void 0===n&&(n=null),void 0===r&&(r=!1),c({AttachmentIds:t,PermissionLevel:e,NewAttachLongPathNames:n,SetToOriginalPermissionLevel:r})}(t,e,n,r);return void 0===(a={request:o}).request||a.request.__type||(a.request=c(a.request)),Object(u.a)("SetAttachmentPermissionsV2",a,i)}e.a=Object(a.action)("changeAttachmentPermission")((function(t,e,n,a){return void 0===n&&(n=null),void 0===a&&(a=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,s(t.map((function(t){return t.Id})),e,n,a)];case 1:if(!(c=r.sent()).OperationSucceeded||!c.NewAttachLongPathNames||c.NewAttachLongPathNames.length!==t.length)throw new Error("Error setting attachment permissions");return t.forEach((function(t,n){var r,a=null;(null===(r=c.ExpirationDates)||void 0===r?void 0:r[n])&&(a=Object(i.lc)(c.ExpirationDates[n])),Object(o.a)(t,e,c.NewAttachLongPathNames[n],a)})),[2]}}))}))}))},7766:function(t,e,n){"use strict";var r=n(0),a=n(347);var i=n(4678),o=n(197);function c(t){return e={ClientSupportsIrm:!0,AttachmentIds:[t]},Object(r.__assign)({__type:"DeleteAttachmentRequest:#Exchange"},e);var e}function u(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,u,s;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return n=c(t),u=Object(a.a)(t.mailboxInfo)||{},s=Object(r.__assign)(Object(r.__assign)({},u),e||{}),[4,Object(i.a)({Header:Object(o.b)(),Body:n},s)];case 1:return[2,l.sent().Body]}}))}))}n.d(e,"a",(function(){return u}))},7782:function(t,e,n){"use strict";var r=n(0),a=n(4542),i=n(4541),o=n(1726),c=n(34),u=n(188),s=Object(u.action)("replaceAttachmentInWell")((function(t,e,n,r){var u=t.docViewAttachments.indexOf(e);u>-1?(Object(i.a)(t,e),t.docViewAttachments.splice(u,0,n)):(u=t.imageViewAttachments.indexOf(e))>-1?(Object(i.a)(t,e),t.imageViewAttachments.splice(u,0,n)):c.d("Can't find the oldAttachment when invoking replaceAttachmentInWell"),n.isCloudy||Object(a.a)(t,r,n.attachmentId),Object(o.o)(n.attachmentId)})),l=n(1953);function d(t,e,n,a,i){var o=Object(l.h)(Object(r.__assign)(Object(r.__assign)({},n.AttachmentId),{mailboxInfo:e.attachmentId.mailboxInfo}),n,a,i,!0,!1,null,null,!1);s(t,e,o,n.Size)}n.d(e,"a",(function(){return d}))},8731:function(t,e,n){"use strict";var r=n(0),a=n(4542),i=n(4667),o=n(5330),c=n(188),u=n(1953);e.a=Object(c.action)("addAttachmentIntoWellBeforeUpload")((function(t,e,n,c,s){var l;void 0===s&&(s=null),n.AttachmentId=c,Object(i.a)([{attachmentId:Object(r.__assign)(Object(r.__assign)({},n.AttachmentId),{mailboxInfo:c.mailboxInfo}),attachment:n,modelInitializationValues:s}],!1,!0,!0),Object(u.s)(t)?(e.inlineAttachments.push(t),l=!0):(t.isPlaceholderAttachment=!0,Object(o.a)(n)?e.imageViewAttachments.push(t):e.docViewAttachments.push(t)),!l&&t.isCloudy||Object(a.a)(e,n.Size,n.AttachmentId)}))},8733:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(28),a=n(374);function i(t,e){return void 0===t.itemId||t.itemId.__type||(t.itemId=Object(a.a)(t.itemId)),Object(r.a)("CreateReferenceAttachmentFromAttachmentDataProvider",t,e)}},8734:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(0),a=n(105),i=n(2980),o=n(1782),c=n(296);function u(t,e,n,a){var u=Object(c.a)()?1:0,l=Object(o.h)(),d=Object(r.__read)(l.filter((function(t){return t.type===u})),1)[0];if(!d)throw new Error("Unable to upload file as couldnt find OneDrive provider");var f=d.model.EndPointUrl,h={fileToUpload:{fileName:t,fileBlob:e},conflictBehavior:"rename",folderInfo:s(n),onProgress:a};return[1===u?Object(i.v)(1,i.e,h):Object(i.v)(0,f,h),d]}function s(t){var e=t.identifierType,n=t.identifier;switch(e){case 0:return{type:0,identifier:n};case 1:return{type:1,identifier:n};default:return Object(a.a)(e)}}},883:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(0),a=n(1),i=n(517),o=n(516),c=n(521),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.__extends)(e,t),e.prototype.render=function(){return a.createElement(c.a,Object(r.__assign)({},this.props,{primary:!0,onRenderDescription:i.b}))},e=Object(r.__decorate)([Object(o.a)("PrimaryButton",["theme","styles"],!0)],e)}(a.Component)},886:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(0),a=n(1),i=n(713),o=n(217),c=n(72),u=n(310),s=n(55),l=n(308),d=n(125),f=function(t){function e(n){var r=t.call(this,n)||this;return r._root=a.createRef(),r._firstBumper=a.createRef(),r._lastBumper=a.createRef(),r._hasFocus=!1,r._onRootFocus=function(t){r.props.onFocus&&r.props.onFocus(t),r._hasFocus=!0},r._onRootBlur=function(t){r.props.onBlur&&r.props.onBlur(t);var e=t.relatedTarget;null===t.relatedTarget&&(e=r._getDocument().activeElement),Object(o.a)(r._root.current,e)||(r._hasFocus=!1)},r._onFirstBumperFocus=function(){r._onBumperFocus(!0)},r._onLastBumperFocus=function(){r._onBumperFocus(!1)},r._onBumperFocus=function(t){if(!r.props.disabled){var e=t===r._hasFocus?r._lastBumper.current:r._firstBumper.current;if(r._root.current){var n=t===r._hasFocus?Object(c.i)(r._root.current,e,!0,!1):Object(c.f)(r._root.current,e,!0,!1);n&&(r._isBumper(n)?r.focus():n.focus())}}},r._onFocusCapture=function(t){r.props.onFocusCapture&&r.props.onFocusCapture(t),t.target===t.currentTarget||r._isBumper(t.target)||(r._previouslyFocusedElementInTrapZone=t.target)},r._forceFocusInTrap=function(t){if(!r.props.disabled&&e._focusStack.length&&r===e._focusStack[e._focusStack.length-1]){var n=r._getDocument().activeElement;Object(o.a)(r._root.current,n)||(r.focus(),r._hasFocus=!0,t.preventDefault(),t.stopPropagation())}},r._forceClickInTrap=function(t){if(!r.props.disabled&&e._focusStack.length&&r===e._focusStack[e._focusStack.length-1]){var n=t.target;n&&!Object(o.a)(r._root.current,n)&&(r.focus(),r._hasFocus=!0,t.preventDefault(),t.stopPropagation())}},Object(u.a)(r),r}return Object(r.__extends)(e,t),e.prototype.componentDidMount=function(){this._bringFocusIntoZone(),this._updateEventHandlers(this.props),!this.props.disabled&&this._root.current&&this.props.enableAriaHiddenSiblings&&(this._unmodalize=Object(i.a)(this._root.current))},e.prototype.UNSAFE_componentWillReceiveProps=function(t){var e=t.elementToFocusOnDismiss;e&&this._previouslyFocusedElementOutsideTrapZone!==e&&(this._previouslyFocusedElementOutsideTrapZone=e),this._updateEventHandlers(t)},e.prototype.componentDidUpdate=function(t){var e=void 0===t.forceFocusInsideTrap||t.forceFocusInsideTrap,n=void 0===this.props.forceFocusInsideTrap||this.props.forceFocusInsideTrap,r=void 0!==t.disabled&&t.disabled,a=void 0!==this.props.disabled&&this.props.disabled;!e&&n||r&&!a?(this._bringFocusIntoZone(),!this._unmodalize&&this._root.current&&this.props.enableAriaHiddenSiblings&&(this._unmodalize=Object(i.a)(this._root.current))):(e&&!n||!r&&a)&&(this._returnFocusToInitiator(),this._unmodalize&&this._unmodalize())},e.prototype.componentWillUnmount=function(){this.props.disabled&&!this.props.forceFocusInsideTrap&&Object(o.a)(this._root.current,this._getDocument().activeElement)||this._returnFocusToInitiator(),this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0),this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),this._unmodalize&&this._unmodalize(),delete this._previouslyFocusedElementInTrapZone,delete this._previouslyFocusedElementOutsideTrapZone},e.prototype.render=function(){var t=this.props,e=t.className,n=t.disabled,i=void 0!==n&&n,o=t.ariaLabelledBy,c=Object(s.j)(this.props,s.h),u={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:i?-1:0,"data-is-visible":!0};return a.createElement("div",Object(r.__assign)({},c,{className:e,ref:this._root,"aria-labelledby":o,onFocusCapture:this._onFocusCapture,onFocus:this._onRootFocus,onBlur:this._onRootBlur}),a.createElement("div",Object(r.__assign)({},u,{ref:this._firstBumper,onFocus:this._onFirstBumperFocus})),this.props.children,a.createElement("div",Object(r.__assign)({},u,{ref:this._lastBumper,onFocus:this._onLastBumperFocus})))},e.prototype.focus=function(){var t=this.props,e=t.focusPreviouslyFocusedInnerElement,n=t.firstFocusableSelector,r=t.firstFocusableTarget;if(e&&this._previouslyFocusedElementInTrapZone&&Object(o.a)(this._root.current,this._previouslyFocusedElementInTrapZone))this._focusAsync(this._previouslyFocusedElementInTrapZone);else{var a="string"==typeof n?n:n&&n(),i=null;this._root.current&&("string"==typeof r?i=this._root.current.querySelector(r):r?i=r(this._root.current):a&&(i=this._root.current.querySelector("."+a)),i||(i=Object(c.j)(this._root.current,this._root.current.firstChild,!1,!1,!1,!0))),i&&this._focusAsync(i)}},e.prototype._focusAsync=function(t){this._isBumper(t)||Object(c.b)(t)},e.prototype._bringFocusIntoZone=function(){var t=this.props,n=t.elementToFocusOnDismiss,r=t.disabled,a=void 0!==r&&r,i=t.disableFirstFocus,c=void 0!==i&&i;a||(e._focusStack.push(this),this._previouslyFocusedElementOutsideTrapZone=n||this._getDocument().activeElement,c||Object(o.a)(this._root.current,this._previouslyFocusedElementOutsideTrapZone)||this.focus())},e.prototype._returnFocusToInitiator=function(){var t=this,n=this.props.ignoreExternalFocusing;e._focusStack=e._focusStack.filter((function(e){return t!==e}));var r=this._getDocument(),a=r.activeElement;n||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!Object(o.a)(this._root.current,a)&&a!==r.body||this._focusAsync(this._previouslyFocusedElementOutsideTrapZone)},e.prototype._updateEventHandlers=function(t){var e=t.isClickableOutsideFocusTrap,n=void 0!==e&&e,r=t.forceFocusInsideTrap,a=void 0===r||r;a&&!this._disposeFocusHandler?this._disposeFocusHandler=Object(l.a)(window,"focus",this._forceFocusInTrap,!0):!a&&this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),n||this._disposeClickHandler?n&&this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0):this._disposeClickHandler=Object(l.a)(window,"click",this._forceClickInTrap,!0)},e.prototype._isBumper=function(t){return t===this._firstBumper.current||t===this._lastBumper.current},e.prototype._getDocument=function(){return Object(d.a)(this._root.current)},e._focusStack=[],e}(a.Component)}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~filesView.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~filesView.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~filesView.js'] = (new Date()).getTime();