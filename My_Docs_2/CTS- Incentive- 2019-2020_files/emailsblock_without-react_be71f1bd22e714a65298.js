/*! Version: 1.4.0; Third Party Notices: https://lpcres.delve.office.com/lpc/versionless/tpn-47603613751f5e112728dbbb725aa9b78721065ba5ac0731b60fd24c01596b0f19d76d97f44af8744a3b2bbdee1bd82537230a0fbefcc583db846c4ac6dcb713.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[38],{1001:function(e,n,t){"use strict";t.r(n),t.d(n,"EmailsBlockView",function(){return w});var r=t(41),o=t(42),i=t(78),a=t(79),c=t(80),s=t(792),u=t(411),p=t(1939),l=t(134),d=t(1031),f=t(1067),b=t(2),m=t(153),g=t(1472),h=t(45),j=t(87),v=t(590),O=t(362),w=function(e){function n(){var e;return Object(r.a)(this,n),(e=Object(i.a)(this,Object(a.a)(n).apply(this,arguments))).getConvertedEmails=Object(l.memoizeFunction)(function(n){return n.map(function(n){return e.getEmailFromIEmail(n)})}),e}return Object(c.a)(n,e),Object(o.a)(n,[{key:"render",value:function(){var e=this,n=this.props.persona;if(!n||Object(h.b)(n))return null;var t=this.getConvertedEmails(this.props.emails);return b.createElement(p.a,{persona:n,messageEntities:t,isLoading:this.props.isLoading,isMePersona:this.props.isMePersona,showError:this.props.hasFailed,onTitleClick:function(){return g.d(n,e.lpcAppContext,e.props.renderingContext)},onFooterClick:function(){return g.b(n,e.lpcAppContext,e.props.renderingContext)},onRetryClick:function(){return g.c(n,e.lpcAppContext)},onMessageEntityClick:function(r,o){return g.a(e.props.emails[t.indexOf(r,0)],n.lpcKey,e.lpcAppContext,o)}})}},{key:"getEmailFromIEmail",value:function(e){return{subject:e.Subject,preview:e.Preview,emailFrom:e.From,fromName:e.FromName,received:Object(s.a)(Object(u.g)(e.Received)||Object(u.f)(),new Date,Object(O.b)(this.lpcAppContext),this.lpcAppContext.logger),isRead:e.IsRead,hasAttachments:e.HasAttachments,isAtMentioned:e.IsAtMentioned,flagStatus:e.FlagStatus,importance:e.Importance,kind:"Email"}}}]),n}(t(168).a);var y=Object(f.a)(w,function(e){var n=e.persona,t=e.hasFailed,r=e.isLoading,o=e.emails,i=e.isMePersona;return{componentName:"EmailsBlock",identifier:n&&n.lpcKey.key||"",logProperties:{hasFailed:t,isLoading:r,emailsCount:o.length.toString(),isMePersona:i}}}),C=Object(m.c)(function(e,n){var t=Boolean(Object(v.a)(e,n.persona));if(!n.persona)return{emails:[],isLoading:!1,hasFailed:!1,isMePersona:t};var r=Object(j.d)(e,n.persona.lpcKey);return{emails:r.emails,isLoading:r.isLoading,hasFailed:r.hasError,isMePersona:t}})(Object(d.a)(y));n.default=C},1059:function(e,n,t){"use strict";t.d(n,"a",function(){return p});var r=t(3),o=t.n(r),i=t(276),a=t(2),c=t(593),s=function(){return(s=o.a||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},u=t(1105);function p(e){var n=Object(c.c)(),t=Object(c.d)(),r=e.identifier,o=e.logProperties,p=t+e.componentName,l=Object(a.useRef)(null),d=Object(a.useRef)(null),f=Object(a.useRef)(null),b=Object(a.useRef)(0);Object(a.useEffect)(function(){return null===l.current&&(l.current=u()),function(){d.current||(d.current=u());var e=l.current&&d.current?d.current-l.current:void 0,t=void 0!==e&&Math.round(e).toString()||"";if(n){var r=s({component:p,duration:t,renderCount:b.current.toString()},f.current);n(p,r)}l.current=null,f.current=null,d.current=null,b.current=0}},[r,p]),Object(a.useEffect)(function(){Object(i.a)(o,f.current)||(b.current++,d.current=u(),f.current=o)},[p,o])}},1067:function(e,n,t){"use strict";t.d(n,"a",function(){return s});var r=t(3),o=t.n(r),i=t(2),a=t(1059),c=function(){return(c=o.a||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function s(e,n){return function(t){var r=n(t);return Object(a.a)(r),i.createElement(e,c({},t))}}},1105:function(e,n,t){(function(n){(function(){var t,r,o,i,a,c;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=n&&n.hrtime?(e.exports=function(){return(t()-a)/1e6},r=n.hrtime,i=(t=function(){var e;return 1e9*(e=r())[0]+e[1]})(),c=1e9*n.uptime(),a=i-c):Date.now?(e.exports=function(){return Date.now()-o},o=Date.now()):(e.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(this,t(795))},1472:function(e,n,t){"use strict";t.d(n,"c",function(){return g}),t.d(n,"d",function(){return h}),t.d(n,"b",function(){return j}),t.d(n,"a",function(){return O}),t.d(n,"e",function(){return w});var r=t(9),o=t.n(r),i=t(5),a=t.n(i),c=t(507),s=t(114),u=t(161),p=t(360),l=t(147),d=t(598),f=t(510),b=t(521),m=function(e,n,t,r){return new(t||(t=a.a))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,c)}s((r=r.apply(e,n||[])).next())})};function g(e,n){return m(this,void 0,void 0,o.a.mark(function t(){var r,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.dispatch(Object(u.c)({personaLpcKey:e.lpcKey})),r=n.getState(),i=d.a.getSelectors(r).getCardTemplateFailed(e.lpcKey),t.next=5,Object(b.b)(e,"",i,n,n.logger,void 0,void 0);case 5:case"end":return t.stop()}},t)}))}function h(e,n,t){var r=v(e,n),o=Object(p.b)(n);r&&o?(Object(s.j)(e,{applicationContext:n,renderingContext:t,cardCorrelationId:n.cardCorrelationId||"",logger:n.logger}),n.dispatch(Object(u.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Conversations",windowId:t.windowId,navigationStartCheckpoint:Object(c.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),o.renderExpandedView(n,"Conversations")):n.dispatch(Object(u.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1}))}function j(e,n,t){var r=v(e,n),o=Object(p.b)(n);r&&o?(Object(s.j)(e,{applicationContext:n,renderingContext:t,cardCorrelationId:n.cardCorrelationId||"",logger:n.logger}),n.dispatch(Object(u.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Conversations",windowId:t.windowId,navigationStartCheckpoint:Object(c.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),o.renderExpandedView(n,"Conversations")):n.dispatch(Object(u.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1}))}function v(e,n){var t=Object(p.b)(n);return n.settings.isImmersiveProfileEnabled&&!!t&&!Object(l.a)(e)}function O(e,n,t,r,o){t.dispatch(Object(u.a)({email:e,indexClicked:r,personaLpcKey:n})),Object(f.h)(t,t.logger)(e,n,o)}function w(e,n,t,r){t.dispatch(Object(u.f)({email:e,personaLpcKey:n})),Object(f.h)(t,t.logger)(e,n,r)}}}]);