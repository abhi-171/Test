self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1371.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1371],{17250:function(e,t,n){"use strict";n.r(t);var r=n(44),o=n(3571),a=n(3260),i=Object(r.e)(o.a,"reloadTableOnTriageActionFailClone",(function(e){var t=e.tableView;t&&Object(a.a)(t)})),c=n(0),u=n(1791),s=n(134),d=n(188),l=Object(d.action)("onLoadMoreRowsSucceeded")((function(e,t,n,r){e.isLoading=!1,r(e,t,n),e.currentLoadedIndex=e.rowKeys.length})),b=Object(d.action)("onLoadMoreRowsFailed")((function(e,t){e.isLoading=!1,Object(s.r)("TnS_LoadMoreRowsError",[e.tableQuery.listViewType,t])})),f=n(1633),O=n(1716),j=n(2099),w=n(3014);var y=n(2787),g=n(2788),v=n(2870),h=n(785),_=n(2789),I=n(8502);var p=n(2535);function T(e,t){var n=e.rowKeys.length-1,r=e.tableQuery;(function(e,t,n,r,o,a,i,c,u,s){var d=Object(v.a)({FieldURIOrConstant:Object(g.a)({Item:Object(y.a)({Value:t})}),Item:Object(h.a)({FieldURI:"InstanceKey"})}),l=Object(_.a)({Item:d}),b=Object(I.a)({BasePoint:"Beginning",Condition:l,MaxEntriesReturned:n});return Object(j.b)(e,b,r,o,a,i,c,u,Object(j.g)(r),s)})(Object(f.i)(r),e.rowKeys[n],t,r.viewFilter,Object(p.a)(r),r.focusedViewFilter,r.requestShapeName,Object(O.e)(r),r.categoryName,Object(f.j)(e,!0)).then((function(t){"Success"===t.ResponseClass?l(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView,u.b):b(e,t.ResponseCode)}),(function(t){b(e)}))}var x=n(2594),m=50;function F(e){switch(e.isLoading=!0,e.tableQuery.listViewType){case 0:!function(e,t){var n,r=e.rowKeys.length-1,o=e.tableQuery,a=null===(n=Object(f.j)(e,!0))||void 0===n?void 0:n.Id;Object(j.d)(o.folderId,t,o.viewFilter,o.sortBy,Object(u.l)(o),o.focusedViewFilter,o.requestShapeName,Object(O.d)(o),e.rowKeys[r],o.categoryName,a).then((function(t){var n=[];t.edges&&(n=t.edges.map((function(e){return e.node}))),l(e,n,t.totalConversationRowsInView,u.a)})).catch((function(t){var n=Object(w.a)(t);b(e,n)}))}(e,m);break;case 1:T(e,m)}}var R=Object(d.action)("loadMoreInTable")((function(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t;return Object(c.__generator)(this,(function(n){if(!e)throw new Error("Selected tableview must not be null if loadMoreRows is being called.");if(e.currentLoadedIndex<e.rowKeys.length){if(e.rowKeys.length-e.currentLoadedIndex>=m)return e.currentLoadedIndex+=m,[2];e.currentLoadedIndex=e.rowKeys.length}return 0!=e.tableQuery.type&&2!=e.tableQuery.type||"spotlight"===e.tableQuery.scenarioType?1===e.tableQuery.type&&("SharedFolders"===(t=e.tableQuery).searchScope.kind?L(e):"PrimaryMailbox"===t.searchScope.kind&&K(e)):F(e),[2]}))}))})),L=function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){switch(t.label){case 0:return[4,x.b.import()];case 1:return t.sent()(e.currentLoadedIndex-1,e,"loadMoreInTable",l,b),[2]}}))}))},K=function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(c.__generator)(this,(function(r){switch(r.label){case 0:return t=e.rowKeys.length-1,n=e.tableQuery,t>n.lastIndexFetched?(n.lastIndexFetched=t,[4,x.c.import()]):[3,2];case 1:r.sent()(t,e,"loadMoreInTable",l,b),r.label=2;case 2:return[2]}}))}))},M=n(7340);function Q(){setTimeout((function(){var e=Object(M.a)();Object(a.a)(e)}),3e3)}n.d(t,"reloadTableOnTriageActionFailOrchestrator",(function(){return i})),n.d(t,"loadMoreInTable",(function(){return R})),n.d(t,"reloadInboxPostBoot",(function(){return Q}))},2787:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"Constant:#Exchange"},e)}},2788:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"FieldURIOrConstantType:#Exchange"},e)}},2789:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"RestrictionType:#Exchange"},e)}},2870:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"IsEqualTo:#Exchange"},e)}},7340:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1740),o=n(3186);function a(){var e=Object(o.a)();return Object(r.c)(e)}},8502:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"SeekToConditionPageView:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.1371.js.map
self.scriptsLoaded['owa.1371.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1371.js'] = (new Date()).getTime();