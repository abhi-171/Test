self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~RecipientSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[711],{1655:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function c(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return c}))},1656:function(t,e,n){"use strict";var r=n(0),c=n(1697),o=n(346),u=n(609),i=n(134),a=n(5),s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function b(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,p,O,j;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(o.k)(t)){if(b.accountState==o.b.AccessRevoked)return[2,null];if(b.accountState==o.b.AccountDeprovisioned||b.accountState==o.b.AccountNotFound)return Object(o.c)(b.accountState,b.accountProviderType),[2,null]}return e?(n[s]=e,n[f]=e):b&&(n[s]=b.anchorMailbox),b?(p=b.token,!(O=Object(u.g)(b.tokenExpiry))&&p?[3,2]:(Object(i.r)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(b.tokenExpiry,Object(a.Pb)()),isTokenExpired_1:O,isTokenInvalid_2:!p},{isCore:!0}),[4,c.a.importAndExecute(b.accountId,t,p)])):[3,3];case 1:(p=r.sent())||(p=""),r.label=2;case 2:j=void 0,"Outlook"==b.accountProviderType?(j='MSAuth1.0 usertoken="'+p+'", type="MSACT"',n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(j="Bearer "+p,n[l]=2..toString()),n[d]=j,r.label=3;case 3:return[2,n]}}))}))}var p=n(1655),O=n(34);function j(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(p.a)(),c=n,[4,v(t,e)];case 1:return c.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function v(t,e){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,g(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return o=r.sent(),Object(p.b)(c,o),[2,c]}}))}))}function g(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&O.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return g}))},1657:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(3),c=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1697:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(44),c=n(1657);n.d(e,"b",(function(){return c.a}));var o=new r.c((function(){return n.e(1261).then(n.bind(null,1903))})),u=new r.a(o,(function(t){return t.getAndUpdateAccessToken}))},1753:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},t)}},2004:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(25),c=n(40),o=n(3456);function u(){var t=Object(r.a)(),e=null==t?void 0:t.SessionSettings,n=null==e?void 0:e.IsExplicitLogon,u=null==e?void 0:e.IsSubstrateSearchServiceAvailable;return!(o.a.fallbackToFindPeople||!Object(c.i)("rp-3SPeopleSuggestions")||n||!u)}},2029:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"FindPeopleJsonRequest:#Exchange"},t)}},2053:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(40);function c(){return Object(r.i)("rp-peopleSuggestionsTrie")&&Object(r.i)("rp-peopleSuggestionsCacheFirst")||Object(r.i)("rp-cacheFirstPeopleTrieSize300")||Object(r.i)("rp-cacheFirstPeopleTrieSize500")||Object(r.i)("rp-cacheFirstPeopleTrieSize700")||Object(r.i)("rp-peopleTrieOnTimeoutLow")||Object(r.i)("rp-peopleTrieOnTimeoutMed")||Object(r.i)("rp-peopleTrieOnTimeoutHigh")}},218:function(t,e,n){"use strict";var r=n(693);n.d(e,"a",(function(){return r.a}))},2207:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"PersonaResponseShape:#Exchange"},t)}},2300:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(28),c=n(2029);function o(t,e){return void 0===t||t.__type||(t=Object(c.a)(t)),Object(r.a)("FindPeople",t,e)}},2331:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"FindPeopleRequest:#Exchange"},t)}},2348:function(t,e,n){"use strict";var r=n(0),c=n(268);var o=n(40),u=n(4);n.d(e,"a",(function(){return s}));var i=null,a="searchtesthook";function s(t){void 0===t&&(t={});var e,n=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},t),function(){if(!i){i={};var t=Object(u.a)(a),e=decodeURIComponent(t||"").trim();if(Object(o.i)("sea-debugHook")&&e.length>0){var n=e.split("&");i=n.reduce((function(t,e){var n=Object(r.__read)(e.split("="),2),c=n[0],o=n[1];return t[c]=o,t}),{})}}return i}()),Object(c.a)("includePartnerIn3SRequest")?((e={}).partner="exchangeshared",e):null);return Object.keys(n).filter((function(t){return null!==n[t]})).reduce((function(t,e){var c;return Object(r.__assign)(Object(r.__assign)({},t),((c={})[e]=n[e],c))}),{})}},2446:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"ContextProperty:#Exchange"},t)}},2619:function(t,e,n){"use strict";n.d(e,"b",(function(){return c}));var r=n(3),c=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),o=c();e.a=o},2806:function(t,e,n){"use strict";n.d(e,"a",(function(){return A})),n.d(e,"b",(function(){return P})),n.d(e,"c",(function(){return x}));var r=n(0),c=n(346),o=n(1656),u=n(40),i=n(208),a=n(218),s=n(178),d=n(2348),l=n(296),f=n(2053),b=n(34),p=n(2865),O="/search/api/v1/init?",j="/search/api/v1/suggestions?",v="owa.react.compose",g=["PandaServingCompose","PandaServingComposeZeroQuery"],h="AppendFreshContactsToTopN",m="ContextAwareServing",S="20",y="5",_="CSRClientEnabled",I="CSRCounterFactual",A="owa.projectMoca.peopleCard";function P(t,e,n,c,o,u,a,d){return void 0===d&&(d=!0),Object(r.__awaiter)(this,void 0,void 0,(function(){var l,f,p,O,g;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return l=a||v,null!=e?[3,1]:[2,T(l)];case 1:return[4,k(e,n,d,u,l)];case 2:return f=r.sent(),p=function(t,e,n){return{AppName:"OWA",Scenario:{Name:n},Cvid:e||Object(i.a)(),EntityRequests:[t]}}(f,null==o?void 0:o.conversationId,l),O=s.d,g=[j+x(l,e),p,c,!1],[4,E(t,null==o?void 0:o.clientSessionId)];case 3:return[2,O.apply(void 0,g.concat([r.sent(),!0,!0,!1])).then((function(t){return t})).catch((function(t){return b.g.info(t),null}))]}}))}))}function T(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=s.b,n=[O+x(t),void 0,!0],[4,E(null)];case 1:return[2,e.apply(void 0,n.concat([r.sent(),!0,!1])).then((function(t){return Object(a.a)(t.status)?t.json():null})).catch((function(t){return t.networkError=!0,b.d(t),null}))]}}))}))}function k(t,e,n,c,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u;return Object(r.__generator)(this,(function(r){return u={Query:{QueryString:t},EntityType:"People",Provenances:w(e),Size:e?S:y},c&&c.length>0&&(u.Context=function(t){var e={};t&&(e.RecipientsTo=t.toString());return e}(c)),u.Fields=o===A?Object(p.a)(2,n):Object(p.a)(1,n),[2,u]}))}))}function w(t){var e=["Mailbox"];return t&&!Object(l.a)()&&e.push("Directory"),e}function x(t,e){var n=Object(r.__assign)({scenario:t},Object(d.a)()),c=[],o=Object(f.a)();return(o||Object(u.i)("rp-cacheFirstPeopleTrieSize500cf"))&&(c.push.apply(c,Object(r.__spread)(g)),o&&Object(u.i)("rp-EnableFreshContactsForZeroQuery")&&c.push(h),c.push(_),c.push(I)),Object(u.i)("rp-contextualZeroQuery")&&""==e&&c.push(m),c.length>0&&(n.setflight=c.join(",")),Object.keys(n).map((function(t){return t+"="+n[t]})).join("&")}function E(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){return n={},e&&(n["client-session-id"]=e),t&&Object(c.r)(t)?[2,Object(o.a)(t).then((function(t){return Object.keys(t).forEach((function(e){return n[e]=t[e]})),n}))]:[2,n]}))}))}},2865:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2053),c=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"],o=c.concat(["FeatureData","GivenName","Surname","Alias"]),u=c.concat(["FeatureData"]),i=c.concat(["Phones","OfficeLocation","Department"]);function a(t,e){return void 0===e&&(e=!0),2===t?i:Object(r.a)()&&e?0==t?o:u:c}},3456:function(t,e,n){"use strict";var r=n(3),c=Object(r.createStore)("recipientcommon",{fallbackToFindPeople:!1})();e.a=c},3457:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2619);function c(t){return!!Object(r.b)().sessionMaskedRecipients[t]}},346:function(t,e,n){"use strict";var r,c=n(3);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var o,u=n(52),i=Object(c.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(c.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(c.action)("updateAccount",(function(t,e,n){return{userIdentity:t,accountToken:e,accountTokenExpiresIn:n}})),d=Object(c.action)("updateOWAConnectedAccountStatus",(function(t,e){return{userIdentity:t,accountState:e}})),l=Object(c.action)("accountIsInErrorState",(function(t,e){return Object(u.c)({name:"accountIsInErrorState",options:{isCore:!0},customData:{accountState_1:r[t],accountProvider_2:e}},{accountState:t})})),f=Object(c.action)("retryAccountUpdateToken",(function(t,e,n,c,o,i){return Object(u.c)({name:"retryAccountUpdateToken",customData:{currentAccountState_1:r[c],localAccountState_2:r[o],previousAccountState_3:r[i]}},{accountId:t,userIdentity:e,currentToken:n})})),b=Object(c.action)("connectedAccountsListRequested",(function(t){return Object(u.c)({name:"connectedAccountsGetResponse",options:{isCore:!0},customData:{isSuccess_1:t}},{isSuccess:t})})),p=Object(c.action)("setAccountsStoreState",(function(t){return{state:t}})),O=n(0),j=n(16);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(o||(o={}));var v=Object(c.createStore)("OWAAccountsStore",{accountsMap:new j.ObservableMap({}),accountsLoadedState:o.None}),g=n(105),h=n(85);function m(t){return t!=Object(h.b)()&&void 0!==y(t)}function S(){return Object(O.__spread)(v().accountsMap.values())}function y(t){return v().accountsMap.get(t)}function _(){var t;return(null===(t=S())||void 0===t?void 0:t.length)>0?S()[0]:null}function I(){return S().filter((function(t){return t.accountState!=r.Valid}))}function A(t){return S().filter((function(e){return t.includes(e.accountState)}))}function P(t){return S().filter((function(e){return e.accountProviderType==t}))}function T(t){return m(t)?y(t).accountProviderType:null}function k(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(g.a)(t.accountProviderType)}function w(t,e){return function(n){var r=y(n);return r?r[t]:e}}w("accountUniqueId","0");var x=w("accountState",r.Valid),E=function(){return S().some((function(t){return!R(t.userIdentity)}))},C=w("accountProviderType",null),D=function(t){return"Outlook"==C(t)},R=function(t){return x(t)==r.Valid},L=function(){return S().length>0};function M(){return v().accountsLoadedState}var F=n(5),N=n(134);Object(c.mutator)(i,(function(t){var e=t.account;Object(N.r)("owaAccountAdded",{accountStatus_1:r[e.accountState]}),v().accountsMap.set(e.userIdentity,e)})),Object(c.mutator)(a,(function(t){var e=t.userIdentity;v().accountsMap.delete(e)})),Object(c.mutator)(s,(function(t){var e=t.userIdentity,n=t.accountToken,r=t.accountTokenExpiresIn,c=v().accountsMap.get(e);c.token=n,c.tokenExpiry=Object(F.j)(Object(F.Pb)(),parseInt(r))})),Object(c.mutator)(d,(function(t){var e=t.userIdentity,n=t.accountState,c=v().accountsMap.get(e);c.accountState==r.Valid&&n!=r.Valid&&Object(N.r)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[n]}),c.accountState=n})),Object(c.mutator)(b,(function(t){var e=t.isSuccess?o.AccountsLoadSuccessful:o.AccountsLoadError;v().accountsLoadedState=e})),Object(c.mutator)(p,(function(t){v().accountsLoadedState=t.state})),n.d(e,"d",(function(){return i})),n.d(e,"u",(function(){return a})),n.d(e,"y",(function(){return s})),n.d(e,"x",(function(){return d})),n.d(e,"c",(function(){return l})),n.d(e,"v",(function(){return f})),n.d(e,"e",(function(){return b})),n.d(e,"w",(function(){return p})),n.d(e,"n",(function(){return S})),n.d(e,"k",(function(){return y})),n.d(e,"i",(function(){return _})),n.d(e,"f",(function(){return I})),n.d(e,"g",(function(){return A})),n.d(e,"o",(function(){return P})),n.d(e,"j",(function(){return T})),n.d(e,"m",(function(){return k})),n.d(e,"l",(function(){return x})),n.d(e,"q",(function(){return E})),n.d(e,"t",(function(){return D})),n.d(e,"s",(function(){return R})),n.d(e,"p",(function(){return L})),n.d(e,"h",(function(){return M})),n.d(e,"r",(function(){return m})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},347:function(t,e,n){"use strict";var r=n(0);function c(t,e){return t?Object(r.__assign)({mailboxInfo:t},e):null!=e?e:void 0}n.d(e,"a",(function(){return c}))},3629:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(7),c=n(3457),o=function(t){return t?{Id:t,__type:"ItemId:#Exchange"}:void 0};function u(t,e,n){var u=t.EmailAddresses,l=t.DisplayName,f=t.Text,b=t.PDLItemId,p=t.ADObjectId,O=t.PersonaId,j=t.FeatureData,v=t.Id,g=t.ReferenceId,h=t.ImAddress,m=t.JobTitle,S=t.PeopleType,y=t.PeopleSubtype,_=t.GivenName,I=t.Surname,A=t.Alias,P=t.Phones,T=t.Department,k=t.OfficeLocation,w=u?u[0]:void 0;if(!n&&w&&Object(c.a)(w))return null;var x={EmailAddress:w,Name:Object(r.f)(l)?f:l,MailboxType:s(y),RoutingType:i(y),ItemId:o(b)};return{DisplayName:l,ADObjectId:p,FeatureData:j,Id:v,ImAddress:h,EmailAddress:x,EmailAddresses:[x],PersonaTypeString:a(y),PersonaId:o(O),Title:m,ReferenceId:g,PeopleType:S,PeopleSubtype:y,GivenName:_,Surname:I,TransactionId:e,Alias:A,PhoneNumber:d(P),Department:T,Location:k}}function i(t){return"PersonalDistributionList"==t?"MAPIPDL":"SMTP"}function a(t){switch(t){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function s(t){switch(t){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return t}}function d(t){return(null==t?void 0:t.length)?{Number:t[0].Number,Type:t[0].Type}:{Number:""}}},5040:function(t,e,n){"use strict";n.r(e);var r=n(0),c=function(){function t(t){var e=this;this.pendingCallbacks=[],this.ongoingCallbacks=0,this.handlePromiseResolution=function(){if(e.ongoingCallbacks--,e.ongoingCallbacks<e.queueSize&&e.pendingCallbacks.length){var t=e.pendingCallbacks.shift();e.ongoingCallbacks++,t&&t().then(e.handlePromiseResolution)}},this.queueSize=t}return t.prototype.queueTask=function(t){if(this.ongoingCallbacks>=this.queueSize){var e=Object(r.__read)(function(t){var e,n;return[function(){var r=t();return r.then(e,n),r},new Promise((function(t,r){e=t,n=r}))]}(t),2),n=e[0],c=e[1];return this.pendingCallbacks.push(n),c}this.ongoingCallbacks++;var o=t();return o.then(this.handlePromiseResolution),o},t}(),o=n(208),u=n(2806),i=n(2004),a=function(t){return t.RoutingType&&"EX"===t.RoutingType.toUpperCase()?Object(r.__assign)(Object(r.__assign)({},t),{EmailAddress:t.OriginalDisplayName}):t},s=n(214),d=n(347),l=n(2446),f=n(2029),b=n(2331),p=n(1753),O=n(2207),j=n(785),v=n(2300),g=n(197),h=n(85),m=20,S=10,y="owa.react.compose";function _(t){return Object(p.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:t?m:S})}function I(t){return{__type:"FindPeopleContextInfo:#Exchange",RecipientsTo:t}}function A(t){return[Object(l.a)({Key:"AppName",Value:"OWA"}),Object(l.a)({Key:"AppScenario",Value:t||y})]}function P(t,e,n,c,o,u,i,l){return void 0===l&&(l=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var c,o,l,p,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=function(t,e,n,r){var c,o=["Mailbox"];return e&&!Object(h.s)()&&o.push("Directory"),Object(b.a)({IndexedPageItemView:_(e),PersonaShape:(c=[Object(j.a)({FieldURI:"PersonaEmailAddress"}),Object(j.a)({FieldURI:"EmailAddresses"}),Object(j.a)({FieldURI:"PersonaDisplayName"}),Object(j.a)({FieldURI:"PersonaDisplayNames"}),Object(j.a)({FieldURI:"PersonaId"}),Object(j.a)({FieldURI:"PersonaType"})],Object(O.a)({BaseShape:"IdOnly",AdditionalProperties:c})),QuerySources:o,QueryString:t,SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,Context:A(r),ContextInfo:I(n||[])})}(e,n,u,i),o=Object(s.d)(t),(l=Object(d.a)(o))?[4,Object(v.a)(Object(f.a)({Header:Object(g.b)(),Body:c}),l)]:[2,null];case 1:return p=r.sent(),(m=p.Body).ResultSet&&(m.ResultSet=m.ResultSet.map((function(t){return t.EmailAddress&&(t.EmailAddress=a(t.EmailAddress)),t}))),[2,m]}}))}))}function T(){return Object(i.a)()?u.b:P}var k=n(3629),w=n(989),x=new c(3),E=function(t){return void 0!==t.Groups},C=function(t){return"People"===t.Type&&1===t.Suggestions.length};function D(t,e){var n,c,u;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,d,l,f,b,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=T(),a=Object(o.a)(),[4,x.queueTask((function(){return i(t,e,!0,a,null,[])}))];case 1:if(!(s=r.sent()))return[2,null];if(E(s)){if(1!==(d=s.Groups.filter(C)).length)return[2,null];if((b=d[0].Suggestions[0]).EmailAddresses.length<1)return[2,null];if(R(e,b.DisplayName,b.EmailAddresses))return l=null===(n=s.Instrumentation)||void 0===n?void 0:n.TraceId,[2,Object(k.a)(b,l,!0)]}else{if(!(f=s.ResultSet)||1!==f.length)return[2,null];if(!(b=f[0])||0==(null===(c=null==b?void 0:b.EmailAddresses)||void 0===c?void 0:c.length))return[2,null];if(p=(null==b?void 0:b.EmailAddresses)?null===(u=null==b?void 0:b.EmailAddresses)||void 0===u?void 0:u.map((function(t){return t.EmailAddress})):[],R(e,null==b?void 0:b.DisplayName,p))return[2,b]}return[2,null]}}))}))}function R(t,e,n){var r;if((t=t.toLowerCase())==(e=null==e?void 0:e.toLowerCase()))return!0;for(var c=0;c<n.length;c++){var o=null===(r=n[c])||void 0===r?void 0:r.toLowerCase();if(o&&(t==o||t==Object(w.d)(o)))return!0}return!1}var L=function(t,e,n,r,c,o,u,i){return T()(t,e,n,r,c,o,u,i)};n.d(e,"searchSuggestionsForSinglePersona",(function(){return D})),n.d(e,"searchSuggestions",(function(){return L}))},609:function(t,e,n){"use strict";var r=n(3),c=Object(r.action)("initializeOwaObservableDateTime"),o=Object(r.action)("observableNowChanged"),u=Object(r.action)("observableTodayChanged"),i=n(5),a=n(16),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(a.computed)((function(){return Object(i.lc)(s().now)})),l=function(){return d.get()},f=Object(a.computed)((function(){return Object(i.lc)(s().today)})),b=function(){return f.get()},p=function(t){return Object(i.Gb)(t,l())},O=function(t){return Object(i.Eb)(t,l())},j=function(t){return g(t,i.Gb)},v=function(t){return g(t,i.Hb)},g=function(t,e){return e(Object(i.Wb)(Object(i.lc)(t)),b())};function h(t){if(!t)return"";var e=Object(i.lc)(t);return function(t,e){var n=Object(i.Wb)(t);if(Object(i.Ib)(n,e))return i.Z;var r=function(t){return Object(i.Mb)(n,Object(i.e)(e,-t),e)};if(r(3))return i.hb;if(r(30))return i.gb;return i.X}(e,b())(e)}function m(t){if(!t)return"";var e=Object(i.lc)(t);return function(t,e){var n=Object(i.Wb)(t);if(Object(i.Ib)(n,e))return i.S;return i.T}(e,b())(e)}function S(t){return t?function(t,e){var n=Object(i.Wb)(t);return Object(i.Ib)(n,e)?Object(i.Z)(t):y(n,e,2)?Object(i.kb)(t):y(n,e,7)?Object(i.H)(Object(i.ab)(t),Object(i.Z)(t)):Object(i.H)(Object(i.J)(t),Object(i.Z)(t))}(Object(i.lc)(t),b()):""}function y(t,e,n){return Object(i.Mb)(t,Object(i.e)(e,-n),e)}var _=Object(r.action)("updateTimes"),I=Object(r.action)("setNow"),A=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(I,(function(){s().now=Object(i.jc)()})),Object(r.mutator)(A,(function(t){var e=t.today;s().today=e}));var P=n(36),T=n(126);Object(r.orchestrator)(c,(function(){_();var t=Object(i.Pb)(),e=Object(i.Yb)(Object(i.h)(t,1)),n=Object(i.w)(e,t);setTimeout((function(){return setInterval(_,P.g)}),n)})),Object(r.orchestrator)(T.l,(function(){_()})),Object(r.orchestrator)(_,(function(){I();var t=Object(i.zb)(Object(i.kc)()),e=s().today!=t;e&&A(t),o(),e&&u()})),n.d(e,"d",(function(){return c})),n.d(e,"j",(function(){return o})),n.d(e,"l",(function(){return u})),n.d(e,"i",(function(){return l})),n.d(e,"k",(function(){return b})),n.d(e,"g",(function(){return p})),n.d(e,"e",(function(){return O})),n.d(e,"f",(function(){return j})),n.d(e,"h",(function(){return v})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return m})),n.d(e,"c",(function(){return S}))},693:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))},785:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"PropertyUri:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.MailBoot~RecipientSuggestions.js.map
self.scriptsLoaded['owa.MailBoot~RecipientSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~RecipientSuggestions.js'] = (new Date()).getTime();