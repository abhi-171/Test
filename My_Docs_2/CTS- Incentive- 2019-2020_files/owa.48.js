self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.48.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[48],{2004:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(25),i=n(40),a=n(3456);function c(){var e=Object(r.a)(),t=null==e?void 0:e.SessionSettings,n=null==t?void 0:t.IsExplicitLogon,c=null==t?void 0:t.IsSubstrateSearchServiceAvailable;return!(a.a.fallbackToFindPeople||!Object(i.i)("rp-3SPeopleSuggestions")||n||!c)}},2053:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(40);function i(){return Object(r.i)("rp-peopleSuggestionsTrie")&&Object(r.i)("rp-peopleSuggestionsCacheFirst")||Object(r.i)("rp-cacheFirstPeopleTrieSize300")||Object(r.i)("rp-cacheFirstPeopleTrieSize500")||Object(r.i)("rp-cacheFirstPeopleTrieSize700")||Object(r.i)("rp-peopleTrieOnTimeoutLow")||Object(r.i)("rp-peopleTrieOnTimeoutMed")||Object(r.i)("rp-peopleTrieOnTimeoutHigh")}},2160:function(e,t,n){"use strict";var r=n(7),i=n(188),a=n(3001),c=n(2944),s=n(197),o=n(34);function u(e){var t=Object(c.a)({EntityFeedbackEntries:e});return Object(a.a)({Header:Object(s.b)(),Body:t}).then((function(e){!function(e){if(null==e?void 0:e.Body){var t=e.Body;o.g.info(Object(r.c)("addEntityFeedback Error count: {0}",t.ErrorCount)),o.g.info(Object(r.c)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)}))}t.a=Object(i.action)("attemptToSubmitAddEntityFeedback")((function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(u(e.entityFeedbackEntries),o.g.info(Object(r.c)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))}))},2170:function(e,t,n){"use strict";var r=n(188);t.a=Object(r.action)("setCommonWellItemSelectedState")((function(e,t){e.isSelected=t}))},2175:function(e,t,n){"use strict";var r=n(0),i=n(2257),a=n(3327),c=n(3899),s=n(3262),o=n(3039),u=n(3630),l=n(3458),d=n(5),b=n(208),p=n(1714),f=n(3900),O=n(188),j=Object(O.action)("autoSearchDirectory")((function(e,t,n,O,j){return Object(r.__awaiter)(this,void 0,void 0,(function(){var v,m,h,S;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return v=Object(d.Pb)(),m=Object(b.a)(),Object(s.b)(e,v,m,!0),[4,i.a.import().then((function(n){return n(e.userIdentity,t,!0,m,e.findPeopleFeedbackManager,null,j)}))];case 1:return h=r.sent(),Object(o.a)(e,!1),e.queryString.trim()==t&&(20,Object(u.a)(e,t),Object(c.a)(e.findResultSet,h,O,20,!0),S=Object(l.a)(h),Object(s.d)(e,!0,S,h),Object(f.a)(e.findResultSet,e,v,S),e.directorySearchType=p.a.Auto,0==e.findResultSet.length&&(e.findResultSet=[]),Object(a.a)(e,p.b.SearchDirectory,0,n)),[2]}}))}))})),v=n(3788),m=n(4008),h=n(3628),S=n(4455),g=n(2004),y=n(4844),R=n(1901),E=n(2053),I=Object(O.action)("backfillCache")((function(e,t,n,a,o,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var O,I,T,A,P,w,_,F;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:O=Object(b.a)(),Object(v.a)(O),I=Object(d.Pb)(),Object(s.b)(e,I,O,!1),T="",r.label=1;case 1:return r.trys.push([1,8,9,10]),[4,i.a.import().then((function(n){return n(e.userIdentity,t,!1,O,null,null,u)}))];case 2:return A=r.sent(),T=Object(l.a)(A),P=function(e){if(Object(g.a)()){var t=[];return Object(h.a)(t,e,!1),t}return e.ResultSet}(A),a&&Object(m.a)(P),w=e.queryString==t,function(e){var t;var n;return Object(g.a)()?!(null===(t=null==(n=e)?void 0:n.Groups)||void 0===t?void 0:t.length):"Success"!=(n=e).ResponseClass||0==n.ResultSet.length}(A)&&w?[4,j(e,t,n,o,u)]:[3,4];case 3:return r.sent(),Object(y.a)(e,p.a.Auto),[3,7];case 4:return w?(_="",Object(E.a)()&&o?[4,R.a.import().then((function(n){return n(t,e.findResultSet,A)}))]:[3,6]):[3,7];case 5:_=r.sent(),r.label=6;case 6:Object(s.d)(e,!1,T,A,_),Object(c.a)(e.findResultSet,A,o,5),Object(f.a)(P,e,I,T),r.label=7;case 7:return[3,10];case 8:throw F=r.sent(),Object(S.a)(e,I,T),F;case 9:return Object(v.b)(O),[7];case 10:return[2]}}))}))}));var T=n(4456),A=n(4657),P=n(134),w=Object(O.action)("setFindResultSet")((function(e,t){e.findResultSet=t}));var _=n(5998),F=Object(O.action)("processCacheResult")((function(e,t,n,i,c){if(n){var s=new Map;e.findResultSet.forEach((function(e){s[e.EmailAddress.EmailAddress]=e})),t=function(e,t){return t.filter((function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]}))}(s,t),(t=Object(r.__spread)(e.findResultSet,t)).splice(5)}Object(o.a)(e,!1),(n||t.length>0)&&w(e,t),Object(_.a)(e,c),Object(a.a)(e,p.b.Cache,t.length,i)})),C=n(1886);function k(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(E.a)()?[4,Object(C.d)(e,5,t)]:[3,2];case 1:return i=r.sent(),[3,3];case 2:i=Object(C.a)(e,5,t),r.label=3;case 3:return 0==(n=i).length?[2,[]]:(a=n.map((function(e){var t=e;return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId,PersonaTypeString:e.PersonaTypeString,FeatureData:e.FeatureData,Id:t.Id}})),[2,Promise.resolve(a)])}}))}))}var D=n(4458),x=function(e,t,n,i,a){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var c,o,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=Object(d.Pb)(),[4,k(e,Object(D.a)(t))];case 1:return o=r.sent(),Object(u.a)(n,e),l=Object(b.a)(),Object(s.a)(n,c,o,l),F(n,o,i,a,c),[2,o]}}))}))},N=Object(O.action)("findPeopleCacheFirst")((function(e,t,n,i,c,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,l,d,b,f,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=p.b.Cache,l=new P.b(T.a.SearchCacheFirst.name),e.directorySearchType=p.a.None,Object(o.a)(e,!0),[4,x(t,n,e,i,c)];case 1:d=r.sent(),b=d.length,f=i||b>0,r.label=2;case 2:return r.trys.push([2,6,,7]),f&&A.a.pendingFindPeopleRequests<3?(I(e,t,c,!Object(E.a)(),f,s),u=p.b.MixedCacheLive,[3,5]):[3,3];case 3:return f?[3,5]:[4,I(e,t,c,!Object(E.a)(),f,s)];case 4:r.sent(),u=p.b.FindPeople,r.label=5;case 5:return[3,7];case 6:return O=r.sent(),f||w(e,[]),l.endWithError("ServerError",O),[3,7];case 7:return e.findResultSet.length>0?(Object(a.a)(e,u,b,c),[3,10]):[3,8];case 8:return[4,j(e,t,c,null,s)];case 9:r.sent(),u=p.b.SearchDirectory,r.label=10;case 10:return Object(o.a)(e,!1),l.addCustomData([u,t==e.queryString]),l.end(),[2]}}))}))})),q=5;var L=n(5677),M=n(40),W=n(3626),G=n(85),Q=n(5678),z=n(5679),J=n(4846),U=Object(O.action)("searchCacheFallback")((function(e,t,n,i,a,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.queryString.trim()!=t.trim()?[3,2]:(o=Object(d.Pb)(),[4,k(t,Object(D.a)(n))]);case 1:l=r.sent(),Object(s.a)(e,o,l,Object(b.a)(),!0),Object(u.a)(e,t),e.directorySearchType=p.a.None,l.length>0?F(e,l,i,a,o):c&&(c.isCacheEmpty=!0),r.label=2;case 2:return[2]}}))}))}));t.a=Object(O.action)("findReadWriteRecipient")(Object(O.select)({store:function(){return A.a}})((function(e,t,n,O,m,h,y,I,A){return Object(r.__awaiter)(this,void 0,void 0,(function(){var w,_,F,C,k,D,x,V,B,H,K,$,X,Y,Z,ee,te,ne,re,ie,ae;return Object(r.__generator)(this,(function(ce){switch(ce.label){case 0:return n||Object(s.c)(e),w=Object(L.a)(e,m),_=!1,h&&h.length>0&&(F=function(e,t){var n=[];if(t){var r=0;for(e=e.toLowerCase();n.length<q&&r<t.length;){var i=t[r].persona.EmailAddress;(i.EmailAddress&&0==i.EmailAddress.toLowerCase().indexOf(e)||i.Name&&0==i.Name.toLowerCase().indexOf(e))&&n.push({EmailAddress:i}),r++}}return n}(t,h))&&F.length>0&&(e.findResultSet=F,_=!0),(k=!Object(W.a)())?(D=!Object(E.a)())?[3,2]:[4,R.c.importAndExecute()]:[3,3];case 1:D=!ce.sent(),ce.label=2;case 2:k=D,ce.label=3;case 3:return C=k,!y&&!Object(J.a)()||n||!C?[3,5]:[4,N(e,t,w,_,O,I)];case 4:return ce.sent(),[2];case 5:return x=!1,A.store.pendingFindPeopleRequests<Q.a?(ae=new P.b(T.a.SearchPeopleIndex.name),Object(o.a)(e,!0),e.findResultSet=Object(r.__spread)(e.findResultSet),V=e.currentRenderedQueryString,B=e.directorySearchType,Object(M.i)("rp-optimizeAutoSearchDirectory")&&""!=V&&!n&&B==p.a.Auto&&V.length<t.length&&0==t.indexOf(e.currentRenderedQueryString)?[4,j(e,t,O,null,I)]:[3,7]):[3,18];case 6:return ce.sent(),x=!0,ae.addCustomData([!1,!0,!0,!1,!0,Object(g.a)()]),ae.end(),[3,17];case 7:H={isTimedOut:!1,isCacheEmpty:!1},K=n||Object(W.a)()?null:setTimeout(function(e,t,n,i,a,c){return function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c.isTimedOut=!0,[4,U(e,n,t,i,a,c)];case 1:return r.sent(),[2]}}))}))}}(e,w,t,_,O,H),Object(z.a)()),$=Object(d.Pb)(),X="",Y=Object(b.a)(),ce.label=8;case 8:return ce.trys.push([8,15,,17]),Object(v.a)(Y),Z=[],w.forEach((function(e){Z.push(e.persona.EmailAddress.EmailAddress)})),Object(s.b)(e,$,Y,n),[4,i.a.import().then((function(r){return r(e.userIdentity,t,n,Y,e.findPeopleFeedbackManager,Z,I,C)}))];case 9:return ee=ce.sent(),Object(v.b)(Y),clearTimeout(K),te=e.queryString==t,H.isTimedOut&&!H.isCacheEmpty||!te?[3,14]:(X=Object(l.a)(ee),Object(s.d)(e,n,X,ee),Object(u.a)(e,t),e.directorySearchType=n?p.a.Manual:p.a.None,ne=n?Q.b:Q.c,Object(c.a)(e.findResultSet,ee,_,ne,n),Object(f.a)(e.findResultSet,e,$,X),e.findResultSet.length>0?(Object(o.a)(e,!1),re=n?p.b.SearchDirectory:p.b.FindPeople,Object(a.a)(e,re,0,O),[3,14]):[3,10]);case 10:return[4,U(e,t,w,_,O)];case 11:return ce.sent(),0!==e.findResultSet.length?[3,14]:Object(G.s)()?(e.directorySearchType=p.a.Auto,e.findResultSet=[],[3,14]):[3,12];case 12:return x=!0,[4,j(e,t,O,null,I)];case 13:ce.sent(),ce.label=14;case 14:return ae.addCustomData([H.isTimedOut,te,n,H.isCacheEmpty,x,Object(g.a)()]),ae.end(),[3,17];case 15:return ie=ce.sent(),Object(v.b)(Y),ae.endWithError("ServerError",ie),Object(S.a)(e,$,X),[4,U(e,t,w,_,O)];case 16:return ce.sent(),[3,17];case 17:return[3,20];case 18:return ae=new P.b("FindPeopleThresholdHit"),[4,U(e,t,w,_,O)];case 19:ce.sent(),ae.end(),ce.label=20;case 20:return Object(o.a)(e,!1),[2]}}))}))})))},2257:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(44),i=new r.c((function(){return n.e(711).then(n.bind(null,5040))})),a=new r.b(i,(function(e){return e.searchSuggestionsForSinglePersona})),c=new r.b(i,(function(e){return e.searchSuggestions}))},2394:function(e,t,n){"use strict";var r=n(7),i=n(188),a=Object(i.action)("increaseEntrySequenceNumber")((function(e){e&&e.entrySequenceNumber++})),c=n(80),s=n(34),o=n(5);function u(e,t,n,i,u,l,d,b){if(void 0===b&&(b=Object(o.Pb)()),!e)return s.g.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(c.b)(e.clientSessionId))return s.g.warn(Object(r.c)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var p={ClientEventTimeUtc:Object(o.tb)(b),ClientEventTimeLocal:Object(o.qb)(b),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:i,EntityAddSource:u,JsonPropertyBag:l,ScenarioName:d||e.entityScenarioName};return a(e),p}n.d(t,"a",(function(){return u}))},2412:function(e,t,n){"use strict";var r=n(0),i=n(214),a=n(1794),c=n(2257),s=n(3787),o=n(3),u=Object(o.action)("addRecipientsToRecipientWell",(function(e,t){return{newRecipients:e,recipientWell:t}}));t.a=u,Object(o.mutator)(u,(function(e){var t,n=e.recipientWell;(t=n.recipients).splice.apply(t,Object(r.__spread)([n.recipients.length,0],e.newRecipients)),n.isDirty=!0})),Object(o.orchestrator)(u,(function(e){var t=e.newRecipients,n=e.recipientWell;t.forEach((function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,o,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.isPendingResolution?(t=Object(a.a)(e.persona.EmailAddress),(o=n.userIdentity)||(o=Object(i.d)().userIdentity),[4,c.b.import().then((function(e){return e(o,t)}))]):[2];case 1:return u=r.sent(),Object(s.a)(e,u,t),[2]}}))}))}))}))},2619:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(3),i=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),a=i();t.a=a},2741:function(e,t,n){"use strict";var r=n(188);t.a=Object(r.action)("updateIsEditing")((function(e,t){e.isEditing=t}))},2944:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"AddEntityFeedbackRequest:#Exchange"},e)}},2946:function(e,t,n){"use strict";var r=n(188);t.a=Object(r.action)("setForceResolveState")((function(e,t){e.inForceResolve=t}))},3001:function(e,t,n){"use strict";var r=n(28),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"AddEntityFeedbackJsonRequest:#Exchange"},n)),Object(r.a)("AddEntityFeedback",e,t)}n.d(t,"a",(function(){return a}))},3039:function(e,t,n){"use strict";var r=n(188);t.a=Object(r.action)("setIsSearching")((function(e,t){e.isSearching!=t&&(e.isSearching=t)}))},3262:function(e,t,n){"use strict";var r=n(2004);n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d}));var i="Cache",a="Mailbox",c="Directory",s=" Fallback";function o(e){e.peopleFeedbackState={live:null,cache:null,directory:null}}function u(e,t,n,i){if(Object(r.a)()&&e.peopleFeedbackState){var s={CorrelationId:"",QueryString:"",SuggestionSource:"",RawResponse:""};s.TimeStamp=t,s.QueryString=e.queryString,s.SuggestionSource=i?c:a,s.RawResponse="pending",n&&(s.CorrelationId=n),i?e.peopleFeedbackState.directory=s:e.peopleFeedbackState.live=s}}function l(e,t,n,i,a){if(Object(r.a)()&&e.peopleFeedbackState){var c=i?JSON.stringify(i):"no response";(null==e?void 0:e.peopleFeedbackState)&&(t&&e.peopleFeedbackState.directory?(e.peopleFeedbackState.directory.RawResponse=c,e.peopleFeedbackState.directory.TraceId=n):!t&&e.peopleFeedbackState.live&&(a&&(c+=a),e.peopleFeedbackState.live.RawResponse=c,e.peopleFeedbackState.live.TraceId=n))}}function d(e,t,n,a,c){if(Object(r.a)()&&e.peopleFeedbackState){var o={CorrelationId:"",QueryString:"",SuggestionSource:"",RawResponse:""};o.QueryString=e.queryString,o.TimeStamp=t,o.SuggestionSource=c?i+s:i,o.RawResponse=n?JSON.stringify(n):"no response",a&&(o.CorrelationId=a),e.peopleFeedbackState.cache=o}}},3327:function(e,t,n){"use strict";var r=n(188),i=n(2412),a=n(3328),c=n(1721);t.a=Object(r.action)("postProcessSuggestionsResult")((function(e,t,n,r){1==e.findResultSet.length&&r&&Object(a.a)(e)?Object(i.a)(e.findResultSet.map(c.b),e):(e.findResultType=t,e.numberOfCacheResults=n)}))},3328:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients&&void 0!==e.findResultSet}n.d(t,"a",(function(){return r}))},3456:function(e,t,n){"use strict";var r=n(3),i=Object(r.createStore)("recipientcommon",{fallbackToFindPeople:!1})();t.a=i},3457:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2619);function i(e){return!!Object(r.b)().sessionMaskedRecipients[e]}},3458:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2004);function i(e){var t,n="";e&&(Object(r.a)()?(t=e).Groups&&t.Instrumentation&&(n=t.Instrumentation.TraceId):"Success"==(t=e).ResponseClass&&t.ResultSet&&(n=t.TransactionId));return n}},3459:function(e,t,n){"use strict";function r(e){var t=[];return e&&e.forEach((function(e,n){t[n]=e.Id||e.EmailAddress.EmailAddress||e.EmailAddress.Name})),t}n.d(t,"a",(function(){return r}))},3460:function(e,t,n){"use strict";var r=n(0),i=n(5220),a=n(2946),c=n(2741),s=n(188),o=n(134);t.a=Object(s.action)("resolveAllUnresolvedRecipients")((function(e,t,n){var s;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,l,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(a.a)(e,!0),e.queryString=e.queryString.trim(),e.recipients&&e.queryString?(null==n||n(),[4,Object(i.a)(e,!1,!0,!0)]):[3,2];case 1:return r.sent(),[3,3];case 2:for(u=-1,l=0;l<t.length;l++)if((null===(s=t[l].persona)||void 0===s?void 0:s.EmailAddress)&&!t[l].persona.EmailAddress.EmailAddress&&"PrivateDL"!=(d=t[l].persona).EmailAddress.MailboxType&&Object(o.r)("EmptyEmailAddress",[d.EmailAddress.MailboxType,d.EmailAddress.RoutingType]),!t[l].isValid){u=l;break}-1!=u?Object(c.a)(t[u],!0):Object(a.a)(e,!1),r.label=3;case 3:return[2]}}))}))}))},3625:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(1),n.e(2),n.e(3),n.e(4),n.e(7),n.e(706)]).then(n.bind(null,9581))})),a=new r.a(i,(function(e){return e.removePendingRequestCorrelationId})),c=new r.a(i,(function(e){return e.addPendingRequestCorrelationId})),s=new r.b(i,(function(e){return e.openFeedbackDialog}))},3626:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1842);function i(){return null===r.a.recipientCache||0==r.a.recipientCache.length}},3628:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(3629),a=20;function c(e,t,n,c,s){var o,u,l;if(!t||!t.Groups){var d=new Error("Response groups should not be null");throw d.networkError=!0,d}var b=[];c=c||a,c=n?c-e.length:c;var p=null===(l=t.Instrumentation)||void 0===l?void 0:l.TraceId;try{for(var f=Object(r.__values)(t.Groups),O=f.next();!O.done;O=f.next()){var j=O.value;if("People"===j.Type){j.Suggestions.forEach((function(e){if(b.length<c){var t=Object(i.a)(e,p,s);t&&b.push(t)}}));break}}}catch(e){o={error:e}}finally{try{O&&!O.done&&(u=f.return)&&u.call(f)}finally{if(o)throw o.error}}n?e.push.apply(e,Object(r.__spread)(b)):e.splice.apply(e,Object(r.__spread)([0,e.length],b))}},3629:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(7),i=n(3457),a=function(e){return e?{Id:e,__type:"ItemId:#Exchange"}:void 0};function c(e,t,n){var c=e.EmailAddresses,d=e.DisplayName,b=e.Text,p=e.PDLItemId,f=e.ADObjectId,O=e.PersonaId,j=e.FeatureData,v=e.Id,m=e.ReferenceId,h=e.ImAddress,S=e.JobTitle,g=e.PeopleType,y=e.PeopleSubtype,R=e.GivenName,E=e.Surname,I=e.Alias,T=e.Phones,A=e.Department,P=e.OfficeLocation,w=c?c[0]:void 0;if(!n&&w&&Object(i.a)(w))return null;var _={EmailAddress:w,Name:Object(r.f)(d)?b:d,MailboxType:u(y),RoutingType:s(y),ItemId:a(p)};return{DisplayName:d,ADObjectId:f,FeatureData:j,Id:v,ImAddress:h,EmailAddress:_,EmailAddresses:[_],PersonaTypeString:o(y),PersonaId:a(O),Title:S,ReferenceId:m,PeopleType:g,PeopleSubtype:y,GivenName:R,Surname:E,TransactionId:t,Alias:I,PhoneNumber:l(T),Department:A,Location:P}}function s(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function o(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function u(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}function l(e){return(null==e?void 0:e.length)?{Number:e[0].Number,Type:e[0].Type}:{Number:""}}},3630:function(e,t,n){"use strict";var r=n(188);t.a=Object(r.action)("updateCurrentRenderedQueryString")((function(e,t){e.currentRenderedQueryString=t}))},3787:function(e,t,n){"use strict";var r=n(1794),i=n(1909),a=n(3),c=Object(a.action)("resolvePendingPersonaOnRecipient",(function(e,t,n){return{recipient:e,nextPersona:t,searchedString:n}}));Object(a.mutator)(c,(function(e){var t=e.recipient,n=e.nextPersona,a=e.searchedString;Object(r.a)(t.persona.EmailAddress)===a&&(t.isPendingResolution=!1,n&&(t.persona=n,t.isValid=!0,t.displayText=Object(i.a)(n.EmailAddress)))})),t.a=c},3788:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(3),i=Object(r.action)("addPendingRequest",(function(e){return{correlationId:e}})),a=Object(r.action)("removePendingRequest",(function(e){return{correlationId:e}}))},3789:function(e,t,n){"use strict";var r=n(3),i=Object(r.action)("onRecipientsChanged",(function(e,t){return{recipientWellRecipients:e,recipientData:t}}));t.a=i},3899:function(e,t,n){"use strict";var r=n(3628),i=n(0),a=n(2004);function c(e,t){t&&(Object(a.a)()?function(e,t){var n,r;try{for(var a=Object(i.__values)(t.Groups),c=a.next();!c.done;c=a.next()){var s=c.value;if("People"===s.Type){var o=s.Suggestions.filter((function(t){return null==e[t.EmailAddresses?t.EmailAddresses[0]:""]}));s.Suggestions=o;break}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}(e,t):function(e,t){var n=t.ResultSet.filter((function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]}));t.ResultSet=n}(e,t))}var s=n(5997),o=n(188);t.a=Object(o.action)("processResponseResults")((function(e,t,n,i,o){if(n){var u=new Map;e.forEach((function(e){u[e.EmailAddress.EmailAddress]=e})),c(u,t)}Object(a.a)()?Object(r.a)(e,t,n,i,o):Object(s.a)(e,t,n,i)}))},3900:function(e,t,n){"use strict";var r=n(7),i=n(2160),a=n(2394),c=n(5),s=n(80),o=n(34),u=n(188),l=Object(u.action)("transactionCompleted")((function(e,t,n,u,l,d,b,p){if(void 0===p&&(p=null),null==e?void 0:e.hasSessionStarted){var f={TransactionRequestTime:Object(c.qb)(l),TransactionRequestDuration:Object(c.w)(Object(c.Pb)(),l),QueryString:Object(r.f)(t)?"":t,QueryStringLength:Object(s.b)(t)?0:t.length,PersonaTypeList:b,ImpressionId:u,Cvid:e.conversationId};p&&Object.keys(p).forEach((function(e){f[e]=p[e]})),d&&(f.Context=d);var O=JSON.stringify(f),j=JSON.stringify(n),v=Object(a.a)(e,u,"TransactionCompleted",j,0,O);Object(i.a)(e,v,!1),o.g.info(Object(r.c)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})),d=n(3459),b=n(4843);function p(e,t,n,r){var i,a,c=e.map((function(e){return b.a[e.PersonaTypeString]}));l(t.findPeopleFeedbackManager,t.queryString,Object(d.a)(e),r,n,{Action:"Type Down"},c,{CacheCorrelationId:null===(a=null===(i=t.peopleFeedbackState)||void 0===i?void 0:i.cache)||void 0===a?void 0:a.CorrelationId})}n.d(t,"a",(function(){return p}))},4008:function(e,t,n){"use strict";var r=n(0),i=n(1842),a=n(188),c=n(4009);t.a=Object(a.action)("addToCache")((function(e){e&&0!=e.length&&null!==i.a.recipientCache&&e.forEach((function(e){if("LinkedIn"!=e.PersonaTypeString){var t=Object(c.a)(e);if(t&&!i.a.allKeys[t]){var n=Object(r.__assign)(Object(r.__assign)({},e),{sessionAdd:!0});i.a.recipientCache.push(n),i.a.allKeys[t]=!0}}}))}))},4009:function(e,t,n){"use strict";function r(e){var t,n;return e?(null===(t=e.EmailAddress)||void 0===t?void 0:t.EmailAddress)||(null===(n=e.PersonaId)||void 0===n?void 0:n.Id):null}n.d(t,"a",(function(){return r}))},4010:function(e,t,n){"use strict";var r=n(0),i=n(3),a=Object(i.action)("removeRecipientFromRecipientWell",(function(e,t,n,r){return{recipientIndex:e,recipientWellRecipients:t,onRecipientDeletedCallback:n,deletedRecipient:t.recipients[e],newRecipients:r}}));Object(i.mutator)(a,(function(e){var t;e.recipientWellRecipients.isDirty=!0,(t=e.recipientWellRecipients.recipients).splice.apply(t,Object(r.__spread)([e.recipientIndex,1],e.newRecipients||[]))})),Object(i.orchestrator)(a,(function(e){e.onRecipientDeletedCallback([e.deletedRecipient],e.recipientIndex,e.recipientWellRecipients)})),t.a=a},4191:function(e,t,n){"use strict";var r=n(0),i=n(3789),a=n(4010),c=n(2170),s=n(188);function o(e,t,n){e[0].isSelected&&n.recipients.length>0&&Object(c.a)(n.recipients[Math.max(0,t-1)],!0)}t.a=Object(s.action)("removeReadWriteRecipients")((function(e,t,n){var c,s;void 0===n&&(n=!0);var u=!1;try{for(var l=Object(r.__values)(t),d=l.next();!d.done;d=l.next()){var b=d.value,p=-1;if((p="number"==typeof b?b:e.recipients.map((function(e){return e.persona.EmailAddress})).indexOf(b.persona.EmailAddress))>=0){if(e.recipients[p].blockWellItemRemoval)return;Object(a.a)(p,e,o),u=!0}}}catch(e){c={error:e}}finally{try{d&&!d.done&&(s=l.return)&&s.call(l)}finally{if(c)throw c.error}}n&&u&&Object(i.a)(e)}))},4455:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5218);function i(e,t,n){Object(r.a)(e.findPeopleFeedbackManager,e.queryString,n,t,{Action:"Type Down"})}},4456:function(e,t,n){"use strict";t.a={SearchPeopleIndex:{name:"SearchPeopleIndex"},AddRecipientFromFindControl:{name:"AddRecipientFromFindControl",customData:function(e,t){return{index:(e>23?23:e).toString(),source:t.toString()}}},SearchCacheFirst:{name:"SearchCacheFirst"}}},4457:function(e,t,n){"use strict";var r=n(3),i=Object(r.action)("removePersonaFromWell",(function(e,t,n){return void 0===n&&(n=!1),{targetRecipientWell:e,personaToRemove:t,shouldRemoveAllOccurrences:n}}));t.a=i},4458:function(e,t,n){"use strict";function r(e){var t=[];return e&&(t=e.map((function(e){return e.persona}))),t}n.d(t,"a",(function(){return r}))},4657:function(e,t,n){"use strict";var r=n(3),i=n(4457),a=n(4845),c=n(4191),s=(Object(r.orchestrator)(i.a,(function(e){var t=e.targetRecipientWell,n=e.personaToRemove,r=e.shouldRemoveAllOccurrences,i=t.recipients.filter((function(e){return Object(a.a)(e.persona,n)}));if(i&&i.length>0){for(var s=r?i.length-1:0,o=[],u=0;u<=s;u++)i[u]&&!i[u].blockWellItemRemoval&&o.push(i[u]);o.length>0&&Object(c.a)(t,o)}})),n(5219)),o=(Object(r.orchestrator)(s.a,(function(e){var t=e.recipientWells;t&&0!==t.length&&e.emailAddresses.forEach((function(e){var n={EmailAddress:e};t.filter((function(e){return!!e})).forEach((function(e){return Object(i.a)(e,n,!0)}))}))})),n(2412)),u=n(4008),l=n(3789),d=n(3460),b=n(3328);Object(r.orchestrator)(o.a,(function(e){e.newRecipients.forEach((function(e){e.isValid&&Object(u.a)([e.persona])}))})),Object(r.orchestrator)(o.a,(function(e){var t=e.recipientWell;t&&Object(b.a)(t)&&t.inForceResolve&&Object(d.a)(t,t.recipients)})),Object(r.orchestrator)(o.a,(function(e){var t=e.recipientWell,n=e.newRecipients;Object(l.a)(t,n.map((function(e){return{isValid:e.isValid,newPersona:e.persona,newEmailAddress:e.persona.EmailAddress.EmailAddress}})))}));var p=n(3788),f=n(3625),O=n(6);Object(r.orchestrator)(p.a,(function(e){v.pendingFindPeopleRequests++,Object(O.i)()&&f.a.importAndExecute(e.correlationId)})),Object(r.orchestrator)(p.b,(function(e){v.pendingFindPeopleRequests--,Object(O.i)()&&f.c.importAndExecute(e.correlationId)}));var j=Object(r.createStore)("readwriterecipientwell",{pendingFindPeopleRequests:0})(),v=t.a=j},4843:function(e,t,n){"use strict";t.a={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},4844:function(e,t,n){"use strict";var r=n(188);t.a=Object(r.action)("setDirectorySearchType")((function(e,t){e.directorySearchType=t}))},4845:function(e,t,n){"use strict";function r(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}n.d(t,"a",(function(){return r}))},4846:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(40);function i(){return Object(r.i)("rp-peopleSuggestionsCacheFirst")||Object(r.i)("rp-cacheFirstPeopleTrieSize300")||Object(r.i)("rp-cacheFirstPeopleTrieSize500")||Object(r.i)("rp-cacheFirstPeopleTrieSize700")}},5218:function(e,t,n){"use strict";var r=n(7),i=n(2160),a=n(2394),c=n(5),s=n(80),o=n(34),u=n(188);t.a=Object(u.action)("transactionFailed")((function(e,t,n,u,l,d){if(void 0===d&&(d=null),null==e?void 0:e.hasSessionStarted){var b={TransactionRequestTime:Object(c.qb)(u),TransactionRequestDuration:Object(c.w)(Object(c.Pb)(),u),QueryString:Object(r.f)(t)?"":t,QueryStringLength:Object(s.b)(t)?0:t.length,ImpressionId:n};d&&Object.keys(d).forEach((function(e){b[e]=d[e]})),l&&(b.Context=l);var p=JSON.stringify(b),f=Object(a.a)(e,n,"TransactionFailed",null,0,p);Object(i.a)(e,f,!1),o.g.info(Object(r.c)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}))},5219:function(e,t,n){"use strict";var r=n(3),i=Object(r.action)("removeRecipientsFromRecipientWells",(function(e,t){return{emailAddresses:e,recipientWells:t}}));t.a=i},5220:function(e,t,n){"use strict";var r=n(0),i=n(2412),a=n(2175),c=n(4844),s=n(3039),o=n(1714),u=n(188),l=n(1956);t.a=Object(u.action)("resolveQueryStringToRecipient")((function(e,t,n,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(c.a)(e,n?o.a.Manual:o.a.None),(d=e.queryString.trim())?t||e.inForceResolve?(e.queryString="",Object(s.a)(e,!1),Object(i.a)([Object(l.a)(d)],e),[3,3]):[3,1]:[3,4];case 1:return Object(s.a)(e,!0),[4,Object(a.a)(e,e.queryString,n,u)];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:Object(s.a)(e,!1),r.label=5;case 5:return[2]}}))}))}))},5677:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3328);function i(e,t){return Object(r.a)(e)?e.recipients:t||[]}},5678:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}));var r=3,i=5,a=20},5679:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(40),i=100,a=250,c=500,s=1e3;function o(){return Object(r.i)("rp-peopleTrieOnTimeoutLow")?i:Object(r.i)("rp-peopleTrieOnTimeoutMed")?a:Object(r.i)("rp-peopleTrieOnTimeoutHigh")?c:s}},5997:function(e,t,n){"use strict";var r=n(0),i=n(188),a=(t.a=Object(i.action)("processFindPeopleResult")((function(e,t,n,i){if("Success"!=t.ResponseClass||!t.ResultSet)throw new Error("Response resultSet should not be null");i=i||20,i=n?i-e.length:i,i=t.ResultSet.length>i?i:t.ResultSet.length;for(var c=t.TransactionId,s=[],o=0;o<i;o++){var u=t.ResultSet[o];u.EmailAddress?s.push({EmailAddress:(l=u.EmailAddress,l.RoutingType&&"EX"===l.RoutingType.toUpperCase()?Object(r.__assign)(Object(r.__assign)({},l),{EmailAddress:l.OriginalDisplayName}):l),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName,TransactionId:c}):"ImplicitGroup"==u.PersonaTypeString&&s.push({EmailAddress:a(u),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,Members:u.Members,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName,TransactionId:c})}var l;n?e.push.apply(e,Object(r.__spread)(s)):e.splice.apply(e,Object(r.__spread)([0,e.length],s))})),function(e){return{EmailAddress:e.FeedbackId,OriginalDisplayName:e.FeedbackId,Name:e.DisplayName,MailboxType:"GroupMailbox",RoutingType:"SMTP"}})},5998:function(e,t,n){"use strict";var r=n(3459),i=n(7),a=n(2160),c=n(2394),s=n(5),o=n(80),u=n(34),l=n(188),d=n(208),b=Object(l.action)("localCacheTransactionCompleted")((function(e,t,n,r,l,b,p){if(void 0===p&&(p=Object(s.Pb)()),null==e?void 0:e.hasSessionStarted){var f={TransactionRequestTime:Object(s.qb)(p),TransactionRequestDuration:Object(s.w)(Object(s.Pb)(),p),QueryString:Object(i.f)(t)?"":t,QueryStringLength:Object(o.b)(t)?0:t.length,FeatureData:null!=r?r:void 0,personaTypeList:l,ImpressionId:Object(d.a)(),Cvid:e.conversationId,CacheCorrelationId:b},O=JSON.stringify(f),j=JSON.stringify(n),v=Object(c.a)(e,"","LocalCacheTransactionCompleted",j,0,O);Object(a.a)(e,v,!1),u.g.info(Object(i.c)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})),p=n(4843),f=n(2053);function O(e,t){var n,i;if(e.findResultSet&&e.findResultSet.length>0){var a=[];e.findResultSet.forEach((function(e){a.push(p.a[e.PersonaTypeString])})),b(e.findPeopleFeedbackManager,e.queryString,Object(r.a)(e.findResultSet),Object(f.a)()?e.findResultSet.map((function(e){return e.FeatureData?e.FeatureData:""})):null,a,null===(i=null===(n=e.peopleFeedbackState)||void 0===n?void 0:n.cache)||void 0===i?void 0:i.CorrelationId,t)}}n.d(t,"a",(function(){return O}))}}]);
//# sourceMappingURL=owa.48.js.map
self.scriptsLoaded['owa.48.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.48.js'] = (new Date()).getTime();