self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SearchActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[726],{1659:function(e,t,r){"use strict";var o={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"},n=0;function a(e){return void 0===e&&(e="id"),""+e+n++}function i(e){return Array.isArray(e)?e.join(" "):e}function c(e){if(!e)return null;for(var t={},r=Object.keys(e),o=0;o<r.length;o++){switch(r[o]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=i(e.controls);break;case"describedBy":t["aria-describedby"]=i(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=i(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=i(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=i(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=i(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=i(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return c}))},1713:function(e,t,r){"use strict";var o=r(0),n=r(16),a=r(3),i=r(2724);function c(e){return Math.floor(Math.random()*e+1)}var s=r(2725);r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return h}));var u=4,l=8,d={toDate:null,fromDate:null,includeAttachments:!1,initialSearchScope:null,isSearchHistoryDirty:!1,isAnswerInitialized:!1,isAnswerLocalizationCompleted:!1,isUnread:!1,previousNode:null,searchNumber:0,staticSearchScope:null,staticSearchScopeList:null,shouldShowAdvancedSearch:!1,shouldShowTimeFilterCallout:!1,advancedSearchViewState:Object(i.a)(),initialAdvancedSearchViewState:Object(i.a)(),legacySuggestions:new n.ObservableMap({}),recipientForPersonalizedGhostTextIndex:c(s.a-1),generalizedGhostTextBankIndex:c(u-1),personalizedGhostTextBankIndex:c(l-1),usePersonalGhostText:!1,isAnswerAvailable:!1},b=Object(o.__assign)({},d),h=Object(a.createStore)("mailSearchStore",b),p=h();t.c=p},1970:function(e,t,r){"use strict";var o=r(44),n=r(2294),a=r(1713),i=r(1802);function c(e){var t=e.tableQuery;return 0===t.type?t.folderId:function(e){if(1!=e.type)return!1;var t=e.searchScope;return["PrimaryMailbox","ArchiveMailbox","SharedFolders"].indexOf(t.kind)>-1}(t)?t.searchScope.folderId:null}var s=r(2247),u=r(2248),l=r(1708);r.d(t,"a",(function(){return b})),r.d(t,"m",(function(){return h})),r.d(t,"c",(function(){return n.b})),r.d(t,"q",(function(){return a.c})),r.d(t,"i",(function(){return a.e})),r.d(t,"f",(function(){return i.a})),r.d(t,"s",(function(){return i.f})),r.d(t,"r",(function(){return i.e})),r.d(t,"g",(function(){return c})),r.d(t,"j",(function(){return s.a})),r.d(t,"h",(function(){return u.a})),r.d(t,"n",(function(){return l.k})),r.d(t,"e",(function(){return l.d})),r.d(t,"d",(function(){return l.c})),r.d(t,"b",(function(){return l.b})),r.d(t,"o",(function(){return l.l})),r.d(t,"p",(function(){return l.n})),r.d(t,"k",(function(){return l.h})),r.d(t,"l",(function(){return l.j}));var d=new o.c((function(){return Promise.all([r.e(3),r.e(5),r.e(6),r.e(7),r.e(8),r.e(11),r.e(13),r.e(15),r.e(17),r.e(20),r.e(21),r.e(22),r.e(26),r.e(25),r.e(28),r.e(29),r.e(31),r.e(32),r.e(33),r.e(42),r.e(41),r.e(44),r.e(45),r.e(48),r.e(842)]).then(r.bind(null,3864))})),b=Object(o.d)(d,(function(e){return e.AnswersContainer})),h=new o.a(d,(function(e){return e.initializeAndWarmupAnswers}))},213:function(e,t,r){var o;
/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var r={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var a=typeof o;if("string"===a||"number"===a)e.push(o);else if(Array.isArray(o))e.push(n.apply(null,o));else if("object"===a)for(var i in o)r.call(o,i)&&o[i]&&e.push(i)}}return e.join(" ")}e.exports?e.exports=n:void 0===(o=function(){return n}.apply(t,[]))||(e.exports=o)}()},2247:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r(40),n=r(2357),a=r(430);function i(){return Object(n.a)()&&(Object(o.i)("sea-fetchPeople2")||Object(o.i)("sea-fetchEvents2")||Object(o.i)("sea-calendarTriggerControl2")||Object(o.i)("sea-fetchFlights2")||Object(o.i)("sea-flightTriggerControl2")||Object(o.i)("sea-fetchFiles4")||Object(o.i)("sea-fileTriggerControl4")||Object(o.i)("sea-peopleTriggerControl2"))||Object(n.a)()&&Object(a.a)()&&(Object(o.i)("sea-fetchBookmarks2")||Object(o.i)("sea-bookmarkTriggerControl2")||Object(o.i)("sea-fetchAcronyms2")||Object(o.i)("sea-fetchLinks2")||Object(o.i)("sea-linkTriggerControl2")||Object(o.i)("sea-acronymTriggerControl2"))}},2248:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var o=r(1713),n=r(40),a=r(2357),i=r(85),c=r(1644),s=r(1673);function u(){var e=Object(o.e)().staticSearchScope,t=null==e?void 0:e.kind;if(Object(i.h)().SessionSettings.IsExplicitLogon)return"ArchiveMailbox"===t?2:Object(n.i)("sea-3s-explicitLogon")&&Object(a.a)()?0:1;if("PrimaryMailbox"===t)return Object(a.a)()?0:1;if("ArchiveMailbox"===t){var r=Object(s.a)(e.folderId);return Object(n.i)("sea-archive-mailbox-3S")&&Object(a.a)()&&r==c.d?0:1}return"Group"===t?1:"SharedFolders"===t?2:null}},2294:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}));var o=r(2035),n=[o.b.File,o.b.People,o.b.Keywords],a=[o.b.File,o.b.People,o.b.Keywords,o.b.Message,o.b.Event,o.b.Category,o.b.TrySuggestion,o.b.Setting]},2398:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r(3),n=Object(o.action)("setShowListPane",(function(e){return{showListPane:e}}))},2399:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r(3),n=Object(o.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},2724:function(e,t,r){"use strict";function o(){return{selectedSearchScope:null,subjectFieldText:"",keywordsFieldText:"",fromDate:null,toDate:null,hasAttachments:null,fromPeopleSuggestions:[],toPeopleSuggestions:[],ccPeopleSuggestions:[]}}r.d(t,"a",(function(){return o}))},2725:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var o=10},2772:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r(3),n=Object(o.action)("onClientReadingPanePositionChange")},3010:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r(1746);function n(){return Object(o.a)().showListPane}},3127:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r(3),n=Object(o.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",(function(e,t){return{jsEndToEndTime:e,jsRenderingTime:t}}))},347:function(e,t,r){"use strict";var o=r(0);function n(e,t){return e?Object(o.__assign)({mailboxInfo:e},t):null!=t?t:void 0}r.d(t,"a",(function(){return n}))},3883:function(e,t,r){"use strict";var o=r(3127),n=r(44),a=new n.c((function(){return Promise.all([r.e(3),r.e(11),r.e(14),r.e(37),r.e(44),r.e(60),r.e(108),r.e(123),r.e(729)]).then(r.bind(null,17510))})),i=new n.b(a,(function(e){return e.addSearchRequestInstrumentation})),c=new n.b(a,(function(e){return e.addResourceTimingEntry})),s=new n.b(a,(function(e){return e.searchDiagnostics})),u=function(){var e=s.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};r.d(t,"a",(function(){return o.a})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return c}))},457:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return s}));var o=r(0),n=r(12),a=r(382),i=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(e){var t,r,a,c,s,u=e.semanticColors,l=e.palette,d=u.buttonBackground,b=u.buttonBackgroundPressed,h=u.buttonBackgroundHovered,p=u.buttonText,f=u.buttonTextHovered,g=u.buttonTextChecked,m=u.buttonTextCheckedHovered;return{root:{backgroundColor:d,color:p},rootHovered:{backgroundColor:h,color:f,selectors:(t={},t[n.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:b,color:g},rootExpanded:{backgroundColor:b,color:g},rootChecked:{backgroundColor:b,color:g},rootCheckedHovered:{backgroundColor:b,color:m},rootDisabled:{selectors:(r={},r[n.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},r)},splitButtonContainer:{selectors:(a={},a[n.HighContrastSelector]={border:"none"},a)},splitButtonMenuButton:{color:l.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:l.neutralLight,selectors:(c={},c[n.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:u.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:u.buttonBackgroundDisabled}}},splitButtonDivider:Object(o.__assign)(Object(o.__assign)({},i()),{backgroundColor:l.neutralTertiaryAlt,selectors:(s={},s[n.HighContrastSelector]={backgroundColor:"WindowText"},s)}),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:u.buttonText},splitButtonMenuIconDisabled:{color:u.buttonTextDisabled}}}function s(e){var t,r,c,s,u,l,d,b,h,p=e.palette,f=e.semanticColors;return{root:{backgroundColor:f.primaryButtonBackground,border:"1px solid "+f.primaryButtonBackground,color:f.primaryButtonText,selectors:(t={},t[n.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},t["."+a.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:p.white}}},t)},rootHovered:{backgroundColor:f.primaryButtonBackgroundHovered,border:"1px solid "+f.primaryButtonBackgroundHovered,color:f.primaryButtonTextHovered,selectors:(r={},r[n.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},r)},rootPressed:{backgroundColor:f.primaryButtonBackgroundPressed,border:"1px solid "+f.primaryButtonBackgroundPressed,color:f.primaryButtonTextPressed,selectors:(c={},c[n.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},c)},rootExpanded:{backgroundColor:f.primaryButtonBackgroundPressed,color:f.primaryButtonTextPressed},rootChecked:{backgroundColor:f.primaryButtonBackgroundPressed,color:f.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:f.primaryButtonBackgroundPressed,color:f.primaryButtonTextPressed},rootDisabled:{selectors:(s={},s[n.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},s)},splitButtonContainer:{selectors:(u={},u[n.HighContrastSelector]={border:"none"},u)},splitButtonDivider:Object(o.__assign)(Object(o.__assign)({},i()),{backgroundColor:p.white,selectors:(l={},l[n.HighContrastSelector]={backgroundColor:"Window"},l)}),splitButtonMenuButton:{backgroundColor:f.primaryButtonBackground,color:f.primaryButtonText,selectors:(d={},d[n.HighContrastSelector]={backgroundColor:"WindowText"},d[":hover"]={backgroundColor:f.primaryButtonBackgroundHovered,selectors:(b={},b[n.HighContrastSelector]={color:"Highlight"},b)},d)},splitButtonMenuButtonDisabled:{backgroundColor:f.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:f.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:f.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:f.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:f.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:f.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:f.primaryButtonText},splitButtonMenuIconDisabled:{color:p.neutralTertiary,selectors:(h={},h[n.HighContrastSelector]={color:"GrayText"},h)}}}},509:function(e,t,r){"use strict";var o,n=r(0),a=r(1),i=r(692),c=r(34);!function(e){e[e.Full=0]="Full",e[e.Simple=1]="Simple",e[e.None=2]="None"}(o||(o={}));var s=function(e){function t(t){var r=e.call(this,t)||this;return r.state={},r}return Object(n.__extends)(t,e),t.prototype.componentDidCatch=function(e,t){var r,o;null===(o=(r=this.props).onError)||void 0===o||o.call(r,e,t),this.props.suppressErrorReport||(e.component=!0,e.diagnosticInfo=(e.diagnosticInfo||"")+t.componentStack,Object(c.d)(e)),this.setState({error:e})},t.prototype.render=function(){var e=this.state.error,t=this.props,r=t.children,i=t.type,c=t.windowIcons;if(e){if(i==o.None)return null;if(i==o.Simple||!this.props.fullErrorComponent)return a.createElement("div",null,e);var s=this.props.fullErrorComponent;return a.createElement(s,Object(n.__assign)({error:e,windowIcons:c},this.props.fullErrorComponentProps))}return r},t=Object(n.__decorate)([i.observer],t)}(a.Component);r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}))},521:function(e,t,r){"use strict";var o=r(0),n=r(1),a=r(396),i=r(517),c=r(516),s=r(12),u=r(220),l=r(397),d=r(453),b=r(457),h=Object(u.c)((function(e,t,r){var o=Object(l.a)(e),n=Object(d.a)(e),a={root:{minWidth:"80px",height:"32px"},label:{fontWeight:s.FontWeights.semibold}};return Object(s.concatStyleSets)(o,a,r?Object(b.a)(e):Object(b.b)(e),n,t)}));r.d(t,"a",(function(){return p}));var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,r=void 0!==t&&t,c=e.styles,s=e.theme;return n.createElement(a.a,Object(o.__assign)({},this.props,{variantClassName:r?"ms-Button--primary":"ms-Button--default",styles:h(s,c,r),onRenderDescription:i.b}))},t=Object(o.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],t)}(n.Component)},5908:function(e,t,r){"use strict";r.r(t);var o=r(1766),n=r(2428),a=r(188),i=Object(a.select)({tableViews:function(){return o.a.tableViews}})(Object(a.action)("cleanSearchTableState")((function(e,t,r){var o=e.id;t&&t.addCheckmark("cleanSearchTable_s"),n.a.clear(e,null),r.tableViews.delete(o),t&&t.addCheckmark("cleanSearchTable_e")}))),c=r(0),s=r(1930),u=r(1791),l=r(300),d=r(208),b=r(1633),h=r(1970),p=r(7775),f=r(134),g=r(3883),m=r(1750),v=r(2061),S=r(1652),y=r(40);function O(e){switch(e.tableQuery.listViewType){case 0:return"MailConversations";case 1:return"MailItems";default:return null}}var j=r(6012),k=r(3068),C=function(e){var t=[],r=1,o=Object(S.o)(S.e.Mail);if(o.alteredQuery){var n={type:"Group",name:"QueryAlterationSuggestion",position:r,layoutType:"Vertical",resultsView:[{name:"Suggestion",position:1,type:"Entity",entityType:o.queryAlterationType,referenceId:o.suggestedSearchTermReferenceId,providerId:o.alterationProviderId,placementType:"Visible"}]};t.push(n),r++}if(o.isAnswerRendered){var a={type:"Entity",entityType:"AnswerBlock",position:r,placementType:"Visible",placeHolderId:o.answerPlaceholderId,referenceId:"00000000-0000-0000-0000-000000000000",providerId:"00000000-0000-0000-0000-000000000000"};t.push(a),r++}var i=[];return null==e||e.rowKeys.forEach((function(t){var r=Object(k.getInstrumentationContext)(t,e);i.push({type:"Entity",name:"Mail",referenceId:r.referenceKey,providerId:r.traceId,position:r.index+1,entityType:"Email",placementType:"Visible"})})),i.length>0&&t.push({type:"Group",name:"Message",position:r,layoutType:"Vertical",resultsView:i}),t},w=r(3),T=Object(w.action)("FIND_ITEM_SEARCH",(function(e,t,r,o,n){return{offset:e,tableView:t,actionSource:r,onLoadInitialRowsSucceeded:o,onInitialTableLoadComplete:n}})),I=Object(w.action)("SET_HIGHLIGHT_TERMS",(function(e){return{highlightTerms:e}})),x=Object(w.action)("SET_IS_ANSWER_RENDERED",(function(e){return{value:e}})),_=Object(w.action)("SET_TABLE_VIEW_ID",(function(e){return{tableViewId:e}})),B=Object(w.action)("SET_ANSWER_PLACEHOLDER_ID",(function(e){return{placeholderId:e}}));var E=Object(a.action)("onExecuteSearchCompleted")((function(e,t,r,o,n,a,i,s,l){return Object(c.__awaiter)(this,void 0,void 0,(function(){var b,h,g,y,O,j,k;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:switch(n){case"MailConversations":b=r.Conversations;break;case"MailItems":b=r.Items}if(b){for(h=0;h<b.length;h++)(g=b[h]).ReferenceKey=g.InstanceKey,g.InstanceKey=Object(d.a)();Object(u.c)(t,b,(w={pageNumber:e.pageNumber,resultsCount:b.length,rowsInTableCount:t.rowKeys.length},T=w.pageNumber,I=w.resultsCount,x=w.rowsInTableCount+I,7===T?x:I===Object(m.r)(T).resultRowCount?x+1:x),"AppendOnSearch",l,s)}return b?(Object(S.u)()&&(_(t.id),0===(y=C(t)).length&&b.length>0&&Object(f.r)("Search_Empty_ResultsView",[b.length],{isCore:!0}),y.length>0&&v.e.importAndExecute(m.a.Mail,null,null,s,l,"Vertical",y,e.pageNumber)),r.SearchTerms&&!t.highlightTerms&&Object(p.a)(t.tableQuery).shouldHighlight&&(t.highlightTerms=Object(S.n)(r)),t.currentLoadedIndex=t.rowKeys.length,0==e.pageNumber&&(t.tableQuery.lastIndexFetched=t.rowKeys.length-1),O=t.tableQuery.searchScope,j=O?O.kind:null,(k=Object(m.q)(e,r,j))?[4,R(k,t,null,null,n,a,s,i,o)]:[3,2]):[2];case 1:c.sent(),c.label=2;case 2:return[2]}var w,T,I,x}))}))})),R=Object(a.action)("performExecuteSearch")((function(e,t,r,o,n,a,i,s,u){return void 0===u&&(u=0),Object(c.__awaiter)(this,void 0,void 0,(function(){var d,p,O,j,k,C,w,T;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:switch(d=Object(h.i)(),p=t.tableQuery,O="ExecuteSearch",j=0==Object(h.h)()&&1==p.searchProvider?1:Object(h.h)()){case 0:O="SubstrateSearch";break;case 1:default:O="ExecuteSearch"}return k=Object(y.i)("sea-hybridSearchSupported")||1!==j?null:"DateTime",C=Object(S.I)(S.e.Mail)||"persona"===p.scenarioType||void 0!==p.viewFilter&&"All"!==p.viewFilter,w={},0!=j||"ArchiveMailbox"!=p.searchScope.kind?[3,2]:[4,H("https://outlook.office.com"==window.location.origin?"https://outlook.office365.com":"https://outlook.office.com")];case 1:T=c.sent(),w.Authorization="Bearer "+T,c.label=2;case 2:return[2,Object(m.m)(e,p.queryString,a,i,p.searchScope,d.searchNumber,n,o,s,O,m.a.Mail,u,p.includeAttachments,p.fromDate,p.toDate,null,null,k,C,Object(S.t)(S.e.Mail),w).then((function(c){var h;if(!c)return o&&o.endWithError("ServerError",Error("Unexpected client-side error")),void r(t,!1,"UnexpectedClientError",!1);var p=c[1];g.d.import().then((function(e){return e(p)}));var j=p.ClientHttpStatus,k=200==j&&null!=(null===(h=c[0])||void 0===h?void 0:h.SearchResults),C=0==e.pageNumber,w=f.j.importAndExecute(c[2]);if(w.then((function(e){setTimeout((function(){g.c.import().then((function(t){if(t(e,p,o),C){var r=p.ClientJSEndToEndTime+p.ClientJSRenderingTime;k&&v.m.importAndExecute(m.a.Mail,p.SearchQueryId,p.SearchTraceID,r)}}))}),0)})),Object(b.w)()&&t.tableQuery.searchNumber==d.searchNumber){var T;if(Object(S.u)()&&(w.then((function(e){var t=e?e.RpE:p.ClientNetworkTime;v.k.importAndExecute(m.a.Mail,p.SearchTraceID,t,p.ClientHttpStatus)})),Object(S.R)(p.SearchTraceID,S.e.Mail,!1)),C&&(T=new f.b("TnS_SearchClientTime")).addCustomData([k,n]),k){var I=c[0],x=I.querySuggestionData;if(x&&C){var _=x.flaggedTokens&&x.flaggedTokens.map((function(e){return{Length:e.Length,Offset:e.Offset||0,Suggestion:e.Suggestion}}));S.E.importAndExecute(x.alteredQuery,x.suggestedSearchTerm,x.suggestedSearchTermReferenceId,_,x.recourseQuery,S.e.Mail,x.queryAlterationType,p.SearchTraceID,p.SearchQueryId)}E(e,t,I.SearchResults,u,n,a,s,i,p.SearchTraceID)}if(C){if(!r)throw new Error("onInitialTableLoadComplete callback should always be set when page number is 0");o&&k&&o.addCustomData({resultCount:c[0].SearchResults.SearchResultsCount}),r(t,k,j.toString(),!1),function(e,t,r){t.ClientResponseProcessTime=e.addCheckmark("ProcessResponseTime"),r&&(t.ClientJSEndToEndTime=r.addCheckmark("ClientJSEndToEndTime")),requestAnimationFrame((function(){return Promise.resolve().then((function(){e.end(),r&&(t.ClientJSRenderingTime=r.getData(l.a.e2eTimeElapsed)-r.waterfallTimings.ClientJSEndToEndTime)}))}))}(T,p,o)}k||(o&&o.endWithError("ServerError",Error(c[1].SearchErrorContent)),"SubstrateSearch"===O&&Object(y.i)("sea-autoFallback")&&C&&(Object(S.U)("SearchErrorFallback",S.e.Mail,!0,[],1),Object(f.r)("SearchFallback",{TraceId:p.SearchTraceID,ResponseCode:j,BETarget:p.SearchBETarget})))}}))]}}))}))}));function M(e,t,r,o,n,a,i){s.b();var c=O(e);return c?R(Object(m.r)(0),e,t,r,c,o,n,i,a):Promise.resolve()}function D(e,t,r,o,n){return void 0===n&&(n=0),Object(c.__awaiter)(this,void 0,void 0,(function(){var a;return Object(c.__generator)(this,(function(i){return a=Object(S.o)(S.e.Mail),Object(S.j)(S.e.Mail),[2,M(e,t,r,a.searchSessionGuid,a.currentSearchQueryId,n,o)]}))}))}function A(e,t,r,o,n){return void 0===n&&(n=0),Object(c.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(c.__generator)(this,(function(c){return a=Object(h.i)(),i=e.tableQuery,a.searchNumber++,i.searchNumber=a.searchNumber,a.staticSearchScope=i.searchScope,[2,M(e,t,r,Object(d.a)(),Object(d.a)(),n,o)]}))}))}function H(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){switch(t.label){case 0:return[4,j.a.importAndExecute(e)];case 1:return[2,t.sent()]}}))}))}var P=r(957),F=r(25),N=r(1653),L=r(1686),V=r(1844);function Q(){return Object(V.s)()?5:3}var W=Object(a.select)({folderForestStore:function(){return L.a}})(Object(a.action)("loadSearchTable")((function(e,t,r,o,n,a){return Object(c.__awaiter)(this,void 0,void 0,(function(){var i,s,u,l,d,b,p;return Object(c.__generator)(this,(function(f){if(1!=e.tableQuery.type)throw new Error("loadSearchTable should only be called for search table types");return i=a.folderForestStore.selectedNode,(s=Object(h.i)()).previousNode||(3==i.type?(u=Object(P.a)("inbox"),l=Object(N.isFolderInFavorites)(u)?"favorites":"primaryFolderTree",s.previousNode={id:u,treeType:l,type:0}):s.previousNode=Object(c.__assign)({},i)),d=e.tableQuery,b=d.scenarioType,p="persona"===b||"category"===b||"privateDistributionList"===b,3==i.type||p||(a.folderForestStore.selectedNode.id=null),"messageSuggestion"===b?(t(e,!0,"",!0),[2,Promise.resolve()]):"SharedFolders"===d.searchScope.kind||"ArchiveMailbox"===d.searchScope.kind&&Object(F.a)().SessionSettings.IsExplicitLogon||"PublicFolder"===d.searchScope.kind?(T(0,e,o,r,t),[2,Promise.resolve()]):p?[2,A(e,t,n,o,Q())]:[2,D(e,t,n,o,Q())]}))}))}))),q=Object(w.action)("LOAD_MORE_FIND_ITEM_SEARCH",(function(e,t,r,o,n){return{offset:e,tableView:t,actionSource:r,onLoadMoreRowsSucceeded:o,onLoadMoreRowsFailed:n}})),G=Object(w.action)("loadMoreSubstrateSearch",(function(e,t,r,o,n){return{offset:e,tableView:t,actionSource:r,onLoadMoreRowsSucceeded:o,onLoadMoreRowsFailed:n}})),z=r(1058),K=r(1057),J=r(197),U=r(790);var $=r(559);function X(e,t,r,o,n,a,i,s,u){var l=function(e,t,r,o,n,a,i,s){return Object(z.a)({ParentFolderIds:[Object($.a)({Id:e})],ItemShape:Object(U.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:i,Paging:r,FocusedViewFilter:a,ViewFilter:o,SortOrder:n,IsWarmUpSearch:!1,QueryString:(u=t,Object(c.__assign)({__type:"QueryStringType:#Exchange"},u)),RefinerRestriction:s,SearchFolderIdentity:Object(d.a)()});var u}(e,t,r,o,n,a,s,u);return Object(K.a)({Header:Object(J.b)(),Body:l},i).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var Y=r(34),Z=r(1716),ee=r(1753),te=r(785),re=r(2001),oe=r(347),ne=50;function ae(e,t){var r=e.tableQuery,o=e.tableQuery,n={Value:o.queryString,MaxResultsCount:ne,ResetCache:!0,ReturnDeletedItems:!0,ReturnHighlightTerms:!0,WaitForSearchComplete:!0},a=Object(ee.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:ne}),i=Object(Z.d)(r),c=Object(oe.a)(i),s=[];return s.push(Object(re.a)({Order:"Descending",Path:Object(te.a)({FieldURI:"DateTimeReceived"})})),{queryStringData:n,paging:a,requestInit:c,sortByResults:s,folderId:o.searchScope.folderId,refinerRestriction:Object(m.t)(o.fromDate,o.toDate,null,null)}}Object(w.orchestrator)(T,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,r,o,n,a,i,s,u,l,d,f,g,m,v;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:t=e.tableView,r=e.onInitialTableLoadComplete,o=e.onLoadInitialRowsSucceeded,n=e.offset,a=ae(t,n),i=a.queryStringData,s=a.paging,u=a.requestInit,l=a.sortByResults,d=a.folderId,f=a.refinerRestriction,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,X(d,i,s,"All",l,-1,u,"Shallow",f)];case 2:return g=c.sent(),[3,4];case 3:return m=c.sent(),Y.d("Find item search call failed "+m),[2,Promise.resolve(null)];case 4:return g&&(Object(b.w)()&&t.tableQuery.searchNumber===h.q.searchNumber)?((v="Success"===g.ResponseClass)&&(o(t,g.RootFolder.Items,g.RootFolder.TotalItemsInView,g.SearchFolderId,null),g.HighlightTerms&&!t.highlightTerms&&Object(p.a)(t.tableQuery).shouldHighlight&&I(g.HighlightTerms.map((function(e){return e.Value})))),r(t,v,g.ResponseCode,!1),[2]):[2]}}))}))})),Object(w.orchestrator)(q,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,r,o,n,a,i,s,l,d,p,f,g,m;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:t=e.tableView,r=e.onLoadMoreRowsSucceeded,o=e.onLoadMoreRowsFailed,n=e.offset,a=ae(t,n),i=a.queryStringData,s=a.paging,l=a.requestInit,d=a.sortByResults,p=a.folderId,f=a.refinerRestriction,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,X(p,i,s,"All",d,-1,l,"Shallow",f)];case 2:return g=c.sent(),[3,4];case 3:return m=c.sent(),Y.d("Load more Find item search call failed "+m),[2,Promise.resolve(null)];case 4:return g&&(Object(b.w)()&&t.tableQuery.searchNumber===h.q.searchNumber)?("Success"===g.ResponseClass?r(t,g.RootFolder.Items,g.RootFolder.TotalItemsInView,u.b):o(t,g.ResponseCode),[2]):[2]}}))}))})),Object(w.orchestrator)(G,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,r,o,n,a,i,s;return Object(c.__generator)(this,(function(c){return t=e.offset,r=e.tableView,o=e.actionSource,n=Object(S.o)(S.e.Mail),a=n.searchSessionGuid,i=n.currentSearchQueryId,(s=Object(m.s)(t))?(R(s,r,null,null,O(r),a,i,o,3),[2]):[2]}))}))})),Object(w.orchestrator)(h.r,(function(e){var t,r,o,n,a;x(!0),t=Object(S.o)(S.e.Mail),r=t.currentSearchQueryId,o=t.tableViewId,n=b.X.tableViews.get(o),a=C(n),v.e.importAndExecute(m.a.Mail,null,null,r,r,"Vertical",a),Object(f.r)("Search_Answers_AnswerRendered")}));Object(w.mutator)(I,(function(e){var t=Object(b.G)();t&&(t.highlightTerms=e.highlightTerms)})),Object(w.mutator)(x,(function(e){Object(S.o)(S.e.Mail).isAnswerRendered=e.value})),Object(w.mutator)(B,(function(e){Object(S.o)(S.e.Mail).answerPlaceholderId=e.placeholderId})),Object(w.mutator)(_,(function(e){Object(S.o)(S.e.Mail).tableViewId=e.tableViewId})),r.d(t,"cleanSearchTableState",(function(){return i})),r.d(t,"executeSearch",(function(){return D})),r.d(t,"loadSearchTable",(function(){return W})),r.d(t,"loadMoreFindItemSearch",(function(){return q})),r.d(t,"loadMoreSubstrateSearch",(function(){return G}))},6012:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var o=r(44),n=new o.c((function(){return r.e(943).then(r.bind(null,8114))})),a=new o.a(n,(function(e){return e.getAccessTokenforResource}))},703:function(e,t,r){"use strict";var o=r(0),n=r(1),a=r(396),i=r(517),c=r(516),s=r(12),u=r(220),l=r(397),d=r(453),b=Object(u.c)((function(e,t){var r,o=Object(l.a)(e),n=Object(d.a)(e),a=e.palette,i={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:e.semanticColors.link},rootHovered:{color:a.themeDarkAlt,backgroundColor:a.neutralLighter,selectors:(r={},r[s.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},r)},rootHasMenu:{width:"auto"},rootPressed:{color:a.themeDark,backgroundColor:a.neutralLight},rootExpanded:{color:a.themeDark,backgroundColor:a.neutralLight},rootChecked:{color:a.themeDark,backgroundColor:a.neutralLight},rootCheckedHovered:{color:a.themeDark,backgroundColor:a.neutralQuaternaryAlt},rootDisabled:{color:a.neutralTertiaryAlt}};return Object(s.concatStyleSets)(o,i,n,t)}));r.d(t,"a",(function(){return h}));var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,r=e.theme;return n.createElement(a.a,Object(o.__assign)({},this.props,{variantClassName:"ms-Button--icon",styles:b(r,t),onRenderText:i.b,onRenderDescription:i.b}))},t=Object(o.__decorate)([Object(c.a)("IconButton",["theme","styles"],!0)],t)}(n.Component)},7775:function(e,t,r){"use strict";var o=r(105);function n(e){switch(e.type){case 1:return function(e){switch(e.scenarioType){case"mail":case"messageSuggestion":return{shouldHighlight:!0,headerGeneratorType:"RelevanceHybrid"};case"persona":case"privateDistributionList":case"category":return{shouldHighlight:!1,headerGeneratorType:"DateTime"};default:return Object(o.a)(e.scenarioType)}}(e);case 0:case 2:return function(e){var t;switch(0==e.type&&e.sortBy.sortColumn){case 3:t="Sender";break;case 7:t="Size";break;case 5:t="Importance";break;case 8:t="Subject";break;case 1:default:t="DateTime"}return{shouldHighlight:!0,headerGeneratorType:t}}(e);default:return Object(o.a)(e.type)}}r.d(t,"a",(function(){return n}))}}]);
//# sourceMappingURL=owa.MailBoot~SearchActions.js.map
self.scriptsLoaded['owa.MailBoot~SearchActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SearchActions.js'] = (new Date()).getTime();