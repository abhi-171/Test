self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SearchService.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[732],{1644:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"j",(function(){return u})),n.d(e,"a",(function(){return o})),n.d(e,"g",(function(){return c})),n.d(e,"b",(function(){return a})),n.d(e,"h",(function(){return s})),n.d(e,"l",(function(){return f})),n.d(e,"k",(function(){return d})),n.d(e,"i",(function(){return l})),n.d(e,"c",(function(){return b})),n.d(e,"e",(function(){return v}));var r=["journal","outbox","syncissues"],i="archivemsgfolderroot",u="msgfolderroot",o="archivedeleteditems",c="deleteditems",a="archiverecoverableitemsdeletions",s="recoverableitemsdeletions",f="msgfolderroot",d="sharedFolderTree",l="primaryFolderTree",b="archiveFolderTree",v="favorites"},1673:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(48);function i(t){if(!t)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(t)||"none"}},1737:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return o}));var r=n(25),i=n(85);function u(t){return!!(t&Object(r.a)().ViewStateConfiguration.ListViewBitFlags)}function o(t,e){u(e)!==t&&Object(i.y)((function(n){t?n.ViewStateConfiguration.ListViewBitFlags|=e:n.ViewStateConfiguration.ListViewBitFlags&=~e}))}},178:function(t,e,n){"use strict";n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"f",(function(){return f}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(3),n.e(23),n.e(877)]).then(n.bind(null,1247))})),u=new r.a(i,(function(t){return t.makePostRequest})).importAndExecute,o=new r.a(i,(function(t){return t.makePatchRequest})).importAndExecute,c=new r.a(i,(function(t){return t.makePutRequest})).importAndExecute,a=new r.a(i,(function(t){return t.makeGetRequest})).importAndExecute,s=new r.a(i,(function(t){return t.makeDeleteRequest})).importAndExecute,f=new r.a(i,(function(t){return t.sendOwsPrimeRequest})).importAndExecute},189:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(24);function i(){var t=Object(r.a)(),e=t.origin;return e||(e=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),e}},1910:function(t,e,n){"use strict";n.d(e,"b",(function(){return o}));var r=n(3),i=n(16),u=Object(r.createStore)("folderStore",{folderTable:new i.ObservableMap,mailboxFolderTreeData:new i.ObservableMap}),o=u();e.a=u},195:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,i=!1;function u(e){r--,delete t[e]}this.put=function(e,n,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=t[e];c?clearTimeout(c.timeout):r++;var a={value:n,expire:i+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){u(e),o&&o(e,n)}.bind(this),i)),t[e]=a,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&u(e),n},this.clear=function(){for(var u in t)clearTimeout(t[u].timeout);r=0,t=Object.create(null),i&&(e=0,n=0)},this.get=function(u){var o=t[u];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&e++,o.value;i&&n++,r--,delete t[u]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){i=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),i=Date.now(),u=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(u)if(t[o])continue;var c=r[o],a=c.expire-i;if(a<=0){this.del(o);continue}a=a>0?a:void 0,this.put(o,c.value,a)}return this.size()}}t.exports=new r,t.exports.Cache=r},1998:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2246);function i(t,e){var n=Object(r.a)(e),i=n&&n.get(t);return null==i?void 0:i.rootFolder}},2147:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1910);function i(){return Object(r.a)().folderTable}},2183:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(296),i=n(40);function u(){var t=Object(r.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(i.i)("notes-folder-view")&&t.push("notes"),t}},2246:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return o}));var r=n(1910),i=n(85);function u(t){return o(t).folderTreeTable}function o(t){return t||(t=Object(i.b)()),Object(r.a)().mailboxFolderTreeData.get(t)}},2435:function(t,e,n){"use strict";n.d(e,"b",(function(){return o}));var r=n(9),i=n(2183);n.d(e,"a",(function(){return i.a}));var u=new r.b((function(){return Promise.all([n.e(9),n.e(12),n.e(16),n.e(18),n.e(19),n.e(677)]).then(n.bind(null,3889))})),o=new r.a(u,(function(t){return t.bootstrapFolderHierarchyCache}))},2529:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1998),i=n(1644);function u(t){return Object(r.a)(i.j,t)}},2530:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1998),i=n(1644);function u(t){return Object(r.a)(i.d,t)}},2531:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1998);function i(t){return Object(r.a)(t)}},2723:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return l})),n.d(e,"d",(function(){return b})),n.d(e,"c",(function(){return v}));var r=n(957),i=n(1673),u=n(1910),o=n(2529),c=n(2147),a=n(2530),s=n(2531),f=n(2435);function d(t){var e=Object(c.a)(),n=Object(r.a)(t);return n?e.get(n):void 0}function l(t,e){if("SharedMailbox"===t&&!e)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var n,r=[];switch(t){case"ArchiveMailbox":n=Object(a.a)();break;case"SharedMailbox":n=Object(s.a)(e);break;default:n=Object(o.a)()}var c=Object(f.a)();"UserMailbox"==t&&n.DistinguishedFolderId==Object(o.a)().DistinguishedFolderId&&n.FolderId&&c.forEach((function(t){var e=d(t);(null==e?void 0:e.ParentFolderId.Id)===n.FolderId.Id&&r.push(e.FolderId.Id)}));for(var l=function(t){var e=[];(null==t?void 0:t.childFolderIds)&&t.childFolderIds.map((function(t){var n=u.b.folderTable.get(t);e.push(n.FolderId.Id)}));return e}(n),b=0;b<l.length;b++)-1==c.indexOf(Object(i.a)(l[b]))&&r.push(l[b]);return r}function b(t,e){var n=Object(c.a)().get(t);return(null==n?void 0:n.mailboxInfo.type)===e}function v(t,e){var n=e.folderTable.get(t);return n?n.mailboxInfo.type:null}},342:function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return o}));var r,i=n(0);function u(t){r=t}function o(){var t,e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(u=r)?[4,r()]:[3,2];case 1:u=i.sent(),i.label=2;case 2:if((n=u)&&n.length>0){if("bearer"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},407:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(65);function i(t){return Object(r.a)(t,[r.c])}},424:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();n.d(e,"a",(function(){return r}))},495:function(t,e,n){"use strict";var r=n(407),i=n(21),u=n(65);function o(t){return Object(u.a)(t,[u.b])}var c=n(17),a=n(50);function s(t){return Object(c.b)(Object(c.c)(Object(c.a)(Object(a.a)()||"",t)))}var f,d,l,b=n(503),v=n(615),h=n(141);function p(){return f||(f=Object(i.a)("/calendar")+"/"),f}function O(){return d||(d=Object(i.a)("/mail")+"/"),d}function m(){return l||(l=Object(i.a)("/files")+"/"),l}var j,g,y,w=n(710);function k(t){return j&&g===t||(g=t,j=t?Object(i.a)("/people/group/owner")+"/":Object(i.a)("/people/group/member")+"/"),j}function T(){return y||(y=Object(i.a)("/people/group/deleted")+"/"),y}function x(t){return window.location.origin+p()+"showPeek/item/"+encodeURIComponent(t)}var I=n(326),S=n(573),R=n(4),E=n(527),F=Object(S.a)().split("/").slice(1).join("/")+"deeplink/";function _(t,e,n,r){n&&((r=r||{}).minus="");var i="";if(r){var u=Object(R.b)();Object(E.a)(u),Object.keys(r).filter((function(t){return t})).forEach((function(t){return u[t]=r[t]})),i="?"+Object(R.i)(u)}var o={pathname:"/"+t+"/"+F+e,search:i};return I.format(o)}var C,N,P=n(144),A=n(0),L=n(25),D="https://to-do.microsoft.com";function M(t,e){var n,r,i,u=Object(L.a)(),o=u.UserOptions,c=null===(r=u.SessionSettings)||void 0===r?void 0:r.UserPrincipalName,a=D,s={};if(null===(i=null==o?void 0:o.ReactOptinSettings)||void 0===i?void 0:i.TasksRedirectUrl){var f;a=(n=Object(A.__read)(o.ReactOptinSettings.TasksRedirectUrl.split("?"),2))[0],f=n[1],s=Object(R.g)(f),c&&(s.auth_upn=c)}return t&&(s.utm_source=t),e&&delete s.fromOwa,Object.keys(s).length>0?Object(h.a)(a,s):a}function V(){return C||(C=Object(i.a)("/spaces")+"/"),C}function q(){return N||(N=Object(i.a)("/eventify")+"/"),N}var U=n(189);n.d(e,"i",(function(){return r.a})),n.d(e,"s",(function(){return i.a})),n.d(e,"e",(function(){return o})),n.d(e,"k",(function(){return s})),n.d(e,"r",(function(){return b.a})),n.d(e,"w",(function(){return c.a})),n.d(e,"a",(function(){return c.b})),n.d(e,"n",(function(){return v.a})),n.d(e,"u",(function(){return h.a})),n.d(e,"c",(function(){return p})),n.d(e,"j",(function(){return O})),n.d(e,"f",(function(){return m})),n.d(e,"o",(function(){return w.a})),n.d(e,"h",(function(){return k})),n.d(e,"g",(function(){return T})),n.d(e,"b",(function(){return x})),n.d(e,"p",(function(){return _})),n.d(e,"v",(function(){return P.a})),n.d(e,"t",(function(){return M})),n.d(e,"m",(function(){return V})),n.d(e,"d",(function(){return q})),n.d(e,"l",(function(){return U.a})),n.d(e,"q",(function(){return a.a}))},503:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(4),i=n(527);function u(){var t=Object(r.b)();Object(i.a)(t);var e=Object(r.i)(t);return e.length>0?"?"+e:""}},527:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId"];function i(t){t&&Object.keys(t).forEach((function(e){r.includes(e)&&delete t[e]}))}},559:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"FolderId:#Exchange"},t)}},573:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(50),i=n(21);function u(t){return(Object(i.a)("/"+(t||Object(r.a)()))+"/").replace(/^\//,"")}},576:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},615:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(24),i=n(21),u=n(189);function o(t){var e=Object(r.a)(),n=Object(u.a)()+Object(i.a)("/owa")+"/",o=e.search&&e.search.length>0;n+=o?e.search:"?";for(var c=Object.keys(t),a=o,s=0;s<c.length;s++)a?n+="&":a=!0,n+=c[s]+"="+t[c[s]];return n}},6989:function(t,e,n){"use strict";n.r(e);var r=n(7352),i={},u=[];function o(t,e,n,u){var o={Name:"clientdatasource",Attributes:[]},c={Results:[]};n.forEach((function(t){c.Results.push({ReferenceId:t.localContentId,EntityId:t.entityId,Type:t.contentType})})),o.Attributes.push({Key:e,Value:btoa(JSON.stringify(c))}),Object(r.a)(t,o,u),function(t){t.forEach((function(t){i[t.entityId]=t.localContentId}))}(n)}function c(t,e,n){if(-1==u.indexOf(t)){u.push(t);var i={Name:"clientlayout",Attributes:[]};Object.keys(e).forEach((function(t){var n={Results:[]};e[t].forEach((function(t){var e=s(t.entityId);n.Results.push({ReferenceId:e,Position:t.position})})),i.Attributes.push({Key:t,Value:btoa(JSON.stringify(n))})})),Object(r.a)(t,i,n)}}function a(){i={},u=[]}function s(t){return i[t]}var f=n(0),d=n(4406),l=n(178),b=n(2348),v=n(375),h=n(495);function p(t,e,n,r){return Object(f.__awaiter)(this,void 0,void 0,(function(){var i,u,o,c,a,s;return Object(f.__generator)(this,(function(p){switch(p.label){case 0:return i={cvid:t,scenario:e},u=Object(b.a)(i),o={},n&&(o["X-Client-Flights"]=n),2!=r?[3,3]:(c=Object(f.__read)(Object(v.getAccessTokenforResourceAsLazy)("https://outlook.office.com/search"),2),a=c[0],s=c[1],a?[3,2]:[4,s]);case 1:a=p.sent(),p.label=2;case 2:o.authorization="Bearer "+a,p.label=3;case 3:return[2,Object(l.b)(Object(h.u)(Object(d.a)("init",r),u),void 0,void 0,o,void 0,!1)]}}))}))}var O=n(1750),m=n(34);function j(t,e,n,r,i,u,o){var c={Cvid:e,EntityRequests:[{EntityType:n,Filter:void 0,From:void 0,PropertySet:void 0,Provenances:void 0,Query:{QueryString:t},RefiningQueries:void 0,Size:r,Sort:void 0}],Scenario:{Name:i},TextDecorations:void 0,TimeZone:void 0,LogicalId:o};return Object(l.d)(Object(h.u)(Object(O.w)("suggestions"),Object(b.a)()),c,void 0,!0,u,void 0,void 0,!1).then((function(t){return Promise.resolve(t)})).catch((function(t){return m.g.warn(t),Promise.reject(t)}))}function g(){w("Delete")}function y(){return w("Export")}var w=function(t){return Object(l.d)(""+Object(d.a)("searchHistory"),{Action:t,Scenario:{Name:"owa.react"}})};n.d(e,"logLocalContentDataSource",(function(){return o})),n.d(e,"logLocalContentLayout",(function(){return c})),n.d(e,"clearLocalContentInstrumentationCache",(function(){return a})),n.d(e,"getLocalContentId",(function(){return s})),n.d(e,"substrateSearchInitOperation",(function(){return p})),n.d(e,"substrateSearchPostSuggestionsService",(function(){return j})),n.d(e,"deleteSubstrateSearchHistoryService",(function(){return g})),n.d(e,"exportSubstrateSearchHistoryService",(function(){return y}))},710:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r,i=n(21);function u(){return r||(r=Object(i.a)("/people")+"/"),r}},712:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"DistinguishedFolderId:#Exchange"},t)}},7352:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(4406),i=n(2),u=n(178),o=n(2348),c=n(495),a=null;function s(t,e,n){var s=e.Attributes.filter((function(t){return null!=t.Value}));e.Attributes=s,e.Attributes.forEach((function(t){if(t.Value&&"string"!=typeof t.Value)throw new Error("All values in substrate search event attributes must be strings or null/undefines")})),null===a&&(a={},setTimeout(function(t){return function(){var e=Object.keys(a).reduce((function(t,e){return t.push({Key:e,Value:a[e]}),t}),[]);a=null;var n={scenario:t},s=Object(o.a)(n);Object(u.d)(Object(c.u)(Object(r.a)("events"),s),e,void 0,void 0,{"Client-Session-Id":Object(i.E)()},void 0,void 0,!1)}}(n),5e3)),a[t]=(a[t]||[]).concat(e)}},785:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"PropertyUri:#Exchange"},t)}},957:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(48);function i(t){if(!t)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(t)}}}]);
//# sourceMappingURL=owa.MailBoot~SearchService.js.map
self.scriptsLoaded['owa.MailBoot~SearchService.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SearchService.js'] = (new Date()).getTime();