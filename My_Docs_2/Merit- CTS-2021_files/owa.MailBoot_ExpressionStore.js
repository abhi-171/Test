self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ExpressionStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[553],{219:function(e,n,t){"use strict";var o,a,i,r=t(3),s=Object(r.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),c=Object(r.action)("assignOptionValue",(function(e,n){return{feature:e,value:n}})),l=Object(r.action)("verifyAndSetOptionValues",(function(e){return{potentialOptionValues:e}})),d=Object(r.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),u=t(0);!function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper",e[e.CalendarHelp=21]="CalendarHelp",e[e.LinkedInViewProfile=22]="LinkedInViewProfile",e[e.Bohemia=23]="Bohemia",e[e.GdprAdsV2=24]="GdprAdsV2",e[e.Proofing=25]="Proofing",e[e.ActiveProxyAddress=26]="ActiveProxyAddress",e[e.OutlookSpaces=27]="OutlookSpaces",e[e.GdprAdsV3=28]="GdprAdsV3",e[e.SxS=29]="SxS"}(o||(o={})),function(e){e[e.EditInBrowser=0]="EditInBrowser",e[e.EditInDesktop=1]="EditInDesktop",e[e.EditAndReply=2]="EditAndReply"}(a||(a={}));var f=Object(r.createStore)("owsOptionsStore",{options:(i={},i[o.SmartSuggestions]={feature:o.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},i[o.DiverseEmojis]={feature:o.DiverseEmojis,diverseEmojisSelectedSkinTone:""},i[o.SurfaceActions]={feature:o.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},i[o.SkypeNotifications]={feature:o.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},i[o.WebPushNotifications]={feature:o.WebPushNotifications,enabled:!1,applicationServerKey:null},i[o.Confetti]={feature:o.Confetti,confettiEnabled:!1},i[o.GdprAdsPrefs]={feature:o.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},i[o.GdprAdsV2]={feature:o.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},i[o.GdprAdsV3]={feature:o.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},i[o.CalendarSurfaceAddins]={feature:o.CalendarSurfaceAddins,calendarSurfaceAddins:[]},i[o.ExternalImages]={feature:o.ExternalImages,externalImagesSelectedOption:null},i[o.EventCapture]={autoCollectionEnabled:!1},i[o.Translation]={feature:o.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},i[o.CalendarSurfaceOptions]={feature:o.CalendarSurfaceOptions,agendaPaneIsClosed:!0,lastKnownRoamingTimeZone:void 0,roamingTimeZoneNotificationsIsDisabled:void 0,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},i[o.MentionEventNotifications]={feature:o.MentionEventNotifications,enabled:!1},i[o.TxpEventNotifications]={feature:o.TxpEventNotifications,enabled:!1},i[o.ComposeAssistance]={feature:o.ComposeAssistance,composeAssistanceEnabled:!1},i[o.AmpDeveloper]={feature:o.AmpDeveloper,enabled:!0,allowedSender:[]},i[o.ActivityFeed]={feature:o.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},i[o.LinkedInViewProfile]={dismissed:!1},i[o.CalendarHelp]={feature:o.CalendarHelp,calendarHelpEnabled:!1},i[o.Bohemia]={feature:o.Bohemia,bohemiaEnabled:!1,fluidEnabledForTenant:!1},i[o.Proofing]={feature:o.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!1,proofingLocale:void 0,overriddenOptions:void 0},i[o.ActiveProxyAddress]={feature:o.ActiveProxyAddress,activeProxyAddresses:[]},i[o.OutlookSpaces]={feature:o.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},i[o.SxS]={feature:o.SxS,hideReadingPane:!1,defaultEditCommand:a.EditInBrowser},i)}),p=t(16);function S(e){return(null==e?void 0:e.feature)in o}var A,b=t(321);function v(e,n){f().options[e]=n}function g(e){return f().options[e]}Object(r.mutator)(c,(function(e){var n=e.feature,t=e.value;b(f().options[n],t)})),Object(r.mutator)(s,(function(e){v(e.feature,e.value)})),Object(r.mutator)(d,(function(e){var n=e.feature,t=e.value;Object(p.extendObservable)(f().options[n],t)})),Object(r.mutator)(l,(function(e){var n,t,o=e.potentialOptionValues;try{for(var a=Object(u.__values)(o),i=a.next();!i.done;i=a.next()){var r=i.value;r&&S(r)&&v(r.feature,r)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(t=a.return)&&t.call(a)}finally{if(n)throw n.error}}})),function(e){e[e.Work=1]="Work",e[e.Life=2]="Life"}(A||(A={})),t.d(n,"h",(function(){return s})),t.d(n,"d",(function(){return c})),t.d(n,"i",(function(){return l})),t.d(n,"g",(function(){return d})),t.d(n,"f",(function(){return f})),t.d(n,"e",(function(){return g})),t.d(n,"c",(function(){return A})),t.d(n,"b",(function(){return o})),t.d(n,"a",(function(){return a}))},2552:function(e,n,t){"use strict";var o=t(16),a=t(3),i=t(876),r={expressionPickerViewStates:new o.ObservableMap,selectedSkinTone:Object(i.e)(i.b.DiverseEmojis).diverseEmojisSelectedSkinTone,useFlexPane:null,isSxSDisplayed:null,primaryExpressionId:null},s=Object(a.createStore)("expression",r)();n.a=s},3428:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return r}));var o=t(44),a=new o.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(8),t.e(567)]).then(t.bind(null,5929))})),i=new o.a(a,(function(e){return e.mountAndShowFlexPane})),r=new o.a(a,(function(e){return e.hideFlexPane}))},4020:function(e,n,t){"use strict";var o=t(3);n.a=Object(o.action)("toggleExpressionSidePane",(function(e){return{showExpressionPane:e}}))},4858:function(e,n,t){"use strict";var o=t(3);n.a=Object(o.mutatorAction)("updateExpressionPage",(function(e,n){if(e.page.toString()!=n)switch(n){case"0":e.page=0;break;case"1":e.page=1;break;case"2":e.page=2}}))},5237:function(e,n,t){"use strict";var o=t(188);n.a=Object(o.action)("setExpressionPickerIsOpen")((function(e,n){e.isOpen=n}))},5693:function(e,n,t){"use strict";var o=t(188);n.a=Object(o.action)("setEmojiCategoryIndex")((function(e,n){e.emojiCategoryIndex=n}))},6396:function(e,n,t){"use strict";t.r(n);var o=t(7737);t.d(n,"closeExpressionPane",(function(){return o.a}))},6397:function(e,n,t){"use strict";var o=t(3);n.a=Object(o.mutatorAction)("setExpressionPickerOpenedSource",(function(e,n){e.source=n}))},6398:function(e,n,t){"use strict";var o=t(3);n.a=Object(o.mutatorAction)("setShouldRestoreSelectionAfterInsertNode",(function(e,n){e.shouldRestoreSelectionAfterInsertNode=n}))},6399:function(e,n,t){"use strict";var o=t(3);n.a=Object(o.mutatorAction)("setWordToReplace",(function(e,n){e.wordToReplace=n}))},6401:function(e,n,t){"use strict";var o=t(0),a=t(3543),i=t(6992),r=t(6402),s=t(188);n.a=Object(s.action)("updateSearch")((function(e,n,t,s){return Object(o.__awaiter)(this,void 0,void 0,(function(){var c;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return n===e.searchTerm?[2]:(e.isSearching=!0,e.searchTerm=n,n?e.gifPickerViewState?(c=e.gifPickerViewState,[4,Object(r.a)(e.gifPickerViewState,n,t,s)]):[3,2]:[3,3]);case 1:c.gifResults=o.sent(),o.label=2;case 2:return e.emojiPickerViewState.emojiResults=Object(i.a)(n),2!==e.page&&e.numSearchesToInsertEmoji++,[3,4];case 3:e.gifPickerViewState&&(e.gifPickerViewState.gifResults=null),e.emojiPickerViewState.emojiResults=Object(a.a)(),o.label=4;case 4:return e.isSearching=!1,[2]}}))}))}))},7737:function(e,n,t){"use strict";var o=t(5693),a=t(5237),i=t(6397),r=t(6398),s=t(6399),c=t(4858),l=t(6400),d=t(2552),u=t(188),f=t(876),p=t(134),S=Object(u.action)("saveEmojiSkinToneToServer")((function(e){var n=Object(f.e)(f.b.DiverseEmojis);if(n.diverseEmojisSelectedSkinTone!=d.a.selectedSkinTone){n.diverseEmojisSelectedSkinTone=d.a.selectedSkinTone;var t=f.f.importAndExecute(f.b.DiverseEmojis,n);if(e){var o="ExpressionPicker_EmojiSkinToneSavedToServer";t.then((function(){Object(p.r)(o,[!0])})).catch((function(e){Object(p.r)(o,[!1,d.a.selectedSkinTone,A(e.toString())])}))}}}));function A(e){switch(e){case"Options are not loaded. Cannot update options.":return 0;case"Error: Error processing options response":return 1;default:return 2}}var b=t(6401),v=t(4501),g=t(76),m=t(3),P=Object(m.action)("resetExpressionPickerViewState",(function(e){return{viewState:e}}));Object(m.orchestrator)(P,(function(e){var n=e.viewState;Object(a.a)(n,!1),n.searchTerm&&Object(b.a)(n,"",null),Object(c.a)(n,Object(v.a)()?(0).toString():1..toString()),Object(s.a)(n,""),Object(l.a)(n),Object(o.a)(n,0),Object(i.a)(n,null),Object(r.a)(n,!1),Object(g.g)()||S(!0)}));var w=P,O=t(4020),E=t(3428),j=t(495);function C(e,n){var t=d.a.expressionPickerViewStates.get(e||d.a.primaryExpressionId);(null==t?void 0:t.isOpen)&&(Object(a.a)(t,!1),w(t),d.a.useFlexPane?Object(j.v)()||n&&n!==window?E.a.importAndExecute(n):window.O365Shell.FlexPane.CloseFlexPaneForProvider("Expressions"):Object(O.a)(!1))}t.d(n,"a",(function(){return C}))},788:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var o=t(296),a=t(219),i=t(40);function r(){var e;return(e={})[a.b.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[a.b.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[a.b.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(o.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddClassicAttachment","InsertLink","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[a.b.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[a.b.Confetti]={confettiEnabled:!0},e[a.b.ComposeAssistance]={composeAssistanceEnabled:!0},e[a.b.GdprAdsPrefs]={feature:a.b.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[a.b.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[a.b.ExternalImages]={externalImagesSelectedOption:0},e[a.b.EventCapture]={autoCollectionEnabled:!1},e[a.b.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[a.b.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[a.b.AmpDeveloper]={enabled:Object(i.i)("rp-ampDefault"),allowedSender:[]},e[a.b.CalendarHelp]={calendarHelpEnabled:!1},e[a.b.LinkedInViewProfile]={dismissed:!1},e[a.b.Bohemia]={bohemiaEnabled:Object(i.i)("cmp-prague")},e[a.b.GdprAdsV2]={feature:a.b.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[a.b.GdprAdsV3]={feature:a.b.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[a.b.Proofing]={feature:a.b.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[a.b.ActiveProxyAddress]={feature:a.b.ActiveProxyAddress,activeProxyAddresses:[]},e[a.b.OutlookSpaces]={feature:a.b.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[a.b.SxS]={feature:a.b.SxS,hideReadingPane:!1,defaultEditCommand:a.a.EditInBrowser},e}},876:function(e,n,t){"use strict";var o=t(44),a=t(985),i=t(219),r=t(3),s=[i.b.SurfaceActions];Object(r.orchestrator)(a.a,(function(e){var n=e.defaultOptions;s.forEach((function(e){n[e]&&Object(i.g)(Number(e),n[e])}))}));var c=t(788);t.d(n,"f",(function(){return d})),t.d(n,"i",(function(){return u})),t.d(n,"g",(function(){return f})),t.d(n,"h",(function(){return p})),t.d(n,"d",(function(){return c.a})),t.d(n,"e",(function(){return i.e})),t.d(n,"c",(function(){return i.c})),t.d(n,"b",(function(){return i.b})),t.d(n,"a",(function(){return i.a}));var l=new o.c((function(){return t.e(866).then(t.bind(null,17245))})),d=new o.a(l,(function(e){return e.createOrUpdateOptionsForFeature})),u=new o.a(l,(function(e){return e.updateAddinPinStatus})),f=(new o.a(l,(function(e){return e.updateAddInArray})),new o.b(l,(function(e){return e.getServerOptionsForFeature}))),p=new o.a(l,(function(e){return e.loadOptions}))},985:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var o=t(3),a=t(788),i=Object(o.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(a.a)()),{defaultOptions:e}}))}}]);
//# sourceMappingURL=owa.MailBoot~ExpressionStore.js.map
self.scriptsLoaded['owa.MailBoot~ExpressionStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ExpressionStore.js'] = (new Date()).getTime();