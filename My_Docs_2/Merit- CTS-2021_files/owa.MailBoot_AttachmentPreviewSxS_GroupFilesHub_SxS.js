self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxS~GroupFilesHub~SxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[146],{1641:function(e,n,t){"use strict";function r(e){if(!e)return null;var n=e.lastIndexOf(".");return n>0?e.substr(n).toLowerCase():null}function u(e){var n=r(e);return n?n.replace(".",""):null}function i(e){var n;return(null===(n=u(e))||void 0===n?void 0:n.substring(0,4))||""}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return i}))},1662:function(e,n,t){"use strict";var r=t(1641),u=t(1839),i=t(7);function o(e){var n;return e>=1073741824?(e/=1073741824,n=Object(i.b)(u.b)):e>=1048576?(e/=1048576,n=Object(i.b)(u.d)):e>=1024?(e/=1024,n=Object(i.b)(u.c)):n=Object(i.b)(u.a),Object(i.c)(n,Math.round(e))}var c,a=t(1709),s=t(40),d=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var n=Object(r.a)(e);return!!n&&d.indexOf(n.toLowerCase())>=0}function b(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return c.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return c.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return c.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(c||(c={}));var l=t(1676);t.d(n,"b",(function(){return r.a})),t.d(n,"c",(function(){return r.b})),t.d(n,"d",(function(){return r.c})),t.d(n,"i",(function(){return o})),t.d(n,"g",(function(){return a.a})),t.d(n,"h",(function(){return f})),t.d(n,"f",(function(){return b})),t.d(n,"e",(function(){return l.b})),t.d(n,"a",(function(){return c}))},1676:function(e,n,t){"use strict";function r(e){return n=e||"",(t=i.exec(n))&&t.length>1&&u[t[1].toLowerCase()];var n,t}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}));var u={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},i=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){var n="";return Object.entries(u).forEach((function(t){t[1]===e&&(n=t[0])})),n}},1709:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return s}));var r=t(1641),u=t(1676),i=t(76),o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function a(e,n,t){return void 0===t&&(t=!0),s(Object(r.a)(e)||Object(u.a)(n),t)}function s(e,n){return void 0===n&&(n=!0),!!e&&(o.indexOf(e.toLowerCase())>=0||n&&c.indexOf(e.toLowerCase())>=0&&(Object(i.e)()||Object(i.d)()||Object(i.h)()||Object(i.g)()&&!Object(i.l)()))}},1839:function(e){e.exports=JSON.parse('{"b":"Hca","d":"Ica","c":"Jca","a":"Kca"}')},1917:function(e,n,t){"use strict";t.d(n,"u",(function(){return d})),t.d(n,"g",(function(){return f})),t.d(n,"i",(function(){return b})),t.d(n,"j",(function(){return l})),t.d(n,"k",(function(){return v})),t.d(n,"l",(function(){return w})),t.d(n,"m",(function(){return p})),t.d(n,"n",(function(){return m})),t.d(n,"o",(function(){return O})),t.d(n,"p",(function(){return j})),t.d(n,"q",(function(){return h})),t.d(n,"r",(function(){return g})),t.d(n,"s",(function(){return I})),t.d(n,"t",(function(){return x})),t.d(n,"v",(function(){return P})),t.d(n,"h",(function(){return y}));var r=t(44),u=t(2633);t.d(n,"a",(function(){return u.a}));var i=t(2259);t.d(n,"b",(function(){return i.a})),t.d(n,"e",(function(){return i.d}));var o=t(2166);t.d(n,"f",(function(){return o.a}));var c=t(2187);t.d(n,"d",(function(){return c.a}));var a=t(2634);t.d(n,"c",(function(){return a.a}));var s=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(20),t.e(22),t.e(27),t.e(32),t.e(36),t.e(43),t.e(55),t.e(61),t.e(63),t.e(64),t.e(68),t.e(147),t.e(146),t.e(174),t.e(209),t.e(230),t.e(207),t.e(753)]).then(t.bind(null,5027))})),d=new r.b(s,(function(e){return e})),f=new r.b(s,(function(e){return e.resetPreviewPane})),b=(new r.b(s,(function(e){return e.setAudioPreviewState})),new r.b(s,(function(e){return e.setBlankPreviewState})),new r.b(s,(function(e){return e.setCustomPreviewState})),new r.b(s,(function(e){return e.setIframePreviewState}))),l=(new r.b(s,(function(e){return e.setImageGalleryItems})),new r.b(s,(function(e){return e.setImagePreviewLoaded}))),v=new r.b(s,(function(e){return e.setImagePreviewState})),w=new r.b(s,(function(e){return e.setImagePreviewStateFromImageGalleryItem})),p=(new r.b(s,(function(e){return e.setNativePdfPreviewState})),new r.b(s,(function(e){return e.setPanesSize}))),m=(new r.b(s,(function(e){return e.setPdfJsPreviewState})),new r.b(s,(function(e){return e.setPdfJsPreviewStateByData})),new r.b(s,(function(e){return e.setPreviewError}))),O=new r.b(s,(function(e){return e.setPreviewLoading})),j=new r.b(s,(function(e){return e.setRightPaneDisplayAndUpdateSize})),h=new r.b(s,(function(e){return e.setSaveStatusText})),g=new r.b(s,(function(e){return e.setTextPreviewState})),I=(new r.b(s,(function(e){return e.setVideoPreviewState})),new r.b(s,(function(e){return e.setWacPreviewState}))),x=new r.b(s,(function(e){return e.setWacReadOnly})),P=new r.b(s,(function(e){return e.updatePanesSize})),y=new r.b(s,(function(e){return e.saveHideReadingPaneOption}));new r.b(s,(function(e){return e.saveDefaultEditCommandOption}))},1976:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(214),u=t(346);function i(e){if("ArchiveMailbox"==e.type)return Object(r.a)();var n=e.userIdentity&&Object(u.r)(e.userIdentity),t="GroupMailbox"===e.type;return n&&!t?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},1981:function(e,n,t){"use strict";var r=t(346),u=t(0),i={};function o(e){return i[e]}function c(e,n){var t=i[e];i[e]=Object(u.__assign)(Object(u.__assign)({},t),n)}var a=t(85),s=t(28);var d=t(134),f=t(34),b=t(616),l=t(1656),v=t(1655);function w(e){return Object(u.__awaiter)(this,void 0,void 0,(function(){var n,t;return Object(u.__generator)(this,(function(r){switch(r.label){case 0:return(n={}).headers=new Headers,[4,Object(l.a)(e)];case 1:return t=r.sent(),Object(v.b)(n.headers,t),[2,n]}}))}))}var p=Object(b.b)({timeBetweenRetryInMS:function(){return 3e4}});function m(e,n){n=n<1?1:n,setInterval((function(){!function(e){Object(u.__awaiter)(this,void 0,void 0,(function(){var n,t,i,a,b,l,v=this;return Object(u.__generator)(this,(function(m){switch(m.label){case 0:if(n=function(){return Object(u.__awaiter)(v,void 0,void 0,(function(){var n,t;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),n={},Object(r.r)(e.userIdentity)?[4,w(e.userIdentity)]:[3,2];case 1:n=u.sent(),u.label=2;case 2:return[2,(i=n,Object(s.a)("GetAttachmentDownloadToken",{},i))];case 3:throw t=u.sent(),f.g.warn("Unable to get the download token "+t),t.networkError=!0,t;case 4:return[2]}var i}))}))},null==(t=o(e.userIdentity))?void 0:t.isRefreshingDownloadToken)return[3,4];c(e.userIdentity,{isRefreshingDownloadToken:!0}),i=0,a=p((function(){return Object(u.__awaiter)(v,void 0,void 0,(function(){var t;return Object(u.__generator)(this,(function(r){switch(r.label){case 0:return i++,[4,n()];case 1:return t=r.sent(),f.g.info("update new token"),c(e.userIdentity,{downloadToken:t,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,b=new d.c("AttachmentRefreshDownloadToken"),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,a()];case 2:return m.sent(),b.addCustomData([i]),b.end(),[3,4];case 3:return l=m.sent(),f.g.warn("Retry to refresh token failed: "+l),b.addCustomData([i]),b.endWithError("ServerError",l),c(e.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(e)}),6e4*n)}var O=t(105);function j(e){var n=Object(r.j)(null==e?void 0:e.userIdentity),t=o(null==e?void 0:e.userIdentity);if((null==t?void 0:t.downloadToken)&&(null==t?void 0:t.downloadUrlBase))return t;switch(n){case null:case"Outlook":!function(e){var n=Object(r.r)(e.userIdentity)?Object(a.i)(e.userIdentity):Object(a.h)(),t=null==n?void 0:n.ApplicationSettings;if(t){var u=t.DownloadUrlBase;c(e.userIdentity,{downloadUrlBase:u,downloadToken:t.FirstDownloadToken}),u&&m(e,t.DownloadTokenRefreshMinutes)}}(e);break;case"Google":case"ICloud":break;default:Object(O.a)(n)}var u=o(e.userIdentity);return u||(Object(d.r)("FilesUrlDataNotFound",{accountProviderType:n}),f.g.warn("Unable to get the url data")),u}function h(e){if(!e)return null;var n=j(e);return null==n?void 0:n.downloadToken}t.d(n,"b",(function(){return j})),t.d(n,"a",(function(){return h}))},2176:function(e,n,t){"use strict";var r=t(105),u=t(7),i=t(47),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",a="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",f="service.svc/s/GetAttachmentThumbnail?id={0}",b="pdfprint.aspx?id={0}",l="pdfprint.aspx?id={0}&location={1}",v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var w=t(296),p=t(62),m=t(2),O=t(21),j=t(1981),h=t(1976);function g(e,n,t,r,c){if(void 0===r&&(r=!1),void 0===c&&(c=null),!e||!e.Id||!e.mailboxInfo)return null;var a=Object(j.b)(e.mailboxInfo),s=null==a?void 0:a.downloadUrlBase,d=Object(h.a)(e.mailboxInfo);if(c=c||Object(u.c)(n,encodeURIComponent(e.Id)),!s||r&&"Firefox"===Object(p.a)().browser){var f=o+c+"&X-OWA-CANARY="+Object(i.a)();return Object(O.a)(f)}var b="{0}{1}/{2}";Object(w.a)()&&(b+="&isc=1");var l=Object(u.c)(b,s,d,c);return t&&(l+="&token="+(null==a?void 0:a.downloadToken),l+="&X-OWA-CANARY="+Object(i.a)()),Object(p.i)()||(l+="&owa="+window.location.hostname,l+="&scriptVer="+Object(m.p)()||!1),l}function I(e,n,t,c,s,f,b,w,p){var m;switch(void 0===s&&(s=0),void 0===f&&(f=0),void 0===b&&(b=!0),void 0===w&&(w=null),void 0===p&&(p=null),t){case 0:m=a;break;case 3:m=l;break;case 1:if(!function(e){if(!e)return!1;var n=null,t=e.lastIndexOf(".");return t>0&&(n=e.substr(t).toLowerCase()),!!n&&v.indexOf(n.toLowerCase())>=0}(w))return null;m=d;break;default:Object(r.a)(t)}var j=c?f:s;!j&&s&&(j=s);var h=Object(u.c)("{0}&permissionLevel={1}",Object(u.c)(m,encodeURIComponent(e.Id),encodeURIComponent(n)),j),I=g(e,m,!0,3===t,h);if(I)return I;var x=Object(u.c)("{0}{1}{2}",o,p,h);b&&(x=x+"&X-OWA-CANARY="+Object(i.a)());return Object(O.a)(x)}function x(e,n,t,i){var o;switch(void 0===t&&(t=!1),void 0===i&&(i=!0),n){case 0:o=c;break;case 1:o=s;break;case 2:o=f;break;case 3:o=b;break;default:return Object(r.a)(n)}if(!Object(u.f)(o)){var a=g(e,o,i,3===n);return Object(u.c)("{0}{1}{2}",a,t?"&isDownload=true":"","&animation=true")}return null}t.d(n,"b",(function(){return I})),t.d(n,"a",(function(){return x}))},2259:function(e,n,t){"use strict";t.d(n,"d",(function(){return r})),t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return o})),t.d(n,"e",(function(){return c})),t.d(n,"f",(function(){return a}));var r=600,u=600,i=650,o=1/2.89*100,c=420,a=420/1300*100},2633:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var r="autoHideEmail"},2634:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.NeedPassword=1]="NeedPassword",e[e.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},3135:function(e){e.exports=JSON.parse('{"a":"uTb"}')},616:function(e,n,t){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var n=e.maximumAttempts,t=e.timeBetweenRetryInMS;return function(e){var r=0,u=!1,i=function(o,c){u?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return o(e)})).catch((function(e){n&&r>=n?c(e):setTimeout((function(){return i(o,c)}),t(r))})))};return{retriableFunc:function(){return new Promise((function(e,n){return i(e,n)}))},cancel:function(){return u=!0}}}}function u(e){return function(n){return Math.pow(2,n)*e}}t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return u}))},9197:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return o}));var r=t(44),u=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(20),t.e(22),t.e(27),t.e(32),t.e(36),t.e(43),t.e(55),t.e(61),t.e(63),t.e(64),t.e(68),t.e(147),t.e(146),t.e(174),t.e(209),t.e(230),t.e(207),t.e(753)]).then(t.bind(null,16703))})),i=new r.b(u,(function(e){return e.getSxSViewStateFromElement})),o=Object(r.d)(u,(function(e){return e.SxSLayerView}));Object(r.d)(u,(function(e){return e.SxSView}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxS~GroupFilesHub~SxS.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxS~GroupFilesHub~SxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxS~GroupFilesHub~SxS.js'] = (new Date()).getTime();