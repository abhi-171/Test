self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SearchInstrumentation.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[730],{178:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l}));var r=n(44),u=new r.c((function(){return Promise.all([n.e(3),n.e(23),n.e(877)]).then(n.bind(null,1247))})),i=new r.a(u,(function(e){return e.makePostRequest})).importAndExecute,a=new r.a(u,(function(e){return e.makePatchRequest})).importAndExecute,c=new r.a(u,(function(e){return e.makePutRequest})).importAndExecute,o=new r.a(u,(function(e){return e.makeGetRequest})).importAndExecute,s=new r.a(u,(function(e){return e.makeDeleteRequest})).importAndExecute,l=new r.a(u,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},189:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(24);function u(){var e=Object(r.a)(),t=e.origin;return t||(t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),t}},2348:function(e,t,n){"use strict";var r=n(0),u=n(268);var i=n(40),a=n(4);n.d(t,"a",(function(){return s}));var c=null,o="searchtesthook";function s(e){void 0===e&&(e={});var t,n=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),function(){if(!c){c={};var e=Object(a.a)(o),t=decodeURIComponent(e||"").trim();if(Object(i.i)("sea-debugHook")&&t.length>0){var n=t.split("&");c=n.reduce((function(e,t){var n=Object(r.__read)(t.split("="),2),u=n[0],i=n[1];return e[u]=i,e}),{})}}return c}()),Object(u.a)("includePartnerIn3SRequest")?((t={}).partner="exchangeshared",t):null);return Object.keys(n).filter((function(e){return null!==n[e]})).reduce((function(e,t){var u;return Object(r.__assign)(Object(r.__assign)({},e),((u={})[t]=n[t],u))}),{})}},407:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(65);function u(e){return Object(r.a)(e,[r.c])}},4406:function(e,t,n){"use strict";function r(e,t){return"search/api/"+(2===t?"v2":"v1")+"/"+e}n.d(t,"a",(function(){return r}))},495:function(e,t,n){"use strict";var r=n(407),u=n(21),i=n(65);function a(e){return Object(i.a)(e,[i.b])}var c=n(17),o=n(50);function s(e){return Object(c.b)(Object(c.c)(Object(c.a)(Object(o.a)()||"",e)))}var l,d,f,b=n(503),y=n(615),v=n(141);function p(){return l||(l=Object(u.a)("/calendar")+"/"),l}function O(){return d||(d=Object(u.a)("/mail")+"/"),d}function j(){return f||(f=Object(u.a)("/files")+"/"),f}var V,g,h,K=n(710);function m(e){return V&&g===e||(g=e,V=e?Object(u.a)("/people/group/owner")+"/":Object(u.a)("/people/group/member")+"/"),V}function A(){return h||(h=Object(u.a)("/people/group/deleted")+"/"),h}function S(e){return window.location.origin+p()+"showPeek/item/"+encodeURIComponent(e)}var k=n(326),R=n(573),w=n(4),N=n(527),I=Object(R.a)().split("/").slice(1).join("/")+"deeplink/";function E(e,t,n,r){n&&((r=r||{}).minus="");var u="";if(r){var i=Object(w.b)();Object(N.a)(i),Object.keys(r).filter((function(e){return e})).forEach((function(e){return i[e]=r[e]})),u="?"+Object(w.i)(i)}var a={pathname:"/"+e+"/"+I+t,search:u};return k.format(a)}var _,P,C=n(144),x=n(0),F=n(25),T="https://to-do.microsoft.com";function q(e,t){var n,r,u,i=Object(F.a)(),a=i.UserOptions,c=null===(r=i.SessionSettings)||void 0===r?void 0:r.UserPrincipalName,o=T,s={};if(null===(u=null==a?void 0:a.ReactOptinSettings)||void 0===u?void 0:u.TasksRedirectUrl){var l;o=(n=Object(x.__read)(a.ReactOptinSettings.TasksRedirectUrl.split("?"),2))[0],l=n[1],s=Object(w.g)(l),c&&(s.auth_upn=c)}return e&&(s.utm_source=e),t&&delete s.fromOwa,Object.keys(s).length>0?Object(v.a)(o,s):o}function U(){return _||(_=Object(u.a)("/spaces")+"/"),_}function J(){return P||(P=Object(u.a)("/eventify")+"/"),P}var D=n(189);n.d(t,"i",(function(){return r.a})),n.d(t,"s",(function(){return u.a})),n.d(t,"e",(function(){return a})),n.d(t,"k",(function(){return s})),n.d(t,"r",(function(){return b.a})),n.d(t,"w",(function(){return c.a})),n.d(t,"a",(function(){return c.b})),n.d(t,"n",(function(){return y.a})),n.d(t,"u",(function(){return v.a})),n.d(t,"c",(function(){return p})),n.d(t,"j",(function(){return O})),n.d(t,"f",(function(){return j})),n.d(t,"o",(function(){return K.a})),n.d(t,"h",(function(){return m})),n.d(t,"g",(function(){return A})),n.d(t,"b",(function(){return S})),n.d(t,"p",(function(){return E})),n.d(t,"v",(function(){return C.a})),n.d(t,"t",(function(){return q})),n.d(t,"m",(function(){return U})),n.d(t,"d",(function(){return J})),n.d(t,"l",(function(){return D.a})),n.d(t,"q",(function(){return o.a}))},503:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),u=n(527);function i(){var e=Object(r.b)();Object(u.a)(e);var t=Object(r.i)(e);return t.length>0?"?"+t:""}},527:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId"];function u(e){e&&Object.keys(e).forEach((function(t){r.includes(t)&&delete e[t]}))}},573:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(50),u=n(21);function i(e){return(Object(u.a)("/"+(e||Object(r.a)()))+"/").replace(/^\//,"")}},576:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},5924:function(e,t,n){"use strict";n.r(t);var r=n(0),u=n(7352);function i(e,t){e.Attributes.push({Key:"localtime",Value:t.toISOString()})}var a={};function c(e,t,n,r,a){var c={Name:"entityclicked",Attributes:[]};i(c,n),c.Attributes.push({Key:"id",Value:t||(a+1).toString()}),Object(u.a)(e,c,r)}function o(e,t,n,r,u){var i={Name:"responsereceived",Attributes:[]};i.Attributes.push({Key:"latency",Value:t.toString()}),i.Attributes.push({Key:"status",Value:n.toString()}),a[e]=[i,r]}function s(e,t,n){var r=e||"00000000-0000-0000-0000-000000000000",a={Name:"sessionend",Attributes:[]};i(a,t),Object(u.a)(r,a,n)}function l(e,t,n){var r=a[e];delete a[e],r&&Promise.resolve().then((function(){var i=t.getTime()-r[1].getTime();r[0].Attributes.push({Key:"renderinglatency",Value:i.toString()}),r[0].Attributes.push({Key:"rendered",Value:"1"}),Object(u.a)(e,r[0],n)}))}function d(e,t){var n=a[e];delete a[e],n&&(n[0].Attributes.push({Key:"renderinglatency",Value:"-1"}),n[0].Attributes.push({Key:"rendered",Value:"0"}),Object(u.a)(e,n[0],t))}function f(e){Object.keys(a).forEach((function(t){return d(t,e)}))}function b(e,t,n,r,a){var c={Name:"searchboxstatechanged",Attributes:[]};c.Attributes.push({Key:"id",Value:n}),i(c,e),c.Attributes.push({Key:"reason",Value:t}),Object(u.a)(r,c,a)}function y(e,t,n,a,c,o){var s,l={Name:t,Attributes:[]};i(l,a),l.Attributes.push({Key:"id",Value:n}),o&&(s=l.Attributes).push.apply(s,Object(r.__spread)(o)),Object(u.a)(e,l,c)}var v=n(6105);function p(e,t,n,r){var i={Name:"responsereceived",Attributes:[{Key:"version",Value:"2"},{Key:"traceId",Value:t},{Key:"localtime",Value:Object(v.a)()},{Key:"latency",Value:n.toString()},{Key:"status",Value:null==r?void 0:r.toString()}]};Object(u.a)(t,i,e)}function O(e,t,n,r,i,a,c){var o={Name:"cachedcontentrendered",Attributes:[{Key:"version",Value:"2"},{Key:"userid",Value:t},{Key:"tenantid",Value:n},{Key:"localtime",Value:Object(v.a)()},{Key:"logicalid",Value:r},{Key:"newlogicalid",Value:i},{Key:"conversationid",Value:a}]};Object(u.a)(c,o,e)}function j(e,t,n,r){var i={Name:"resultsrendered",Attributes:[{Key:"version",Value:"2"},{Key:"logicalid",Value:t},{Key:"localtime",Value:Object(v.a)()},{Key:"e2elatency",Value:r.toString()}]};n&&i.Attributes.push({Key:"traceId",Value:n}),Object(u.a)(n||t,i,e)}function V(e,t){var n={Name:"clientdatasource",Attributes:[{Key:"version",Value:"2"},{Key:"userid",Value:t.userId},{Key:"tenantid",Value:t.tenantId},{Key:"logicalid",Value:t.logicalId},{Key:"traceId",Value:t.traceId},{Key:"providername",Value:t.providerName},{Key:"scenarioname",Value:e},{Key:"localtime",Value:Object(v.a)()},{Key:"impressiontype",Value:t.impressionType},{Key:"results",Value:JSON.stringify(t.results)}]};Object(u.a)(t.traceId,n,e)}function g(e,t,n,r,i,a,c,o,s){var l={Name:"clientlayout",Attributes:[{Key:"version",Value:"2"},{Key:"userid",Value:t},{Key:"tenantid",Value:n},{Key:"logicalid",Value:r},{Key:"localtime",Value:Object(v.a)()},{Key:"layouttype",Value:a},{Key:"resultsview",Value:JSON.stringify(c)}]};null!=o&&l.Attributes.push({Key:"part",Value:o.toString()}),s&&l.Attributes.push({Key:"verticaltype",Value:s}),Object(u.a)(i,l,e)}function h(e,t,n,r,i,a){void 0===i&&(i=null);var c={Name:"searchactions",Attributes:[{Key:"version",Value:"2"},{Key:"userid",Value:t},{Key:"tenantid",Value:n},{Key:"localtime",Value:Object(v.a)()},{Key:"logicalid",Value:r},{Key:"eventType",Value:a}]};i&&c.Attributes.push({Key:"traceId",Value:i}),Object(u.a)(r,c,e)}function K(e,t,n,r,i,a,c,o,s){void 0===i&&(i=null);var l={Name:"searchentityactions",Attributes:[{Key:"version",Value:"2"},{Key:"userid",Value:t},{Key:"tenantid",Value:n},{Key:"logicalid",Value:r},{Key:"localtime",Value:Object(v.a)()},{Key:"id",Value:a},{Key:"eventtype",Value:c}]};if(i&&l.Attributes.push({Key:"traceId",Value:i}),o){var d=[];o.forEach((function(e,t){d.push({Key:t,Value:e})})),l.Attributes.push({Key:"metadata",Value:JSON.stringify(d)})}Object(u.a)(s||r,l,e)}function m(e,t,n,r,u,i){K(r,null,null,i,e,t,n,new Map([["entityactiontaken",u]]))}function A(e,t,n,r,a){var c={Name:"SearchFeedback",Attributes:[]};c.Attributes.push({Key:"TraceId",Value:t}),i(c,e),c.Attributes.push({Key:"Version",Value:"2"});var o={Type:"ResultFoundResponse",ResponseValue:n?"Yes":"No",FeedbackString:r};c.Attributes.push({Key:"FeedbackResponse",Value:JSON.stringify(o)}),Object(u.a)(t,c,a)}function S(e,t,n,r,i){var a={Name:"searchfeedback",Attributes:[{Key:"version",Value:"2"},{Key:"logicalid",Value:t},{Key:"localtime",Value:Object(v.a)()},{Key:"id",Value:r},{Key:"feedbackresponse",Value:i}]};Object(u.a)(n,a,e)}function k(e,t,n,r,i,a){var c={Name:"EntitiesFromFilePicker",Attributes:[{Key:"userid",Value:t},{Key:"tenantid",Value:n},{Key:"localtime",Value:Object(v.a)()},{Key:"fileType",Value:i},{Key:"fileId",Value:a},{Key:"traceId",Value:r}]};Object(u.a)(r,c,e)}var R=[];function w(e,t,n,r,u,i,a,c,o){R.includes(u)||(R.push(u),g(e,t,n,r,u,i,a,c,o))}var N=[];function I(e,t,n,r){N.includes(n)||(N.push(n),j(e,t,n,r))}function E(){R.length=0,N.length=0}n.d(t,"logEntityClicked",(function(){return c})),n.d(t,"logResponseReceived",(function(){return o})),n.d(t,"logResponseRendered",(function(){return l})),n.d(t,"logSearchBoxStateChanged",(function(){return b})),n.d(t,"logSessionEnd",(function(){return s})),n.d(t,"logSearchResultInteraction",(function(){return y})),n.d(t,"logResponseNeverRendered",(function(){return d})),n.d(t,"flushNonRenderedResponseReceivedItemsFromCache",(function(){return f})),n.d(t,"logCachedContentRendered",(function(){return O})),n.d(t,"logClientLayout",(function(){return g})),n.d(t,"logClientDataSource",(function(){return V})),n.d(t,"logEntitiesFromFilePicker",(function(){return k})),n.d(t,"logResponseRecievedV2",(function(){return p})),n.d(t,"logResultsRendered",(function(){return j})),n.d(t,"logSearchEntityActions",(function(){return K})),n.d(t,"logSecondaryEntityActionClicked",(function(){return m})),n.d(t,"logFeedback",(function(){return A})),n.d(t,"logSearchFeedbackActions",(function(){return S})),n.d(t,"logSearchActions",(function(){return h})),n.d(t,"clearProcessedTraceIds",(function(){return E})),n.d(t,"logSearchSuggestionsClientLayoutEvent",(function(){return w})),n.d(t,"logSearchSuggestionsResultsRenderedEvent",(function(){return I}))},6105:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(5);function u(){return Object(r.lc)().toString()}},615:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(24),u=n(21),i=n(189);function a(e){var t=Object(r.a)(),n=Object(i.a)()+Object(u.a)("/owa")+"/",a=t.search&&t.search.length>0;n+=a?t.search:"?";for(var c=Object.keys(e),o=a,s=0;s<c.length;s++)o?n+="&":o=!0,n+=c[s]+"="+e[c[s]];return n}},710:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r,u=n(21);function i(){return r||(r=Object(u.a)("/people")+"/"),r}},7352:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4406),u=n(2),i=n(178),a=n(2348),c=n(495),o=null;function s(e,t,n){var s=t.Attributes.filter((function(e){return null!=e.Value}));t.Attributes=s,t.Attributes.forEach((function(e){if(e.Value&&"string"!=typeof e.Value)throw new Error("All values in substrate search event attributes must be strings or null/undefines")})),null===o&&(o={},setTimeout(function(e){return function(){var t=Object.keys(o).reduce((function(e,t){return e.push({Key:t,Value:o[t]}),e}),[]);o=null;var n={scenario:e},s=Object(a.a)(n);Object(i.d)(Object(c.u)(Object(r.a)("events"),s),t,void 0,void 0,{"Client-Session-Id":Object(u.E)()},void 0,void 0,!1)}}(n),5e3)),o[e]=(o[e]||[]).concat(t)}}}]);
//# sourceMappingURL=owa.MailBoot~SearchInstrumentation.js.map
self.scriptsLoaded['owa.MailBoot~SearchInstrumentation.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SearchInstrumentation.js'] = (new Date()).getTime();