self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentModelStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[314,454],{1024:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},t)}},1057:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(28),c=n(1024);function i(t,e){return void 0===t||t.__type||(t=Object(c.a)(t)),Object(r.a)("FindItem",t,e)}},1058:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},t)}},1641:function(t,e,n){"use strict";function r(t){if(!t)return null;var e=t.lastIndexOf(".");return e>0?t.substr(e).toLowerCase():null}function c(t){var e=r(t);return e?e.replace(".",""):null}function i(t){var e;return(null===(e=c(t))||void 0===e?void 0:e.substring(0,4))||""}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return i}))},1655:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function c(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return c}))},1656:function(t,e,n){"use strict";var r=n(0),c=n(1697),i=n(346),u=n(609),o=n(134),a=n(5),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,v,p,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(t)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return e?(n[s]=e,n[l]=e):b&&(n[s]=b.anchorMailbox),b?(v=b.token,!(p=Object(u.g)(b.tokenExpiry))&&v?[3,2]:(Object(o.r)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(b.tokenExpiry,Object(a.Pb)()),isTokenExpired_1:p,isTokenInvalid_2:!v},{isCore:!0}),[4,c.a.importAndExecute(b.accountId,t,v)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:O=void 0,"Outlook"==b.accountProviderType?(O='MSAuth1.0 usertoken="'+v+'", type="MSACT"',n[f]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(O="Bearer "+v,n[f]=2..toString()),n[d]=O,r.label=3;case 3:return[2,n]}}))}))}var v=n(1655),p=n(34);function O(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(v.a)(),c=n,[4,m(t,e)];case 1:return c.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function m(t,e){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,h(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(v.b)(c,i),[2,c]}}))}))}function h(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&p.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return O})),n.d(e,"c",(function(){return h}))},1657:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(3),c=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1674:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(331);function c(t){var e;return null===(e=Object(r.a)(t))||void 0===e?void 0:e.AttachmentPolicy}},1682:function(t,e,n){"use strict";var r,c,i;n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return i})),function(t){t[t.Compose=0]="Compose",t[t.Extensibility=1]="Extensibility",t[t.ReadingPane=2]="ReadingPane",t[t.Fileshub=3]="Fileshub",t[t.Txp=4]="Txp",t[t.Peek=5]="Peek",t[t.CalendarCard=6]="CalendarCard"}(r||(r={})),function(t){t[t.SmimeSignature=0]="SmimeSignature",t[t.Safety=1]="Safety",t[t.Error=2]="Error",t[t.Info=3]="Info",t[t.Encryption=4]="Encryption",t[t.Translation=5]="Translation",t[t.Sensitivity=6]="Sensitivity",t[t.InsightMessage=7]="InsightMessage",t[t.External=8]="External",t[t.Spotlight=9]="Spotlight"}(c||(c={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow",t[t.Orange=4]="Orange",t[t.Green20=5]="Green20"}(i||(i={}))},1697:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(44),c=n(1657);n.d(e,"b",(function(){return c.a}));var i=new r.c((function(){return n.e(1261).then(n.bind(null,1903))})),u=new r.a(i,(function(t){return t.getAndUpdateAccessToken}))},1743:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return o}));var r="FileAttachment:#Exchange",c="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",u="ReferenceAttachment:#Exchange",o="LinkAttachment:#Exchange"},1753:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},t)}},1793:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1743);function c(t){return(t.__type||t.OwsTypeName)===r.e}},1822:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(105);function c(t){switch(t){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(t)}}},1830:function(t,e){t.exports=function(t){return t instanceof Date}},1869:function(t,e,n){var r=n(1830),c=36e5,i=6e4,u=2,o=/[T ]/,a=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,l=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,v=/^-?(\d{3})$/,p=/^-?(\d{2})-?(\d{2})$/,O=/^-?W(\d{2})$/,m=/^-?W(\d{2})-?(\d{1})$/,h=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,y=/^(Z)$/,A=/^([+-])(\d{2})$/,I=/^([+-])(\d{2}):?(\d{2})$/;function w(t,e,n){e=e||0,n=n||0;var r=new Date(0);r.setUTCFullYear(t,0,4);var c=7*e+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+c),r}t.exports=function(t,e){if(r(t))return new Date(t.getTime());if("string"!=typeof t)return new Date(t);var n=(e||{}).additionalDigits;n=null==n?u:Number(n);var x=function(t){var e,n={},r=t.split(o);a.test(r[0])?(n.date=null,e=r[0]):(n.date=r[0],e=r[1]);if(e){var c=S.exec(e);c?(n.time=e.replace(c[1],""),n.timezone=c[1]):n.time=e}return n}(t),T=function(t,e){var n,r=d[e],c=l[e];if(n=f.exec(t)||c.exec(t)){var i=n[1];return{year:parseInt(i,10),restDateString:t.slice(i.length)}}if(n=s.exec(t)||r.exec(t)){var u=n[1];return{year:100*parseInt(u,10),restDateString:t.slice(u.length)}}return{year:null}}(x.date,n),k=T.year,_=function(t,e){if(null===e)return null;var n,r,c,i;if(0===t.length)return(r=new Date(0)).setUTCFullYear(e),r;if(n=b.exec(t))return r=new Date(0),c=parseInt(n[1],10)-1,r.setUTCFullYear(e,c),r;if(n=v.exec(t)){r=new Date(0);var u=parseInt(n[1],10);return r.setUTCFullYear(e,0,u),r}if(n=p.exec(t)){r=new Date(0),c=parseInt(n[1],10)-1;var o=parseInt(n[2],10);return r.setUTCFullYear(e,c,o),r}if(n=O.exec(t))return i=parseInt(n[1],10)-1,w(e,i);if(n=m.exec(t)){i=parseInt(n[1],10)-1;var a=parseInt(n[2],10)-1;return w(e,i,a)}return null}(T.restDateString,k);if(_){var C,E=_.getTime(),P=0;return x.time&&(P=function(t){var e,n,r;if(e=h.exec(t))return(n=parseFloat(e[1].replace(",",".")))%24*c;if(e=g.exec(t))return n=parseInt(e[1],10),r=parseFloat(e[2].replace(",",".")),n%24*c+r*i;if(e=j.exec(t)){n=parseInt(e[1],10),r=parseInt(e[2],10);var u=parseFloat(e[3].replace(",","."));return n%24*c+r*i+1e3*u}return null}(x.time)),x.timezone?C=function(t){var e,n;if(e=y.exec(t))return 0;if(e=A.exec(t))return n=60*parseInt(e[2],10),"+"===e[1]?-n:n;if(e=I.exec(t))return n=60*parseInt(e[2],10)+parseInt(e[3],10),"+"===e[1]?-n:n;return 0}(x.timezone):(C=new Date(E+P).getTimezoneOffset(),C=new Date(E+P+C*i).getTimezoneOffset()),new Date(E+P+C*i)}return new Date(t)}},1876:function(t,e,n){"use strict";var r=n(1743),c=n(7),i=function(t){return t&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(t)};function u(t){var e=t.__type||t.OwsTypeName;switch(e){case r.a:return 0;case r.e:return t.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:var n=t,u=t.EmbeddedItemClass;return u&&i(u)||Object(c.f)(n.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e)}}n.d(e,"a",(function(){return u}))},189:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(24);function c(){var t=Object(r.a)(),e=t.origin;return e||(e=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),e}},1921:function(t,e,n){"use strict";var r=n(1674);function c(){var t=Object(r.a)();return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var i=n(1822),u=n(1793);function o(){return c()}function a(t){return(t&&t.length>0&&function(t){return t.some((function(t){return!((e=t).IsInline&&!Object(u.a)(e));var e}))}(t)?c():[]).map(i.a)}n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a}))},195:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,c=!1;function i(e){r--,delete t[e]}this.put=function(e,n,c,u){if(void 0!==c&&("number"!=typeof c||isNaN(c)||c<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var o=t[e];o?clearTimeout(o.timeout):r++;var a={value:n,expire:c+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){i(e),u&&u(e,n)}.bind(this),c)),t[e]=a,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(e),n},this.clear=function(){for(var i in t)clearTimeout(t[i].timeout);r=0,t=Object.create(null),c&&(e=0,n=0)},this.get=function(i){var u=t[i];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return c&&e++,u.value;c&&n++,r--,delete t[i]}else c&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){c=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),c=Date.now(),i=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(i)if(t[u])continue;var o=r[u],a=o.expire-c;if(a<=0){this.del(u);continue}a=a>0?a:void 0,this.put(u,o.value,a)}return this.size()}}t.exports=new r,t.exports.Cache=r},208:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return u}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function c(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function i(){return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()}function u(t){return r.test(t)}},214:function(t,e,n){"use strict";var r=n(25),c=n(0),i=n(85),u=n(40);function o(t){var e=Object(i.i)(t);return e&&e.SessionSettings?0===e.SessionSettings.WebSessionType?Object(u.i)("doc-attachment-routingKeyAadSmtp")?"SMTP:":"":"MSA:":"no-routing-key:"}var a=n(34);function s(t,e,n){var r,i;if(n)try{for(var u=Object(c.__values)(n),o=u.next();!o.done;o=u.next()){var a=o.value;if(!d(t,a))return a}}catch(t){r={error:t}}finally{try{o&&!o.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return e&&e.length>0?e[0]:"NoResolvableAddress@invalid.outlook.com"}function d(t,e){return("outlook_"+t+"@outlook.com").toLowerCase()===e.toLowerCase()}function f(){var t=function(){var t=Object(r.a)();if(!t||!t.SessionSettings)return a.d("SessionSettings not available"),"no-routing-key";var e=t.SessionSettings.UserEmailAddress;if(0===t.SessionSettings.WebSessionType)return o()+e;if(Object(u.i)("doc-attachment-routingKeyPuid"))return"PUID:"+t.SessionSettings.UserPuid+"@"+t.SessionSettings.TenantGuid;if(t.SessionSettings.IsShadowMailbox)return o()+t.SessionSettings.LogonEmailAddress;if(d(t.HexCID,t.SessionSettings.UserEmailAddress))return o()+s(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses);return o()+e}();return t=encodeURIComponent(t)}function l(){var t=Object(r.a)();if(!t||!t.SessionSettings)return a.d("SessionSettings not available"),"no-mailbox-id";var e=t.SessionSettings.UserEmailAddress;return Object(u.i)("doc-attachment-usePrimarySmtpAddressForMailboxId")?e:(t.SessionSettings.IsShadowMailbox?e=t.SessionSettings.LogonEmailAddress:d(t.HexCID,t.SessionSettings.UserEmailAddress)&&(e=s(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses)),e)}var b=n(704),v=n(525);function p(t){var e=Object(v.a)().userMailboxInfoMap;e&&e.delete(t)}function O(t,e){return t===e||null!=t&&null!=e&&t.Id===e.Id}n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return b.a})),n.d(e,"f",(function(){return p})),n.d(e,"e",(function(){return O})),n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return o}))},2140:function(t,e,n){"use strict";var r=n(44),c=[0,1],i=n(2208),u=n(2165),o=n(7),a=n(105),s=n(1682);function d(t){switch(t){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(u.a),messageParts:[Object(o.b)(u.a),f()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(i.b),messageParts:[Object(o.b)(i.b),f()],color:s.a.Red};default:return Object(a.a)(t)}}function f(){return{text:Object(o.b)(i.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var l=n(1921),b=n(1822),v=n(0),p=n(40),O=n(1674);function m(){var t=Object(O.a)();if(Object(p.i)("fwk-devTools")){if(Object(p.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(v.__assign)(Object(v.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(p.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(v.__assign)(Object(v.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return t}function h(){var t=m();return t.DirectFileAccessOnPrivateComputersEnabled&&t.DirectFileAccessOnPublicComputersEnabled?2:t.WacViewingOnPrivateComputersEnabled&&t.WacViewingOnPublicComputersEnabled?0:1}n.d(e,"g",(function(){return j})),n.d(e,"a",(function(){return c})),n.d(e,"f",(function(){return d})),n.d(e,"b",(function(){return l.a})),n.d(e,"e",(function(){return b.a})),n.d(e,"d",(function(){return h})),n.d(e,"c",(function(){return m}));var g=new r.c((function(){return n.e(1686).then(n.bind(null,16825))})),j=new r.b(g,(function(t){return t.getAccessIssuesForAttachments}))},2165:function(t){t.exports=JSON.parse('{"a":"nla"}')},218:function(t,e,n){"use strict";var r=n(693);n.d(e,"a",(function(){return r.a}))},2208:function(t){t.exports=JSON.parse('{"a":"lla","b":"mla"}')},2544:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1743);function c(t){return(t.__type||t.OwsTypeName)===r.d}},342:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return u}));var r,c=n(0);function i(t){r=t}function u(){var t,e;return Object(c.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return(i=r)?[4,r()]:[3,2];case 1:i=c.sent(),c.label=2;case 2:if((n=i)&&n.length>0){if("bearer"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},346:function(t,e,n){"use strict";var r,c=n(3);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var i,u=n(52),o=Object(c.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(c.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(c.action)("updateAccount",(function(t,e,n){return{userIdentity:t,accountToken:e,accountTokenExpiresIn:n}})),d=Object(c.action)("updateOWAConnectedAccountStatus",(function(t,e){return{userIdentity:t,accountState:e}})),f=Object(c.action)("accountIsInErrorState",(function(t,e){return Object(u.c)({name:"accountIsInErrorState",options:{isCore:!0},customData:{accountState_1:r[t],accountProvider_2:e}},{accountState:t})})),l=Object(c.action)("retryAccountUpdateToken",(function(t,e,n,c,i,o){return Object(u.c)({name:"retryAccountUpdateToken",customData:{currentAccountState_1:r[c],localAccountState_2:r[i],previousAccountState_3:r[o]}},{accountId:t,userIdentity:e,currentToken:n})})),b=Object(c.action)("connectedAccountsListRequested",(function(t){return Object(u.c)({name:"connectedAccountsGetResponse",options:{isCore:!0},customData:{isSuccess_1:t}},{isSuccess:t})})),v=Object(c.action)("setAccountsStoreState",(function(t){return{state:t}})),p=n(0),O=n(16);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(i||(i={}));var m=Object(c.createStore)("OWAAccountsStore",{accountsMap:new O.ObservableMap({}),accountsLoadedState:i.None}),h=n(105),g=n(85);function j(t){return t!=Object(g.b)()&&void 0!==y(t)}function S(){return Object(p.__spread)(m().accountsMap.values())}function y(t){return m().accountsMap.get(t)}function A(){var t;return(null===(t=S())||void 0===t?void 0:t.length)>0?S()[0]:null}function I(){return S().filter((function(t){return t.accountState!=r.Valid}))}function w(t){return S().filter((function(e){return t.includes(e.accountState)}))}function x(t){return S().filter((function(e){return e.accountProviderType==t}))}function T(t){return j(t)?y(t).accountProviderType:null}function k(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(h.a)(t.accountProviderType)}function _(t,e){return function(n){var r=y(n);return r?r[t]:e}}_("accountUniqueId","0");var C=_("accountState",r.Valid),E=function(){return S().some((function(t){return!D(t.userIdentity)}))},P=_("accountProviderType",null),M=function(t){return"Outlook"==P(t)},D=function(t){return C(t)==r.Valid},N=function(){return S().length>0};function L(){return m().accountsLoadedState}var R=n(5),F=n(134);Object(c.mutator)(o,(function(t){var e=t.account;Object(F.r)("owaAccountAdded",{accountStatus_1:r[e.accountState]}),m().accountsMap.set(e.userIdentity,e)})),Object(c.mutator)(a,(function(t){var e=t.userIdentity;m().accountsMap.delete(e)})),Object(c.mutator)(s,(function(t){var e=t.userIdentity,n=t.accountToken,r=t.accountTokenExpiresIn,c=m().accountsMap.get(e);c.token=n,c.tokenExpiry=Object(R.j)(Object(R.Pb)(),parseInt(r))})),Object(c.mutator)(d,(function(t){var e=t.userIdentity,n=t.accountState,c=m().accountsMap.get(e);c.accountState==r.Valid&&n!=r.Valid&&Object(F.r)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[n]}),c.accountState=n})),Object(c.mutator)(b,(function(t){var e=t.isSuccess?i.AccountsLoadSuccessful:i.AccountsLoadError;m().accountsLoadedState=e})),Object(c.mutator)(v,(function(t){m().accountsLoadedState=t.state})),n.d(e,"d",(function(){return o})),n.d(e,"u",(function(){return a})),n.d(e,"y",(function(){return s})),n.d(e,"x",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"v",(function(){return l})),n.d(e,"e",(function(){return b})),n.d(e,"w",(function(){return v})),n.d(e,"n",(function(){return S})),n.d(e,"k",(function(){return y})),n.d(e,"i",(function(){return A})),n.d(e,"f",(function(){return I})),n.d(e,"g",(function(){return w})),n.d(e,"o",(function(){return x})),n.d(e,"j",(function(){return T})),n.d(e,"m",(function(){return k})),n.d(e,"l",(function(){return C})),n.d(e,"q",(function(){return E})),n.d(e,"t",(function(){return M})),n.d(e,"s",(function(){return D})),n.d(e,"p",(function(){return N})),n.d(e,"h",(function(){return L})),n.d(e,"r",(function(){return j})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},347:function(t,e,n){"use strict";var r=n(0);function c(t,e){return t?Object(r.__assign)({mailboxInfo:t},e):null!=e?e:void 0}n.d(e,"a",(function(){return c}))},407:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(65);function c(t){return Object(r.a)(t,[r.c])}},424:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();n.d(e,"a",(function(){return r}))},525:function(t,e,n){"use strict";var r=n(3),c=n(16);e.a=Object(r.createStore)("OWAClientIdStore",{userMailboxInfoMap:new c.ObservableMap})},559:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"FolderId:#Exchange"},t)}},609:function(t,e,n){"use strict";var r=n(3),c=Object(r.action)("initializeOwaObservableDateTime"),i=Object(r.action)("observableNowChanged"),u=Object(r.action)("observableTodayChanged"),o=n(5),a=n(16),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(a.computed)((function(){return Object(o.lc)(s().now)})),f=function(){return d.get()},l=Object(a.computed)((function(){return Object(o.lc)(s().today)})),b=function(){return l.get()},v=function(t){return Object(o.Gb)(t,f())},p=function(t){return Object(o.Eb)(t,f())},O=function(t){return h(t,o.Gb)},m=function(t){return h(t,o.Hb)},h=function(t,e){return e(Object(o.Wb)(Object(o.lc)(t)),b())};function g(t){if(!t)return"";var e=Object(o.lc)(t);return function(t,e){var n=Object(o.Wb)(t);if(Object(o.Ib)(n,e))return o.Z;var r=function(t){return Object(o.Mb)(n,Object(o.e)(e,-t),e)};if(r(3))return o.hb;if(r(30))return o.gb;return o.X}(e,b())(e)}function j(t){if(!t)return"";var e=Object(o.lc)(t);return function(t,e){var n=Object(o.Wb)(t);if(Object(o.Ib)(n,e))return o.S;return o.T}(e,b())(e)}function S(t){return t?function(t,e){var n=Object(o.Wb)(t);return Object(o.Ib)(n,e)?Object(o.Z)(t):y(n,e,2)?Object(o.kb)(t):y(n,e,7)?Object(o.H)(Object(o.ab)(t),Object(o.Z)(t)):Object(o.H)(Object(o.J)(t),Object(o.Z)(t))}(Object(o.lc)(t),b()):""}function y(t,e,n){return Object(o.Mb)(t,Object(o.e)(e,-n),e)}var A=Object(r.action)("updateTimes"),I=Object(r.action)("setNow"),w=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(I,(function(){s().now=Object(o.jc)()})),Object(r.mutator)(w,(function(t){var e=t.today;s().today=e}));var x=n(36),T=n(126);Object(r.orchestrator)(c,(function(){A();var t=Object(o.Pb)(),e=Object(o.Yb)(Object(o.h)(t,1)),n=Object(o.w)(e,t);setTimeout((function(){return setInterval(A,x.g)}),n)})),Object(r.orchestrator)(T.l,(function(){A()})),Object(r.orchestrator)(A,(function(){I();var t=Object(o.zb)(Object(o.kc)()),e=s().today!=t;e&&w(t),i(),e&&u()})),n.d(e,"d",(function(){return c})),n.d(e,"j",(function(){return i})),n.d(e,"l",(function(){return u})),n.d(e,"i",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"g",(function(){return v})),n.d(e,"e",(function(){return p})),n.d(e,"f",(function(){return O})),n.d(e,"h",(function(){return m})),n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return S}))},616:function(t,e,n){"use strict";function r(t){void 0===t&&(t={}),function(t){t.timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4}}(t);var e=t.maximumAttempts,n=t.timeBetweenRetryInMS;return function(t){var r=0,c=!1,i=function(u,o){c?o(new Error("The function retry was cancelled")):(r++,t().then((function(t){return u(t)})).catch((function(t){e&&r>=e?o(t):setTimeout((function(){return i(u,o)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(t,e){return i(t,e)}))},cancel:function(){return c=!0}}}}function c(t){return function(e){return Math.pow(2,e)*t}}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return c}))},693:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))},704:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(85),c=n(525);function i(t){var e=Object(c.a)().userMailboxInfoMap;if(!e||!e.get(t)){var n=!1;t&&(n=t!=Object(r.b)());var i={type:"UserMailbox",userIdentity:n?t:Object(r.b)(),mailboxSmtpAddress:n?t:Object(r.c)()};return e.set(t,i),i}return e.get(t)}},7201:function(t,e,n){"use strict";var r=n(0),c=n(1675),i=n(1922),u=n(4850),o=n(1985),a=n(2393),s=n(188);e.a=Object(s.action)("refreshThumbnailImageUrl")((function(t,e,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(s=Object(c.a)(t),!Object(o.b)(s.model))return[3,7];switch(s.model.ProviderType){case i.e:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(u.a)(s.model)];case 2:return d=r.sent(),s.thumbnailImage.url=d,[3,4];case 3:return r.sent(),s.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:d=Object(a.a)(t,s.model,2,Object(o.b)(s.model),e,n),s.thumbnailImage.url=d,r.label=8;case 8:return[2]}}))}))}))},7421:function(t,e,n){"use strict";var r=n(2063),c=n(1675),i=n(6531),u=n(40),o=n(188);e.a=Object(o.action)("setAttachmentPermissionLevel")((function(t,e,n,o){var a=Object(c.a)(t),s=a.model;s.PermissionType=e,n&&(s.AttachLongPathName=n,a.openUrl=Object(i.a)(s)),Object(u.i)("doc-attachment-referenceAttachmentExpiration")&&a.info&&a.info.sharingInfo&&(a.info.sharingInfo.expirationDate=o),Object(r.a)(t)}))},7725:function(t,e,n){"use strict";var r=n(0),c=n(188),i=n(5),u=n(7421);function o(t){return Object(r.__assign)({__type:"SetAttachmentPermissionsRequest:#Exchange"},t)}var a=n(28);function s(t,e,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var c,i,u=function(t,e,n,r){return void 0===n&&(n=null),void 0===r&&(r=!1),o({AttachmentIds:t,PermissionLevel:e,NewAttachLongPathNames:n,SetToOriginalPermissionLevel:r})}(t,e,n,r);return void 0===(c={request:u}).request||c.request.__type||(c.request=o(c.request)),Object(a.a)("SetAttachmentPermissionsV2",c,i)}e.a=Object(c.action)("changeAttachmentPermission")((function(t,e,n,c){return void 0===n&&(n=null),void 0===c&&(c=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,s(t.map((function(t){return t.Id})),e,n,c)];case 1:if(!(o=r.sent()).OperationSucceeded||!o.NewAttachLongPathNames||o.NewAttachLongPathNames.length!==t.length)throw new Error("Error setting attachment permissions");return t.forEach((function(t,n){var r,c=null;(null===(r=o.ExpirationDates)||void 0===r?void 0:r[n])&&(c=Object(i.lc)(o.ExpirationDates[n])),Object(u.a)(t,e,o.NewAttachLongPathNames[n],c)})),[2]}}))}))}))},790:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0);function c(t){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},t)}},957:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(48);function c(t){if(!t)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(t)}}}]);
//# sourceMappingURL=owa.AttachmentModelStore.js.map
self.scriptsLoaded['owa.AttachmentModelStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentModelStore.js'] = (new Date()).getTime();