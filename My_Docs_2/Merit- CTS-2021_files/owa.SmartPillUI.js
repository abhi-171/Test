self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SmartPillUI.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[923],{10916:function(t,e,n){var r=n(16105),a=n(107);"string"==typeof r&&(r=[[t.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(t.exports=r.locals)},11142:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n(521),o=n(770),i=n(3875),l=n(1),c=n(10916),u="SmartReply",s=function(t){function e(e){var n=t.call(this,e)||this;return n.handleClickForSimpleButton=function(){var t=n.props,e=t.smartPillData,r=t.pillsToShowTypes,a=e.onClick;Object(i.j)(i.d,e.logData,{numOfPillsShown:r.length,typesOfPillsShown:r}),Object(i.k)(e.logData.mainPayload.EID,e.logData.mainPayload.position,e.logData.mainPayload.loggableText,e.featureName,e.logData.mainPayload.language,e.logData.mainPayload.locale,e.logData.cosmosOnlyData),a&&a(e)},n.getMenuForContextualMenuButton=function(t){var e=n.props,a=e.smartPillData,c=e.pillsToShowTypes;return a.featureName===u?Object(i.j)(i.e,a.logData):Object(i.j)(i.d,a.logData,{numOfPillsShown:c.length,typesOfPillsShown:c}),l.createElement(o.a,Object(r.__assign)({},t))},n.props.smartPillData.logData.mainPayload.position=n.props.position,n}return Object(r.__extends)(e,t),e.prototype.render=function(){var t=this.props.smartPillData,e=t.featureName,n=t.ariaLabel,r=t.icon,o=t.text,i=t.toolTip,c=t.onRender,s=t.menuProps,m=!1,d=this.getSmartPillButtonStyles();return e===u&&null!=s&&(m=!0,d=this.getSmartPillSplitButtonStyles()),c?c(this.props.position,d,this.props.pillsToShowTypes):l.createElement(a.a,{ariaDescription:n,iconProps:r,onClick:this.handleClickForSimpleButton,key:this.props.position,split:m,styles:d,text:o,title:i,menuProps:s,menuAs:this.getMenuForContextualMenuButton})},e.prototype.getSmartPillButtonStyles=function(){return{root:c.smartPillButton,label:c.smartPillButtonTextContainer,icon:this.props.smartPillData.icon?c.smartPillIcon:null}},e.prototype.getSmartPillSplitButtonStyles=function(){return{root:c.smartPillSplitButton,label:c.smartPillButtonTextContainer,icon:this.props.smartPillData.icon?c.smartPillIcon:null,splitButtonContainer:c.smartPillSplitButtonContainer,splitButtonDivider:c.smartPillSplitButtonDivider,splitButtonMenuButton:c.smartPillSplitButtonMenuButton}},e}(l.Component),m=n(2561),d=n(7),f=n(16106),p="ReadingPane",h="SmartReply";function g(t){var e={title:Object(d.b)(f.f),subTitle:t.feedbackData.subtitle,categories:t.feedbackData.dSATOptions,ghostText:Object(d.b)(f.e),donationText:Object(d.b)(f.a),donationToolTip:Object(d.b)(f.b),donationJson:t.feedbackData.donationJson,submitCallBack:void 0,cancelCallBack:void 0,createUVTicket:!1};return l.createElement(m.a,{feature:p,subFeature:h,ribbonMessage:Object(d.b)(f.d),thankYouMessage:Object(d.b)(f.g),metadata:JSON.stringify({data:t.arbitratedPills.pillsToShow.map((function(t){return t.logData}))}),yesCallBack:void 0,yesFeedbackDialogParams:void 0,noFeedbackDialogParams:e,noCallBack:void 0,okCallBack:void 0,notNowCallBack:void 0,moreFeedbackRibbonMessage:Object(d.b)(f.c)})}var b=n(40),P=n(10916);var y=function(t){l.useEffect((function(){var e=t.arbitratedPills;if(e&&(e.pillsToShow.length>0||e.pillsToHide.length>0)){var n=e.pillsToShow,r=e.pillsToHide,a=e.arbitratorId;Object(i.l)(n,r,a);var o=void 0;n.length>0?o=n[0].logData:r.length>0&&(o=r[0].logData);var l=o&&o.mainPayload.EID;l&&Object(i.m)(l,n.map((function(t){return t.logData.mainPayload.loggableText})),n.map((function(t){return t.featureName})),r.map((function(t){return t.featureName})),o.mainPayload.language,o.mainPayload.locale,o.cosmosOnlyData)}}),[]);var e=t.arbitratedPills,n=t.enableFeedbackForm;if(!e||0==e.pillsToShow.length)return null;var r=e.pillsToShow.map((function(t){return t.logData.mainPayload.type}));return l.createElement(l.Fragment,null,l.createElement("div",{className:P.smartPillButtonContainer},e.pillsToShow.map((function(t,e){return l.createElement(s,{key:e,smartPillData:t,position:e,pillsToShowTypes:r})}))),function(t,e,n){if(t&&Object(b.i)("mc-smartPillsFeedbackFormV2"))return n&&l.createElement(g,{arbitratedPills:e,feedbackData:n});return null}(n,e,t.feedbackData))};n.d(e,"SmartPill",(function(){return s})),n.d(e,"SmartPillBlock",(function(){return y}))},16105:function(t,e,n){(e=t.exports=n(106)(!1)).push([t.i,'._2Q01fwc5NbrZTI5BcpGw-s{color:"[theme:themePrimary, default:#0078D4]";font-size:12px;font-stretch:normal;font-style:normal;letter-spacing:normal;line-height:normal;vertical-align:top}html[dir] ._2Q01fwc5NbrZTI5BcpGw-s{background-color:"[theme:white, default:#ffffff]";border:solid 1px;border-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px;margin-bottom:8px;padding:8px;text-align:center}html[dir=ltr] ._2Q01fwc5NbrZTI5BcpGw-s{margin-right:8px}html[dir=rtl] ._2Q01fwc5NbrZTI5BcpGw-s{margin-left:8px}._2Q01fwc5NbrZTI5BcpGw-s:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._2Q01fwc5NbrZTI5BcpGw-s:hover{background-color:"[theme:themePrimary, default:#0078D4]"}._2425MOOSFPWffiKpjexDmi{font-weight:400}html[dir] ._2425MOOSFPWffiKpjexDmi{margin:0}._1XvPPaPlhtm-u0Wx9Efhd5{display:block}._31LpRC6uIQIR-Y-CJ93wqQ{line-height:14px;height:14px;font-size:14px}html[dir=ltr] ._31LpRC6uIQIR-Y-CJ93wqQ{margin-left:0}html[dir=rtl] ._31LpRC6uIQIR-Y-CJ93wqQ{margin-right:0}html[dir] ._3GyIgBgHc6IwZ0B6VR7L9g{border:solid 1px;border-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px;margin-bottom:8px}html[dir=ltr] ._3GyIgBgHc6IwZ0B6VR7L9g{margin-right:8px}html[dir=rtl] ._3GyIgBgHc6IwZ0B6VR7L9g{margin-left:8px}._16nzFtPmd323RjROkNLnM8{color:"[theme:themePrimary, default:#0078D4]";font-size:12px;font-stretch:normal;font-style:normal;letter-spacing:normal;line-height:normal;height:auto}html[dir] ._16nzFtPmd323RjROkNLnM8{background:none;border:none;padding:7px;text-align:center}._16nzFtPmd323RjROkNLnM8:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._16nzFtPmd323RjROkNLnM8:hover{background-color:"[theme:themePrimary, default:#0078D4]";border-color:"[theme:themePrimary, default:#0078D4]";border-radius:0}._1Ju4p03KQWRyn1ab0fo49z{color:"[theme:themePrimary, default:#0078D4]";font-size:12px;font-stretch:normal;font-style:normal;letter-spacing:normal;line-height:normal;height:auto}html[dir] ._1Ju4p03KQWRyn1ab0fo49z{background:none;border:none;padding:7px;text-align:center}html[dir] ._1Ju4p03KQWRyn1ab0fo49z:hover{background-color:"[theme:themePrimary, default:#0078D4]";border-color:"[theme:themePrimary, default:#0078D4]";border-radius:0}._1Ju4p03KQWRyn1ab0fo49z:hover span>i{color:"[theme:white, default:#ffffff]"}._1Ju4p03KQWRyn1ab0fo49z>span>i{color:"[theme:themePrimary, default:#0078D4]"}._2ym8ooAHRgiqCjbA9NmEIH{width:1px}html[dir] ._2ym8ooAHRgiqCjbA9NmEIH{background-color:"[theme:themePrimary, default:#0078D4]"}',""]),e.locals={smartPillButton:"_2Q01fwc5NbrZTI5BcpGw-s",smartPillButtonTextContainer:"_2425MOOSFPWffiKpjexDmi",smartPillButtonContainer:"_1XvPPaPlhtm-u0Wx9Efhd5",smartPillIcon:"_31LpRC6uIQIR-Y-CJ93wqQ",smartPillSplitButtonContainer:"_3GyIgBgHc6IwZ0B6VR7L9g",smartPillSplitButton:"_16nzFtPmd323RjROkNLnM8",smartPillSplitButtonMenuButton:"_1Ju4p03KQWRyn1ab0fo49z",smartPillSplitButtonDivider:"_2ym8ooAHRgiqCjbA9NmEIH"}},16106:function(t){t.exports=JSON.parse('{"f":"Occ","e":"Pcc","a":"Qcc","b":"Rcc","d":"Scc","c":"Tcc","g":"Ucc"}')},2561:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var r=n(44),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(7),n.e(559)]).then(n.bind(null,4111))})),o=Object(r.d)(a,(function(t){return t.FeedbackRibbon})),i=new r.b(a,(function(t){return t.launchFeedbackDialogWithoutRibbon}))},3875:function(t,e,n){"use strict";var r=n(0),a=2500,o=n(134),i=n(359);function l(t,e,n){var r=new i.a(t,e,{isCore:!0,isCosmosDatapoint:!0});n&&r.addCosmosOnlyData(n),o.n.importAndExecute(r)}function c(t,e,n,i,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s,m,d,f,p,h,g,b,P;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u={},s=c||a,n?[4,Promise.all(n.map((function(t){return t.preRun().catch((function(e){u[t.getName()]=new Error(e)}))})))]:[3,2];case 1:r.sent(),r.label=2;case 2:return(m=new o.b("SmartPillPerformance",{sessionSampleRate:10})).addCustomProperty("preDefinedTimeout",s),[4,Promise.all(t.map((function(t){return Promise.race([t.buildPills(),(e=s,new Promise((function(t,n){setTimeout((function(){var t=new Error("timeout");t.networkError=!0,n(t)}),e)})))]).catch((function(e){return u[t.getName()]=new Error(e),[]}));var e}))).then((function(t){return m.end(),t}))];case 3:d=r.sent(),f=[].concat.apply([],d),p=f.length,i&&i.map((function(t){try{t.updateLogData(f)}catch(e){u[t.getName()]=new Error(e)}})),h={pillsToShow:[],pillsToHide:[],arbitratorId:""};try{h=e.arbitratePills(f)}catch(t){u.arbitrator=new Error(t)}return(g=Object.keys(u)).length>0&&(b=[],P=[],g.forEach((function(t){var e=u[t];e.hasOwnProperty("networkError")?b.push(t+"_"+e.message):P.push(t+"_"+e.message)})),l("SmartPillError",[b.toString(),P.toString(),p])),[2,h]}}))}))}function u(t,e,n,r,a){return{mainPayload:{renderStory:0,loggableText:e,type:t,position:-1,EID:n,confidenceScore:r},cosmosOnlyData:a}}function s(t,e,n){var r=void 0;t.concat(e).forEach((function(t){!r&&t.logData.cosmosOnlyData&&(r=t.logData.cosmosOnlyData)}));var a={data:t.map((function(t){return t.logData.mainPayload}))},o={data:e.map((function(t){return t.logData.mainPayload}))};l("SmartPillsRendered",[t.length,e.length,JSON.stringify(a),JSON.stringify(o),n],r)}function m(t,e,n,r,a,o,i){l("SmartReply_Rendered",[t,!1,e.join("$"),!1,n.toString(),r.toString(),a,o],i)}function d(t,e,n){var a=(new Date).toISOString(),o={data:[Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e.mainPayload),{timeClicked:a}),n)]};l(t,[JSON.stringify(o)],e.cosmosOnlyData)}function f(t,e,n,r,a,o,i,c){l("SmartReply_Clicked",[t,e,n,!1,r,a,o,c],i)}n.d(e,"h",(function(){return c})),n.d(e,"i",(function(){return u})),n.d(e,"l",(function(){return s})),n.d(e,"m",(function(){return m})),n.d(e,"j",(function(){return d})),n.d(e,"k",(function(){return f})),n.d(e,"n",(function(){return l})),n.d(e,"d",(function(){return"SmartPillClicked"})),n.d(e,"e",(function(){return"SmartPillMenuOpened"})),n.d(e,"g",(function(){return"SmartTimeMenuClicked"})),n.d(e,"a",(function(){return"SmartDocMenuClicked"})),n.d(e,"b",(function(){return"SmartDocMenuClosed"})),n.d(e,"c",(function(){return"SmartDocSpinnerDisposed"})),n.d(e,"f",(function(){return"SmartReplyMenuClicked"}))}}]);
//# sourceMappingURL=owa.SmartPillUI.js.map
self.scriptsLoaded['owa.SmartPillUI.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SmartPillUI.js'] = (new Date()).getTime();