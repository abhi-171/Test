self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~RecipientPermissionChecker.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[710],{1e3:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"GetPersonaJsonRequest:#Exchange"},e)}},1001:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"GetItemRequest:#Exchange"},e)}},1002:function(e,t,n){"use strict";var r=n(28),o=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return i}))},1046:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(0),o=void 0,i=new Promise((function(e){o=e}));function s(e){null==o||o(e)}function c(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Promise.race([i,new Promise((function(e,t){setTimeout((function(){return t()}),45e3)}))])]}))}))}},1049:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(820),o=n(197),i=n(816);function s(e){if(!e)return Promise.reject(new Error("GetPersonaByEmailAddress failed"));var t=Object(r.a)({EmailAddress:{EmailAddress:e}});return Object(i.a)({Header:Object(o.b)(),Body:t}).then((function(e){if(e.Body&&"NoError"===e.Body.ResponseCode)return e.Body.Persona;throw new Error("GetPersonaByEmailAddress failed")}))}},143:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"i",(function(){return r}));var r,o="ktp",i="-",s=o+i,c="data-ktp-target",a="data-ktp-execute-target",u="data-ktp-aria-target",d="ktp-layer-id",l=", ";!function(e){e.KEYTIP_ADDED="keytipAdded",e.KEYTIP_REMOVED="keytipRemoved",e.KEYTIP_UPDATED="keytipUpdated",e.PERSISTED_KEYTIP_ADDED="persistedKeytipAdded",e.PERSISTED_KEYTIP_REMOVED="persistedKeytipRemoved",e.PERSISTED_KEYTIP_EXECUTE="persistedKeytipExecute",e.ENTER_KEYTIP_MODE="enterKeytipMode",e.EXIT_KEYTIP_MODE="exitKeytipMode"}(r||(r={}))},1655:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function o(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},1656:function(e,t,n){"use strict";var r=n(0),o=n(1697),i=n(346),s=n(609),c=n(134),a=n(5),u="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",p="X-OWA-ExplicitLogonUser";function f(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,f,h,b,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},f=Object(i.k)(e)){if(f.accountState==i.b.AccessRevoked)return[2,null];if(f.accountState==i.b.AccountDeprovisioned||f.accountState==i.b.AccountNotFound)return Object(i.c)(f.accountState,f.accountProviderType),[2,null]}return t?(n[u]=t,n[p]=t):f&&(n[u]=f.anchorMailbox),f?(h=f.token,!(b=Object(s.g)(f.tokenExpiry))&&h?[3,2]:(Object(c.r)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(f.tokenExpiry,Object(a.Pb)()),isTokenExpired_1:b,isTokenInvalid_2:!h},{isCore:!0}),[4,o.a.importAndExecute(f.accountId,e,h)])):[3,3];case 1:(h=r.sent())||(h=""),r.label=2;case 2:v=void 0,"Outlook"==f.accountProviderType?(v='MSAuth1.0 usertoken="'+h+'", type="MSACT"',n[l]=1..toString()):"Google"!=f.accountProviderType&&"ICloud"!=f.accountProviderType||(v="Bearer "+h,n[l]=2..toString()),n[d]=v,r.label=3;case 3:return[2,n]}}))}))}var h=n(1655),b=n(34);function v(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(h.a)(),o=n,[4,m(e,t)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function m(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,f(e.mailboxInfo.userIdentity,g(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(h.b)(o,i),[2,o]}}))}))}function g(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&b.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return g}))},1657:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},1674:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(331);function o(e){var t;return null===(t=Object(r.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},1682:function(e,t,n){"use strict";var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(o||(o={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},1697:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(44),o=n(1657);n.d(t,"b",(function(){return o.a}));var i=new r.c((function(){return n.e(1261).then(n.bind(null,1903))})),s=new r.a(i,(function(e){return e.getAndUpdateAccessToken}))},1726:function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"m",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"g",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"k",(function(){return h})),n.d(t,"j",(function(){return b})),n.d(t,"h",(function(){return v})),n.d(t,"f",(function(){return m})),n.d(t,"n",(function(){return g}));var r=n(44),o=n(2063);n.d(t,"o",(function(){return o.a}));var i=n(1825);n.d(t,"b",(function(){return i.a}));var s=n(1913);n.d(t,"d",(function(){return s.a})),n.d(t,"c",(function(){return s.b}));var c=n(1922);n.d(t,"a",(function(){return c.a}));var a=new r.c((function(){return Promise.all([n.e(3),n.e(23),n.e(32),n.e(63),n.e(206),n.e(314)]).then(n.bind(null,3528))})),u=new r.a(a,(function(e){return e.addAndInitializeAttachments})),d=new r.a(a,(function(e){return e.setPreviewImageUrl})),l=new r.a(a,(function(e){return e.refreshDownloadUrl})),p=new r.a(a,(function(e){return e.createAttachmentInfo})),f=new r.a(a,(function(e){return e.setAttachmentInfo})),h=new r.a(a,(function(e){return e.refreshThumbnailImageUrl})),b=new r.a(a,(function(e){return e.refreshPreviewImageUrl})),v=new r.b(a,(function(e){return e.getAttachment})),m=new r.b(a,(function(e){return e.checkPendingAttachmentOperation})),g=new r.b(a,(function(e){return e.shouldShowImageView}))},1731:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return a}));var r=n(44),o=new r.c((function(){return Promise.all([n.e(20),n.e(22),n.e(24),n.e(34),n.e(39),n.e(40),n.e(599)]).then(n.bind(null,2646))})),ReactEditor=Object(r.d)(o,(function(e){return e.ReactEditor})),i=new r.b(o,(function(e){return e.setTableHeaderRow})),s=new r.b(o,(function(e){return e.operateContent})),c=new r.b(o,(function(e){return e.focusToEditor}));function a(e){c.import().then((function(t){return t(e)}))}},1753:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},e)}},1792:function(e,t,n){"use strict";var r=n(2062),o=n(2036),i=n(1726),s=n(1876),c=n(2544),a=n(1793);function u(e,t,n,u){if(Object(i.d)(n))return function(e){return 2===Object(s.a)(e)?p():d()}(n);if(3===Object(s.a)(n)&&!u)return l();var f;switch(t){case 2:f={allowEdit:!1,previewMethod:o.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:f={allowEdit:!1,previewMethod:o.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:f={allowEdit:!1,previewMethod:o.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:f={allowEdit:e.wacEdit,previewMethod:o.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:f={allowEdit:!1,previewMethod:o.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:f={allowEdit:!1,previewMethod:o.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:f=p();break;case 11:f={allowEdit:!1,previewMethod:o.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:f={allowEdit:!1,previewMethod:o.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:f={allowEdit:!1,previewMethod:o.a.Unsupported,supportedOpenActions:[]};break;case 13:f={allowEdit:!1,previewMethod:o.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]};break;default:f=function(e){return Object(c.a)(e)||Object(a.a)(e)}(n)?l():d()}return f}function d(){return{allowEdit:!1,previewMethod:o.a.Unsupported,supportedOpenActions:[r.a.Download]}}function l(){return{allowEdit:!1,previewMethod:o.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function p(){return{allowEdit:!1,previewMethod:o.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var f=n(188),h=Object(f.action)("setIsPlaceholderAttachment")((function(e,t){e.isPlaceholderAttachment=t})),b=Object(f.action)("setThumbnailLoadState")((function(e,t){e.thumbnailLoadState=t}));function v(e,t,n,r,i,s){return void 0===s&&(s=null),{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:n,isReadOnly:t,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:o.a.Unsupported,supportedOpenActions:[]},parentItemId:s,fileType:i}}var m,g=n(25);function _(){return Object(g.a)().SessionSettings.CompanyName}function y(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub",e[e.FolderTree=12]="FolderTree"}(m||(m={})),n.d(t,"e",(function(){return u})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"g",(function(){return _})),n.d(t,"f",(function(){return y})),n.d(t,"b",(function(){return o.a})),n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return m}))},1822:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(105);function o(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1830:function(e,t){e.exports=function(e){return e instanceof Date}},1869:function(e,t,n){var r=n(1830),o=36e5,i=6e4,s=2,c=/[T ]/,a=/:/,u=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,p=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],f=/^-(\d{2})$/,h=/^-?(\d{3})$/,b=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,m=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,_=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,y=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,O=/([Z+-].*)$/,k=/^(Z)$/,C=/^([+-])(\d{2})$/,w=/^([+-])(\d{2}):?(\d{2})$/;function E(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var o=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+o),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?s:Number(n);var j=function(e){var t,n={},r=e.split(c);a.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var o=O.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e),T=function(e,t){var n,r=d[t],o=p[t];if(n=l.exec(e)||o.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=u.exec(e)||r.exec(e)){var s=n[1];return{year:100*parseInt(s,10),restDateString:e.slice(s.length)}}return{year:null}}(j.date,n),I=T.year,S=function(e,t){if(null===t)return null;var n,r,o,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=f.exec(e))return r=new Date(0),o=parseInt(n[1],10)-1,r.setUTCFullYear(t,o),r;if(n=h.exec(e)){r=new Date(0);var s=parseInt(n[1],10);return r.setUTCFullYear(t,0,s),r}if(n=b.exec(e)){r=new Date(0),o=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,o,c),r}if(n=v.exec(e))return i=parseInt(n[1],10)-1,E(t,i);if(n=m.exec(e)){i=parseInt(n[1],10)-1;var a=parseInt(n[2],10)-1;return E(t,i,a)}return null}(T.restDateString,I);if(S){var P,x=S.getTime(),D=0;return j.time&&(D=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*o;if(t=_.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*o+r*i;if(t=y.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var s=parseFloat(t[3].replace(",","."));return n%24*o+r*i+1e3*s}return null}(j.time)),j.timezone?P=function(e){var t,n;if(t=k.exec(e))return 0;if(t=C.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=w.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(j.timezone):(P=new Date(x+D).getTimezoneOffset(),P=new Date(x+D+P*i).getTimezoneOffset()),new Date(x+D+P*i)}return new Date(e)}},1913:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.AttachmentId)&&o(e.AttachmentId.Id)}function o(e){return e&&-1!==e.indexOf("smime-")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},1915:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),t.b=r},1921:function(e,t,n){"use strict";var r=n(1674);function o(){var e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var i=n(1822),s=n(1793);function c(){return o()}function a(e){return(e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!Object(s.a)(t));var t}))}(e)?o():[]).map(i.a)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}))},1922:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"a",(function(){return h}));var r="Box",o="Dropbox",i="Facebook",s="GDrive",c="Mailbox",a="MailMessage",u="OneDriveConsumer",d="OneDrivePro",l="WopiBox",p="WopiDropbox",f="WopiEgnyte",h={providers:{BOX:r,DROPBOX:o,FACEBOOK:i,GDRIVE:s,MAILBOX:c,ONE_DRIVE_CONSUMER:u,ONE_DRIVE_PRO:d,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:l,WOPI_EGNYTE:f}}},195:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,s){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==s&&"function"!=typeof s)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var a={value:n,expire:o+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){i(t),s&&s(t,n)}.bind(this),o)),e[t]=a,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var s=e[i];if(void 0!==s){if(isNaN(s.expire)||s.expire>=Date.now())return o&&t++,s.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var s in r)if(r.hasOwnProperty(s)){if(i)if(e[s])continue;var c=r[s],a=c.expire-o;if(a<=0){this.del(s);continue}a=a>0?a:void 0,this.put(s,c.value,a)}return this.size()}}e.exports=new r,e.exports.Cache=r},2036:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},2062:function(e,t,n){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),t.a=r},2063:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",(function(e){return{attachmentId:e}}))},2140:function(e,t,n){"use strict";var r=n(44),o=[0,1],i=n(2208),s=n(2165),c=n(7),a=n(105),u=n(1682);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(s.a),messageParts:[Object(c.b)(s.a),l()],color:u.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(i.b),messageParts:[Object(c.b)(i.b),l()],color:u.a.Red};default:return Object(a.a)(e)}}function l(){return{text:Object(c.b)(i.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var p=n(1921),f=n(1822),h=n(0),b=n(40),v=n(1674);function m(){var e=Object(v.a)();if(Object(b.i)("fwk-devTools")){if(Object(b.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(h.__assign)(Object(h.__assign)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(b.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(h.__assign)(Object(h.__assign)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function g(){var e=m();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return y})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return p.a})),n.d(t,"e",(function(){return f.a})),n.d(t,"d",(function(){return g})),n.d(t,"c",(function(){return m}));var _=new r.c((function(){return n.e(1686).then(n.bind(null,16825))})),y=new r.b(_,(function(e){return e.getAccessIssuesForAttachments}))},2165:function(e){e.exports=JSON.parse('{"a":"nla"}')},218:function(e,t,n){"use strict";var r=n(693);n.d(t,"a",(function(){return r.a}))},2208:function(e){e.exports=JSON.parse('{"a":"lla","b":"mla"}')},2544:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1743);function o(e){return(e.__type||e.OwsTypeName)===r.d}},270:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(306),o=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,n,o,i){var s;if(e._isElement(t)){if("undefined"!=typeof document&&document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(n,i||!1,!0),Object(r.a)(c,o),s=t.dispatchEvent(c)}else if("undefined"!=typeof document&&document.createEventObject){var a=document.createEventObject(o);t.fireEvent("on"+n,a)}}else for(;t&&!1!==s;){var u=t.__events__,d=u?u[n]:null;if(d)for(var l in d)if(d.hasOwnProperty(l))for(var p=d[l],f=0;!1!==s&&f<p.length;f++){var h=p[f];h.objectCallback&&(s=h.objectCallback.call(h.parent,o))}t=i?t.parent:null}return s},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var r in t)t.hasOwnProperty(r)&&this.on(e,r,t[r],n)},e.prototype.on=function(t,n,r,o){var i=this;if(n.indexOf(",")>-1)for(var s=n.split(/[ ,]+/),c=0;c<s.length;c++)this.on(t,s[c],r,o);else{var a=this._parent,u={target:t,eventName:n,parent:a,callback:r,options:o};if((s=t.__events__=t.__events__||{})[n]=s[n]||{count:0},s[n][this._id]=s[n][this._id]||[],s[n][this._id].push(u),s[n].count++,e._isElement(t)){var d=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!i._isDisposed){var n;try{if(!1===(n=r.apply(a,e))&&e[0]){var o=e[0];o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.cancelBubble=!0}}catch(o){}return n}};u.elementCallback=d,t.addEventListener?t.addEventListener(n,d,o):t.attachEvent&&t.attachEvent("on"+n,d)}else{u.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!i._isDisposed)return r.apply(a,e)}}this._eventRecords.push(u)}},e.prototype.off=function(e,t,n,r){for(var o=0;o<this._eventRecords.length;o++){var i=this._eventRecords[o];if(!(e&&e!==i.target||t&&t!==i.eventName||n&&n!==i.callback||"boolean"==typeof r&&r!==i.options)){var s=i.target.__events__,c=s[i.eventName],a=c?c[this._id]:null;a&&(1!==a.length&&n?(c.count--,a.splice(a.indexOf(i),1)):(c.count-=a.length,delete s[i.eventName][this._id]),c.count||delete s[i.eventName]),i.elementCallback&&(i.target.removeEventListener?i.target.removeEventListener(i.eventName,i.elementCallback,i.options):i.target.detachEvent&&i.target.detachEvent("on"+i.eventName,i.elementCallback)),this._eventRecords.splice(o--,1)}}},e.prototype.raise=function(t,n,r){return e.raise(this._parent,t,n,r)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}()},342:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r,o=n(0);function i(e){r=e}function s(){var e,t;return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return(i=r)?[4,r()]:[3,2];case 1:i=o.sent(),o.label=2;case 2:if((n=i)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},3949:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(44),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(20),n.e(23),n.e(27),n.e(30),n.e(32),n.e(36),n.e(41),n.e(44),n.e(55),n.e(63),n.e(64),n.e(68),n.e(92),n.e(104),n.e(147),n.e(148),n.e(210),n.e(209),n.e(208),n.e(211),n.e(315)]).then(n.bind(null,5914))})),i=new r.a(o,(function(e){return e.prefetchAllWacResources})),s=new r.a(o,(function(e){return e.prefetchWacResourcesForAttachments})),c=new r.a(o,(function(e){return e.prefetchWacResourcesForFiles}))},408:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){var t=r.useRef();return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}},424:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();n.d(t,"a",(function(){return r}))},453:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(12),i=n(220),s=Object(i.c)((function(e,t){var n,i,s,c,a,u,d,l,p,f,h,b,v=e.effects,m=e.palette,g=e.semanticColors,_={position:"absolute",width:1,right:31,top:8,bottom:8},y={splitButtonContainer:[Object(o.getFocusStyle)(e,{highContrastStyle:{left:-2,top:-2,bottom:-2,right:-2,border:"none"},inset:2}),{display:"inline-flex",selectors:{".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none"},".ms-Button--primary":{borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",selectors:(n={},n[o.HighContrastSelector]={color:"WindowText",backgroundColor:"Window",border:"1px solid WindowText",borderRightWidth:"0",MsHighContrastAdjust:"none"},n)},".ms-Button--primary + .ms-Button":{border:"none",selectors:(i={},i[o.HighContrastSelector]={border:"1px solid WindowText",borderLeftWidth:"0"},i)}}}],splitButtonContainerHovered:{selectors:{".ms-Button--primary":{selectors:(s={},s[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight"},s)},".ms-Button.is-disabled":{color:g.buttonTextDisabled,selectors:(c={},c[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},c)}}},splitButtonContainerChecked:{selectors:{".ms-Button--primary":{selectors:(a={},a[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},a)}}},splitButtonContainerCheckedHovered:{selectors:{".ms-Button--primary":{selectors:(u={},u[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},u)}}},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:{padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:v.roundedCorner2,borderBottomRightRadius:v.roundedCorner2,border:"1px solid "+m.neutralSecondaryAlt,borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},_),{selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"WindowText"},d)}),splitButtonDividerDisabled:Object(r.__assign)(Object(r.__assign)({},_),{selectors:(l={},l[o.HighContrastSelector]={backgroundColor:"GrayText"},l)}),splitButtonMenuButtonDisabled:{pointerEvents:"none",border:"none",selectors:(p={":hover":{cursor:"default"},".ms-Button--primary":{selectors:(f={},f[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},f)},".ms-Button-menuIcon":{selectors:(h={},h[o.HighContrastSelector]={color:"GrayText"},h)}},p[o.HighContrastSelector]={color:"GrayText",border:"1px solid GrayText",backgroundColor:"Window"},p)},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none",selectors:Object(r.__assign)((b={},b[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},b),Object(o.getEdgeChromiumNoHighContrastAdjustSelector)())}};return Object(o.concatStyleSets)(y,t)}))},457:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a}));var r=n(0),o=n(12),i=n(382),s=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(e){var t,n,i,c,a,u=e.semanticColors,d=e.palette,l=u.buttonBackground,p=u.buttonBackgroundPressed,f=u.buttonBackgroundHovered,h=u.buttonText,b=u.buttonTextHovered,v=u.buttonTextChecked,m=u.buttonTextCheckedHovered;return{root:{backgroundColor:l,color:h},rootHovered:{backgroundColor:f,color:b,selectors:(t={},t[o.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:p,color:v},rootExpanded:{backgroundColor:p,color:v},rootChecked:{backgroundColor:p,color:v},rootCheckedHovered:{backgroundColor:p,color:m},rootDisabled:{selectors:(n={},n[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},n)},splitButtonContainer:{selectors:(i={},i[o.HighContrastSelector]={border:"none"},i)},splitButtonMenuButton:{color:d.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:d.neutralLight,selectors:(c={},c[o.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:u.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:u.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},s()),{backgroundColor:d.neutralTertiaryAlt,selectors:(a={},a[o.HighContrastSelector]={backgroundColor:"WindowText"},a)}),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:d.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:d.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:d.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:d.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:u.buttonText},splitButtonMenuIconDisabled:{color:u.buttonTextDisabled}}}function a(e){var t,n,c,a,u,d,l,p,f,h=e.palette,b=e.semanticColors;return{root:{backgroundColor:b.primaryButtonBackground,border:"1px solid "+b.primaryButtonBackground,color:b.primaryButtonText,selectors:(t={},t[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},t["."+i.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:h.white}}},t)},rootHovered:{backgroundColor:b.primaryButtonBackgroundHovered,border:"1px solid "+b.primaryButtonBackgroundHovered,color:b.primaryButtonTextHovered,selectors:(n={},n[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},n)},rootPressed:{backgroundColor:b.primaryButtonBackgroundPressed,border:"1px solid "+b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed,selectors:(c={},c[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},c)},rootExpanded:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootChecked:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootDisabled:{selectors:(a={},a[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},a)},splitButtonContainer:{selectors:(u={},u[o.HighContrastSelector]={border:"none"},u)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},s()),{backgroundColor:h.white,selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"Window"},d)}),splitButtonMenuButton:{backgroundColor:b.primaryButtonBackground,color:b.primaryButtonText,selectors:(l={},l[o.HighContrastSelector]={backgroundColor:"WindowText"},l[":hover"]={backgroundColor:b.primaryButtonBackgroundHovered,selectors:(p={},p[o.HighContrastSelector]={color:"Highlight"},p)},l)},splitButtonMenuButtonDisabled:{backgroundColor:b.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:b.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:b.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:b.primaryButtonText},splitButtonMenuIconDisabled:{color:h.neutralTertiary,selectors:(f={},f[o.HighContrastSelector]={color:"GrayText"},f)}}}},462:function(e,t,n){"use strict";function r(e,t,n){void 0===n&&(n=0);for(var r=-1,o=n;e&&o<e.length;o++)if(t(e[o],o)){r=o;break}return r}function o(e,t){var n=r(e,t);if(!(n<0))return e[n]}function i(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n}function s(e,t){return e.reduce((function(e,n,r){return r%t==0?e.push([n]):e[e.length-1].push(n),e}),[])}function c(e,t){return e.filter((function(e,n){return t!==n}))}function a(e,t,n){var r=e.slice();return r[n]=t,r}function u(e,t,n){var r=e.slice();return r.splice(t,0,n),r}function d(e){var t=[];return e.forEach((function(e){return t=t.concat(e)})),t}function l(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return l}))},463:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n(0),o=n(143),i=n(462);function s(e){return e.reduce((function(e,t){return e+o.h+t.split("").join(o.h)}),o.g)}function c(e,t){var n=t.length,o=Object(r.__spreadArrays)(t).pop(),s=Object(r.__spreadArrays)(e);return Object(i.a)(s,n-1,o)}function a(e){return"["+o.c+'="'+s(e)+'"]'}function u(e){return"["+o.b+'="'+e+'"]'}function d(e){var t=" "+o.f;return e.length?t+" "+s(e):t}},465:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(143),i=n(561),s=function(e){var t,n=e.children,s=Object(r.__rest)(e,["children"]),c=Object(i.a)(s),a=c.keytipId,u=c.ariaDescribedBy;return n(((t={})[o.c]=a,t[o.b]=a,t["aria-describedby"]=u,t))}},502:function(e,t,n){"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter((function(e){return e})).join(" ").trim();return""===n?void 0:n}n.d(t,"a",(function(){return r}))},5041:function(e,t,n){"use strict";var r=n(0),o=n(3),i=Object(o.action)("ON_SHARING_LINK_DETECTED",(function(e,t,n,r,o,i,s,c,a,u){return{linkId:e,linkUrl:t,sharingLinkIds:n,response:r,shouldAddComposeLinkViewState:o,isPreviouslyBeautified:i,source:s,providerType:c,unwrappedUrl:a,creationDateTime:u}})),s=n(3239),c=n(1773),a=n(2463),u=n(3949);Object(o.orchestrator)(i,(function(e){Object(c.c)(e.linkId,e.linkUrl,e.sharingLinkIds,e.response,e.source,e.providerType,e.unwrappedUrl,e.creationDateTime),e.shouldAddComposeLinkViewState&&Object(s.g)(e.linkId)})),Object(o.orchestrator)(i,(function(e){var t,n;(null===(t=e.response)||void 0===t?void 0:t.FileName)&&function(e,t){Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,a.g.import()];case 1:return n.sent()(t)&&u.c.importAndExecute([e]),[2]}}))}))}(null===(n=e.response)||void 0===n?void 0:n.FileName,e.providerType)}));var d=n(134),l=n(1662),p=n(2055),f=n(5);function h(e){var t=!1;if(e){try{var n=Object(f.lc)(e);t=Object(f.Eb)(n,Object(f.h)(Object(f.Pb)(),-10))&&Object(f.Gb)(n,Object(f.Pb)())}catch(e){}Object(d.r)("validlinkCreatedDateTime",{isNewlyCreatedLink:t})}return t}function b(e,t,n,o,i,s,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,f,b,v,m,g;return Object(r.__generator)(this,(function(_){switch(_.label){case 0:return f="",b=function(e){var t,n,o=e.toLowerCase();try{for(var i=Object(r.__values)(["onedrive.aspx","onenote.aspx","allitems.aspx","all.aspx","sites"]),s=i.next();!s.done;s=i.next()){var c=s.value;if(-1!==o.indexOf(c))return c}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return"NoErrorExpected"}(e),v=new d.b("GetSharingInformationForLink"),[4,a.g.import()];case 1:m=_.sent(),v.addCustomData({anchorElementsSource:t.toString(),shouldBeautify:n,shouldRehydrate:o,expectedErrorType:b,providerType:i}),_.label=2;case 2:return _.trys.push([2,5,,6]),[4,p.h.import()];case 3:return[4,_.sent()(e,i,h(c))];case 4:return u=_.sent(),[3,6];case 5:return g=_.sent(),f=g.fetchErrorType,u={ResultCode:1},[3,6];case 6:return 0!==u.ResultCode||m(i)&&!u.CanonicalUrl?(0===u.ResultCode&&m(i)&&!u.CanonicalUrl&&(u.ResultCode=1,f="NullCanonicalUrlFromSuccessResponse"),Object(d.r)("GetSharingInformationFailure",{errorType:f,resultCode:u.ResultCode||-1,anchorElementsSource:t.toString(),shouldBeautify:n,shouldRehydrate:o,expectedErrorType:b}),v.addCustomData({errorType:f,resultCode:u.ResultCode||-1,extension:""}),v.endWithError("ServerError")):(v.addCustomData({errorType:"",resultCode:u.ResultCode||-1,extension:Object(l.d)(u.FileName||""),sharingLinkKind:u.SharingLinkKind,linkId:s}),v.end()),[2,u]}}))}))}n.d(t,"a",(function(){return"contenteditable"})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return h}))},521:function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(396),s=n(517),c=n(516),a=n(12),u=n(220),d=n(397),l=n(453),p=n(457),f=Object(u.c)((function(e,t,n){var r=Object(d.a)(e),o=Object(l.a)(e),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:a.FontWeights.semibold}};return Object(a.concatStyleSets)(r,i,n?Object(p.a)(e):Object(p.b)(e),o,t)}));n.d(t,"a",(function(){return h}));var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,c=e.styles,a=e.theme;return o.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:f(a,c,n),onRenderDescription:s.b}))},t=Object(r.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],t)}(o.Component)},561:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),o=n(1),i=n(408),s=n(711),c=n(502),a=n(702),u=n(463);function d(e){var t,n,d=o.useRef(),l=e.keytipProps?Object(r.__assign)({disabled:e.disabled},e.keytipProps):void 0,p=Object(i.a)(a.a.getInstance());o.useEffect((function(){return l&&(d.current=p.register(l)),function(){l&&p.unregister(l,d.current)}}),[]);var f=Object(s.a)(e);d.current&&l&&((null===(t=f)||void 0===t?void 0:t.keytipProps)!==e.keytipProps||(null===(n=f)||void 0===n?void 0:n.disabled)!==e.disabled)&&p.update(l,d.current);var h={ariaDescribedBy:void 0,keytipId:void 0};return l&&(h=function(e,t,n){var o=e.addParentOverflow(t),i=Object(c.a)(n,Object(u.a)(o.keySequences)),s=Object(r.__spreadArrays)(o.keySequences);o.overflowSetSequence&&(s=Object(u.d)(s,o.overflowSetSequence));var a=Object(u.e)(s);return{ariaDescribedBy:i,keytipId:a}}(p,l,e.ariaDescribedBy)),h}},5906:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(2416),i=n(1915),s=n(2055);function c(e,t,n,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,u,d,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,s.e.import()];case 1:return a=r.sent(),u=a(t,!c),d=[],u.some((function(e){return e.recipient.expansionStatus===i.a.None}))?(Object(o.b)(e,u,n,c),[2,[!1,d]]):(l=u.filter((function(e){return e.recipient.expansionStatus===i.a.SucceededWithoutDLOrGroupMembers}))).length!==u.length?[2,[!1,d]]:(l.forEach((function(e){e.recipient.members.forEach((function(e){d.push(e)}))})),[2,[!0,d]])}}))}))}function a(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,u,d,l,p;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return[4,s.k.import()];case 1:return i=f.sent(),[4,s.m.import()];case 2:return a=f.sent(),i(t)||a(t)?[2,[]]:[4,c(e,t,n,o)];case 3:return u=r.__read.apply(void 0,[f.sent(),2]),d=u[0],l=u[1],d?[4,s.g.import()]:[2,[]];case 4:return p=f.sent(),p(t).forEach((function(e){l.push({emailAddress:e.recipient.persona.EmailAddress.EmailAddress,displayName:e.recipient.persona.EmailAddress.Name,personaTypeString:null})})),[2,l]}}))}))}var u=n(1773);function d(e){var t=Object(u.k)(e),n=Object(u.l)(e);return n&&0===n.providerType&&t&&t.sharingInfo.getSharingInfoSucceeded&&(0===t.currentPermissionLevel||2===t.currentPermissionLevel||1===t.currentPermissionLevel)}var l=n(134),p=n(5041),f=n(7),h=n(34),b=n(2660),v=n(40),m=n(2980),g=n(326);function _(e,t,n){var o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,s,c,a,u,d,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=function(e){return Object(f.c)("https://{0}/{1}/{2}/permission/checkAccess",Object(g.parse)(e).hostname,Object(m.q)(0),Object(b.g)(e))}(e),s=function(e){return JSON.stringify((t=e,{recipients:t.map((function(e){return{alias:e.emailAddress}}))}));var t}(t),c={method:b.d,mode:b.a,body:s,datapointNamePrefix:"checkRecipientPermission"},a=Object(v.i)("doc-link-cogs"),u={Application:"Outlook_Web",Scenario:"ShareFile",ScenarioType:"PO"},a&&(n||(Object(l.r)("CheckAccessWithReadOnlyHeader"),u.Prefer="eventualconsistencyreadonly")),r.label=1;case 1:return r.trys.push([1,3,,7]),[4,Object(b.f)(0,i,e,c,u)];case 2:return p=r.sent(),[2,JSON.parse(p).value];case 3:return d=r.sent(),!a||n||404!==(null===(o=JSON.parse(d))||void 0===o?void 0:o.responseStatus)?[3,5]:(Object(l.r)("CheckAccessRetryOnNotFound"),[4,Object(b.f)(0,i,e,c,null)]);case 4:return p=r.sent(),[2,JSON.parse(p).value];case 5:throw d;case 6:return[3,7];case 7:return[2]}}))}))}var y=n(3),O=Object(y.action)("startCheckPerm",(function(e){return{composeId:e}})),k=Object(y.action)("finishCheckPerm",(function(e){return{composeId:e}})),C=Object(y.action)("addCheckPerm",(function(e){return{composeId:e}})),w=Object(y.action)("removeCheckPerm",(function(e){return{composeId:e}})),E=Object(y.action)("updateCheckPermCount ",(function(e,t){return{composeId:e,offset:t}})),j=30,T=23;function I(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,s,c,a,b,v,m,g;return Object(r.__generator)(this,(function(y){switch(y.label){case 0:return e.length>0?(h.g.info(Object(f.c)("RecipientPermission: LinkId:{0}, add {1} recipients",t,e.length)),i=null,[4,u.q.import()]):[3,10];case 1:if(s=y.sent(),!d(t))return[2,!1];s(t,e),c=Object(u.l)(t),O(o),(a=new l.b("LinkCheckPerms")).addCustomData({RecipientCount:e.length}),y.label=2;case 2:y.trys.push([2,8,9,10]),b=0,y.label=3;case 3:return b<e.length/j?(i=e.slice(b*j,(b+1)*j),d(t)?[4,_(n,i,Object(p.d)(c.creationDateTime))]:(a.addCustomData({permissionChangedSoCheckPermStoped:!0}),a.end(),a=null,[2,!1])):[3,7];case 4:return v=y.sent(),m=v.filter((function(e){return!e.hasAccess})).length,[4,u.y.import()];case 5:y.sent()(t,v),a.addCustomData({countOfRecipientsWhoCannotAccess:Math.min(m,T)}),h.g.info(Object(f.c)("RecipientPermission: checkAccess for {0} recipients succeeded",v.length)),y.label=6;case 6:return b++,[3,3];case 7:return[3,10];case 8:return g=y.sent(),function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return h.g.info(Object(f.c)("RecipientPermission: checkAccess for {0} recipients failed",t.length)),[4,u.w.import()];case 1:return n.sent()(e,t),[2]}}))}))}(t,i||e,g.message),a.endWithError(g.message),a=null,[2,!1];case 9:return null==a||a.end(),k(o),[7];case 10:return[2,!0]}}))}))}function S(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,c;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return(o=Object(u.l)(e))&&d(e)?(i=o.unwrappedUrl?o.unwrappedUrl:o.url,[4,s.j.import()]):[2];case 1:return c=a.sent(),function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(o=e.filter((function(e){return!P(e.emailAddress,t)}))).length>0?(h.g.info(Object(f.c)("RecipientPermission: LinkId:{0}, remove {1} recipients ",n,o.length)),[4,u.u.import()]):[3,2];case 1:r.sent()(n,o),r.label=2;case 2:return[2]}}))}))}(o.sharingRecipientsInfo.recipientPermissionInfos,t,e),c(o.sharingRecipientsInfo)?[2]:[4,I(function(e,t){var n=t.filter((function(t){return!P(t.emailAddress,e)})),r=[];return n.forEach((function(e){r.push({emailAddress:e.emailAddress,name:e.displayName,getPermissionInfoStatus:s.a.InProgress,hasAccess:!1})})),r}(o.sharingRecipientsInfo.recipientPermissionInfos,t),e,i,n)];case 2:return a.sent(),[2]}}))}))}function P(e,t){return t.some((function(t){return t.emailAddress===e}))}function x(e){return e.some((function(e){return d(e)}))}Object(y.orchestrator)(o.d,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return x(e.linkIds)?(h.g.info("RecipientPermission: tryCheckPermForLinks"),[4,a(e.linkIds,e.recipientInfos,e.composeId,e.isCalendar)]):[2];case 1:t=r.sent(),n=0,r.label=2;case 2:return n<e.linkIds.length?[4,S(e.linkIds[n],t,e.composeId)]:[3,5];case 3:r.sent(),r.label=4;case 4:return n++,[3,2];case 5:return[2]}}))}))}));var D=n(10509),A=n(44),B=new A.c((function(){return n.e(895).then(n.bind(null,17453))})),R=new A.a(B,(function(e){return e.setMembersToRecipientViewState})),F=new A.a(B,(function(e){return e.setRecipientExpansionStatus})),M=n(7202);function H(e){var t,n,o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,c,a,u,d,p,f,b,v,m,g,_,y;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return h.g.info("RecipientPermission: expandAndSetRecipientViewState"),[4,D.b.import()];case 1:return s=r.sent(),[4,F.import()];case 2:return c=r.sent(),a=e.recipient.persona,u=a.EmailAddress,d=a.ADObjectId,p=a.PersonaId,null!==(null===(t=a.PersonaId)||void 0===t?void 0:t.Id)?[3,4]:[4,Object(M.a)(null===(n=a.EmailAddress)||void 0===n?void 0:n.EmailAddress)];case 3:if(!(f=r.sent()))return h.d("Failed to get persona by Email Address. persona has email address:"+!!(null===(o=a.EmailAddress)||void 0===o?void 0:o.EmailAddress.toString())),c(e.recipient,i.a.Failed),[2];d=f.ADObjectId,p=f.PersonaId,u=f.EmailAddress,r.label=4;case 4:b={EmailAddress:u.EmailAddress,Name:u.Name,MailboxType:u.MailboxType,RoutingType:u.RoutingType},r.label=5;case 5:return r.trys.push([5,9,,10]),c(e.recipient,i.a.InProgress),[4,s(p,d,b,100,!0)];case 6:return(null==(v=r.sent())?void 0:v.Members)?(m=!1,g=[],v.Members.forEach((function(e){var t;switch(e.PersonaTypeString){case"DistributionList":case"ImplicitGroup":case"ExplicitGroup":case"ModernGroup":m=!0,t={emailAddress:e.EmailAddress.EmailAddress,displayName:e.DisplayName,personaTypeString:e.PersonaTypeString};break;case"Person":case"Guest":t={emailAddress:e.EmailAddress.EmailAddress,displayName:e.DisplayName,personaTypeString:e.PersonaTypeString};break;default:h.d("RecipientExpansionIgnoredPersonaType: "+e.PersonaTypeString)}t&&g.push(t)})),[4,R.import()]):[3,8];case 7:return _=r.sent(),Object(l.r)("SmallDLExpansionSucceess",[m]),c(e.recipient,m?i.a.SucceededWithDLOrGroupMembers:i.a.SucceededWithoutDLOrGroupMembers),_(e.recipient,g),[2];case 8:return[3,10];case 9:return y=r.sent(),Object(l.r)("SmallDLExpansionFailure",[y.message]),[3,10];case 10:return c(e.recipient,i.a.Failed),[2]}}))}))}Object(y.orchestrator)(o.b,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,c,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return x(e.linkIds)?[4,s.e.import()]:[2];case 1:t=r.sent(),n=t(e.recipientInfos,!e.isCalendar),c=n.filter((function(e){return e.recipient.expansionStatus===i.b.None})),a=0,r.label=2;case 2:return a<c.length?[4,H(c[a])]:[3,5];case 3:r.sent(),r.label=4;case 4:return a++,[3,2];case 5:return Object(o.d)(e.linkIds,e.recipientInfos,e.composeId,e.isCalendar),[2]}}))}))})),Object(y.orchestrator)(o.e,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return d(e.linkId)?(h.g.info("RecipientPermission: tryCheckPermForOneLink"),[4,u.s.import()]):[2];case 1:return t=r.sent(),n=t(e.recipientContainers,e.fromAddress),[4,a([e.linkId],n,e.composeId,e.isCalendar)];case 2:return 0===(o=r.sent()).length?[2]:[4,S(e.linkId,o,e.composeId)];case 3:return r.sent(),[2]}}))}))}));var N=n(3044);Object(y.orchestrator)(o.a,(function(e){Object(N.a)(e.composeId)&&Object(l.r)("checkPermPendingWhenSend")})),Object(y.orchestrator)(u.A,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return d(e.linkId)?[4,u.v.import()]:[2];case 1:return n.sent()(e.linkId),[4,a([e.linkId],e.recipientInfos,e.composeId,e.isCalendar)];case 2:return 0===(t=n.sent()).length?[2]:[4,S(e.linkId,t,e.composeId)];case 3:return n.sent(),[2]}}))}))}));var W=n(3494);Object(y.orchestrator)(k,(function(e){var t=Object(W.a)(e.composeId);t?t.pendingCheckPermCount>1?E(e.composeId,-1):w(e.composeId):h.d("Finish check perm while tracker has not logged start. ")})),Object(y.orchestrator)(O,(function(e){Object(W.a)(e.composeId)?E(e.composeId,1):C(e.composeId)})),Object(y.orchestrator)(o.c,(function(e){E(e.composeId,-1)}));var L=n(3649);Object(y.mutator)(C,(function(e){Object(L.a)().permissionCheckers.set(e.composeId,{pendingCheckPermCount:1})})),Object(y.mutator)(w,(function(e){Object(L.a)().permissionCheckers.delete(e.composeId)})),Object(y.mutator)(E,(function(e){var t=Object(W.a)(e.composeId);t&&(t.pendingCheckPermCount=t.pendingCheckPermCount+e.offset)})),n.d(t,"tryCheckPermForLinks",(function(){return o.d})),n.d(t,"tryCheckPermForOneLink",(function(){return o.e})),n.d(t,"expandGroupsAndSmallDLs",(function(){return o.b})),n.d(t,"onRemoveLink",(function(){return o.c}))},616:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,o=!1,i=function(s,c){o?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return s(e)})).catch((function(e){t&&r>=t?c(e):setTimeout((function(){return i(s,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return i(e,t)}))},cancel:function(){return o=!0}}}}function o(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},671:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(1),o=r.createContext({window:"object"==typeof window?window:void 0}),i=function(){return r.useContext(o).window},s=function(){var e;return null===(e=r.useContext(o).window)||void 0===e?void 0:e.document},c=function(e){return r.createElement(o.Provider,{value:e},e.children)}},693:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},702:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n(270),i=n(262),s=n(143),c=function(){function e(){this.keytips={},this.persistedKeytips={},this.sequenceMapping={},this.inKeytipMode=!1,this.shouldEnterKeytipMode=!0,this.delayUpdatingKeytipChange=!1}return e.getInstance=function(){return this._instance},e.prototype.init=function(e){this.delayUpdatingKeytipChange=e},e.prototype.register=function(e,t){void 0===t&&(t=!1);var n=e;t||(n=this.addParentOverflow(e),this.sequenceMapping[n.keySequences.toString()]=n);var r=this._getUniqueKtp(n);if(t?this.persistedKeytips[r.uniqueID]=r:this.keytips[r.uniqueID]=r,this.inKeytipMode||!this.delayUpdatingKeytipChange){var i=t?s.i.PERSISTED_KEYTIP_ADDED:s.i.KEYTIP_ADDED;o.a.raise(this,i,{keytip:n,uniqueID:r.uniqueID})}return r.uniqueID},e.prototype.update=function(e,t){var n=this.addParentOverflow(e),r=this._getUniqueKtp(n,t),i=this.keytips[t];i&&(r.keytip.visible=i.keytip.visible,this.keytips[t]=r,delete this.sequenceMapping[i.keytip.keySequences.toString()],this.sequenceMapping[r.keytip.keySequences.toString()]=r.keytip,!this.inKeytipMode&&this.delayUpdatingKeytipChange||o.a.raise(this,s.i.KEYTIP_UPDATED,{keytip:r.keytip,uniqueID:r.uniqueID}))},e.prototype.unregister=function(e,t,n){void 0===n&&(n=!1),n?delete this.persistedKeytips[t]:delete this.keytips[t],!n&&delete this.sequenceMapping[e.keySequences.toString()];var r=n?s.i.PERSISTED_KEYTIP_REMOVED:s.i.KEYTIP_REMOVED;!this.inKeytipMode&&this.delayUpdatingKeytipChange||o.a.raise(this,r,{keytip:e,uniqueID:t})},e.prototype.enterKeytipMode=function(){o.a.raise(this,s.i.ENTER_KEYTIP_MODE)},e.prototype.exitKeytipMode=function(){o.a.raise(this,s.i.EXIT_KEYTIP_MODE)},e.prototype.getKeytips=function(){var e=this;return Object.keys(this.keytips).map((function(t){return e.keytips[t].keytip}))},e.prototype.addParentOverflow=function(e){var t=Object(r.__spreadArrays)(e.keySequences);if(t.pop(),0!==t.length){var n=this.sequenceMapping[t.toString()];if(n&&n.overflowSetSequence)return Object(r.__assign)(Object(r.__assign)({},e),{overflowSetSequence:n.overflowSetSequence})}return e},e.prototype.menuExecute=function(e,t){o.a.raise(this,s.i.PERSISTED_KEYTIP_EXECUTE,{overflowButtonSequences:e,keytipSequences:t})},e.prototype._getUniqueKtp=function(e,t){return void 0===t&&(t=Object(i.a)()),{keytip:Object(r.__assign)({},e),uniqueID:t}},e._instance=new e,e}()},703:function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(396),s=n(517),c=n(516),a=n(12),u=n(220),d=n(397),l=n(453),p=Object(u.c)((function(e,t){var n,r=Object(d.a)(e),o=Object(l.a)(e),i=e.palette,s={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:e.semanticColors.link},rootHovered:{color:i.themeDarkAlt,backgroundColor:i.neutralLighter,selectors:(n={},n[a.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},n)},rootHasMenu:{width:"auto"},rootPressed:{color:i.themeDark,backgroundColor:i.neutralLight},rootExpanded:{color:i.themeDark,backgroundColor:i.neutralLight},rootChecked:{color:i.themeDark,backgroundColor:i.neutralLight},rootCheckedHovered:{color:i.themeDark,backgroundColor:i.neutralQuaternaryAlt},rootDisabled:{color:i.neutralTertiaryAlt}};return Object(a.concatStyleSets)(r,s,o,t)}));n.d(t,"a",(function(){return f}));var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return o.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:"ms-Button--icon",styles:p(n,t),onRenderText:s.b,onRenderDescription:s.b}))},t=Object(r.__decorate)([Object(c.a)("IconButton",["theme","styles"],!0)],t)}(o.Component)},706:function(e,t,n){"use strict";var r=n(44),o={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return o}));var i=new r.c((function(){return Promise.all([n.e(3),n.e(23),n.e(664)]).then(n.bind(null,17142))})),s=new r.a(i,(function(e){return e.subscribe})),c=new r.a(i,(function(e){return e.unsubscribe})),a=new r.b(i,(function(e){return e.getChannelId})),u=(new r.b(i,(function(e){return e.getChannelReady})),new r.a(i,(function(e){return e.setup}))),d=new r.a(i,(function(e){return e.initializeNotificationManager})),l=new r.b(i,(function(e){return e.getNotificationEmitter}))},711:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e})),t.current}},713:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(125);function o(e){for(var t,n=[],o=Object(r.a)(e)||document;e!==o.body;){for(var i=0,s=e.parentElement.children;i<s.length;i++){var c=s[i];c!==e&&"true"!==(null===(t=c.getAttribute("aria-hidden"))||void 0===t?void 0:t.toLowerCase())&&n.push(c)}if(!e.parentElement)break;e=e.parentElement}return n.forEach((function(e){e.setAttribute("aria-hidden","true")})),function(){!function(e){e.forEach((function(e){e.setAttribute("aria-hidden","false")}))}(n),n=[]}}},7202:function(e,t,n){"use strict";var r=n(1046);n.d(t,"b",(function(){return r.b}));var o=n(1049);n.d(t,"a",(function(){return o.a}))},790:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},816:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28),o=n(1e3);function i(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(r.a)("GetPersona",e,t)}},820:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"GetPersonaRequest:#Exchange"},e)}},883:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(1),i=n(517),s=n(516),c=n(521),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){return o.createElement(c.a,Object(r.__assign)({},this.props,{primary:!0,onRenderDescription:i.b}))},t=Object(r.__decorate)([Object(s.a)("PrimaryButton",["theme","styles"],!0)],t)}(o.Component)},886:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),o=n(1),i=n(713),s=n(217),c=n(72),a=n(310),u=n(55),d=n(308),l=n(125),p=function(e){function t(n){var r=e.call(this,n)||this;return r._root=o.createRef(),r._firstBumper=o.createRef(),r._lastBumper=o.createRef(),r._hasFocus=!1,r._onRootFocus=function(e){r.props.onFocus&&r.props.onFocus(e),r._hasFocus=!0},r._onRootBlur=function(e){r.props.onBlur&&r.props.onBlur(e);var t=e.relatedTarget;null===e.relatedTarget&&(t=r._getDocument().activeElement),Object(s.a)(r._root.current,t)||(r._hasFocus=!1)},r._onFirstBumperFocus=function(){r._onBumperFocus(!0)},r._onLastBumperFocus=function(){r._onBumperFocus(!1)},r._onBumperFocus=function(e){if(!r.props.disabled){var t=e===r._hasFocus?r._lastBumper.current:r._firstBumper.current;if(r._root.current){var n=e===r._hasFocus?Object(c.i)(r._root.current,t,!0,!1):Object(c.f)(r._root.current,t,!0,!1);n&&(r._isBumper(n)?r.focus():n.focus())}}},r._onFocusCapture=function(e){r.props.onFocusCapture&&r.props.onFocusCapture(e),e.target===e.currentTarget||r._isBumper(e.target)||(r._previouslyFocusedElementInTrapZone=e.target)},r._forceFocusInTrap=function(e){if(!r.props.disabled&&t._focusStack.length&&r===t._focusStack[t._focusStack.length-1]){var n=r._getDocument().activeElement;Object(s.a)(r._root.current,n)||(r.focus(),r._hasFocus=!0,e.preventDefault(),e.stopPropagation())}},r._forceClickInTrap=function(e){if(!r.props.disabled&&t._focusStack.length&&r===t._focusStack[t._focusStack.length-1]){var n=e.target;n&&!Object(s.a)(r._root.current,n)&&(r.focus(),r._hasFocus=!0,e.preventDefault(),e.stopPropagation())}},Object(a.a)(r),r}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this._bringFocusIntoZone(),this._updateEventHandlers(this.props),!this.props.disabled&&this._root.current&&this.props.enableAriaHiddenSiblings&&(this._unmodalize=Object(i.a)(this._root.current))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.elementToFocusOnDismiss;t&&this._previouslyFocusedElementOutsideTrapZone!==t&&(this._previouslyFocusedElementOutsideTrapZone=t),this._updateEventHandlers(e)},t.prototype.componentDidUpdate=function(e){var t=void 0===e.forceFocusInsideTrap||e.forceFocusInsideTrap,n=void 0===this.props.forceFocusInsideTrap||this.props.forceFocusInsideTrap,r=void 0!==e.disabled&&e.disabled,o=void 0!==this.props.disabled&&this.props.disabled;!t&&n||r&&!o?(this._bringFocusIntoZone(),!this._unmodalize&&this._root.current&&this.props.enableAriaHiddenSiblings&&(this._unmodalize=Object(i.a)(this._root.current))):(t&&!n||!r&&o)&&(this._returnFocusToInitiator(),this._unmodalize&&this._unmodalize())},t.prototype.componentWillUnmount=function(){this.props.disabled&&!this.props.forceFocusInsideTrap&&Object(s.a)(this._root.current,this._getDocument().activeElement)||this._returnFocusToInitiator(),this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0),this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),this._unmodalize&&this._unmodalize(),delete this._previouslyFocusedElementInTrapZone,delete this._previouslyFocusedElementOutsideTrapZone},t.prototype.render=function(){var e=this.props,t=e.className,n=e.disabled,i=void 0!==n&&n,s=e.ariaLabelledBy,c=Object(u.j)(this.props,u.h),a={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:i?-1:0,"data-is-visible":!0};return o.createElement("div",Object(r.__assign)({},c,{className:t,ref:this._root,"aria-labelledby":s,onFocusCapture:this._onFocusCapture,onFocus:this._onRootFocus,onBlur:this._onRootBlur}),o.createElement("div",Object(r.__assign)({},a,{ref:this._firstBumper,onFocus:this._onFirstBumperFocus})),this.props.children,o.createElement("div",Object(r.__assign)({},a,{ref:this._lastBumper,onFocus:this._onLastBumperFocus})))},t.prototype.focus=function(){var e=this.props,t=e.focusPreviouslyFocusedInnerElement,n=e.firstFocusableSelector,r=e.firstFocusableTarget;if(t&&this._previouslyFocusedElementInTrapZone&&Object(s.a)(this._root.current,this._previouslyFocusedElementInTrapZone))this._focusAsync(this._previouslyFocusedElementInTrapZone);else{var o="string"==typeof n?n:n&&n(),i=null;this._root.current&&("string"==typeof r?i=this._root.current.querySelector(r):r?i=r(this._root.current):o&&(i=this._root.current.querySelector("."+o)),i||(i=Object(c.j)(this._root.current,this._root.current.firstChild,!1,!1,!1,!0))),i&&this._focusAsync(i)}},t.prototype._focusAsync=function(e){this._isBumper(e)||Object(c.b)(e)},t.prototype._bringFocusIntoZone=function(){var e=this.props,n=e.elementToFocusOnDismiss,r=e.disabled,o=void 0!==r&&r,i=e.disableFirstFocus,c=void 0!==i&&i;o||(t._focusStack.push(this),this._previouslyFocusedElementOutsideTrapZone=n||this._getDocument().activeElement,c||Object(s.a)(this._root.current,this._previouslyFocusedElementOutsideTrapZone)||this.focus())},t.prototype._returnFocusToInitiator=function(){var e=this,n=this.props.ignoreExternalFocusing;t._focusStack=t._focusStack.filter((function(t){return e!==t}));var r=this._getDocument(),o=r.activeElement;n||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!Object(s.a)(this._root.current,o)&&o!==r.body||this._focusAsync(this._previouslyFocusedElementOutsideTrapZone)},t.prototype._updateEventHandlers=function(e){var t=e.isClickableOutsideFocusTrap,n=void 0!==t&&t,r=e.forceFocusInsideTrap,o=void 0===r||r;o&&!this._disposeFocusHandler?this._disposeFocusHandler=Object(d.a)(window,"focus",this._forceFocusInTrap,!0):!o&&this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),n||this._disposeClickHandler?n&&this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0):this._disposeClickHandler=Object(d.a)(window,"click",this._forceClickInTrap,!0)},t.prototype._isBumper=function(e){return e===this._firstBumper.current||e===this._lastBumper.current},t.prototype._getDocument=function(){return Object(l.a)(this._root.current)},t._focusStack=[],t}(o.Component)}}]);
//# sourceMappingURL=owa.MailBoot~RecipientPermissionChecker.js.map
self.scriptsLoaded['owa.MailBoot~RecipientPermissionChecker.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~RecipientPermissionChecker.js'] = (new Date()).getTime();