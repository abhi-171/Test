self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~BulkActions~TriageAction.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[220],{10239:function(n,t,e){"use strict";var r=e(188);t.a=Object(r.action)("clearTableViewLastEmptiedTime")((function(n){n.lastEmptiedTime=null}))},1710:function(n,t,e){"use strict";e.d(t,"b",(function(){return o})),e.d(t,"c",(function(){return c})),e.d(t,"d",(function(){return a})),e.d(t,"a",(function(){return d}));var r=e(1999),u=e(25),i=e(1746);function o(){return s(r.a.Bottom)}function c(){return s(r.a.Off)}function a(){return s(r.a.Right)}function s(n){var t=Object(i.a)();return null!==t.clientReadingPanePosition?t.clientReadingPanePosition===n:Object(u.a)().UserOptions.GlobalReadingPanePositionReact==n}function d(){var n=Object(u.a)().UserOptions.GlobalReadingPanePositionReact;return n==r.a.Off||n==r.a.Bottom}},1740:function(n,t,e){"use strict";var r=e(3),u=e(52),i=e(1633),o=Object(r.action)("selectFocusedViewFilter",(function(n,t){return Object(u.c)({name:0===n?"TnS_SelectFocusedPivot":"TnS_SelectOtherPivot",options:{isCore:!0},customData:[n,t,null!=i.X.inboxPausedDateTime]},{focusedViewFilter:n,actionSource:t})})),c=Object(r.action)("ON_INITIAL_TABLE_LOAD_COMPLETE",(function(n){return{tableView:n}}));var a=e(16);var s=Object(r.mutatorAction)("addTableViewToStore",(function(n,t){t.set(n.id,n)}));function d(n,t){var e=Object(i.J)().tableViews,r=function(n){var t=[];switch(n.type){case 0:t.push("folderId:"+n.folderId);var e=n;t.push("lVT:"+n.listViewType),t.push("vF:"+e.viewFilter),t.push("fVF:"+e.focusedViewFilter),t.push("sC:"+e.sortBy.sortColumn),t.push("sD:"+e.sortBy.sortDirection),e.categoryName&&t.push("catName:"+e.categoryName),t.push("sT:"+e.scenarioType);break;case 1:t.push("folderId:"+n.folderId);var r=n;t.push("id:"+r.searchNumber),t.push("query:"+r.queryString),t.push("lVT:"+n.listViewType),t.push("sT:"+r.scenarioType);break;case 2:t.push("gId:"+n.folderId);var u=n;t.push("lVT:"+n.listViewType),t.push("vF:"+u.viewFilter)}return t.join(";").toString()}(n),u=e.get(r);if(!u&&(u=function(n,t){return{currentLoadedIndex:0,loadErrorStatus:0,id:n,isInCheckedMode:!1,isInVirtualSelectAllMode:!1,isInitialLoadComplete:!1,isLoading:!0,rowKeys:[],rowIdToRowKeyMap:new a.ObservableMap,lastEmptiedTime:null,selectAllModeTimeStamp:null,selectedRowKeys:new a.ObservableMap,serverFolderId:t.folderId,tableQuery:t,totalRowsInView:0,virtualSelectAllExclusionList:[],selectionAnchorRowKey:null,focusedRowKey:null,multiSelectionAnchorRowKey:null}}(r,n),!t)){var o=u.id;s(u,e),u=e.get(o)}return u}e.d(t,"a",(function(){return 25})),e.d(t,"b",(function(){return 25})),e.d(t,"e",(function(){return o})),e.d(t,"d",(function(){return c})),e.d(t,"c",(function(){return d}))},1746:function(n,t,e){"use strict";e.d(t,"a",(function(){return u}));var r=e(3),u=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0})},1850:function(n,t,e){"use strict";e.d(t,"a",(function(){return u}));var r=e(2025);function u(n){return n&&Object(r.b)(n.ItemClass)}},1999:function(n,t,e){"use strict";var r;!function(n){n[n.Off=0]="Off",n[n.Right=1]="Right",n[n.Bottom=2]="Bottom"}(r||(r={})),t.a=r},2014:function(n,t,e){"use strict";function r(n){return n.match(/^ipm\.schedule\.meeting\.request/i)}e.d(t,"a",(function(){return r}))},2022:function(n,t,e){"use strict";var r=e(44),u=e(2077),i=e(2122),o=e(2078),c=e(2014),a=e(2079),s=e(2046),d=e(2123);function f(n){var t=n;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function l(n){return!!n.RecurrenceId}e.d(t,"s",(function(){return h})),e.d(t,"t",(function(){return m})),e.d(t,"w",(function(){return v})),e.d(t,"d",(function(){return g})),e.d(t,"g",(function(){return w})),e.d(t,"h",(function(){return O})),e.d(t,"b",(function(){return p})),e.d(t,"f",(function(){return j})),e.d(t,"e",(function(){return I})),e.d(t,"i",(function(){return y})),e.d(t,"j",(function(){return R})),e.d(t,"a",(function(){return T})),e.d(t,"c",(function(){return k})),e.d(t,"v",(function(){return M})),e.d(t,"u",(function(){return C})),e.d(t,"k",(function(){return u.a})),e.d(t,"x",(function(){return i.a})),e.d(t,"m",(function(){return o.a})),e.d(t,"q",(function(){return c.a})),e.d(t,"r",(function(){return a.a})),e.d(t,"l",(function(){return s.a})),e.d(t,"o",(function(){return d.a})),e.d(t,"p",(function(){return f})),e.d(t,"n",(function(){return l}));var b=new r.c((function(){return Promise.all([e.e(0),e.e(1),e.e(2),e.e(3),e.e(6),e.e(15),e.e(17),e.e(22),e.e(23),e.e(25),e.e(28),e.e(31),e.e(42),e.e(57),e.e(130),e.e(131),e.e(260),e.e(255),e.e(652)]).then(e.bind(null,17094))})),h=new r.a(b,(function(n){return n.addItemToCalendar})),m=new r.a(b,(function(n){return n.initializeMeetingRequestViewStateAction})),v=new r.a(b,(function(n){return n.removeCancelledMeetingFromCalendar})),g=Object(r.d)(b,(function(n){return n.MeetingMessageInfo})),w=(Object(r.d)(b,(function(n){return n.MeetingRequestActions})),Object(r.d)(b,(function(n){return n.MeetingCancellationAction})),Object(r.d)(b,(function(n){return n.MeetingActionButton})),Object(r.d)(b,(function(n){return n.MeetingDetailsTime})),Object(r.d)(b,(function(n){return n.MeetingDetailsLocation})),Object(r.d)(b,(function(n){return n.MeetingRequestInfo}))),O=Object(r.d)(b,(function(n){return n.MeetingRequestResponseEditor})),p=Object(r.d)(b,(function(n){return n.MeetingDetails})),j=Object(r.d)(b,(function(n){return n.MeetingRequestConflicts})),I=(Object(r.d)(b,(function(n){return n.EditEventLink})),Object(r.d)(b,(function(n){return n.MeetingMessageSummary}))),y=Object(r.d)(b,(function(n){return n.PreviewSummary})),R=Object(r.d)(b,(function(n){return n.SenderSummary})),T=Object(r.d)(b,(function(n){return n.CollapsedMeetingMessage})),k=Object(r.d)(b,(function(n){return n.MeetingIcon})),M=new r.a(b,(function(n){return n.logMeetingMessageActionForInvite})),C=new r.a(b,(function(n){return n.logMeetingMessageActionForEvent}))},2046:function(n,t,e){"use strict";function r(n){return n.match(/^ipm\.schedule\.meeting\.canceled/i)}e.d(t,"a",(function(){return r}))},2075:function(n,t,e){"use strict";e.d(t,"a",(function(){return u}));var r=e(1746);function u(){return Object(r.a)().showReadingPane}},2077:function(n,t,e){"use strict";var r=e(3);t.a=Object(r.action)("deleteMeetingMessage",(function(n,t){return{item:n,issueDeleteItemCall:t}}))},2078:function(n,t,e){"use strict";function r(n){return(null==n?void 0:n.ItemClass)&&n.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}e.d(t,"a",(function(){return r}))},2079:function(n,t,e){"use strict";function r(n){return n.match(/^ipm\.schedule\.meeting\.resp/i)}e.d(t,"a",(function(){return r}))},2119:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(1710),u=e(2075);function i(){return Object(r.c)()&&Object(u.a)()}},2122:function(n,t,e){"use strict";var r=e(3);t.a=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(function(n,t){return{status:n,sxsId:t}}))},2123:function(n,t,e){"use strict";function r(n){var t=n;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}e.d(t,"a",(function(){return r}))},2468:function(n,t,e){"use strict";var r=e(3),u=Object(r.action)("ON_NUDGE_REMOVED",(function(n){return{rowKey:n}})),i=Object(r.action)("ON_GET_NUDGES_COMPLETED",(function(n,t){return{nudgedRows:n,tableView:t}})),o=Object(r.createStore)("nudgeStore",{nudgedRows:[]}),c=o();Object(r.mutator)(i,(function(n){c.nudgedRows=n.nudgedRows})),Object(r.mutator)(u,(function(n){for(var t=c.nudgedRows.length-1;t>=0;t--)c.nudgedRows[t].rowKey===n.rowKey&&c.nudgedRows.splice(t,1)}));var a=e(4369),s=e(7);function d(n){var t=c.nudgedRows.filter((function(t){return t.rowKey===n}))[0],e=t.daysAgo,r=0==t.reason;return 0==e?r?Object(s.b)(a.c):Object(s.b)(a.f):1==e?r?Object(s.b)(a.b):Object(s.b)(a.e):r?Object(s.c)(Object(s.b)(a.a),e):Object(s.c)(Object(s.b)(a.d),e)}var f=e(1633);function l(n,t){return c.nudgedRows.some((function(e){return e.rowKey===n&&e.tableViewId===t||"testNudgeRowKey"==n}))}var b=e(4162);function h(n,t,e){return!!l(n,t)&&(!!Object(b.c)(t)&&!Object(f.v)(e))}function m(n){var t=c.nudgedRows.filter((function(t){return t.conversationId===n}));return t.length>0&&g(t[0])?t[0].rowKey:null}function v(n){var t=c.nudgedRows.filter((function(t){return t.itemId===n}));return t.length>0&&g(t[0])?t[0].rowKey:null}function g(n){var t=n.tableViewId,e=Object(f.J)().tableViews.get(t);if(!e||e.id!=Object(f.H)())return!1;var r=n.rowKey;return h(r,t,f.b.getLastDeliveryOrRenewTimeStamp(r,e))}function w(n){var t=c.nudgedRows.filter((function(t){return t.rowKey===n}));return t.length>0?t[0].itemId:null}e.d(t,"c",(function(){return d})),e.d(t,"e",(function(){return v})),e.d(t,"d",(function(){return m})),e.d(t,"b",(function(){return w})),e.d(t,"a",(function(){return h})),e.d(t,"g",(function(){return l})),e.d(t,"f",(function(){return o})),e.d(t,"h",(function(){return i})),e.d(t,"i",(function(){return u}))},271:function(n,t,e){"use strict";var r;!function(n){n.Mail="Mail",n.Calendar="Calendar",n.People="People",n.FilesHub="FilesHub",n.Tasks="Tasks",n.OutlookSpaces="OutlookSpaces",n.Eventify="Eventify",n.PublishedCalendar="PublishedCalendar",n.MailDeepLink="MailDeepLink"}(r||(r={})),e.d(t,"a",(function(){return r}))},3010:function(n,t,e){"use strict";e.d(t,"a",(function(){return u}));var r=e(1746);function u(){return Object(r.a)().showListPane}},309:function(n,t,e){"use strict";e.d(t,"b",(function(){return i})),e.d(t,"e",(function(){return o})),e.d(t,"d",(function(){return c})),e.d(t,"c",(function(){return a})),e.d(t,"a",(function(){return s}));var r=e(9),u=new r.b((function(){return Promise.all([e.e(38),e.e(47),e.e(102),e.e(145),e.e(480)]).then(e.bind(null,736))})),i=new r.a(u,(function(n){return n.createApolloClient})),o=new r.a(u,(function(n){return n.wrapInApolloProvider})),c=new r.a(u,(function(n){return n.unblockBootResolvers})),a=new r.a(u,(function(n){return n.getApolloClient})),s=new r.c(u,(function(n){return n.ApolloProvider}))},3255:function(n,t,e){"use strict";var r=e(44),u=e(1633),i=e(1716),o=e(1640),c=e(1673),a=e(1895);var s=e(1850),d=e(188);function f(n,t){if(t.folderId&&"junkemail"==Object(c.a)(t.folderId))return!1;if(Object(s.a)(n))return!1;var e=o.u.items.get(n.ItemId.Id);return!(null==e||!e.shouldShowAttachmentPreviews)||!(!n.HasAttachments&&!n.HasProcessedSharepointLink)&&(m.importAndExecute(Object(i.d)(t),n.ConversationId,n.ItemId.Id),!0)}var l=Object(d.select)({listViewStore:function(){return u.X}})((function(n,t,e){var r,u,o,s=1==t.type,d=n.ConversationId,f=e.listViewStore.conversationItems.get(d.Id),l=n.HasProcessedSharepointLink;if(t.folderId&&"junkemail"==Object(c.a)(t.folderId))return!1;if((null==(r=n)?void 0:r.ItemClasses)&&r.ItemClasses.length>0&&r.ItemClasses.some((function(n){return 0===n.indexOf(a.a)})))return!1;if(s){if(f)return f.shouldShowAttachmentPreviews;u=o=!!n.HasAttachments}else{if(!n.HasAttachmentPreviews&&!l)return!1;f&&!l?(u=f.globalItemIds.length!=n.GlobalItemIds.length,o=f.shouldShowAttachmentPreviews):(u=!0,o=!0)}return u&&m.importAndExecute(Object(i.d)(t),n.ConversationId,null),o}));e.d(t,"b",(function(){return h})),e.d(t,"a",(function(){return m})),e.d(t,"c",(function(){return v})),e.d(t,"d",(function(){return g})),e.d(t,"e",(function(){return l})),e.d(t,"f",(function(){return f}));var b=new r.c((function(){return e.e(481).then(e.bind(null,17328))})),h=new r.a(b,(function(n){return n.getPreviews})),m=new r.a(b,(function(n){return n.add})),v=new r.a(b,(function(n){return n.getAttachmentsForConversationWell})),g=new r.a(b,(function(n){return n.removeAttachmentPreviewsForRow}))},3274:function(n,t,e){"use strict";e.d(t,"a",(function(){return u})),e.d(t,"b",(function(){return i}));var r=e(85);function u(n){return!!(n&Object(r.h)().ViewStateConfiguration.FocusedInboxBitFlags)}function i(n,t){u(t)!==n&&Object(r.y)((function(e){n?e.ViewStateConfiguration.FocusedInboxBitFlags|=t:e.ViewStateConfiguration.FocusedInboxBitFlags&=~t}))}},341:function(n,t,e){"use strict";e.d(t,"a",(function(){return c})),e.d(t,"b",(function(){return a})),e.d(t,"c",(function(){return s}));var r=e(0),u=e(309),i=null,o=null;function c(){return d(i),i}function a(){return d(o),o}function s(n){var t=n.lazyResolvers,e=n.lazyLocalStateResolvers,c=n.lazyCreateManagedQueryLink,a=n.context;return i=Promise.all([u.b.import(),t,e,c]).then((function(n){var t=Object(r.__read)(n,4),e=t[0],u=t[1],i=t[2],c=t[3];return o=e({resolvers:u,localStateResolvers:i,createManagedQueryLink:c,context:a})}))}function d(n){if(!n)throw new Error("Apollo client has not been initialized yet.")}},380:function(n,t,e){"use strict";var r=e(341);e.d(t,"a",(function(){return r.a})),e.d(t,"b",(function(){return r.c}));var u=e(309);e.d(t,"c",(function(){return u.a})),e.d(t,"d",(function(){return u.c})),e.d(t,"e",(function(){return u.d})),e.d(t,"f",(function(){return u.e}))},4162:function(n,t,e){"use strict";e.d(t,"b",(function(){return d})),e.d(t,"c",(function(){return b})),e.d(t,"a",(function(){return h}));var r=e(40),u=e(3397),i=e(957),o=e(1633),c=e(3274),a=e(25),s=e(296);function d(){var n=Object(s.a)(),t=n&&Object(r.i)("tri-nudge-consumer"),e=!n&&Object(r.i)("tri-nudge");return Object(a.a)().UserOptions.MessageRemindersEnabled&&(e||t)&&!Object(c.a)(16)}function f(n){return n===Object(i.a)("inbox")||n===Object(i.a)("sentitems")}function l(n,t){if(0!=n.tableQuery.type)return!1;if("All"!=Object(o.O)(n))return!1;var e=Object(o.l)(n);if(0!=e&&-1!=e)return!1;var r=Object(o.I)(n);return 1==r.sortColumn&&r.sortDirection==u.DESCENDING_SORT_DIR}function b(n){var t=o.X.tableViews.get(n),e=t.tableQuery.folderId;return!!f(e)&&l(t)}function h(n){return!!f(n)&&l(Object(o.G)())}},424:function(n,t,e){"use strict";var r=function(){function n(n,t,e){this.maxParallelTasks=n,this.taskCallback=t,this.taskDelay=e,this.taskList=[],this.numberOfTasksRunning=0}return n.prototype.add=function(n){this.taskList.unshift(n),this.scheduleTask()},n.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},n.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},n.prototype.scheduleTask=function(){var n=this;this.canRunMoreTasks()&&setTimeout((function(){n.tryRunTask()}),this.taskDelay)},n.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},n.prototype.tryRunTask=function(){var n=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){n.onTaskComplete()})).catch((function(){n.onTaskComplete()})),this.scheduleTask()}},n}();e.d(t,"a",(function(){return r}))},429:function(n,t,e){"use strict";function r(n,t){var e=Math.pow(2,32);if(n>=e||t>=e){var r=n%e,u=t%e;return(((n-=r)/e&(t-=u)/e)>>>0)*e+((r&u)>>>0)}return(n&t)>>>0}e.d(t,"a",(function(){return r}))},4369:function(n){n.exports=JSON.parse('{"c":"S1b","b":"T1b","a":"U1b","f":"V1b","e":"W1b","d":"X1b"}')},730:function(n,t,e){"use strict";e.d(t,"a",(function(){return r})),e.d(t,"b",(function(){return u}));var r=1,u=16}}]);
//# sourceMappingURL=owa.MailBoot~BulkActions~TriageAction.js.map
self.scriptsLoaded['owa.MailBoot~BulkActions~TriageAction.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~BulkActions~TriageAction.js'] = (new Date()).getTime();