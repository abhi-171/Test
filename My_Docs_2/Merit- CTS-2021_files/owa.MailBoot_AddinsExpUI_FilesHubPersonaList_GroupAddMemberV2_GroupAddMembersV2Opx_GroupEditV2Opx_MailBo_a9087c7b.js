self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupAddMemberV2~GroupAddMembersV2Opx~GroupEditV2Opx~MailBo~a9087c7b.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[52],{1653:function(e,t,r){"use strict";r.r(t);var n=r(44),o=r(3),a=r(2477),i=r(7080),u=r(7081),c=r(7082);Object(o.mutator)(a.a,(function(e){var t=e.temporaryData,r=e.favoriteData,n=e.newIndex;Object(u.a)(t),Object(c.b)(t),Object(i.a)(r,n)})),Object(o.mutator)(a.c,(function(e){var t=e.favoriteData,r=e.newIndex;Object(i.a)(t,r),Object(c.a)(t)})),Object(o.mutator)(a.d,(function(e){var t=e.favoriteData;Object(i.a)(t)})),Object(o.mutator)(a.b,(function(e){var t=e.favoriteData;Object(c.b)(t),Object(u.a)(t)})),Object(o.mutator)(a.e,(function(e){var t=e.temporaryFavorites,r=e.favoritesData;t.forEach((function(e){Object(u.a)(e)})),r.forEach((function(e){Object(i.a)(e)}))})),Object(o.mutator)(a.f,(function(e){e.favoritesData.forEach((function(e){Object(i.a)(e)}))}));var s=r(2011),d=Object(o.action)("ADD_TO_ORDERED_FAVORITE_ID_LIST",(function(e){return{favoriteId:e}})),f=(Object(o.mutator)(d,(function(e){s.a.orderedOutlookFavoritesIds.push(e.favoriteId)})),r(5109)),l=(Object(o.mutator)(f.a,(function(e){s.a.favoritesLoaded=!0})),r(0)),v=Object(o.action)("ADD_NEW_MAILBOX_DEFAULT_FAVORITES"),b=r(957),p=r(1634),O=r(2912);function F(e,t,r){return{folderId:t.FolderId.Id,treeType:"favorites",type:"folder",favoriteId:e,displayName:Object(p.j)(t),client:r?"MigrateDefault":"OWA"}}function y(e,t){return{Type:"folder",DisplayName:Object(p.j)(e),SingleValueSettings:[{Key:"FolderId",Value:Object(se.a)(e.FolderId.Id)}],Client:t?"MigrateDefault":"OWA"}}var m=r(208),j=r(3748),g=r(178),I=r(4154);function h(e){return Object(I.a)((function(){return Object(g.d)(j.a+"/Create",e,void 0,!0,null,!0)}))}Object(o.orchestrator)(v,(function(e){return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e,t,r,n,o,i,u,c,s,d,f,v,j,g,I;return Object(l.__generator)(this,(function(S){switch(S.label){case 0:e=[Object(b.a)("inbox"),Object(b.a)("drafts"),Object(b.a)("archive")],t=[],r=[];try{for(n=Object(l.__values)(e),o=n.next();!o.done;o=n.next())i=o.value,u=Object(m.a)(),c=p.d.folderTable.get(i),s=y(c,!0),d=F(u,c,!0),t.push(s),r.push(d)}catch(e){g={error:e}}finally{try{o&&!o.done&&(I=n.return)&&I.call(n)}finally{if(g)throw g.error}}S.label=1;case 1:return S.trys.push([1,3,,4]),[4,h(t)];case 2:return f=S.sent(),v=(f.value||[]).map((function(e){return Object(O.a)(e,"folder")})),Object(a.e)(r,v),[3,4];case 3:return j=S.sent(),r.forEach((function(e){return Object(a.b)(j,e)})),[3,4];case 4:return[2]}}))}))}));var S=r(2396),w=r(4718),A=r(25),N=r(3077),D=r(6033),_=r(52),T=Object(o.action)("MIGRATE_OUTLOOK_FAVORITES",(function(){return Object(_.c)(D.a.MigrateOutlookFavorites)})),C=r(884),E=r(40),V=r(134),M=r(3749);var k=36e5;function P(){return Object(l.__awaiter)(this,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(t){switch(t.label){case 0:return s.a.favoritesLoaded?[2]:(0===p.d.folderTable.size&&Object(p.x)(),[4,L()]);case 1:return t.sent(),e=Object(M.a)(2),Object(M.a)(16)||T(),e||(0==s.a.orderedOutlookFavoritesIds.length&&(O=new Date(Object(A.a)().MailboxCreateDate),Date.now()-O.getTime()<k)&&v(),Ve.importAndExecute(2)),Object(f.a)(),r=Object(l.__spread)(s.a.outlookFavorites.values()),n=r.filter((function(e){return"folder"===e.type})),o=n.filter((function(e){return"Migration"===e.client})),a=r.filter((function(e){return"category"===e.type})),i=a.filter((function(e){return"Migration"==e.client})),u=r.filter((function(e){return"persona"===e.type})),c=u.filter((function(e){return"Migration"==e.client})),d=r.filter((function(e){return"group"===e.type})),b=r.filter((function(e){return"privatedistributionlist"===e.type})),Object(V.r)("LoadOutlookFavorites",[n.length,d.length,a.length,u.length,b.length,o.length,i.length,c.length]),[2]}var r,n,o,a,i,u,c,d,b,O}))}))}function L(){var e,t;return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,n,o,i,u;return Object(l.__generator)(this,(function(c){switch(c.label){case 0:if(r=Object(A.a)(),n=null===(e=Object(N.a)())||void 0===e?void 0:e.value,o=null===(t=null==r?void 0:r.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon,n||o)return[3,5];i=void 0,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Object(g.b)(j.a,void 0,!1,void 0,!0)];case 2:return i=c.sent(),[3,4];case 3:return u=c.sent(),Object(V.r)("GetOutlookFavoritesRetryFailed",{errorMessage:u.toString()}),[2];case 4:if(!(n=null==i?void 0:i.value))return[2];Object(V.r)("FavoritesRetrySuccess"),c.label=5;case 5:return null==n||n.forEach((function(e){var t=e.Type.toLocaleLowerCase(),r=null;try{switch(r=Object(O.a)(e,t),t){case"folder":!function(e,t){(function(e,t){if(0===p.d.folderTable.size)return!1;return!s.a.outlookFavorites.has(e)&&p.d.folderTable.has(t)})(t,e.folderId)&&Object(a.d)(e)}(r,e.SingleValueSettings[0].Value);break;case"persona":Object(a.d)(r);break;case"group":!function(e){Object(z.d)(e.groupId)||Object(a.d)(e)}(r);break;case"category":!function(e){(function(e){return Object(C.q)(e.categoryId)&&!s.a.outlookFavorites.has(e.favoriteId)})(e)&&(Object(a.d)(e),C.z.importAndExecute())}(r);break;case"privatedistributionlist":Object(E.i)("peo-favoritePdls")&&Object(a.d)(r);break;default:d(r.favoriteId)}}catch(e){Object(V.r)("AddFavoriteToStoreInitialFailed",{favoriteType:t,errorMessage:e.toString()})}})),[2]}}))}))}Object(o.orchestrator)(S.a,(function(e){Object(E.i)("tri-favorites-roaming")?P():Object(w.b)()}));var R=r(3268),z=r(2589),K=r(3078);function x(){var e=Object(s.b)();return Object(E.i)("tri-favorites-roaming")?Object(l.__spread)(e.outlookFavorites.entries()).filter((function(e){var t=Object(l.__read)(e,2);t[0];return"persona"===t[1].type})).map((function(e){var t=Object(l.__read)(e,2),r=t[0];t[1];return r})):Object(l.__spread)(e.favoritesPersonaNodes.keys())}function U(e){var t=Object(s.b)();return Object(E.i)("tri-favorites-roaming")?t.outlookFavorites.get(e):t.favoritesPersonaNodes.get(e)}function W(e){var t=U(e);return t?t.mainEmailAddress:null}function G(e){var t=U(e);return t?t.displayName:null}var B=r(4722),J=r(4156),q=r(6035),Y=r(6036),$=r(7),Q=r(2397),X=r(32),H=r(1),Z=Object(X.a)((function(e){var t,r=e.isInFavorites,n=e.isClickDisabled,o=e.animate,a=e.iconStyles,i=e.buttonStyles,u=e.spinnerStyles,c=e.tooltipStyles,s=e.onClick,d=e.isCategory,f=Object(A.a)();if(null===(t=null==f?void 0:f.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon)return null;var l=d?Object($.b)(Y.a):Object($.b)(J.a),v=d?Object($.b)(q.a):Object($.b)(B.a);return H.createElement(Q.a,{isStarred:r,onClick:s,isClickDisabled:n,animate:o,iconStyles:a,buttonStyles:i,spinnerStyles:u,tooltipStyles:c,ariaLabelText:r?l:v,tooltip:{starred:l,unstarred:v}})})),ee=r(4155),te=r(4677),re=r(4719),ne=r(5616),oe=r(3750),ae=r(4157),ie=r(4721);function ue(e){return Object(E.i)("tri-favorites-roaming")?Object(l.__spread)(s.a.outlookFavorites.values()).filter((function(e){return"persona"===e.type})).some((function(t){return t.searchFolderId&&t.searchFolderId===e})):Object(l.__spread)(s.a.favoritesPersonaNodes.values()).some((function(t){return t.searchFolderId&&t.searchFolderId===e}))}function ce(e){return!!Object(E.i)("tri-favorites-roaming")&&Object(l.__spread)(s.a.outlookFavorites.values()).filter((function(e){return"privatedistributionlist"===e.type})).some((function(t){return t.searchFolderId&&t.searchFolderId===e}))}var se=r(3566),de=r(4720),fe=r(4723),le=r(5617),ve=r(4356),be=r(5618),pe=r(5110),Oe=r(6034);function Fe(e,t){return function(e){var t=Object(l.__spread)(s.a.outlookFavorites.values()).filter((function(t){return"privatedistributionlist"===t.type&&t.pdlId===e}));return t.length>0?t[0].favoriteId:void 0}(e)||function(e){var t=Object(l.__spread)(s.a.outlookFavorites.values()).filter((function(t){return"privatedistributionlist"===t.type&&Object(Oe.a)(t.members,e)}));return t.length>0?t[0].favoriteId:void 0}(t)}r.d(t,"lazyMigrateFavorites",(function(){return me})),r.d(t,"lazyMoveFavoriteUpDown",(function(){return je})),r.d(t,"lazyUpdateFavoritePosition",(function(){return ge})),r.d(t,"lazyAddFavoriteCategory",(function(){return Ie})),r.d(t,"lazyRemoveFavoriteCategory",(function(){return he})),r.d(t,"lazyRemoveFavoritePersonaV2",(function(){return Se})),r.d(t,"lazyAddFavoritePersonaV2",(function(){return we})),r.d(t,"lazyRemoveFavoriteGroup",(function(){return Ae})),r.d(t,"lazyAddFavoriteGroup",(function(){return Ne})),r.d(t,"lazyRemoveFavoriteFolderV2",(function(){return De})),r.d(t,"lazyAddFavoriteFolderV2",(function(){return _e})),r.d(t,"lazyRemoveFavoritePrivateDistributionList",(function(){return Te})),r.d(t,"lazyAddFavoritePrivateDistributionList",(function(){return Ce})),r.d(t,"lazyEditFavoritePrivateDistributionList",(function(){return Ee})),r.d(t,"lazySetOutlookFavoritesBitFlag",(function(){return Ve})),r.d(t,"lazyAddFavoriteToStore",(function(){return Me})),r.d(t,"lazyAddFavoriteCompleted",(function(){return ke})),r.d(t,"lazyAddFavoriteFailed",(function(){return Pe})),r.d(t,"lazyAddMultipleFavoritesToStore",(function(){return Le})),r.d(t,"lazyAddMultipleFavoritesCompleted",(function(){return Re})),r.d(t,"lazyRemoveFavoriteFromStore",(function(){return ze})),r.d(t,"lazyRemoveFavoriteCompleted",(function(){return Ke})),r.d(t,"lazyRemoveFavoriteFailed",(function(){return xe})),r.d(t,"addFavoriteFailed",(function(){return a.b})),r.d(t,"addFavoriteToStoreInitial",(function(){return a.d})),r.d(t,"removeFavoriteFailed",(function(){return R.b})),r.d(t,"getStore",(function(){return s.b})),r.d(t,"favoritesStore",(function(){return s.a})),r.d(t,"loadFavorites",(function(){return S.a})),r.d(t,"isFolderInFavorites",(function(){return z.c})),r.d(t,"isGroupInFavorites",(function(){return z.d})),r.d(t,"isPersonaInFavorites",(function(){return z.e})),r.d(t,"isSearchInFavorites",(function(){return z.h})),r.d(t,"isCategoryInFavorites",(function(){return z.b})),r.d(t,"isPublicFolderInFavorites",(function(){return z.g})),r.d(t,"isPrivateDLInFavorites",(function(){return z.f})),r.d(t,"getPersonaFromPersonIdOrEmailAddress",(function(){return z.a})),r.d(t,"isOutlookFavoritingInProgress",(function(){return K.a})),r.d(t,"getFavoriteIdsForPersonaFavorites",(function(){return x})),r.d(t,"getFavoritePersonaEmail",(function(){return W})),r.d(t,"getFavoritePersonaDisplayName",(function(){return G})),r.d(t,"ToggleFavoriteButton",(function(){return Z})),r.d(t,"parseFavoriteNode",(function(){return ee.a})),r.d(t,"updateFavoritesUserOption",(function(){return te.a})),r.d(t,"addFavoriteToStoreV1",(function(){return w.a})),r.d(t,"getIsBitEnabled",(function(){return M.a})),r.d(t,"getFavoriteIdFromGroupId",(function(){return re.a})),r.d(t,"editOutlookFavoriteService",(function(){return ne.a})),r.d(t,"createOutlookFavoriteService",(function(){return oe.a})),r.d(t,"deleteOutlookFavoriteService",(function(){return ae.a})),r.d(t,"getFavoriteIdFromFolderId",(function(){return ie.a})),r.d(t,"isFolderPersonaFavoriteSearchFolder",(function(){return ue})),r.d(t,"isFolderPrivateDLFavoriteSearchFolder",(function(){return ce})),r.d(t,"convertEWSFolderIdToRestFolderId",(function(){return se.a})),r.d(t,"convertRestFolderIdToEWSFolderId",(function(){return se.b})),r.d(t,"getFavoriteIdFromCategoryId",(function(){return de.a})),r.d(t,"createMultipleOutlookFavoritesService",(function(){return h})),r.d(t,"createClientFavoriteCategoryData",(function(){return fe.a})),r.d(t,"createOwsFavoriteCategoryData",(function(){return fe.b})),r.d(t,"createOwsFavoriteFolderData",(function(){return le.a})),r.d(t,"migrateOutlookFavorites",(function(){return T})),r.d(t,"onCategoryFavorited",(function(){return ve.a})),r.d(t,"onCategoryUnfavorited",(function(){return ve.b})),r.d(t,"convertFavoritePersonaDataToFavoritePersonaNode",(function(){return be.a})),r.d(t,"convertFavoritePdlDataToFavoritePdlNode",(function(){return pe.a})),r.d(t,"convertServiceResponseToFavoriteData",(function(){return O.a})),r.d(t,"getSingleValueSettingValueForKey",(function(){return O.b})),r.d(t,"getFavoriteIdForPDL",(function(){return Fe}));var ye=new n.c((function(){return r.e(558).then(r.bind(null,17108))})),me=new n.a(ye,(function(e){return e.migrateFavorites})),je=new n.b(ye,(function(e){return e.moveFavoriteUpDown})),ge=new n.b(ye,(function(e){return e.updateFavoritePosition})),Ie=new n.b(ye,(function(e){return e.addFavoriteCategory})),he=new n.b(ye,(function(e){return e.removeFavoriteCategory})),Se=new n.b(ye,(function(e){return e.removeFavoritePersonaV2})),we=new n.b(ye,(function(e){return e.addFavoritePersonaV2})),Ae=new n.b(ye,(function(e){return e.removeFavoriteGroup})),Ne=new n.b(ye,(function(e){return e.addFavoriteGroup})),De=new n.b(ye,(function(e){return e.removeFavoriteFolderV2})),_e=new n.b(ye,(function(e){return e.addFavoriteFolderV2})),Te=new n.b(ye,(function(e){return e.removeFavoritePrivateDistributionList})),Ce=new n.b(ye,(function(e){return e.addFavoritePrivateDistributionList})),Ee=new n.b(ye,(function(e){return e.editFavoritePrivateDistributionList})),Ve=new n.a(ye,(function(e){return e.setOutlookFavoritesBitFlag})),Me=new n.b(ye,(function(e){return e.addFavoriteToStore})),ke=new n.b(ye,(function(e){return e.addFavoriteCompleted})),Pe=new n.b(ye,(function(e){return e.addFavoriteFailed})),Le=new n.b(ye,(function(e){return e.addMultipleFavoritesToStore})),Re=new n.b(ye,(function(e){return e.addMultipleFavoritesCompleted})),ze=new n.b(ye,(function(e){return e.removeFavoriteFromStore})),Ke=new n.b(ye,(function(e){return e.removeFavoriteCompleted})),xe=new n.b(ye,(function(e){return e.removeFavoriteFailed}))},2011:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r(16),o=r(3),a={favoritesFolderNodes:new n.ObservableMap,favoritesPersonaNodes:new n.ObservableMap,favoriteSearches:new n.ObservableMap,favoriteCategories:new n.ObservableMap,orderedFavoritesNodeIds:[],orderedOutlookFavoritesIds:[],outlookFavorites:new n.ObservableMap,favoriteSecondaryKeyMap:new n.ObservableMap,favoritingInProgressMap:new n.ObservableMap,favoritesLoaded:!1},i=Object(o.createStore)("favorites",a);t.a=i()},2477:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"e",(function(){return i})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return s})),r.d(t,"f",(function(){return d}));var n=r(3),o=r(52),a=Object(n.action)("addFavoriteCompleted",(function(e,t,r){return Object(o.c)({name:"AddFavoriteCompleted",customData:{temporaryFavoriteId:e.favoriteId,favoriteId:t.favoriteId,favoriteKind:t.type}},{temporaryData:e,favoriteData:t,newIndex:r})})),i=Object(n.action)("addMultipleFavoritesCompleted",(function(e,t){return Object(o.c)({name:"AddMultipleFavoritesCompleted"},{temporaryFavorites:e,favoritesData:t})})),u=Object(n.action)("addFavoriteFailed",(function(e,t){return Object(o.c)({name:"AddFavoriteFailed",customData:{errorMessage:e?e.message:"Undefined error",cV:e?e.correlationVector:"Undefined error",favoriteId:t.favoriteId,favoriteKind:t.type}},{error:e,favoriteData:t,favoriteKind:t.type})})),c=Object(n.action)("addFavoriteToStore",(function(e,t){return Object(o.c)({name:"AddFavoriteToStore",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e,newIndex:t})})),s=Object(n.action)("addFavoriteToStoreInitial",(function(e){return Object(o.c)({name:"AddFavoriteToStoreInitial",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})})),d=Object(n.action)("addMultipleFavoritesToStore",(function(e){return Object(o.c)({name:"AddMultipleFavoritesToStore"},{favoritesData:e})}))},2589:function(e,t,r){"use strict";r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return f})),r.d(t,"h",(function(){return l})),r.d(t,"b",(function(){return v})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return O})),r.d(t,"a",(function(){return F}));var n=r(0),o=r(2011),a=r(40),i=r(6034),u=r(4719),c=r(4720),s=r(4721);function d(e){return Object(a.i)("tri-favorites-roaming")?!!Object(s.a)(e):Object(o.b)().favoritesFolderNodes.has(e)}function f(e){return!!Object(u.a)(e)}function l(e){return Object(a.i)("tri-favorites-roaming")?Object(n.__spread)(Object(o.b)().outlookFavorites.values()).filter((function(e){return"search"===e.type})).some((function(t){return t.searchQuery===e})):Object(o.b)().favoriteSearches.has(e)}function v(e){return Object(a.i)("tri-favorites-roaming")?!!Object(c.a)(e):Object(o.b)().favoriteCategories.has(e)}function b(e,t){return null!==F(e,t)}function p(e,t){return Object(n.__spread)(Object(o.b)().outlookFavorites.values()).filter((function(e){return"privatedistributionlist"===e.type})).some((function(r){return r.pdlId===e||Object(i.a)(r.members,t)}))}function O(e){return Object(o.b)().favoriteSecondaryKeyMap.has(e)}function F(e,t){var r=Object(o.b)(),i=null;Object(a.i)("tri-favorites-roaming")?i=Object(n.__spread)(r.outlookFavorites.values()).filter((function(r){return"persona"===r.type&&y(r,e,t)})):i=Object(n.__spread)(r.favoritesPersonaNodes.values()).filter((function(r){return y(r,e,t)}));return i&&i.length>0?i[0]:null}function y(e,t,r){return t&&e.personaId===t||r&&e.allEmailAddresses&&e.allEmailAddresses.some((function(e){return e&&e.toLocaleLowerCase()===r.toLocaleLowerCase()}))}},2912:function(e,t,r){"use strict";r.d(t,"b",(function(){return b})),r.d(t,"a",(function(){return O}));var n=r(3566),o="SearchFolderId",a="PersonaId",i="MainEmailAddress",u="EmailAddresses",c="ContactDisplayName",s="ContactMainEmailAddress",d="PdlId",f="MemberNames",l="EmailAddress",v="ExtDirId";function b(e,t){var r=e.SingleValueSettings&&e.SingleValueSettings.filter((function(e){return e.Key==t}));return r&&1===r.length?r[0].Value:void 0}function p(e,t){var r=e.MultiValueSettings&&e.MultiValueSettings.filter((function(e){return e.Key==t}));return r&&1===r.length?r[0].Values:[]}function O(e,t){var r;switch(t){case"folder":r={type:"folder",folderId:Object(n.b)(e.SingleValueSettings[0].Value)};break;case"persona":var O=b(e,o),F=O?Object(n.b)(O):null;r={type:"persona",searchFolderId:F,allEmailAddresses:p(e,u),mainEmailAddress:b(e,i),isSearchFolderPopulated:!!F,personaId:b(e,a),contactDisplayName:b(e,c),contactMainEmailAddress:b(e,s),isSyncUpdateDone:!1};break;case"privatedistributionlist":for(var y=b(e,o),m=y?Object(n.b)(y):null,j=b(e,d),g=b(e,"PersonaId"),I=g?Object(n.b)(g):null,h=p(e,u),S=p(e,f),w=[],A=0;A<h.length;A++)w.push({name:S[A],emailAddress:h[A]});r={type:"privatedistributionlist",searchFolderId:m,isSearchFolderPopulated:!!m,pdlId:j,members:w,owsPersonaId:I};break;case"group":r={type:"group",groupId:e.SingleValueSettings[0].Value.toLowerCase(),groupSmtp:b(e,l).toLowerCase(),groupExternalDirectoryObjectId:b(e,v)};break;case"category":r={type:"category",categoryId:e.SingleValueSettings[0].Value};break;case"search":r={type:"search",searchQuery:e.SingleValueSettings[0].Value};break;case"publicFolder":r={type:"publicFolder",publicFolderId:b(e,"FolderId")};break;default:r={type:e.Type}}return r.treeType="favorites",r.favoriteId=e.Id,r.displayName=e.DisplayName,r.client=e.Client,r.lastModifiedTime=e.LastModifiedTime,r}},3078:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2011),o=r(4355);function a(e){if(!e)return!1;var t=n.a.favoritingInProgressMap;return"string"==typeof e?t.has(e):t.has(Object(o.a)(e))}},3268:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return u}));var n=r(3),o=r(52),a=Object(n.action)("removeFavoriteCompleted",(function(e){return Object(o.c)({name:"RemoveFavoriteCompleted",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})})),i=Object(n.action)("removeFavoriteFailed",(function(e,t){return Object(o.c)({name:"RemoveFavoriteFailed",customData:{errorMessage:e?e.message:"Undefined error",cV:e?e.correlationVector:"Undefined error",favoriteId:t.favoriteId,favoriteKind:t.type}},{error:e,favoriteData:t,favoriteKind:t.type})})),u=Object(n.action)("removeFavoriteFromStore",(function(e){return Object(o.c)({name:"RemoveFavoriteFromStore",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})}))},3566:function(e,t,r){"use strict";function n(e){return a(a(e,"/","-"),"+","_")}function o(e){return a(a(e,"-","/"),"_","+")}function a(e,t,r){return e.split(t).join(r)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}))},3748:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="ows/api/beta/outlookfavorites"},3749:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(25),o=r(333);function a(e){return!!(e&Object(n.a)().UserOptions.FavoritesBitFlags)}function i(e,t){Object(o.a)((function(r){e?r.UserOptions.FavoritesBitFlags|=t:r.UserOptions.FavoritesBitFlags&=~t}))}},3750:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3748),o=r(178),a=r(4154);function i(e){return Object(a.a)((function(){return Object(o.d)(n.a,e,void 0,!0,null,!0)}))}},4154:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0),o=r(218),a=/cv=([^&]+)&?.*$/;function i(e){var t;return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,i,u,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:r=!1,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,e()];case 2:return[4,(i=n.sent()).text().then((function(e){return e?JSON.parse(e):{}}))];case 3:if(u=n.sent(),Object(o.a)(i.status))return[2,u];throw r=!0,l=i.status,v=i.url,b=null===(t=null==u?void 0:u.error)||void 0===t?void 0:t.code,F=(O=v)&&O.match(a),p=F&&2===F.length?decodeURIComponent(F[1]):"No CV was found",{message:"Request failed with Status Code: "+l+" - Error Code: "+b+" --- cV: "+p,statusCode:l,correlationVector:p};case 4:if(c=n.sent(),r)throw c;throw d=(s=c)?s.message:"No error message",f=s?s.stack:"No error stack",{message:"Request failed with a network error - ErrorMessage: "+d+" - ErrorStack: "+f,statusCode:void 0,correlationVector:s.correlationVector};case 5:return[2]}var s,d,f,l,v,b,p,O,F}))}))}},4155:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(1654),o=r(34);function a(e){var t;try{t=JSON.parse(e)}catch(t){return void o.g.warn("Cannot parse folderForestNode: "+e)}if(void 0!==t.id)switch(t.type){case 6:case 0:return{id:t.id,type:t.type,treeType:"favorites"};case 3:case 4:return{id:t.id,type:t.type,treeType:"favorites",dropViewState:Object(n.a)()};case 1:var r={id:t.id,type:t.type,treeType:"favorites",displayName:t.displayName,mainEmailAddress:t.personaEmail,allEmailAddresses:t.personaAllEmails||[],searchFolderId:t.personaSearchFolderId,isJustAdded:!1,isSearchFolderPopulated:!0,isSyncUpdateDone:!1,dropViewState:Object(n.a)()};return t.personaId&&(r.personaId=t.personaId),r;default:return void o.g.warn("Non supported FolderForestNodeType: "+t.type)}}function i(e,t,r,n,a){return e.map((function(e){var i;return t.has(e)?i=t.get(e):r.has(e)?i=r.get(e):n.has(e)?i=n.get(e):a.has(e)?i=a.get(e):o.g.warn("Favorites not found. favoriteType: "+i.type),function(e){var t={id:e.id,type:e.type};if(1===e.type){var r=e;t.displayName=r.displayName,t.personaSearchFolderId=r.searchFolderId,t.personaEmail=r.mainEmailAddress,t.personaAllEmails=r.allEmailAddresses,t.personaId=r.personaId}return JSON.stringify(t)}(i)}))}},4156:function(e){e.exports=JSON.parse('{"a":"kva"}')},4157:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(178),o=r(3748),a=r(4154);function i(e){return Object(a.a)((function(){return Object(n.a)(o.a+"/"+e,null,null,!0,null,!0)}))}},4355:function(e,t,r){"use strict";function n(e){switch(e.type){case"folder":return e.folderId;case"group":return e.groupId.toLowerCase();case"category":return e.categoryId;case"persona":var t=e;return t.personaId||t.mainEmailAddress;case"privatedistributionlist":return"FavoritePdl";case"publicFolder":return e.publicFolderId;default:return}}r.d(t,"a",(function(){return n}))},4356:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));var n=r(3),o=Object(n.action)("ON_CATEGORY_FAVORITED",(function(e){return{categoryId:e}})),a=Object(n.action)("ON_CATEGORY_UNFAVORITED",(function(e){return{categoryId:e}}))},4677:function(e,t,r){"use strict";var n=r(4155),o=r(85);var a=r(2011),i=r(188);t.a=Object(i.action)("updateFavoritesUserOption")(Object(i.select)({favoritesFolderNodes:function(){return a.a.favoritesFolderNodes},favoritesPersonaNodes:function(){return a.a.favoritesPersonaNodes},favoriteSearches:function(){return a.a.favoriteSearches},favoriteCategories:function(){return a.a.favoriteCategories},orderedFavoritesNodeIds:function(){return a.a.orderedFavoritesNodeIds}})((function(e){var t,r=n.b(e.orderedFavoritesNodeIds,e.favoritesFolderNodes,e.favoritesPersonaNodes,e.favoriteSearches,e.favoriteCategories);return Object(o.y)((function(e){e.UserOptions.FavoriteNodes=r})),t=r,o.v.importAndExecute([{key:"FavoriteNodes",valuetype:"StringArray",value:t}]).then((function(e){var t=e.Body.ResponseMessages.Items[0];return"Success"==t.ResponseClass?Promise.resolve():Promise.reject("updateUserConfiguration failed: "+t.ResponseClass)}))})))},4718:function(e,t,r){"use strict";r.d(t,"d",(function(){return O})),r.d(t,"c",(function(){return y})),r.d(t,"a",(function(){return m}));var n=r(0),o=r(4155),a=r(3749),i=r(2011),u=r(134),c=r(884),s=r(1653),d=r(1634),f=r(25),l=r(34),v=r(188),b=r(5109),p=Object(v.select)({favoritesStore:function(){return i.a},folderTable:function(){return d.d.folderTable}})((function(e,t){return!(t.folderTable.size>0)||!t.favoritesStore.favoritesFolderNodes.has(e)&&t.folderTable.has(e)}));function O(e){p(e.id)&&(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoritesFolderNodes.set(e.id,e))}function F(e){var t;t=e.id,Object(c.q)(t)&&!i.a.favoriteCategories.get(t)&&(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoriteCategories.set(e.id,e))}var y=Object(v.action)("loadFavoriteNodesToStore")((function(e,t){var r=Object(f.a)().UserOptions;if(r.FavoriteNodes){r.FavoriteNodes.forEach((function(t){var r,n,a=o.a(t);if(a)switch(a.type){case 0:O(a);break;case 3:n=a,i.a.orderedFavoritesNodeIds.push(n.id),i.a.favoriteSearches.set(n.id,n);break;case 1:r=a.id,i.a.favoritesPersonaNodes.has(r)||(e.orderedFavoritesNodeIds.push(a.id),e.favoritesPersonaNodes.set(a.id,a));break;case 4:F(a);break;default:l.g.warn("Non supported FolderForestNodeType: "+a.id)}}));var a=Object(n.__spread)(e.favoritesPersonaNodes.values()).filter((function(e){return e.personaId}));Object(u.r)("LoadFavorites",[e.favoritesFolderNodes.size,e.favoritesPersonaNodes.size,e.favoriteSearches.size,e.favoriteCategories.size,a.length])}}));t.b=Object(v.action)("loadFavoritesV1")(Object(v.select)({favoritesStore:function(){return i.a}})((function(e){i.a.favoritesLoaded||(0===d.d.folderTable.size&&Object(d.x)(),Object(a.a)(2)?y(e.favoritesStore):s.lazyMigrateFavorites.importAndExecute(),Object(b.a)())})));var m=Object(v.action)("addFavoriteToStoreV1")(Object(v.select)({favoritesStore:function(){return i.a}})((function(e){i.a.favoritesFolderNodes.has(e.id)||(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoritesFolderNodes.set(e.id,e))})))},4719:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1653);function o(e){return Object(n.getStore)().favoriteSecondaryKeyMap.get(e.toLowerCase())}},4720:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1653);function o(e){return Object(n.getStore)().favoriteSecondaryKeyMap.get(e)}},4721:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1653);function o(e){return Object(n.getStore)().favoriteSecondaryKeyMap.get(e)}},4722:function(e){e.exports=JSON.parse('{"a":"jva"}')},4723:function(e,t,r){"use strict";r.d(t,"b",(function(){return v})),r.d(t,"a",(function(){return b}));var n=r(0),o=r(3),a=r(7083),i=r(2477),u=r(2589),c=r(3750),s=r(884),d=r(208),f=r(2912),l=r(3078);Object(o.orchestrator)(a.a,(function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t,r,o,a,p,O,F,y;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(t=e.categoryId,r=Object(s.o)().filter((function(e){return e.Id===t}))[0],o=Object(d.a)(),a=b(o,r,!1),Object(l.a)(t))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),Object(u.b)(t)?[2]:(Object(i.c)(a),p=v(r,!1),[4,Object(c.a)(p)]);case 2:return O=n.sent(),F=Object(f.a)(O,"category"),s.z.importAndExecute(),Object(i.a)(a,F),[3,4];case 3:return y=n.sent(),Object(i.b)(y,a),[3,4];case 4:return[2]}}))}))}));function v(e,t){return{Type:"category",DisplayName:e.Name,SingleValueSettings:[{Key:"CategoryId",Value:e.Id}],Client:t?"Migration":"OWA"}}function b(e,t,r){return{treeType:"favorites",type:"category",favoriteId:e,displayName:t.Name,categoryId:t.Id,client:r?"Migration":"OWA"}}},5109:function(e,t,r){"use strict";var n=r(3);t.a=Object(n.action)("SET_FAVORITES_LOADED")},5110:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"e",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return c}));var n=r(3566);function o(e){return{id:e.favoriteId,treeType:"favorites",type:5,data:e}}function a(e,t,r,n,o){return{treeType:"favorites",type:"privatedistributionlist",favoriteId:e,displayName:t,members:r,pdlId:n,searchFolderId:void 0,client:"OWA",isSearchFolderPopulated:!1,owsPersonaId:o}}function i(e,t){return{Type:"privatedistributionlist",DisplayName:e,MultiValueSettings:[{Key:"EmailAddresses",Values:t.map((function(e){return e.emailAddress}))},{Key:"MemberNames",Values:t.map((function(e){return e.name}))}],Client:"OWA"}}function u(e,t,r){return{Type:"privatedistributionlist",DisplayName:e,SingleValueSettings:[{Key:"PdlId",Value:Object(n.a)(t)},{Key:"PersonaId",Value:r}],Client:"OWA"}}function c(e,t){var r={Type:"privatedistributionlist",Client:"OWA"};if(e&&(r.DisplayName=e),t){var n=[{Key:"EmailAddresses",Values:t.map((function(e){return e.emailAddress}))},{Key:"MemberNames",Values:t.map((function(e){return e.name}))}];r.MultiValueSettings=n}return r}},5616:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3748),o=r(178),a=r(4154);function i(e,t){return Object(a.a)((function(){return Object(o.c)(n.a+"/"+e,t,void 0,!0,null,!0)}))}},5617:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(0),o=r(6037),a=r(1634),i=r(208),u=r(3),c=r(3750),s=r(3566),d=r(2912),f=r(2477),l=r(3078);Object(u.orchestrator)(o.a,(function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t,r,o,u,s,b;return Object(n.__generator)(this,(function(n){return t=e.folderIdToAdd,r=e.newIndex,o=a.d.folderTable.get(t),u=Object(i.a)(),s=function(e,t,r){return{treeType:"favorites",type:"folder",favoriteId:e,displayName:Object(a.j)(t),folderId:t.FolderId.Id,client:r?"Migration":"OWA"}}(u,o,!1),Object(l.a)(t)?[2]:(Object(f.c)(s,r),b=v(o,!1,r),Object(c.a)(b).then((function(e){var t=Object(d.a)(e,"folder");Object(f.a)(s,t,r)})).catch((function(e){Object(f.b)(e,s)})),[2])}))}))}));function v(e,t,r){return{Type:"folder",DisplayName:Object(a.j)(e),SingleValueSettings:[{Key:"FolderId",Value:Object(s.a)(e.FolderId.Id)},{Key:"ChangeKey",Value:e.FolderId.ChangeKey}],Client:t?"Migration":"OWA",Index:r}}},5618:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return a}));r(1653);function n(e){return{id:e.favoriteId,treeType:"favorites",type:1,allEmailAddresses:e.allEmailAddresses,displayName:e.displayName,mainEmailAddress:e.mainEmailAddress,searchFolderId:e.searchFolderId,isSyncUpdateDone:!0,isJustAdded:!1,isSearchFolderPopulated:e.isSearchFolderPopulated,markedForDeletion:!1,dropViewState:null,personaId:e.personaId}}function o(e,t,r){return{treeType:"favorites",type:"persona",favoriteId:e,displayName:t,searchFolderId:void 0,client:"OWA",allEmailAddresses:[r],personaId:void 0,mainEmailAddress:r,isSearchFolderPopulated:!1,isSyncUpdateDone:!0}}function a(e,t){return{Type:"persona",DisplayName:e,SingleValueSettings:[{Key:"MainEmailAddress",Value:t}],Client:"OWA"}}},6033:function(e,t,r){"use strict";t.a={MigrateOutlookFavorites:{name:"MigrateOutlookFavorites",options:{isCore:!0}},UpdateFavoriteNode:{name:"UpdateFavoriteNode"}}},6034:function(e,t,r){"use strict";function n(e,t){if(e.length!==t.length)return!1;var r=e.map((function(e){return e.emailAddress.toLocaleLowerCase()})),n=t.map((function(e){return e.emailAddress.toLocaleLowerCase()}));return r.filter((function(e){return n.includes(e)})).length===r.length}r.d(t,"a",(function(){return n}))},6035:function(e){e.exports=JSON.parse('{"a":"gfa"}')},6036:function(e){e.exports=JSON.parse('{"a":"ffa"}')},6037:function(e,t,r){"use strict";var n=r(3);t.a=Object(n.action)("ADD_FAVORITE_FOLDER_V2",(function(e,t){return{folderIdToAdd:e,newIndex:t}}))},7080:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0),o=r(2011),a=r(4355);function i(e,t){var r=o.a.favoriteSecondaryKeyMap,i=o.a.orderedOutlookFavoritesIds,u=o.a.outlookFavorites;i.some((function(t){return t===e.favoriteId}))||(void 0!==t?i.splice(t,0,e.favoriteId):i.push(e.favoriteId),u.set(e.favoriteId,Object(n.__assign)({treeType:"favorites"},e)),r.set(Object(a.a)(e),e.favoriteId))}},7081:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(4355),o=r(2011);function a(e){var t=o.a.favoriteSecondaryKeyMap,r=o.a.orderedOutlookFavoritesIds,a=o.a.outlookFavorites;o.a.orderedOutlookFavoritesIds=r.filter((function(t){return t!==e.favoriteId})),a.delete(e.favoriteId),t.delete(Object(n.a)(e))}},7082:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(2011),o=r(4355);function a(e){n.a.favoritingInProgressMap.set(Object(o.a)(e),!0)}function i(e){n.a.favoritingInProgressMap.delete(Object(o.a)(e))}},7083:function(e,t,r){"use strict";var n=r(3);t.a=Object(n.action)("ADD_FAVORITE_CATEGORY_V2",(function(e){return{categoryId:e}}))}}]);
//# sourceMappingURL=owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupAddMemberV2~GroupAddMembersV2Opx~GroupEditV2Opx~MailBo~a9087c7b.js.map
self.scriptsLoaded['owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupAddMemberV2~GroupAddMembersV2Opx~GroupEditV2Opx~MailBo~a9087c7b.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupAddMemberV2~GroupAddMembersV2Opx~GroupEditV2Opx~MailBo~a9087c7b.js'] = (new Date()).getTime();