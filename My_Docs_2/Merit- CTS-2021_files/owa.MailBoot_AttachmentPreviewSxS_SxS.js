self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxS~SxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[207],{1024:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},10390:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),i=n(9699),a=n(34);function u(e,t,n,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c,s,d,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:o={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."},r.label=1;case 1:return r.trys.push([1,3,,4]),u&&(c="getAttachmentTextPreview"+u,(t=t||{}).headers=t.headers||new Headers,t.headers.set("X-OWA-ActionName",c)),[4,Object(i.a)({AttachmentId:e,ReadMode:n},t)];case 2:if((s=r.sent())&&0===s.Status)return[2,s.Content];switch(d=(null==s?void 0:s.Status)||1){case 2:o.errorMessage="The attachment has been moved or deleted.";break;case 3:o.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:o.errorMessage="Something went wrong while the document preview was being created. Please try again later."}return o.error=new Error("getAttachmentTextPreview failed with status: "+d),[3,4];case 3:return l=r.sent(),a.g.warn("getAttachmentTextPreview failed with error: "+l),o.error=l,[3,4];case 4:throw o}}))}))}},1057:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28),i=n(1024);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindItem",e,t)}},1058:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},1647:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1698:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(0),i=n(16),a=n(40),u=n(1736),o=n(3),c={conversationReadingPaneViewState:null,loadedItemReadingPaneViewStates:new i.ObservableMap({}),loadedConversationReadingPaneViewStates:new i.ObservableMap({}),itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsItemId:null},s=Object(o.createStore)("readingpane",c),d=s();u.a.registerReference((function(){var e,t;return Object(a.i)("rp-persistedReadingPaneTabs")?Object(r.__spread)(d.loadedConversationReadingPaneViewStates.keys()):null===(t=null===(e=d.conversationReadingPaneViewState)||void 0===e?void 0:e.conversationId)||void 0===t?void 0:t.Id})),t.a=d},1715:function(e,t,n){"use strict";var r=n(1647),i=n(1662);function a(e){return e.map((function(e){return{fileType:r.a.Uri,name:e.name,type:Object(i.b)(e.url)||"",size:0,uri:e.url}}))}var u=n(34);function o(e,t,n){if(e.length!=t.length)return u.d("The sizes of subjects and latestItemIds are different"),null;for(var i=[],a=0;a<e.length;a++){var o={fileType:r.a.MailItem,name:e[a],size:(null==n?void 0:n[a])||0,itemId:t[a]};i.push(o)}return i}function c(e,t,n){var i=[],a={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return i.push(a),i}function s(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var i=e[n],a={fileType:r.a.Local,name:i.name,size:i.size,type:i.type,fileObject:i};t.push(a)}return t}function d(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function l(e){var t,n;return null===e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function f(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var v={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function b(e){switch(e?e.toLowerCase():null){case v.ONE_DRIVE_PRO.toLowerCase():return 0;case v.GDRIVE.toLowerCase():return 5;case v.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case v.DROPBOX.toLowerCase():return 2;case v.BOX.toLowerCase():return 3;case v.WOPI_BOX.toLowerCase():return 7;case v.WOPI_EGNYTE.toLowerCase():return 8;case v.MAILBOX.toLowerCase():return 4;case v.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"i",(function(){return a})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return r.a}))},1748:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1698),i=n(40),a=n(2048);function u(e){return Object(i.i)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedConversationReadingPaneViewStates.get(e||Object(r.b)().sxsItemId||Object(a.a)()):Object(r.b)().conversationReadingPaneViewState}},1938:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",(function(e,t,n){return{itemContexts:e,parentFolderId:t,actionType:n}}))},195:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function a(t){r--,delete e[t]}this.put=function(t,n,i,u){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var o=e[t];o?clearTimeout(o.timeout):r++;var c={value:n,expire:i+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){a(t),u&&u(t,n)}.bind(this),i)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&a(t),n},this.clear=function(){for(var a in e)clearTimeout(e[a].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(a){var u=e[a];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return i&&t++,u.value;i&&n++,r--,delete e[a]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),a=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(a)if(e[u])continue;var o=r[u],c=o.expire-i;if(c<=0){this.del(u);continue}c=c>0?c:void 0,this.put(u,o.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},2023:function(e,t,n){"use strict";var r=n(44),i=n(2439),a=n(2059),u=n(1938),o=n(2047),c=n(2201),s=n(2202),d=n(2268),l=n(2440),f=n(2325),v=n(1698),b=n(40),m=n(1638);function I(e,t){return!!e&&(1!==t&&!!m.a.conversations.get(e))}function O(e,t){return 2!=t&&(Object(b.i)("rp-persistedReadingPaneTabs")?v.a.loadedItemReadingPaneViewStates.has(e):v.a.itemReadingPaneViewState&&v.a.itemReadingPaneViewState.itemId==e)}var p=n(2163),h=n(2164),w=n(2080),g=n(1748);n.d(t,"l",(function(){return T})),n.d(t,"p",(function(){return P})),n.d(t,"m",(function(){return E})),n.d(t,"q",(function(){return _})),n.d(t,"s",(function(){return R})),n.d(t,"n",(function(){return j})),n.d(t,"o",(function(){return A})),n.d(t,"i",(function(){return C})),n.d(t,"j",(function(){return y})),n.d(t,"k",(function(){return N})),n.d(t,"g",(function(){return x})),n.d(t,"r",(function(){return M})),n.d(t,"h",(function(){return V})),n.d(t,"d",(function(){return I})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return p.a})),n.d(t,"a",(function(){return h.a})),n.d(t,"t",(function(){return v.a})),n.d(t,"c",(function(){return w.a})),n.d(t,"b",(function(){return g.a}));var S=new r.c((function(){return Promise.all([n.e(3),n.e(6),n.e(8),n.e(15),n.e(17),n.e(20),n.e(21),n.e(22),n.e(24),n.e(43),n.e(55),n.e(61),n.e(75),n.e(130),n.e(168),n.e(174),n.e(268),n.e(260),n.e(271),n.e(257),n.e(707)]).then(n.bind(null,17099))})),T=new r.a(S,(function(e){return e.loadConversationReadingPane})),P=new r.a(S,(function(e){return e.moveReadingPaneToTab})),E=new r.a(S,(function(e){return e.loadConversationReadingPaneForSingleMailItemSelected})),_=new r.a(S,(function(e){return e.print})),R=new r.a(S,(function(e){return e.setItemIdToScrollTo})),j=new r.a(S,(function(e){return e.loadItemReadingPane})),A=new r.a(S,(function(e){return e.loadItemReadingPaneForSingleMailItemSelected})),C=new r.a(S,(function(e){return e.expandCollapseAllItemParts}));Object(r.f)(u.a,S,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(c.a,S,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(s.a,S,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(o.a,S,(function(e){return e.markAllAsReadOrchestrator})),Object(r.f)(i.a,S,(function(e){return e.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(a.a,S,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(f.a,S,(function(e){return e.conversationReadyToLoadOrchestrator})),Object(r.f)(f.b,S,(function(e){return e.updateAttachmentsOrchestrator})),Object(r.f)(f.c,S,(function(e){return e.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(d.a,S,(function(e){return e.updateInternetMessageIdOrchestrator})),Object(r.f)(l.a,S,(function(e){return e.initializeExtendedCardForItemReadingPaneOrchestrator}));new r.b(S,(function(e){return e.getLastestNonDraftItemId}));var y=new r.b(S,(function(e){return e.getLatestNonDraftItemIdFromConversation})),N=new r.b(S,(function(e){return e.isUnsupportedItem})),x=new r.a(S,(function(e){return e.clearReadingPaneStore})),M=new r.a(S,(function(e){return e.replyByMeeting})),V=new r.a(S,(function(e){return e.ensureSecondaryReadingPaneTabHandler}))},2047:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(function(e,t,n){return{tableView:e,markAsRead:t,rowIdsToExclude:n}}))},2048:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1720),i=n(2250);function a(){var e=Object(r.d)();switch(e.type){case r.a.SecondaryReadingPane:return e.data.id.Id;case r.a.Primary:default:return Object(i.a)()}}},2059:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("DELETE_CONVERSATION_STORE_UPDATE",(function(e,t,n){return{conversationIds:e,tableView:t,actionType:n}}))},2080:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1698),i=n(40),a=n(2048);function u(e){return Object(i.i)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedItemReadingPaneViewStates.get(e||Object(a.a)()):Object(r.b)().itemReadingPaneViewState}},2163:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(40);function i(){return Object(r.i)("rp-linkedInViewProfile")||Object(r.i)("rp-linkedInViewProfileV1_1")}},2164:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="displaylinkedindataprebind"},2172:function(e,t,n){"use strict";var r=n(2176);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var i=n(1981);n.d(t,"c",(function(){return i.a}));var a=n(1976);n.d(t,"d",(function(){return a.a}))},2201:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",(function(e,t,n,r){return{conversationIds:e,tableViewId:t,isReadValue:n,isExplicit:r}}))},2202:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",(function(e,t,n,r){return{itemIds:e,isReadValue:t,isExplicit:n,tableViewId:r}}))},2250:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1698),i=n(495);function a(){var e,t;return Object(i.v)()?null===(e=Object(r.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(r.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},2268:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateInternetMessageId",(function(e,t,n){return{conversationId:e,itemId:t,internetMessageId:n}}))},2325:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u}));var r=n(3),i=Object(r.action)("CONVERSATION_READY_TO_LOAD",(function(e,t){return{conversationId:e,nodeIdCollectionChange:t}})),a=Object(r.action)("UPDATE_ATTACHMENTS"),u=Object(r.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(function(e,t){return{conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:t}}))},2386:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1720),a=n(1658),u=n(1762),o=n(105);function c(e,t,n){var c,f;void 0===t&&(t=0);var v=function(e){switch(e){case 0:return s;case 1:return d;case 2:return l;default:return Object(o.a)(e)}}(t),b=Object(u.b)();try{for(var m=Object(r.__values)(Object(a.a)().tabs),I=m.next();!I.done;I=m.next()){var O=I.value;if(O.type==i.a.Compose&&0==O.state){var p=b.viewStates.get(O.data);if((null==p?void 0:p.isInlineCompose)&&v(p,e)&&(0==p.asyncSendState||n&&6==p.asyncSendState))return p}}}catch(e){c={error:e}}finally{try{I&&!I.done&&(f=m.return)&&f.call(m)}finally{if(c)throw c.error}}return null}function s(e,t){return e.conversationId===t}function d(e,t){return e.referenceItemId.Id===t}function l(e,t){return!1}},2393:function(e,t,n){"use strict";var r=n(105),i=n(2172),a=n(47),u=n(2784);function o(e,t,n,a,o){var c;void 0===o&&(o=!0);var s=t,d=s.Name,l=s.OriginalPermissionType,f=s.PermissionType,v=Object(u.a)(t),b="GroupMailbox"===(null===(c=null==e?void 0:e.mailboxInfo)||void 0===c?void 0:c.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(e,v,n,a,f,l,o,d,b);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:i.b(e,v,1,a,f,l,o,d,b);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function c(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),i.a(e,t,n,r)}function s(e,t,n,r,u){void 0===u&&(u=!1);var s=n?o(e,t,1,r,!1):c(e,1,u,!1);if(n)return{url:s,init:{credentials:"include"}};var d=Object(i.c)(e.mailboxInfo),l=new Headers;return l.set("X-Token",d),l.set("X-OWA-CANARY",Object(a.a)()),{url:s,init:{headers:l}}}function d(e,t,n,r,i,a){return void 0===a&&(a=!1),r?o(e,t,n,i):c(e,n,a)}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}))},2439:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(function(e,t,n){return{conversationIds:e,flagType:t,tableViewId:n}}))},2440:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("initializeExtendedCardForItemReadingPane",(function(e,t){return{itemReadingPaneViewState:e,loadedItem:t}}))},2784:function(e,t,n){"use strict";function r(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},342:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r,i=n(0);function a(e){r=e}function u(){var e,t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(a=r)?[4,r()]:[3,2];case 1:a=i.sent(),i.label=2;case 2:if((n=a)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},347:function(e,t,n){"use strict";var r=n(0);function i(e,t){return e?Object(r.__assign)({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return i}))},5844:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SINGLE_EVENT_ICS=1]="SINGLE_EVENT_ICS",e[e.MULTIPLE_EVENT_ICS=2]="MULTIPLE_EVENT_ICS"}(r||(r={}))},9196:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(44),i=n(5844);n.d(t,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([n.e(4),n.e(6),n.e(15),n.e(17),n.e(20),n.e(75),n.e(212),n.e(607)]).then(n.bind(null,16654))})),u=new r.b(a,(function(e){return e.addToCalendar})),o=(new r.b(a,(function(e){return e.getIcsCalendarItem})),new r.b(a,(function(e){return e.getIcsCalendarItemOrchestrator}))),c=Object(r.d)(a,(function(e){return e.IcsPreview}))},9699:function(e,t,n){"use strict";var r=n(28),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"GetAttachmentTextPreviewRequest:#Exchange"},n)),Object(r.a)("GetAttachmentTextPreview",e,t)}n.d(t,"a",(function(){return a}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxS~SxS.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxS~SxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxS~SxS.js'] = (new Date()).getTime();