self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MeetingMessage~TimePanel~TimePanelOpx~WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[131],{1013:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return o}));var i=n(887);n.d(t,"e",(function(){return i.c})),n.d(t,"d",(function(){return i.b}));var r=n(44),a=new r.c((function(){return n.e(809).then(n.bind(null,1586))})),c=new r.a(a,(function(e){return e.initializeOwaAccountsStore})),u=new r.a(a,(function(e){return e.initializeOwaConnectedAccount})),o=new r.a(a,(function(e){return e.removeOWAConnectedAccount}))},178:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return d}));var i=n(44),r=new i.c((function(){return Promise.all([n.e(3),n.e(23),n.e(877)]).then(n.bind(null,1247))})),a=new i.a(r,(function(e){return e.makePostRequest})).importAndExecute,c=new i.a(r,(function(e){return e.makePatchRequest})).importAndExecute,u=new i.a(r,(function(e){return e.makePutRequest})).importAndExecute,o=new i.a(r,(function(e){return e.makeGetRequest})).importAndExecute,s=new i.a(r,(function(e){return e.makeDeleteRequest})).importAndExecute,d=new i.a(r,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},2139:function(e,t,n){"use strict";var i=n(3),r=n(0),a=n(85),c=Object(i.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",(function(e,t){return{settings:e,userIdentity:t}})),u=Object(i.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",(function(e){return{userIdentity:e}}));var o="ows/beta/ScenarioSettings",s=["IsTimePanelDatePickerExpanded","TimePanelCalendarIds","IsTimePanelCalendarViewTaskListSelected","WasFocusTimeSuggestionDisabled"];function d(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l=71;function f(e){return 0!=(e&l)}var w=n(614);function b(e){if(s.some((function(t){return t===e})))return"Owa";var t=Object(w.b)();return f(t)?d(t):null}var v=n(1701),m=n(178);function O(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,a,c,u,s,l,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=["Owa"],f(i=Object(w.b)())&&(a=d(i),n.push(a)),c=function(e){var t=e.join(",");return o+"/?Scenarios="+t}(n),s=m.b,l=[c,void 0,void 0],[4,Object(v.b)(e)];case 1:return[4,s.apply(void 0,l.concat([r.sent(),!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS"]))];case 2:return u=r.sent(),O={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1,isTimePanelCalendarViewTaskListSelected:!0,wasFocusTimeSuggestionDisabled:!1},null===(t=null==u?void 0:u.settings)||void 0===t||t.forEach((function(e){var t,n=b(e.settingName);(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName&&n===b("TimePanelCalendarIds")?O.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)||n!==b("TimePanelSelectedView")?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)||n!==b("SelectedCalendarListView")?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)||n!==b("IsTimePanelOpen")?!function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)||n!==b("IsTimePanelDatePickerExpanded")?!function(e){return void 0!==e.isSelected&&"IsTimePanelCalendarViewTaskListSelected"===e.settingName}(e)||n!==b("IsTimePanelCalendarViewTaskListSelected")?function(e){return void 0!==e.wasDisabled&&"WasFocusTimeSuggestionDisabled"===e.settingName}(e)&&n===b("WasFocusTimeSuggestionDisabled")&&(O.wasFocusTimeSuggestionDisabled=e.wasDisabled):O.isTimePanelCalendarViewTaskListSelected=e.isSelected:O.isTimePanelDatePickerExpanded=e.isExpanded:O.isTimePanelOpen=e.isOpen:O.timePanelSelectedCalendarView=e.selectedView:O.timePanelSelectedView=e.selectedView})),[2,O]}}))}))}var p=n(616),S=Object(p.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(p.a)(1e3)}),j={};function T(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e=Object(a.e)().map(h),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),j[e]?[2]:(j[e]=S((function(){return O(e)})),[4,j[e].retriableFunc()]);case 1:return t=n.sent(),c(t,e),[3,3];case 2:return n.sent(),u(e),[3,3];case 3:return[2]}}))}))}var P=n(1013);Object(i.orchestrator)(P.e,(function(e){h(e.userIdentity)}));function _(e,t){return o+"/"+e+"/"+t}function g(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t=b("TimePanelSelectedView"))?(n=_(t,"TimePanelSelectedView"),i={ViewType:e},[4,Object(m.c)(n,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function I(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=b("TimePanelCalendarIds"))?(i=_(n,"TimePanelCalendarIds"),a={CalendarIds:e},c=m.c,u=[i,a,void 0,void 0],[4,Object(v.b)(t)]):[3,3];case 1:return[4,c.apply(void 0,u.concat([r.sent(),!0,void 0,"UpdateTimePanelCalendarIdsRequest"]))];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))}function V(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t=b("IsTimePanelOpen"))?(n=_(t,"IsTimePanelOpen"),i={IsOpen:e},[4,Object(m.c)(n,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function k(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t=b("SelectedCalendarListView"))?(n=_(t,"SelectedCalendarListView"),i={ViewType:e},[4,Object(m.c)(n,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function C(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t=b("IsTimePanelDatePickerExpanded"))?(n=_(t,"IsTimePanelDatePickerExpanded"),i={isExpanded:e},[4,Object(m.c)(n,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function A(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t=b("IsTimePanelCalendarViewTaskListSelected"))?(n=_(t,"IsTimePanelCalendarViewTaskListSelected"),i={isSelected:e},[4,Object(m.c)(n,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function E(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t=b("WasFocusTimeSuggestionDisabled"))?(n=_(t,"WasFocusTimeSuggestionDisabled"),i={wasDisabled:e},[4,Object(m.c)(n,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}n.d(t,"j",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return T})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return I})),n.d(t,"f",(function(){return V})),n.d(t,"e",(function(){return k})),n.d(t,"d",(function(){return C})),n.d(t,"c",(function(){return A})),n.d(t,"i",(function(){return E}))},2710:function(e,t,n){"use strict";var i=n(2262),r=n(3),a=Object(r.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{stack:e||[]}}(Object(i.a)().initialPanelView)}),c=n(2520),u=n(2139),o=n(214),s=Object(r.action)("pushTimePanelView",(function(e){return{newView:e}})),d=Object(r.action)("updateTopTimePanelView",(function(e){return{updatedView:e}})),l=Object(r.action)("popTimePanelView");function f(e){Object(c.a)(e)&&function(e,t){if(0===t.length)return null;t[t.length-1]=e}(e,a().panelViewStack.stack)}Object(r.mutator)(s,(function(e){var t,n=e.newView;Object(c.a)(n)&&(t=n,a().panelViewStack.stack.push(t))})),Object(r.mutator)(d,(function(e){return f(e.updatedView)})),Object(r.mutator)(l,(function(){var e=a().panelViewStack;e.stack.pop()})),Object(r.mutator)(u.j,(function(e){var t=e.settings,n=e.userIdentity;Object(o.d)().userIdentity===n&&t.timePanelSelectedView&&f(t.timePanelSelectedView)}));var w=n(0),b=n(616),v=n(34),m=Object(b.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(b.a)(1e3)}),O=null;Object(r.orchestrator)(d,(function(e){return Object(w.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(w.__generator)(this,(function(i){switch(i.label){case 0:if(t=e.updatedView,"Tasks"!==(r=t)&&"Calendar"!==r||!Object(c.a)(t))return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),O&&O.cancel(),[4,(O=m((function(){return Object(u.h)(t)}))).retriableFunc()];case 2:return i.sent(),[3,4];case 3:return n=i.sent(),v.g.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+n),[3,4];case 4:O=null,i.label=5;case 5:return[2]}var r}))}))}));var p=n(2586);function S(){return Object(p.a)(j())}function j(){var e,t=a().panelViewStack;return 0===(e=t.stack).length?null:e[e.length-1]}function T(){return a().panelViewStack.stack.length}function h(){return-1!==a().panelViewStack.stack.indexOf("Conflicts")}function P(){return-1!==a().panelViewStack.stack.indexOf("AttendeeTracking")}function _(){var e=a().panelViewStack;return T()>=2?e.stack[T()-2]:null}n.d(t,"j",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return j})),n.d(t,"e",(function(){return T})),n.d(t,"g",(function(){return h})),n.d(t,"f",(function(){return P})),n.d(t,"d",(function(){return _})),n.d(t,"c",(function(){return p.a})),n.d(t,"h",(function(){return c.a}))},616:function(e,t,n){"use strict";function i(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var i=0,r=!1,a=function(c,u){r?u(new Error("The function retry was cancelled")):(i++,e().then((function(e){return c(e)})).catch((function(e){t&&i>=t?u(e):setTimeout((function(){return a(c,u)}),n(i))})))};return{retriableFunc:function(){return new Promise((function(e,t){return a(e,t)}))},cancel:function(){return r=!0}}}}function r(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}))},887:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u}));var i=n(3),r=Object(i.action)("initializeOwaAccountsStore"),a=Object(i.action)("owaConnectedAccountAdded",(function(e,t){return{userIdentity:e,accountProviderType:t}})),c=Object(i.action)("removeAccount",(function(e){return{userIdentity:e}})),u=Object(i.action)("owaAccountStoreInitializationFailed",(function(e,t,n,i){return{userIdentity:e,isRetry:t,accountProvider:n,error:i}}))}}]);
//# sourceMappingURL=owa.MailBoot~MeetingMessage~TimePanel~TimePanelOpx~WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.MailBoot~MeetingMessage~TimePanel~TimePanelOpx~WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MeetingMessage~TimePanel~TimePanelOpx~WorkloadScenarioSettings.js'] = (new Date()).getTime();