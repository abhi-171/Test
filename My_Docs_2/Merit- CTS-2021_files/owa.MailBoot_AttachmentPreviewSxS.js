self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[486],{15332:function(e){e.exports=JSON.parse('{"a":"hVb"}')},1655:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function a(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},1656:function(e,t,n){"use strict";var r=n(0),a=n(1697),i=n(346),o=n(609),c=n(134),s=n(5),u="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",b="X-OWA-ExplicitLogonUser";function f(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,f,p,v,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},f=Object(i.k)(e)){if(f.accountState==i.b.AccessRevoked)return[2,null];if(f.accountState==i.b.AccountDeprovisioned||f.accountState==i.b.AccountNotFound)return Object(i.c)(f.accountState,f.accountProviderType),[2,null]}return t?(n[u]=t,n[b]=t):f&&(n[u]=f.anchorMailbox),f?(p=f.token,!(v=Object(o.g)(f.tokenExpiry))&&p?[3,2]:(Object(c.r)("getAndUpdateAccessToken",{tokenExpiry:Object(s.y)(f.tokenExpiry,Object(s.Pb)()),isTokenExpired_1:v,isTokenInvalid_2:!p},{isCore:!0}),[4,a.a.importAndExecute(f.accountId,e,p)])):[3,3];case 1:(p=r.sent())||(p=""),r.label=2;case 2:m=void 0,"Outlook"==f.accountProviderType?(m='MSAuth1.0 usertoken="'+p+'", type="MSACT"',n[l]=1..toString()):"Google"!=f.accountProviderType&&"ICloud"!=f.accountProviderType||(m="Bearer "+p,n[l]=2..toString()),n[d]=m,r.label=3;case 3:return[2,n]}}))}))}var p=n(1655),v=n(34);function m(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(p.a)(),a=n,[4,h(e,t)];case 1:return a.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function h(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,f(e.mailboxInfo.userIdentity,w(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(p.b)(a,i),[2,a]}}))}))}function w(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&v.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return w}))},1657:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),a=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},1675:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1825);function a(e){return Object(r.a)().attachments.get(e.Id)}},1697:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(44),a=n(1657);n.d(t,"b",(function(){return a.a}));var i=new r.c((function(){return n.e(1261).then(n.bind(null,1903))})),o=new r.a(i,(function(e){return e.getAndUpdateAccessToken}))},1753:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},e)}},1762:function(e,t,n){"use strict";var r=n(16),a=n(3),i={viewStates:new r.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1},o=Object(a.createStore)("compose",i),c=o();n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}))},1818:function(e,t,n){"use strict";var r;function a(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1830:function(e,t){e.exports=function(e){return e instanceof Date}},1869:function(e,t,n){var r=n(1830),a=36e5,i=6e4,o=2,c=/[T ]/,s=/:/,u=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,b=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],f=/^-(\d{2})$/,p=/^-?(\d{3})$/,v=/^-?(\d{2})-?(\d{2})$/,m=/^-?W(\d{2})$/,h=/^-?W(\d{2})-?(\d{1})$/,w=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,j=/^(Z)$/,I=/^([+-])(\d{2})$/,x=/^([+-])(\d{2}):?(\d{2})$/;function P(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var y=function(e){var t,n={},r=e.split(c);s.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var a=S.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),T=function(e,t){var n,r=d[t],a=b[t];if(n=l.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=u.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(y.date,n),_=T.year,C=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=f.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=p.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=v.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=m.exec(e))return i=parseInt(n[1],10)-1,P(t,i);if(n=h.exec(e)){i=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return P(t,i,s)}return null}(T.restDateString,_);if(C){var A,k=C.getTime(),D=0;return y.time&&(D=function(e){var t,n,r;if(t=w.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=g.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=O.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(y.time)),y.timezone?A=function(e){var t,n;if(t=j.exec(e))return 0;if(t=I.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=x.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(y.timezone):(A=new Date(k+D).getTimezoneOffset(),A=new Date(k+D+A*i).getTimezoneOffset()),new Date(k+D+A*i)}return new Date(e)}},1963:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1985:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1876);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},1990:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),a=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1991:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},2055:function(e,t,n){"use strict";n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return b})),n.d(t,"m",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return v})),n.d(t,"j",(function(){return m})),n.d(t,"l",(function(){return h}));var r=n(44),a=n(1990);n.d(t,"n",(function(){return a.a}));var i=n(1963);n.d(t,"a",(function(){return i.a}));var o=n(1818);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(1991);n.d(t,"b",(function(){return c.a}));var s=new r.c((function(){return Promise.all([n.e(3),n.e(32),n.e(67),n.e(738)]).then(n.bind(null,3241))})),u=new r.b(s,(function(e){return e.getSharingInformation})),d=new r.b(s,(function(e){return e.getSharingIssuesForSharingData})),l=new r.b(s,(function(e){return e.getInfoBarCreator})),b=new r.b(s,(function(e){return e.hasLargeDLRecipient})),f=new r.b(s,(function(e){return e.hasRecipientExpansionFailure})),p=new r.b(s,(function(e){return e.getGroupsAndSmallDLs})),v=new r.b(s,(function(e){return e.getInvididualRecipients})),m=new r.b(s,(function(e){return e.hasGetRecipientPermissionFailed})),h=new r.b(s,(function(e){return e.logSharingTipChangesForLinkRemoval}))},218:function(e,t,n){"use strict";var r=n(693);n.d(t,"a",(function(){return r.a}))},2188:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return s})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"n",(function(){return v})),n.d(t,"r",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return w})),n.d(t,"j",(function(){return g})),n.d(t,"f",(function(){return O})),n.d(t,"i",(function(){return S})),n.d(t,"a",(function(){return j}));var r=n(44),a=new r.c((function(){return Promise.all([n.e(3),n.e(20),n.e(32),n.e(34),n.e(39),n.e(63),n.e(64),n.e(68),n.e(144),n.e(148),n.e(211),n.e(818)]).then(n.bind(null,3865))})),i=new r.a(a,(function(e){return e.onSmimeItemAttachmentOpened})),o=new r.a(a,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(a,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(a,(function(e){return e.setSmimePropertiesInDraftMessage}))),s=new r.b(a,(function(e){return e.trySetSmimeProperties})),u=new r.b(a,(function(e){return e.tryAddSmimeProperties})),d=new r.b(a,(function(e){return e.createMailResponseBodyContent})),l=new r.b(a,(function(e){return e.downloadSmimeAttachment})),b=new r.b(a,(function(e){return e.getMergedSmimeViewState})),f=new r.b(a,(function(e){return e.getMergedSmimeViewStateForDraft})),p=new r.b(a,(function(e){return e.isSmimeItemDecoding})),v=new r.b(a,(function(e){return e.previewSmimeAttachment})),m=new r.b(a,(function(e){return e.updateSmimeAttachmentIds})),h=new r.b(a,(function(e){return e.createSmimeAttachmentsFromFiles})),w=new r.b(a,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),g=new r.b(a,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),O=new r.b(a,(function(e){return e.getAttachmentsForSmimeResponse})),S=new r.b(a,(function(e){return e.getSmimeAttachmentsForRequest})),j=Object(r.d)(a,(function(e){return e.SignatureDetails}))},2353:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"UnifiedGroupIdentity:#Exchange"},e)}},2588:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n(0);function a(e){return Object(r.__assign)({},e)}function i(e){return Object(r.__assign)({},e)}function o(e){return Object(r.__assign)({},e)}function c(e){return Object(r.__assign)({},e)}function s(e){return Object(r.__assign)({},e)}},3247:function(e,t,n){"use strict";var r=n(712),a=n(559),i=n(0);function o(e){return Object(i.__assign)({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function c(e){return Object(i.__assign)({__type:"SearchFolderScopeType:#Exchange"},e)}var s=n(2353),u=n(1673);var d=n(25),l=n(957),b=n(2588),f=n(1644),p=n(2723);n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return x}));var v={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,t,n=[];n.push(Object(b.b)({folderId:Object(l.a)(f.j),kind:"PrimaryMailbox"}));var r=Object(p.b)("UserMailbox");try{for(var a=Object(i.__values)(r),o=a.next();!o.done;o=a.next()){var c=o.value;n.push(Object(b.b)({folderId:c,kind:"PrimaryMailbox"}))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return n},getSearchScopeType:function(e){var t,n,o=Object(u.a)(e.folderId);return t="none"!=o?Object(r.a)({Id:o}):Object(a.a)({Id:e.folderId}),[(n={FolderScope:c({BaseFolderId:t}),IsDeepTraversal:!0},Object(i.__assign)({__type:"PrimaryMailboxSearchScopeType:#Exchange"},n))]}},m={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,t=[],n=Object(d.a)();return(null===(e=null==n?void 0:n.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)||t.push(Object(b.a)({folderId:Object(l.a)(f.d),kind:"ArchiveMailbox"})),t.push(Object(b.a)({folderId:Object(l.a)(f.a),kind:"ArchiveMailbox"})),t},getSearchScopeType:function(e){var t,n,s=Object(u.a)(e.folderId);return t="none"!=s?Object(r.a)({Id:s}):Object(a.a)({Id:e.folderId}),"archivemsgfolderroot"==s?[(n={ArchiveTypes:16777215},Object(i.__assign)({__type:"LargeArchiveSearchScopeType:#Exchange"},n))]:[o({FolderScope:c({BaseFolderId:t})})]}},h={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},w={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(s.a)({Type:0,Value:e.groupId})},Object(i.__assign)({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},g={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},O={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},S=function(e){switch(e.kind){case"PrimaryMailbox":return v;case"ArchiveMailbox":return m;case"SharedFolders":return h;case"Group":return w;case"Calendar":return g;case"PublicFolder":return O;default:throw new Error("Unregistered search scope")}},j=function(e){return S(e).getKey(e)},I=function(e){return S(e).getSearchScopeList()},x=function(e){return S(e).getSearchScopeType(e)}},3533:function(e,t,n){"use strict";var r=n(0);function a(e,t,n,a,i,o,c,s,u,d){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:t,searchScope:n,pillSuggestions:Object(r.__spread)(a.values()),includeAttachments:o,fromDate:c,toDate:s,scenarioType:"mail",lastIndexFetched:0,searchProvider:u,viewFilter:d||"All"}}function i(e){var t=e;return 1==e.type?t.scenarioType:void 0}var o=n(1644),c=n(1640),s=n(957),u=n(2588),d=n(3565);function l(e){var t=e;return Object(c.m)(t.folderId)?Object(d.a)(t.searchScope,Object(u.a)({folderId:Object(s.a)(o.b),kind:"ArchiveMailbox"})):Object(d.a)(t.searchScope,Object(u.b)({folderId:Object(s.a)(o.h),kind:"PrimaryMailbox"}))}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return l}))},3565:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3247);function a(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},424:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();n.d(t,"a",(function(){return r}))},4548:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(4905),a=n(5328),i=n(3135),o=n(7);function c(e){switch(e){case 2:return Object(o.b)(a.d);case 3:return Object(o.b)(a.e);case 5:return Object(o.b)(a.c);case 6:return Object(o.b)(r.a);case 7:return Object(o.b)(a.g);case 4:return Object(o.b)(a.f);case 10:return Object(o.b)(a.a);case 11:return Object(o.b)(a.b);default:return Object(o.b)(i.a)}}},4563:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return r}))},4648:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(3),i=Object(a.action)("initializeReadingPaneInSxS",(function(e,t,n,r,a,i){return{readingPaneStrategy:e,attachmentSelectionSource:t,parentItemId:n,instrumentationContext:r,sxsId:a,isProjectionPopout:i}})),o=Object(a.action)("initializeConversationReadingPaneInSxS",(function(e,t,n,r,a){return{readingPaneStrategy:e,attachmentSelectionSource:t,parentItemId:n,instrumentationContext:r,sxsId:a}})),c=Object(a.action)("initializeReadingPaneInSxSByCopyingMailReadingPane",(function(e,t,n,r,a){return{attachmentSelectionSource:e,parentItemId:t,instrumentationContext:n,sxsId:r,isProjectionPopout:a}})),s=n(105),u=n(2023),d=n(1722);Object(a.orchestrator)(o,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.attachmentSelectionSource,a=e.parentItemId,i=e.instrumentationContext,o=e.sxsId,t&&t.conversationId?(c=Object(d.l)(o)).readingPaneState&&c.readingPaneState.mode===d.h.ConversationReadingPane&&c.readingPaneState.conversationId&&c.readingPaneState.conversationId.Id===t.conversationId.Id?(a&&function(e){switch(e){case d.b.MailList:case d.b.ConversationAttachmentWell:return!0;case d.b.ReadingPane:case d.b.FilesHub:case d.b.PhotoHub:case d.b.GroupFilesHub:case d.b.ConsumerGroupFilesHub:case d.b.Deeplink:case d.b.FileSuggestion:case d.b.LinkSuggestion:case d.b.ComposeDocLink:case d.b.ReadingPaneDocLink:case d.b.FolderTree:return!1;default:return Object(s.a)(e)}}(n)&&u.s.importAndExecute(t.conversationId.Id,a.Id),[2]):(Object(d.J)(t.conversationId.Id),[4,u.l.importAndExecute(t.conversationId,i,t.conversationSubject,t.conversationCategories,t.itemIdToScrollTo)]):[2];case 1:return r.sent(),Object(d.N)({mode:d.h.ConversationReadingPane,conversationId:t.conversationId,conversationCategories:t.conversationCategories,conversationSubject:t.conversationSubject},o),a&&u.s.importAndExecute(t.conversationId.Id,a.Id),[2]}}))}))}));var l=Object(a.action)("initializeItemReadingPaneInSxS",(function(e,t,n){return{readingPaneStrategy:e,sxsId:t,instrumentationContext:n}}));Object(a.orchestrator)(l,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.instrumentationContext,a=e.sxsId,t&&t.itemId?(i=Object(d.l)(a)).readingPaneState&&i.readingPaneState.mode===d.h.ItemReadingPane&&i.readingPaneState.itemId&&i.readingPaneState.itemId.Id===t.itemId.Id?[2]:(o=Object(u.c)(t.itemId.Id))&&o.itemId==t.itemId.Id?(Object(d.N)({mode:d.h.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:o},a),[3,4]):[3,1]:[2];case 1:return[4,u.n.import()];case 2:return[4,r.sent()(t.itemId,n,(function(e){Object(d.N)({mode:d.h.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:e},a)}))];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}));var b=n(2340),f=n(1762),p=n(3533),v=n(1698),m=n(1748),h=n(1720),w=n(495),g=n(1780),O=n(7091),S=n(2386),j=n(1633),I=n(1717);Object(a.orchestrator)(c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,c,s,u,x,P,y,T,_,C,A,k,D,E,M,R,L;return Object(r.__generator)(this,(function(F){switch(F.label){case 0:return e.isProjectionPopout?[2]:(t=Object(d.l)(e.sxsId)).shouldShow&&(t.readingPaneState||t.composeId)?[2]:(n=e.attachmentSelectionSource,a=e.parentItemId,i=e.instrumentationContext,c=null===(L=j.X.tableViews.get(j.X.selectedTableViewId))||void 0===L?void 0:L.tableQuery,s=c&&(Object(j.Q)(c)||Object(p.c)(c)),u=Object(h.d)(),(x=Object(O.a)())?Object(w.v)()&&window.opener?[2]:x.composeId!==f.a.primaryComposeId?[3,2]:[4,g.k.import()]:[3,5]);case 1:F.sent()(x,!0,!0),u=Object(h.d)(),F.label=2;case 2:return[4,h.k.importAndExecute(u,!1)];case 3:return F.sent(),[4,d.C.import()];case 4:return F.sent()(x.composeId,e.sxsId),[2];case 5:return P=v.a.deeplinkId,y=Object(m.a)(),P?l({method:b.a.LoadItemReadingPane,itemId:{mailboxInfo:P.mailboxInfo,Id:P.id}},e.sxsId,i):u&&u.type===h.a.SecondaryReadingPane?1===(T=u.data).listViewType||Object(I.a)()?l({method:b.a.LoadItemReadingPane,itemId:T.id},e.sxsId,i):0===T.listViewType&&o({method:b.a.LoadConversationReadingPane,conversationId:T.id,conversationSubject:T.subject,conversationCategories:T.categories},n,a,i,e.sxsId):y&&Object(S.a)(y.conversationId.Id)?o({method:b.a.LoadConversationReadingPane,conversationId:y.conversationId,conversationSubject:y.conversationSubject,conversationCategories:y.conversationCategories},n,a,i,e.sxsId):(_=Object(j.G)(),C=_&&Object(r.__spread)(_.selectedRowKeys.keys()),A=null==_?void 0:_.isInVirtualSelectAllMode,k=j.X.expandedConversationViewState.selectedNodeIds.length,1==C.length&&k<=1&&!A&&!s&&(D=j.b.getRowIdToShowInReadingPane(C[0],_),1===(E=_&&_.tableQuery.listViewType)||Object(I.a)()?l({method:b.a.LoadItemReadingPane,itemId:D},e.sxsId,i):0===E&&(M=j.b.getSubject(C[0],_),R=j.b.getCategories(C[0],_),o({method:b.a.LoadConversationReadingPane,conversationId:D,conversationSubject:M,conversationCategories:R},n,a,i,e.sxsId)))),[2]}}))}))})),Object(a.orchestrator)(i,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,s,u;return Object(r.__generator)(this,(function(r){if(t=e.readingPaneStrategy,n=e.attachmentSelectionSource,a=e.parentItemId,i=e.instrumentationContext,s=e.sxsId,u=e.isProjectionPopout,!t)return[2];switch(t.method){case b.a.NoOp:return[2];case b.a.AlwaysHidden:return Object(d.N)(null,s),[2];case b.a.CopyMailReadingPaneContainer:return c(n,a,i,s,u),[2];case b.a.LoadConversationReadingPane:return o(t,n,a,i,s),[2];case b.a.LoadItemReadingPane:return l(t,s,i),[2];default:return[2]}return[2]}))}))}));var x=n(134),P=n(1792),y=n(1953),T=n(1726),_=n(2980),C=n(5684),A="download",k="open";function D(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(C.a)(e.AttachLongPathName),[4,Object(_.l)(n)];case 1:return a=r.sent(),[2,(null===(t=a.result)||void 0===t?void 0:t.webContentLink)&&(i=a.result.webContentLink,i.lastIndexOf(A,i.length-A.length)>-1)?E(a.result.webContentLink):null]}var i}))}))}function E(e){return e.slice(0,-A.length)+k}var M=n(1985),R=n(2222),L=n(10390),F=n(2393),N=n(3504),U=n(9195),W=n(40),V=n(1662),B=n(4563),G=n(208),H=n(7),z=n(3135),$=n(4905),J=n(4920),X=n(1640),K=n(9196),q=n(4),Q=n(1917),Y=n(34);function Z(e){switch(e){case P.b.Unsupported:return"Unsupported";case P.b.Image:return"Image";case P.b.MailItem:return"MailItem";case P.b.CalendarEvent:return"CalendarEvent";case P.b.Wac:return"Wac";case P.b.SuiteExtensions:return"SuiteExtensions";case P.b.Audio:return"Audio";case P.b.Text:return"Text";case P.b.NativeView:return"NativeView";case P.b.GoogleDoc:return"GoogleDoc";case P.b.PdfJs:return"PdfJs";case P.b.ItemAttachment:return"ItemAttachment";case P.b.Video:return"Video";default:return Object(s.a)(e)}}var ee="/owa/{0}/service.svc/s/GetAttachmentPdfPreview?id={1}";function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(H.c)(ee,e,encodeURIComponent(t)),[4,fetch(n,{credentials:"same-origin"})];case 1:return[2,r.sent()]}}))}))}var ne=n(2172);function re(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,i,o,c,s,u,d,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.mailboxInfo?[4,te(Object(ne.d)(e.mailboxInfo),e.Id)]:[2,null];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:for(n=r.sent(),a=n.replace(/\s/gi,""),i=atob(a),o=i.length,c=new Uint8Array(new ArrayBuffer(o)),s=0;s<o;s++)c[s]=i.charCodeAt(s);return u=t.headers.get("PrintAllowed"),d=t.headers.get("CopyAllowed"),l=t.headers.get("ExportAllowed"),[2,{data:c,printAllowed:!u||"true"===u.toLowerCase(),copyAllowed:!d||"true"===d.toLowerCase(),exportAllowed:!l||"true"===l.toLowerCase()}];case 3:throw t.statusText}}))}))}var ae=n(2);function ie(e,t){var n=Object(ae.G)()?"OWA-PWA":"OWA-WEB",r=t?"SXS-EDIT":"SXS-VIEW",a="";switch(e){case d.b.MailList:a="ML";break;case d.b.ConversationAttachmentWell:a="CAW";break;case d.b.ReadingPane:a="RP";break;case d.b.FilesHub:a="FH";break;case d.b.PhotoHub:a="PH";break;case d.b.GroupFilesHub:a="GFH";break;case d.b.ConsumerGroupFilesHub:a="CGF";break;case d.b.Deeplink:a="DL";break;case d.b.FileSuggestion:a="FS";break;case d.b.LinkSuggestion:a="LS";break;case d.b.ComposeDocLink:a="CDL";break;case d.b.ReadingPaneDocLink:a="RPDL";break;case d.b.FolderTree:a="FT";break;default:a="UNKNOWN"}return n+"."+a+"."+r}var oe=n(2387);function ce(e){var t=new Error(e);throw t.isUserError=!0,t}function se(e){if(null!=e&&e.isUserError)return!0;return!1}var ue=n(15332),de=n(2462),le=n(347),be=[".odp",".pot",".potm",".potx",".pps",".ppsm",".ppsx",".ppt",".pptm",".pptx"];function fe(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,g.j.import()];case 1:return r.sent()(e.Id,t,3,{forceInsertSignatureOperation:n}),[2]}}))}))}function pe(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return t=e.mailboxInfo,n=t&&"GroupMailbox"==t.type?t.mailboxSmtpAddress:null,[4,g.d.import()];case 1:return[4,i.sent()(e.Id,!0,n,!1)];case 2:return a=i.sent(),[2,Object(r.__assign)(Object(r.__assign)({},a.ItemId),{mailboxInfo:e.mailboxInfo})]}}))}))}function ve(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=Object(S.a)(e))?[4,g.r.import()]:[3,3];case 1:return[4,n.sent()(t)];case 2:return n.sent(),[2,t.itemId];case 3:return[2,null]}}))}))}function me(e,t,n,a,o,c,s,u,l,b,f){var m,w;return void 0===b&&(b=d.f.Mail),Object(r.__awaiter)(this,void 0,void 0,(function(){function g(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c?[3,1]:(n=null,[3,3]);case 1:return[4,c()];case 2:n=r.sent(),r.label=3;case 3:return t=n,te(),je.setImagePreviewState(Pe,Te.previewImage.url,t,ke,!ke&&!Object(R.e)().printWithoutDownloadEnabled,Re),[4,T.j.import()];case 4:return[4,r.sent()(e.attachmentId,e.isReadOnly)];case 5:return r.sent(),te(),je.setImagePreviewState(Pe,ye(e.attachmentId).previewImage.url,t,ke,!ke&&!Object(R.e)().printWithoutDownloadEnabled,Re),[2]}}))}))}function I(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=Te.model.ProviderType,Object(y.b)(e.isCloudy,t,Te.model.Name)&&t===T.a.providers.ONE_DRIVE_PRO?[4,C()]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,_()];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))}function _(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,i,c,s,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=!1,[4,Object(U.a)(e.attachmentId,t,P.c[o])];case 1:return n=r.sent(),Te.model.Name&&(a=Te.model.Name.lastIndexOf("."))>=0&&(i=Te.model.Name.substr(a).toLowerCase(),Re.useHighContrastCommandBar=be.indexOf(i)>=0),te(),je.setWacPreviewState(Pe,n.wacUrl,null,n.accessToken,n.accessTokenTtl,n.additionalParameters,n.deprecatedTokenAndParameters,ne.getTime(),!t,Re),[3,3];case 2:if(c=r.sent(),null==(s=c)?void 0:s.errorMessage)throw Y.g.warn("Something went wrong while getting the attachment state: "+s),e.isCloudy&&(u=Te,Re.openInNewTabUrl=Object(W.i)("doc-unwrap-safelinks")?u.originalUrl:u.openUrl),je.setPreviewError(Pe,s.errorMessage,Re),s.error;throw c;case 3:return[2]}}))}))}function C(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a,i,c,s,u;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:e=Te,t=Object(W.i)("doc-unwrap-safelinks")?e.originalUrl:e.openUrl,d.label=1;case 1:if(d.trys.push([1,3,,4]),We.addCustomData({useJsApi:"true"}),null==t)throw new Error("openUrl is null");return n=Te.model.Name,a=n&&n.substring(n.lastIndexOf(".")),l=a,i=!Object(W.i)("doc-SxS-jsApi-ODB-Readonly")&&".xls"!==l,[4,Object(N.a)(0,t,i,!0)];case 2:if(!(c=d.sent()))throw new Error("Vroom API call failed");return te(),s=Object(G.a)(),je.setWacPreviewState(Pe,c.openWith.wac.applicationUrl,{bootScriptUrl:c.openWith.wac.bootstrapperUrl,wopiSrcUrl:c.openWith.wac.wopiSrc,accessToken:c.openWith.wac.accessToken,accessTokenExpiry:c.openWith.wac.accessTokenExpiry,fileSize:Te.model.Size,fileGetUrl:c.openWith.wac.fileGetUrl,bundleInfo:c.officeBundle,fetchStartTime:c.fetchStartTime,responseStartTime:c.responseStartTime,openUrl:t,owaSessionId:s,userId:c.openWith.wac.userId,sessionOrigin:ie(o,i),clientThrottlingProtection:c.openWith.wac.clientThrottlingProtection,requestedCallThrottling:c.openWith.wac.requestedCallThrottling},null,null,null,null,ne.getTime(),c.currentUserRole.readOnly,Re),We.addCustomData({owaSessionId:s}),[3,4];case 3:throw u=d.sent(),Y.g.warn("Something went wrong while getting the attachment state: "+u.message),je.setPreviewError(Pe,Object(H.b)(z.a),Object(r.__assign)(Object(r.__assign)({},Re),{openInNewTabUrl:t})),u;case 4:return[2]}var l}))}))}function A(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Object(M.b)(Te.model)&&Te.model.ProviderType===T.a.providers.GDRIVE?[4,k()]:[3,2];case 1:return n.sent(),[3,3];case 2:t=Object(F.a)(e.attachmentId,Te.model,3,Object(M.b)(Te.model),e.isReadOnly),je.setNativePdfPreviewState(Pe,Te.download.url+"&isDocumentPreview=True#toolbar=0",t,"application/pdf",Re),n.label=3;case 3:return[2]}}))}))}function k(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,D(Te.model)];case 2:return(t=r.sent())?(te(),je.setNativePdfPreviewState(Pe,t,null,"application/pdf",Re),[2]):[3,4];case 3:return n=r.sent(),e=n,[3,4];case 4:throw te(),je.setPreviewError(Pe,Object(H.b)($.a)),e||new Error("Unexpected error in handleNativeViewPreviewForGDrive")}}))}))}function E(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(R.c)(Te.model,!0),ke&&t.directFileAccessEnabled&&!Fe?(je.setPdfJsPreviewState(Pe,Te.download.url+"&isDocumentPreview=True",!1,Re),[3,3]):[3,1];case 1:return[4,re(e.attachmentId)];case 2:n=r.sent(),te(),je.setPdfJsPreviewStateByData(Pe,n.data,!ke&&!Object(R.e)().printWithoutDownloadEnabled||!n.printAllowed,n.copyAllowed,n.exportAllowed,Re),r.label=3;case 3:return[2]}}))}))}function V(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(L.a)(e.attachmentId.Id,Object(le.a)(e.attachmentId.mailboxInfo),0,P.c[o])];case 1:return t=r.sent(),te(),je.setTextPreviewState(Pe,t,ke,Re),[3,3];case 2:if(n=r.sent(),null==(a=n)?void 0:a.errorMessage)throw te(),je.setPreviewError(Pe,a.errorMessage),a.error;throw n;case 3:return[2]}}))}))}function ee(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t={calendarItem:null,isIcsAttachmentLoading:!0,icsCalendarEventType:K.a.UNKNOWN,attachmentId:e.attachmentId,addToCalendarStatus:1,errorMessage:null},[4,K.d.import()];case 1:return n=r.sent(),a=null,[4,n({attachmentId:e.attachmentId,size:Te.model.Size,showSizeLimitExceedsError:function(){a=Object(H.b)(ue.a)},errorCallback:function(){a=Object(H.b)(J.a)},state:t})];case 2:if(r.sent(),te(),a)throw je.setPreviewError(Pe,a),new Error(a);return ae.onShowCustomPreview(t,Oe),je.setCustomPreviewState(Pe,Re),[2]}}))}))}function te(){Object(d.l)(Oe).pendingPreviewOperation&&Ge.id===Object(d.l)(Oe).pendingPreviewOperation.id||ce("Preview changed before loading finished")}var ne,ae,me,Oe,Se,je,Ie,xe,Pe,ye,Te,_e,Ce,Ae,ke,De,Ee,Me,Re,Le,Fe,Ne,Ue,We,Ve,Be,Ge,He,ze,$e,Je,Xe,Ke,qe;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return ne=new Date,[4,d.H.import()];case 1:return ae=c.sent(),oe.a.available()?(l=l||window,me=l!==window,Oe=Object(d.k)(l),oe.a.run(l,Oe),f&&o==P.c.Deeplink&&(Se=(new Date).getTime()-f,Object(x.r)("PopOutSxSUsage",{PopOutType:"DeepLink",TimeElapsed:Se})),[4,Q.u.import()]):(ae.openSxSInANewWindow(t,e.attachmentId.Id,null),[2]);case 2:return je=c.sent(),Ie=ae.onPreviewOperationStart,xe=ae.onPreviewOperationFinished,Pe=Object(d.l)(Oe).viewState,[4,T.h.import()];case 3:ye=c.sent(),Te=ye(e.attachmentId),_e=e.strategy,Ce=-1!==_e.supportedOpenActions.indexOf(P.a.Download),Ae=Ce&&(null==Te?void 0:Te.download)?Te.download.url:null,ke=Te.info.allowDownload,De=0,Object(W.i)("wvn-productizeSTCChicletAndPreview")||Object(W.i)("wvn-sxsEditButtonSplit")?De=_e.isSaveToCloudSupported?Object(H.f)(Te.model.AttachmentOriginalUrl)?1:3:0:(Ee=_e.isSaveToCloudSupported&&Object(H.f)(Te.model.AttachmentOriginalUrl),De=Ee?1:0),Me=_e.previewMethod===P.b.Wac,Re={downloadUrl:Ae,downloadShouldOpenNewTab:Me,fileName:Te.model.Name,useHighContrastCommandBar:!1,id:e.attachmentId,isCloudy:e.isCloudy,openInNewTabUrl:null},Le=_e.previewMethod,Fe=!1,_e.previewMethod!==P.b.NativeView&&_e.previewMethod!==P.b.PdfJs||(Ne=X.u.items.get(t.Id))&&Ne.RightsManagementLicenseData&&(Le=P.b.PdfJs,Fe=!0),Ue=function(e,t,n,r,a,i,o,c){var s,u,d=ge(e),l=new x.b("PreviewAttachmentInSxSE2E",{timeout:he}),b=Date.now(),f=!1;c&&(f=!!we&&we===c,we=c);var p={previewMethod:Z(t),isCloudy:n?"cloudy":"classic",isChangingFromEditing:r?"changingFromEdit":"",officeFileType:Object(B.a)(d),actionSource:P.c[a],attachmentFileType:i,isRepeat:o,downloadAllowed:!!e.download.url,fromSameReadingPane:f},v="";Object(W.i)("doc-SxS-jsApi-ODB-Base")&&(v+="doc-SxS-jsApi-ODB-Base;");Object(W.i)("doc-SxS-jsApi-ODB-BaseNoEditString")&&(v+="doc-SxS-jsApi-ODB-BaseNoEditString;");Object(W.i)("doc-SxS-jsApi-ODB-Readonly")&&(v+="doc-SxS-jsApi-ODB-Readonly;");Object(W.i)("doc-SxS-jsApi-ODB-Basecf")&&(v+="doc-SxS-jsApi-ODB-Basecf;");return p.associatedFlights=v,p.hostName=window.location.hostname,p.hideEmailOption=null===(s=Q.u.tryImportForRender())||void 0===s?void 0:s.getHideReadingPaneOption(),l.addCustomData(p),l.addCosmosOnlyData(JSON.stringify({attachmentId:null===(u=null==e?void 0:e.id)||void 0===u?void 0:u.Id,fileType:(null==d?void 0:d.substring(0,4))||"",fileSize:e.model.Size})),Object(x.r)("PreviewAttachmentInSxSUsage",p,{isCosmosDatapoint:!0}),{perfDatapoint:l,perfDatapointCreatedTime:b}}(Te,Le,e.isCloudy,Object(d.l)(Oe).editState.mode!==d.c.View,o,e.fileType,ae.repeatTracker.contains(e.attachmentId.Id),!Object(d.l)(Oe).shouldShow&&function(){var e,t,n,a,i,o=null===(e=j.X.tableViews.get(j.X.selectedTableViewId))||void 0===e?void 0:e.tableQuery,c=o&&(Object(j.Q)(o)||Object(p.c)(o)),s=Object(h.d)(),u=Object(O.a)(),d=null===(t=null==u?void 0:u.itemId)||void 0===t?void 0:t.Id;if(d)return d;var l=Object(v.b)(),b=l.conversationReadingPaneViewState,f=l.deeplinkId;if(f)return f.id;if(s&&s.type===h.a.SecondaryReadingPane){var m=s.data;return null===(n=null==m?void 0:m.id)||void 0===n?void 0:n.Id}if(b&&Object(S.a)(b.conversationId.Id))return b.conversationId.Id;var w=Object(j.G)(),g=w&&Object(r.__spread)(w.selectedRowKeys.keys()),I=null==w?void 0:w.isInVirtualSelectAllMode,x=null===(i=null===(a=j.X.expandedConversationViewState)||void 0===a?void 0:a.selectedNodeIds)||void 0===i?void 0:i.length;return 1===(null==g?void 0:g.length)&&x<=1&&!I&&!c?j.b.getRowClientItemId(g[0],w).Id:null}()),We=Ue.perfDatapoint,Ve=Ue.perfDatapointCreatedTime,Be=function(){We.addCustomData({autoHide:!0})},Pe.eventManager.on(Q.a,Be),Ge={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.attachmentId},Ie(Ge,Oe),c.label=4;case 4:return c.trys.push([4,30,31,32]),[4,ae.canCloseSxS(Oe)];case 5:if(c.sent()||We.addCustomData({exitEditMode:"notSaved"}),te(),a&&!n||i(s,o,t,u,Oe,me),He=null==t?void 0:t.Id,ze=He&&Object(X.v)(He),je.setPreviewLoading(Pe,"",Re),ae.showSxS(Object(d.l)(Oe).shouldShow?null:b,{previewMode:Le,attachmentId:e.attachmentId,selectionSource:o,isCloudy:e.isCloudy,saveToCloudStatus:De,textPreviewReadMode:0},{editAllowed:_e.allowEdit&&!(Object(q.d)("sxsHideEdit")&&(Object(d.l)(Oe).shouldShow?Object(d.l)(Oe).customization:b)===d.f.DeepLink),itemId:t,isDraft:n},null,Oe,{itemId:He,fileId:e.attachmentId.Id,fileType:ge(Te),sender:null===(w=null===(m=(null==ze?void 0:ze.From)||(null==ze?void 0:ze.Sender))||void 0===m?void 0:m.Mailbox)||void 0===w?void 0:w.EmailAddress,startTime:(new Date).getTime()}),Object(d.M)(null),$e=void 0,a)return[3,25];switch(Le){case P.b.Image:return[3,6];case P.b.Wac:return[3,8];case P.b.GoogleDoc:return[3,10];case P.b.NativeView:return[3,11];case P.b.PdfJs:return[3,13];case P.b.Audio:return[3,15];case P.b.Video:return[3,16];case P.b.Text:return[3,17];case P.b.ItemAttachment:return[3,19];case P.b.CalendarEvent:return[3,20]}return[3,22];case 6:return[4,g()];case 7:return c.sent(),[3,23];case 8:return[4,I()];case 9:return c.sent(),[3,23];case 10:return je.setIframePreviewState(Pe,Te.model.AttachLongPathName,Re),[3,23];case 11:return[4,A()];case 12:return c.sent(),[3,23];case 13:return[4,E()];case 14:return c.sent(),[3,23];case 15:return je.setAudioPreviewState(Pe,Te.download.url,Re),[3,23];case 16:return je.setVideoPreviewState(Pe,Te.download.url,Re),[3,23];case 17:return[4,V()];case 18:return c.sent(),[3,23];case 19:return Object(de.a)(e.attachmentId,We),je.setCustomPreviewState(Pe,Re),[3,23];case 20:return[4,ee()];case 21:return c.sent(),[3,23];case 22:throw new Error("Unsupported preview method");case 23:return[4,ae.waitForPreviewLoadOrThrowError(Oe)];case 24:$e=c.sent(),c.label=25;case 25:return te(),xe(Oe),a?n?[4,d.u.import()]:[3,27]:[3,29];case 26:return c.sent()(fe,Oe),[3,29];case 27:return[4,d.t.import()];case 28:c.sent()(fe,pe,ve,Oe),c.label=29;case 29:return Je=null==$e?void 0:$e.errorObject,Xe=null==$e?void 0:$e.loadedTime,Je&&We.addCustomData({errorObject:Je}),Xe?(Ke=Xe-Ve,We.end(Ke)):We.end(),ae.repeatTracker.add(e.attachmentId.Id),[3,32];case 30:return qe=c.sent(),We.endWithError(se(qe)?"UserError":"ServerError",qe),[3,32];case 31:return Pe.eventManager.off(Q.a,Be),[7];case 32:return[2]}}))}))}var he=18e4,we=null;function ge(e){return 8!==e.attachmentClass&&9!==e.attachmentClass&&Object(V.c)(e.model.Name||"")||e.model.ContentType||""}var Oe=n(1675),Se=n(2188);function je(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.viewState&&Object(Oe.a)(e.viewState.attachmentId))&&Object(T.d)(t.model)?[4,Se.n.import()]:[3,2];case 1:return n.sent()(t.model,e.parentItemId),[2];case 2:return e.onBeforePreview&&e.onBeforePreview(),[4,me(e.viewState,e.parentItemId,e.isDraft,e.isEdit,e.attachmentSelectionSource,e.createImageGallery,{method:b.a.CopyMailReadingPaneContainer},e.instrumentationContext,e.targetWindow)];case 3:return n.sent(),[2]}}))}))}var Ie=n(9197);function xe(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=null,Object(W.i)("rp-projectionPopout")&&Object(W.i)("doc-SxS-multipleViews")?"IMG"!==(null===(n=null===(t=e)||void 0===t?void 0:t.tagName)||void 0===n?void 0:n.toUpperCase())?[3,2]:[4,Ie.b.import()]:[3,4];case 1:return i=r.sent(),a=i(e),[3,3];case 2:a=e,r.label=3;case 3:return[3,7];case 4:return e instanceof HTMLElement?[4,Ie.b.import()]:[3,6];case 5:return i=r.sent(),a=i(e),[3,7];case 6:a=e,r.label=7;case 7:return[2,a]}}))}))}function Pe(e,t,n,a){var o,c,s;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,l,f,p,v,m,w,g,O,S,j,I,x;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=(null===(c=null===(o=a)||void 0===o?void 0:o.ownerDocument)||void 0===c?void 0:c.defaultView)||window,l=u===window?"primaryTab":Object(h.f)(u),f=u!==window,oe.a.run(u,l),p=Object(d.l)(l),[4,d.B.import()];case 1:return v=r.sent(),[4,d.A.import()];case 2:return m=r.sent(),[4,xe(a)];case 3:(w=r.sent())||(w=p.viewState),g={downloadUrl:e.downloadUrl,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:e.id},O={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.id},v(O,l),r.label=4;case 4:return r.trys.push([4,8,,9]),[4,d.G.import()];case 5:return S=r.sent(),[4,Q.k.import()];case 6:return j=r.sent(),[4,T.h.import()];case 7:return I=r.sent(),x=null===(s=I(e.id))||void 0===s?void 0:s.info.allowDownload,p.pendingPreviewOperation&&O.id===p.pendingPreviewOperation.id||ce("Preview changed before loading finished"),i({method:b.a.CopyMailReadingPaneContainer},d.b.ReadingPane,null,null,l,f),j(w,e.previewUrl,t,x,!x&&!Object(R.e)().printWithoutDownloadEnabled,g),S(p.shouldShow?null:d.f.Mail,{previewMode:P.b.Image,attachmentId:e.id,selectionSource:d.b.ReadingPane,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:n,isDraft:!1},null,l),Object(d.M)(null),m(l),[3,9];case 8:return r.sent(),[3,9];case 9:return[2]}}))}))}function ye(e,t,n,a,o,c,s,u,l,b,f){return void 0===l&&(l=null),void 0===b&&(b=null),void 0===f&&(f=d.f.Mail),Object(r.__awaiter)(this,void 0,void 0,(function(){function p(){j.pendingPreviewOperation&&C.id===j.pendingPreviewOperation.id||ce("Preview changed before loading finished")}var v,m,h,w,g,O,S,j,I,y,T,_,C,A,k,D,E,M,R;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=u||window,v=u!==window,m=Object(d.k)(u),oe.a.run(u,m),h=e(),[4,Q.u.import()];case 1:return w=r.sent(),[4,d.H.import()];case 2:g=r.sent(),O=g.onPreviewOperationStart,S=g.onPreviewOperationFinished,j=Object(d.l)(m),I=j.viewState,y={downloadUrl:null,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:null,fileName:l,openInNewTabUrl:b},T=function(e,t){var n=new x.b("PreviewLinkInSxSE2E");return n.addCustomData({previewMethod:Z(e),actionSource:d.b[t]}),n}(P.b.Wac,n),_=function(){T.addCustomData({autoHide:!0})},I.eventManager.on(Q.a,_),C={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:null},O(C,m),r.label=3;case 3:return r.trys.push([3,10,11,12]),[4,g.canCloseSxS(m)];case 4:r.sent(),p(),i(a,n,t,o,m,v),w.setPreviewLoading(I,"",y),g.showSxS(j.shouldShow?null:f,{previewMode:P.b.Wac,attachmentId:null,selectionSource:n,isCloudy:!0,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:t,isDraft:!1},c,m),Object(d.M)(c,s),r.label=5;case 5:return r.trys.push([5,7,,8]),[4,h];case 6:return A=r.sent(),p(),A.jsApiInfo&&(k=Object(G.a)(),A.jsApiInfo.owaSessionId=k,D=ie(n,!0),A.jsApiInfo.sessionOrigin=D,y.fileName=A.jsApiInfo.fileName,function(e,t,n){var r=Object(V.c)(t.fileName);e.addCustomData({useJsApi:"true",officeFileType:Object(B.a)(r),owaSessionId:t.owaSessionId,extraInfo:n}),e.addCosmosOnlyData(JSON.stringify({fileType:(null==r?void 0:r.substring(0,4))||""}))}(T,A.jsApiInfo,A.extraInfo)),w.setWacPreviewState(I,A.wacUrl,A.jsApiInfo,A.accessToken,A.accessTokenTtl,A.additionalParameters,A.deprecatedTokenAndParameters,(new Date).getTime(),s,y),[3,8];case 7:throw E=r.sent(),(null==(M=E)?void 0:M.errorMessage)?(w.setPreviewError(I,M.errorMessage),M.error):(w.setPreviewError(I,E.message||""+E),E);case 8:return[4,g.waitForPreviewLoadOrThrowError(m)];case 9:return r.sent(),p(),S(m),T.end(),[3,12];case 10:return R=r.sent(),T.endWithError(se(R)?"UserError":"ServerError",R),[3,12];case 11:return I.eventManager.off(Q.a,_),[7];case 12:return[2]}}))}))}n.d(t,"previewAttachment",(function(){return je})),n.d(t,"previewAttachmentInSxS",(function(){return me})),n.d(t,"previewImageInSxS",(function(){return Pe})),n.d(t,"previewLinkInSxS",(function(){return ye})),n.d(t,"initializeItemReadingPaneInSxS",(function(){return l}))},4905:function(e){e.exports=JSON.parse('{"a":"tTb"}')},4920:function(e){e.exports=JSON.parse('{"a":"jVb"}')},5328:function(e){e.exports=JSON.parse('{"d":"vTb","e":"wTb","c":"xTb","g":"yTb","f":"zTb","a":"ATb","b":"BTb"}')},609:function(e,t,n){"use strict";var r=n(3),a=Object(r.action)("initializeOwaObservableDateTime"),i=Object(r.action)("observableNowChanged"),o=Object(r.action)("observableTodayChanged"),c=n(5),s=n(16),u=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(s.computed)((function(){return Object(c.lc)(u().now)})),l=function(){return d.get()},b=Object(s.computed)((function(){return Object(c.lc)(u().today)})),f=function(){return b.get()},p=function(e){return Object(c.Gb)(e,l())},v=function(e){return Object(c.Eb)(e,l())},m=function(e){return w(e,c.Gb)},h=function(e){return w(e,c.Hb)},w=function(e,t){return t(Object(c.Wb)(Object(c.lc)(e)),f())};function g(e){if(!e)return"";var t=Object(c.lc)(e);return function(e,t){var n=Object(c.Wb)(e);if(Object(c.Ib)(n,t))return c.Z;var r=function(e){return Object(c.Mb)(n,Object(c.e)(t,-e),t)};if(r(3))return c.hb;if(r(30))return c.gb;return c.X}(t,f())(t)}function O(e){if(!e)return"";var t=Object(c.lc)(e);return function(e,t){var n=Object(c.Wb)(e);if(Object(c.Ib)(n,t))return c.S;return c.T}(t,f())(t)}function S(e){return e?function(e,t){var n=Object(c.Wb)(e);return Object(c.Ib)(n,t)?Object(c.Z)(e):j(n,t,2)?Object(c.kb)(e):j(n,t,7)?Object(c.H)(Object(c.ab)(e),Object(c.Z)(e)):Object(c.H)(Object(c.J)(e),Object(c.Z)(e))}(Object(c.lc)(e),f()):""}function j(e,t,n){return Object(c.Mb)(e,Object(c.e)(t,-n),t)}var I=Object(r.action)("updateTimes"),x=Object(r.action)("setNow"),P=Object(r.action)("setToday",(function(e){return{today:e}}));Object(r.mutator)(x,(function(){u().now=Object(c.jc)()})),Object(r.mutator)(P,(function(e){var t=e.today;u().today=t}));var y=n(36),T=n(126);Object(r.orchestrator)(a,(function(){I();var e=Object(c.Pb)(),t=Object(c.Yb)(Object(c.h)(e,1)),n=Object(c.w)(t,e);setTimeout((function(){return setInterval(I,y.g)}),n)})),Object(r.orchestrator)(T.l,(function(){I()})),Object(r.orchestrator)(I,(function(){x();var e=Object(c.zb)(Object(c.kc)()),t=u().today!=e;t&&P(e),i(),t&&o()})),n.d(t,"d",(function(){return a})),n.d(t,"j",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return m})),n.d(t,"h",(function(){return h})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return S}))},693:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},706:function(e,t,n){"use strict";var r=n(44),a={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return a}));var i=new r.c((function(){return Promise.all([n.e(3),n.e(23),n.e(664)]).then(n.bind(null,17142))})),o=new r.a(i,(function(e){return e.subscribe})),c=new r.a(i,(function(e){return e.unsubscribe})),s=new r.b(i,(function(e){return e.getChannelId})),u=(new r.b(i,(function(e){return e.getChannelReady})),new r.a(i,(function(e){return e.setup}))),d=new r.a(i,(function(e){return e.initializeNotificationManager})),l=new r.b(i,(function(e){return e.getNotificationEmitter}))},7091:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1762),a=n(1720);function i(){var e=Object(a.d)(),t=Object(r.b)(),n=e?function(e,t){switch(e.type){case a.a.Primary:return t.primaryComposeId;case a.a.Compose:return e.data;default:return null}}(e,t):t.primaryComposeId,i=n?t.viewStates.get(n):null;return i&&!i.isInlineCompose?i:null}},793:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},e)}},9195:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(3135),i=n(7),o=n(4548),c=n(4906);function s(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(c.a)(e,t,n,!0)];case 1:return s=r.sent(),[3,3];case 2:throw u=r.sent(),{errorMessage:Object(i.b)(a.a),error:u};case 3:if(0===s.Status)return[2,{wacUrl:s.WacUrl,bootScriptUrl:s.BootScriptUrl,wopiSrcUrl:s.WopiSrcUrl,accessToken:s.AccessToken,accessTokenTtl:s.AccessTokenTtl,additionalParameters:s.AdditionalParameters,deprecatedTokenAndParameters:s.Token}];throw{errorMessage:Object(o.a)(s.Status),error:new Error("GetWacAttachmentInfo failed with status: "+s.Status)}}}))}))}}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxS.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxS.js'] = (new Date()).getTime();