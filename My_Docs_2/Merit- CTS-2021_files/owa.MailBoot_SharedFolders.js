self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SharedFolders.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[736],{12968:function(e){e.exports=JSON.parse('{"a":"s2b"}')},12969:function(e){e.exports=JSON.parse('{"a":"m3b"}')},1714:function(e,r,t){"use strict";var n,a;t.d(r,"b",(function(){return n})),t.d(r,"a",(function(){return a})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(a||(a={}))},347:function(e,r,t){"use strict";var n=t(0);function a(e,r){return e?Object(n.__assign)({mailboxInfo:e},r):null!=r?r:void 0}t.d(r,"a",(function(){return a}))},3675:function(e){e.exports=JSON.parse('{"a":"t0b"}')},4234:function(e){e.exports=JSON.parse('{"a":"n3b"}')},4561:function(e){e.exports=JSON.parse('{"a":"r2b"}')},4726:function(e,r,t){"use strict";t.d(r,"a",(function(){return o}));var n=t(1634),a=t(85);function o(e){return e||(e=Object(a.b)()),Object(n.u)(e).sharedFolderUserEmails}},5326:function(e,r,t){"use strict";t.d(r,"a",(function(){return o})),t.d(r,"b",(function(){return i}));var n=t(9),a=new n.b((function(){return t.e(869).then(t.bind(null,9193))})),o=new n.c(a,(function(e){return e.FolderHierarchyDocument})),i=new n.c(a,(function(e){return e.PrimaryFolderHierarchyDocument}))},5905:function(e,r,t){"use strict";t.r(r);var n=t(32),a=t(12968),o=t(4561),i=t(7),s=t(9693),c=t(1),d=t(6525),u=t(0),l=t(12969),b=t(3),f=Object(b.action)("ADD_SHARED_FOLDER_USER_EMAIL",(function(e,r){return{sharedUserMailboxSmtpAddress:e,userIdentity:r}})),O=Object(b.action)("ON_ADD_SHARED_FOLDER_SUCCESS",(function(e,r,t){return{sharedUserMailboxSmtpAddress:e,folder:r,userIdentity:t}})),h=t(28);function p(e,r){return t={displayName:e,primarySMTPAddress:r},Object(h.a)("AddSharedFolders",t,n);var t,n}var S=t(134),j=t(877),v=t(3675),_=t(34),y=t(85);function m(e,r,t,n){return void 0===t&&(t=!1),void 0===n&&(n=Object(y.b)()),Object(u.__awaiter)(this,void 0,void 0,(function(){var a;return Object(u.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t?[3,2]:[4,p(e,r)];case 1:if(!o.sent())return[2];o.label=2;case 2:return[3,4];case 3:return a=o.sent(),Object(j.b)(Object(i.b)(v.a),Object(i.b)(l.a),!1,{hideCancelButton:!0}),_.d("Add shared folder API returned error "+a),[2];case 4:return O(r,{FolderId:{Id:r},DisplayName:e,principalSMTPAddress:r,UnreadCount:0,TotalCount:0,DistinguishedFolderId:void 0,mailboxInfo:{type:"SharedMailbox",userIdentity:n,mailboxSmtpAddress:r}},n),f(r,n),t||Object(S.r)("Triage_SharedFolders_AddFolder"),[2]}}))}))}var g=Object(b.action)("showAddSharedFolderDialog",(function(e){return{showDialogMessageFlag:e}})),x=Object(n.a)((function(){return d.a.showPeoplePickerDialog&&c.createElement(s.a,{title:Object(i.b)(o.a),subTitle:Object(i.b)(a.a),addCallback:M,cancelCallback:A})}));function M(e){m(e.Name,e.EmailAddress)}function A(){g(!1)}var F=Object(b.action)("REMOVE_SHARED_FOLDER_USER",(function(e,r){return r||(r=Object(y.b)()),{sharedUserMailboxSmtpAddress:e,userIdentity:r}})),I=t(4726),R=Object(b.action)("REMOVE_SHARED_FOLDER_USER_EMAIL",(function(e,r){return{sharedUserMailboxSmtpAddress:e,userIdentity:r}})),D=(Object(b.mutator)(R,(function(e){var r=Object(I.a)(e.userIdentity),t=r.indexOf(e.sharedUserMailboxSmtpAddress);-1!==t?r.splice(t,1):_.d("Trying to remove a non-existent shared folder user : "+e.sharedUserMailboxSmtpAddress)})),Object(b.mutator)(f,(function(e){var r=Object(I.a)(e.userIdentity);-1==r.indexOf(e.sharedUserMailboxSmtpAddress)&&r.push(e.sharedUserMailboxSmtpAddress)})),Object(b.mutator)(g,(function(e){Object(d.b)().showPeoplePickerDialog=e.showDialogMessageFlag})),t(1634));Object(b.orchestrator)(O,(function(e){var r={};r[e.sharedUserMailboxSmtpAddress]=e.folder,Object(D.b)(r),Object(D.X)(e.sharedUserMailboxSmtpAddress,e.folder,D.a.Uninitialized,!0,0,e.userIdentity)}));var E=Object(b.action)("ON_SHARED_FOLDER_FETCH_FAILED",(function(e,r){return{sharedUserMailboxSmtpAddress:e,actionSource:r}})),P=t(52),w=t(7309),T=t(1644),U=t(380),C=t(5326),N=Object(b.action)("INITIALIZE_SHARED_FOLDER_RETENTION_POLICY_TAGS",(function(e,r){return{sharedUserMailboxSmtpAddress:e,userIdentity:r}}));Object(b.orchestrator)(w.a,(function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var r,t,n,a,o,i,s,c,d,l,b,f,O;return Object(u.__generator)(this,(function(h){switch(h.label){case 0:if(r=e.userIdentity,t=e.sharedUserMailboxSmtpAddress,n=e.actionSource,a=e.isLoadingMore,(o=Object(D.r)(t,r))===D.a.Loading||o===D.a.Loaded&&!a)return[2];Object(D.Y)(t,D.a.Loading,r),s=Object(D.p)(t,r),h.label=1;case 1:return h.trys.push([1,4,,5]),[4,Promise.all([Object(U.a)(),C.a.import()])];case 2:return c=u.__read.apply(void 0,[h.sent(),2]),d=c[0],l=c[1],[4,d.query({query:l,variables:{baseFolderDistinguishedIds:[T.l,"inbox"],indexedPageOffset:s,mailboxInfo:{userIdentity:r,mailboxSmtpAddress:t,type:"SharedMailbox"},shouldPopulateChildFolderIds:!1}})];case 3:return b=h.sent(),i=b.data.folderHierarchy,[3,5];case 4:return f=h.sent(),Object(S.r)("SharedFolders_FetchFailed",[f.ResponseCode,f.diagnosticInfo],{isCore:!0}),E(t,n),Object(D.Y)(t,D.a.ErrorLoading,r),[2];case 5:return O=Object(D.y)(t).DisplayName,Object(D.T)(i.RootFolder,i.Folders,T.l,t,O,t,r,i.IncludesLastItemInRange,i.IndexedPagingOffset),0===s&&N(t,r),p=i.TotalItemsInView,Object(S.r)("Triage_SharedFolders_OpenFolder",[Object(P.e)({value:p})]),[2]}var p}))}))}));var L=t(4234),k=t(2344),H=t(2775);function z(e){return r={primarySMTPAddress:e},Object(h.a)("RemoveSharedFolders",r,t);var r,t}Object(b.orchestrator)(E,(function(e){Object(k.k)(Object(i.b)(v.a),Object(i.b)(L.a)),"folderPane"===e.actionSource&&Object(H.a)(e.sharedUserMailboxSmtpAddress,!1)}));Object(b.orchestrator)(F,(function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var r,t,n,a;return Object(u.__generator)(this,(function(o){switch(o.label){case 0:r=e.sharedUserMailboxSmtpAddress,t=e.userIdentity,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,z(r)];case 2:return n=o.sent(),[3,4];case 3:return a=o.sent(),_.d("Remove shared folders server call failed with error "+a),[3,4];case 4:return n?(R(r,t),Object(D.W)(r,t),Object(S.r)("Triage_SharedFolders_RemoveFolder")):_.d("Remove shared folders server call returned false"),[2]}}))}))}));function J(e,r){var t;return void 0===e||e.__type||(t=e,e=Object(u.__assign)({__type:"GetUserRetentionPolicyTagsJsonRequest:#Exchange"},t)),Object(h.a)("GetUserRetentionPolicyTags",e,r)}var W=t(197),q=t(347);var B=Object(b.mutatorAction)("setPolicyTags",(function(e,r){Object(d.b)().retentionPolicyTags.set(e,r)}));function G(){return e={},Object(h.a)("GetOtherMailboxConfiguration",e,r);var e,r}Object(b.orchestrator)(N,(function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var r,t,n,a,o;return Object(u.__generator)(this,(function(i){switch(i.label){case 0:r=e.sharedUserMailboxSmtpAddress,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(s=r,c={type:"SharedMailbox",userIdentity:Object(y.b)(),mailboxSmtpAddress:s},d=Object(q.a)(c),J({Header:Object(W.b)(),Body:{}},d))];case 2:return t=i.sent(),"Success"===(null===(a=null==t?void 0:t.Body)||void 0===a?void 0:a.ResponseClass)?B(r,t.Body.RetentionPolicyTags):_.d("Initialize shared folders policy tags server call failed with error "+(null===(o=null==t?void 0:t.Body)||void 0===o?void 0:o.MessageText)),[3,4];case 3:return n=i.sent(),_.d("Initialize shared folders policy tags server call failed with error "+n),[3,4];case 4:return[2]}var s,c,d}))}))}));var V=t(44),Y=Object(V.e)(D.C,"initializeSharedFolderRootsOrchestratorClone",(function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e,r;return Object(u.__generator)(this,(function(t){switch(t.label){case 0:return[4,G()];case 1:return e=t.sent(),(r=null==e?void 0:e.OtherMailboxEntries)?r.length>0&&(r.forEach((function(e){m(e.DisplayName,e.PrincipalSMTPAddress,!0)})),n=r.length,Object(S.r)("Triage_SharedFolders_LoadList",[Object(P.e)({value:n})])):_.d("initializeSharedFolderRoots failed with getOtherMailboxConfiguration response as : "+e),[2]}var n}))}))}));t.d(r,"SharedFolderPeoplePicker",(function(){return x})),t.d(r,"showSharedFolderPeoplePickerDialog",(function(){return g})),t.d(r,"removeSharedFolderUser",(function(){return F})),t.d(r,"initializeSharedFolderRootsOrchestrator",(function(){return Y}))},6525:function(e,r,t){"use strict";t.d(r,"b",(function(){return o}));var n=t(3),a={showPeoplePickerDialog:!1,retentionPolicyTags:new(t(16).ObservableMap)({})},o=Object(n.createStore)("sharedFolderState",a),i=o();r.a=i},7309:function(e,r,t){"use strict";t.d(r,"a",(function(){return o}));var n=t(3),a=t(85),o=Object(n.action)("GET_SHARED_FOLDERS",(function(e,r,t,n){return n||(n=Object(a.b)()),{sharedUserMailboxSmtpAddress:e,actionSource:r,isLoadingMore:t,userIdentity:n}}))},7378:function(e,r,t){"use strict";t.d(r,"b",(function(){return a})),t.d(r,"a",(function(){return o}));var n=t(3),a=Object(n.action)("populateUserMailboxInfo",(function(e){return{userMailboxWrapper:e}})),o=Object(n.action)("ON_DISMISSED")},7379:function(e,r,t){"use strict";t.d(r,"b",(function(){return i}));var n=t(1714),a=t(3),o={userMailboxWrapper:null,findControlViewState:{queryString:"",findResultSet:[],findResultType:n.b.None,isSearching:!1,directorySearchType:n.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}},i=Object(a.createStore)("peoplePickerDialogStore",o);r.a=i()},9693:function(e,r,t){"use strict";var n=t(7378),a=t(7379),o=t(1714),i=t(3),s=(Object(i.mutator)(n.b,(function(e){Object(a.b)().userMailboxWrapper=e.userMailboxWrapper})),Object(i.mutator)(n.a,(function(){var e=Object(a.b)();e.userMailboxWrapper=null,e.findControlViewState={queryString:"",findResultSet:[],findResultType:o.b.None,isSearching:!1,directorySearchType:o.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}})),t(44));t.d(r,"a",(function(){return d}));var c=new s.c((function(){return Promise.all([t.e(4),t.e(6),t.e(13),t.e(33),t.e(48),t.e(65),t.e(689)]).then(t.bind(null,17433))})),d=Object(s.d)(c,(function(e){return e.PeoplePickerDialog}))}}]);
//# sourceMappingURL=owa.MailBoot~SharedFolders.js.map
self.scriptsLoaded['owa.MailBoot~SharedFolders.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SharedFolders.js'] = (new Date()).getTime();