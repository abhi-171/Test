self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SharingData.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[738,454],{1024:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(0);function i(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},1057:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(28),i=t(1024);function a(e,n){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindItem",e,n)}},1058:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(0);function i(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},14471:function(e){e.exports=JSON.parse('{"b":"Tla","a":"Ula"}')},14472:function(e){e.exports=JSON.parse('{"h":"Ela","i":"Fla","j":"Gla","d":"Hla","k":"Ila","e":"Jla","g":"Kla","m":"Lla","o":"Mla","f":"Nla","l":"Ola","n":"Pla","a":"Qla","c":"Rla","b":"Sla"}')},1662:function(e,n,t){"use strict";var r=t(1641),i=t(1839),a=t(7);function s(e){var n;return e>=1073741824?(e/=1073741824,n=Object(a.b)(i.b)):e>=1048576?(e/=1048576,n=Object(a.b)(i.d)):e>=1024?(e/=1024,n=Object(a.b)(i.c)):n=Object(a.b)(i.a),Object(a.c)(n,Math.round(e))}var o,u=t(1709),c=t(40),l=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(c.i)("doc-attachment-documentThumbnail"))return!1;var n=Object(r.a)(e);return!!n&&l.indexOf(n.toLowerCase())>=0}function d(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return o.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return o.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return o.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(o||(o={}));var p=t(1676);t.d(n,"b",(function(){return r.a})),t.d(n,"c",(function(){return r.b})),t.d(n,"d",(function(){return r.c})),t.d(n,"i",(function(){return s})),t.d(n,"g",(function(){return u.a})),t.d(n,"h",(function(){return f})),t.d(n,"f",(function(){return d})),t.d(n,"e",(function(){return p.b})),t.d(n,"a",(function(){return o}))},1676:function(e,n,t){"use strict";function r(e){return n=e||"",(t=a.exec(n))&&t.length>1&&i[t[1].toLowerCase()];var n,t}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return s}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},a=/^\s*([^;\s]*)(?:;|\s|$)/;function s(e){var n="";return Object.entries(i).forEach((function(t){t[1]===e&&(n=t[0])})),n}},1682:function(e,n,t){"use strict";var r,i,a;t.d(n,"c",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return a})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(a||(a={}))},1709:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return c}));var r=t(1641),i=t(1676),a=t(76),s=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],o=[".tiff",".tif"];function u(e,n,t){return void 0===t&&(t=!0),c(Object(r.a)(e)||Object(i.a)(n),t)}function c(e,n){return void 0===n&&(n=!0),!!e&&(s.indexOf(e.toLowerCase())>=0||n&&o.indexOf(e.toLowerCase())>=0&&(Object(a.e)()||Object(a.d)()||Object(a.h)()||Object(a.g)()&&!Object(a.l)()))}},1753:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(0);function i(e){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},e)}},178:function(e,n,t){"use strict";t.d(n,"d",(function(){return a})),t.d(n,"c",(function(){return s})),t.d(n,"e",(function(){return o})),t.d(n,"b",(function(){return u})),t.d(n,"a",(function(){return c})),t.d(n,"f",(function(){return l}));var r=t(44),i=new r.c((function(){return Promise.all([t.e(3),t.e(23),t.e(877)]).then(t.bind(null,1247))})),a=new r.a(i,(function(e){return e.makePostRequest})).importAndExecute,s=new r.a(i,(function(e){return e.makePatchRequest})).importAndExecute,o=new r.a(i,(function(e){return e.makePutRequest})).importAndExecute,u=new r.a(i,(function(e){return e.makeGetRequest})).importAndExecute,c=new r.a(i,(function(e){return e.makeDeleteRequest})).importAndExecute,l=new r.a(i,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},1830:function(e,n){e.exports=function(e){return e instanceof Date}},1839:function(e){e.exports=JSON.parse('{"b":"Hca","d":"Ica","c":"Jca","a":"Kca"}')},1869:function(e,n,t){var r=t(1830),i=36e5,a=6e4,s=2,o=/[T ]/,u=/:/,c=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,d=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,h=/^-?(\d{3})$/,g=/^-?(\d{2})-?(\d{2})$/,m=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,v=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,x=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,j=/^(Z)$/,k=/^([+-])(\d{2})$/,w=/^([+-])(\d{2}):?(\d{2})$/;function I(e,n,t){n=n||0,t=t||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*n+t+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,n){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var t=(n||{}).additionalDigits;t=null==t?s:Number(t);var y=function(e){var n,t={},r=e.split(o);u.test(r[0])?(t.date=null,n=r[0]):(t.date=r[0],n=r[1]);if(n){var i=S.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}(e),L=function(e,n){var t,r=l[n],i=d[n];if(t=f.exec(e)||i.exec(e)){var a=t[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(t=c.exec(e)||r.exec(e)){var s=t[1];return{year:100*parseInt(s,10),restDateString:e.slice(s.length)}}return{year:null}}(y.date,t),P=L.year,E=function(e,n){if(null===n)return null;var t,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(n),r;if(t=p.exec(e))return r=new Date(0),i=parseInt(t[1],10)-1,r.setUTCFullYear(n,i),r;if(t=h.exec(e)){r=new Date(0);var s=parseInt(t[1],10);return r.setUTCFullYear(n,0,s),r}if(t=g.exec(e)){r=new Date(0),i=parseInt(t[1],10)-1;var o=parseInt(t[2],10);return r.setUTCFullYear(n,i,o),r}if(t=m.exec(e))return a=parseInt(t[1],10)-1,I(n,a);if(t=b.exec(e)){a=parseInt(t[1],10)-1;var u=parseInt(t[2],10)-1;return I(n,a,u)}return null}(L.restDateString,P);if(E){var T,C=E.getTime(),D=0;return y.time&&(D=function(e){var n,t,r;if(n=v.exec(e))return(t=parseFloat(n[1].replace(",",".")))%24*i;if(n=O.exec(e))return t=parseInt(n[1],10),r=parseFloat(n[2].replace(",",".")),t%24*i+r*a;if(n=x.exec(e)){t=parseInt(n[1],10),r=parseInt(n[2],10);var s=parseFloat(n[3].replace(",","."));return t%24*i+r*a+1e3*s}return null}(y.time)),y.timezone?T=function(e){var n,t;if(n=j.exec(e))return 0;if(n=k.exec(e))return t=60*parseInt(n[2],10),"+"===n[1]?-t:t;if(n=w.exec(e))return t=60*parseInt(n[2],10)+parseInt(n[3],10),"+"===n[1]?-t:t;return 0}(y.timezone):(T=new Date(C+D).getTimezoneOffset(),T=new Date(C+D+T*a).getTimezoneOffset()),new Date(C+D+T*a)}return new Date(e)}},1915:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),n.b=r},195:function(e,n,t){"use strict";function r(){var e=Object.create(null),n=0,t=0,r=0,i=!1;function a(n){r--,delete e[n]}this.put=function(n,t,i,s){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==s&&"function"!=typeof s)throw new Error("Cache timeout callback must be a function");var o=e[n];o?clearTimeout(o.timeout):r++;var u={value:t,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){a(n),s&&s(n,t)}.bind(this),i)),e[n]=u,t},this.del=function(n){var t=!0,r=e[n];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(t=!1)):t=!1,t&&a(n),t},this.clear=function(){for(var a in e)clearTimeout(e[a].timeout);r=0,e=Object.create(null),i&&(n=0,t=0)},this.get=function(a){var s=e[a];if(void 0!==s){if(isNaN(s.expire)||s.expire>=Date.now())return i&&n++,s.value;i&&t++,r--,delete e[a]}else i&&t++;return null},this.size=function(){return r},this.memsize=function(){var n,t=0;for(n in e)t++;return t},this.debug=function(e){i=e},this.hits=function(){return n},this.misses=function(){return t},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var n={};for(var t in e){var r=e[t];n[t]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(n)},this.importJson=function(n,t){var r=JSON.parse(n),i=Date.now(),a=t&&t.skipDuplicates;for(var s in r)if(r.hasOwnProperty(s)){if(a)if(e[s])continue;var o=r[s],u=o.expire-i;if(u<=0){this.del(s);continue}u=u>0?u:void 0,this.put(s,o.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},218:function(e,n,t){"use strict";var r=t(693);t.d(n,"a",(function(){return r.a}))},2463:function(e,n,t){"use strict";t.d(n,"e",(function(){return s})),t.d(n,"b",(function(){return o})),t.d(n,"f",(function(){return u})),t.d(n,"g",(function(){return c})),t.d(n,"c",(function(){return l})),t.d(n,"d",(function(){return f}));var r=t(44),i=t(3054);t.d(n,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([t.e(32),t.e(67),t.e(561)]).then(t.bind(null,6973))})),s=new r.b(a,(function(e){return e.createGetSharingInfoResponse})),o=new r.b(a,(function(e){return e.checkSharingLinkUrlDomain})),u=new r.b(a,(function(e){return e.getLinkProviderType})),c=new r.b(a,(function(e){return e.isOneDriveProRelatedLink})),l=new r.b(a,(function(e){return e.convertToAttachmentDataProviderType})),f=new r.b(a,(function(e){return e.convertToLinkProviderType}))},3054:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},3241:function(e,n,t){"use strict";t.r(n);var r=t(0),i=t(105),a=t(40),s=t(2463),o=t(2982),u=t(218);function c(e){return Object(r.__assign)({__type:"GetSharingInfoRequest:#Exchange"},e)}function l(e){return Object(r.__assign)({__type:"GetSharingInfoResponse:#Exchange"},e)}var f=t(28);var d,p,h=t(34);!function(e){e.OneDrivePro="OneDrivePro"}(d||(d={})),function(e){e.None="None",e.View="View",e.Edit="Edit",e.AnonymousView="AnonymousView",e.AnonymousEdit="AnonymousEdit",e.OrganizationView="OrganizationView",e.OrganizationEdit="OrganizationEdit"}(p||(p={}));var g=t(178),m="ows/api/beta/sharinglink/info";function b(e,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(g.d)(m,{url:e},void 0,n)];case 1:return[2,t.sent()]}}))}))}function v(e,n){return c({attachmentUrl:e,useReadWriteServer:n})}function O(e,n,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,s.c.import()];case 1:switch(u=r.sent(),n){case s.a.OneDrivePro:case s.a.OfficeOneDrivePro:return Object(a.i)("doc-attachment-sharingLinkInfoOWSPrimeService")?[2,x(e)]:[2,(l=v(e,t),void 0===l||l.__type||(l=c(l)),Object(f.a)("GetSharingInformation",l,d))];case s.a.OneDriveConsumer:case s.a.Dropbox:case s.a.Box:case s.a.GDrive:return[2,Object(o.j)(e,u(n))];default:return[2,Object(i.a)(n)]}return[2]}var l,d}))}))}function x(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t,i,a,s,o,c,f,g,m,v,O;return Object(r.__generator)(this,(function(x){switch(x.label){case 0:return[4,b(e,!0)];case 1:return n=x.sent(),Object(u.a)(n.status)?(a=(i=JSON).parse,[4,n.text()]):[3,3];case 2:if(function(e){return e.providerType===d.OneDrivePro}(t=a.apply(i,[x.sent()])))return s=Object(r.__read)(t.sharingLinks.filter((function(e){return e.type===p.AnonymousEdit})),1),o=s[0],c=Object(r.__read)(t.sharingLinks.filter((function(e){return e.type===p.AnonymousView})),1),f=c[0],g=Object(r.__read)(t.sharingLinks.filter((function(e){return e.type===p.OrganizationEdit})),1),m=g[0],v=Object(r.__read)(t.sharingLinks.filter((function(e){return e.type===p.OrganizationView})),1),O=v[0],[2,l({AccessRequestMode:t.accessRequestMode,AnonymousEditLink:o?o.url:void 0,AnonymousViewLink:f?f.url:void 0,CanCreateAnonymousEditLink:t.canCreateAnonymousEditLink,CanCreateAnonymousViewLink:t.canCreateAnonymousViewLink,CanCreateOrganizationEditLink:t.canCreateOrganizationEditLink,CanCreateOrganizationViewLink:t.canCreateOrganizationViewLink,CanShareExternally:t.canShareExternally,CanShareInternally:t.canShareInternally,CanonicalUrl:t.canonicalUrl,ExpirationDate:t.expirationTime,FileName:t.name,IsAnonymousEditLinkAvailable:!!o,IsAnonymousViewLinkAvailable:!!f,IsOrganizationEditLinkAvailable:!!m,IsOrganizationViewLinkAvailable:!!O,MimeType:void 0,OrganizationEditLink:m?m.url:void 0,OrganizationViewLink:O?O.url:void 0,ResultCode:0,SharingLinkKind:S(t.linkType)})];throw new Error("Invalid response from OWS` from sharing link info");case 3:return 404===n.status?[2,l({ResultCode:4})]:400===n.status?[2,l({ResultCode:24})]:(h.g.warn("Invalid response for OWS' get share info. Status code: "+n.status),[2,l({ResultCode:1})]);case 4:return[2]}}))}))}function S(e){switch(e){case p.None:return 0;case p.View:case p.Edit:return 1;case p.AnonymousView:return 4;case p.AnonymousEdit:return 5;case p.OrganizationView:return 2;case p.OrganizationEdit:return 3;default:return Object(i.a)(e)}}var j=t(7),k=t(14471),w=t(1818);var I=t(8827),y=t(7458),L=t(1990);function P(e,n,t){if(1!==e.length||null===t)return null;switch(n){case w.a.noPermissionToShare:case w.a.noPermissionToShareExternally:case w.a.externalRecipientCSL:case w.a.sharingWithLargeDL:return e[0].supportsDownsell?[t(e[0].id)]:null;case w.a.getSharingInfoFailed:case w.a.noPermissionSet:return null;case w.a.linkHasExpired:case w.a.linkWillExpire:return function(e){return[{text:Object(j.b)(y.a),action:function(){Object(L.a)(e.id)}},{text:Object(j.b)(I.a),action:function(){e.sharingTipsIgnored.push(w.a.linkHasExpired),e.sharingTipsIgnored.push(w.a.linkWillExpire)}}]}(e[0]);default:return Object(i.a)(n)}}var E=t(1682);function T(e,n){return n.filter((function(e){return e.externalMemberCount>0})).length>0&&e.sharingInfo&&!e.sharingInfo.canShareExternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var C=100,D=1,R="PublicDL",F="PrivateDL",_="GroupMailbox",A="RecommendedGroup",M="InternalMailbox",W="ExternalMailbox",N="Mailbox",G="OneOff",z="Contact",V="ImplicitContact",$="PublicFolder",U="Other",H="Room",J="LinkedIn";function q(e){return e.some((function(e){return e.totalMemberCount>C}))}function Y(e,n){return q(n)&&e.sharingInfo&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}function B(e){return e.sharingInfo&&!e.sharingInfo.getSharingInfoSucceeded}function K(e,n){return n.filter((function(e){return e.externalMemberCount>0})).length>0&&(6===e.currentPermissionLevel||5===e.currentPermissionLevel)}var Z=t(5);function Q(e){return(null==e?void 0:e.sharingInfo)&&!!e.sharingInfo.expirationDate&&Object(Z.Gb)(e.sharingInfo.expirationDate,Object(Z.Pb)())}function X(e){return(null==e?void 0:e.sharingInfo)&&!!e.sharingInfo.expirationDate&&Object(Z.Eb)(e.sharingInfo.expirationDate,Object(Z.Pb)())}var ee=t(1963);function ne(e){return e.recipientPermissionInfos.some((function(e){return e.getPermissionInfoStatus===ee.a.Failed}))}var te=t(1915);function re(e){switch(e){case R:case F:case _:case A:return!0;default:return!1}}function ie(e,n){return e.filter((function(e){return function(e){var t=n?re(e.recipient.persona.EmailAddress.MailboxType):e.totalMemberCount>1,r=e.totalMemberCount<=C;return t&&r}(e)}))}function ae(e){return ie(e,!0).some((function(e){return e.recipient.expansionStatus===te.b.Failed||e.recipient.expansionStatus===te.b.SucceededWithDLOrGroupMembers}))}function se(e,n){return oe(e.sharingRecipientsInfo,n)?0===e.currentPermissionLevel&&e.sharingInfo&&e.sharingInfo.getSharingInfoSucceeded:0===e.currentPermissionLevel&&e.sharingRecipientsInfo.recipientPermissionInfos.some((function(e){return!e.hasAccess&&e.getPermissionInfoStatus===ee.a.Succeeded}))||(1===e.currentPermissionLevel||2===e.currentPermissionLevel)&&function(e){return e.recipientPermissionInfos.some((function(e){return!e.hasAccess&&!e.canHaveAccess&&e.getPermissionInfoStatus===ee.a.Succeeded}))}(e.sharingRecipientsInfo)}function oe(e,n){return q(n)||ae(n)||ne(e)}function ue(e){var n;return(null===(n=e.sharingInfo)||void 0===n?void 0:n.getSharingInfoSucceeded)&&!e.sharingInfo.canShareInternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var ce=t(1991);var le=t(134),fe=t(14472);var de=function(e){return e?e.filter((function(e){return e.totalMemberCount>100})).map((function(e){return e.recipient.persona.EmailAddress.Name})).join(", "):""};function pe(e,n,t,r){if(oe(e,n))return Object(j.b)(fe.o);var i=e.recipientPermissionInfos,a=null,s=!1;if(0===t?(a=i.filter((function(e){return!e.hasAccess&&e.getPermissionInfoStatus===ee.a.Succeeded})),Object(le.r)("RecipientCanNotAccess",{numOfRecipients:a.length,linkId:r})):1!==t&&2!==t||(s=!0,a=i.filter((function(e){return!e.hasAccess&&!e.canHaveAccess&&e.getPermissionInfoStatus===ee.a.Succeeded})),Object(le.r)("RecipientCanNotHaveAccess",{numOfRecipients:a.length})),null!==a){var o=a.length,u=function(e){return e.map((function(e){return e.name?e.name:e.emailAddress})).join(", ")}(a.slice(0,3));return 1===o?Object(j.c)(Object(j.b)(s?fe.c:fe.l),u,"{0}"):o<4?Object(j.c)(Object(j.b)(s?fe.c:fe.n),u,"{0}"):Object(j.c)(Object(j.b)(s?fe.b:fe.a),u,"{0}")}return Object(j.b)(fe.o)}function he(e,n,t,r,s){if(!function(e){switch(e){case w.a.noPermissionToShare:case w.a.noPermissionToShareExternally:case w.a.externalRecipientCSL:case w.a.noPermissionSet:case w.a.sharingWithLargeDL:case w.a.linkWillExpire:case w.a.linkHasExpired:return!0;case w.a.getSharingInfoFailed:return Object(a.i)("doc-attachment-sharingInfoFailureTip");default:return Object(i.a)(e)}}(n))return null;var o=function(e){switch(e){case w.a.noPermissionToShare:return ue;case w.a.getSharingInfoFailed:return B;case w.a.linkHasExpired:return Q;case w.a.linkWillExpire:return X;case w.a.externalRecipientCSL:return K;case w.a.noPermissionToShareExternally:return T;case w.a.noPermissionSet:return se;case w.a.sharingWithLargeDL:return Y;default:return Object(i.a)(e)}}(n),u=e.filter((function(e){return o(e,t)}));if(0===u.length)return null;var c=u.filter((function(e){return!Object(j.f)(e.name)})).map((function(e){return e.name})).join(", "),l=function(e,n,t){switch(e){case w.a.noPermissionToShare:return{singleFile:Object(j.b)(fe.h),multipleFiles:Object(j.b)(fe.h)};case w.a.getSharingInfoFailed:return{singleFile:Object(j.b)(fe.i),multipleFiles:Object(j.b)(fe.i)};case w.a.linkHasExpired:return{singleFile:Object(j.b)(fe.j),multipleFiles:Object(j.b)(fe.d)};case w.a.linkWillExpire:return{singleFile:Object(j.b)(fe.k),multipleFiles:Object(j.b)(fe.e)};case w.a.noPermissionToShareExternally:return{singleFile:Object(j.b)(fe.g),multipleFiles:Object(j.b)(fe.g)};case w.a.externalRecipientCSL:return{singleFile:Object(j.b)(fe.m),multipleFiles:Object(j.b)(fe.m)};case w.a.noPermissionSet:return{singleFile:pe(t[0].sharingRecipientsInfo,n,t[0].currentPermissionLevel,"string"==typeof t[0].id?t[0].id:""),multipleFiles:Object(j.b)(fe.o)};case w.a.sharingWithLargeDL:var r=de(n);return{singleFile:Object(j.c)(Object(j.b)(fe.f),r,"{0}","{1}"),multipleFiles:Object(j.c)(Object(j.b)(fe.f),r,"{0}","{1}")};default:return Object(i.a)(e)}}(n,t,u),f=u.length>1?l.multipleFiles:l.singleFile;c&&0!==c.length||!f||0===f.length||h.d("file names should not be null or empty if the infobarStringTemplate is not");var d,p=P(u,n,s),g=function(e){switch(e){case w.a.noPermissionToShare:case w.a.noPermissionToShareExternally:return[ce.a.ignore,ce.a.attachAsACopy];case w.a.getSharingInfoFailed:return[ce.a.ignore];case w.a.externalRecipientCSL:case w.a.noPermissionSet:case w.a.sharingWithLargeDL:return[ce.a.ignore,ce.a.changePermission,ce.a.attachAsACopy];case w.a.linkWillExpire:case w.a.linkHasExpired:return[ce.a.ignore,ce.a.refreshExpiration];default:return Object(i.a)(e)}}(n);if(r||null!==p&&0!==p.length)d=Object(j.c)(f,c);else{var m="",b=function(e){switch(e){case w.a.noPermissionToShare:case w.a.noPermissionToShareExternally:case w.a.externalRecipientCSL:return{singleFile:Object(j.b)(k.b),multipleFiles:Object(j.b)(k.a)};case w.a.getSharingInfoFailed:case w.a.linkHasExpired:case w.a.linkWillExpire:case w.a.noPermissionSet:case w.a.sharingWithLargeDL:return null;default:return Object(i.a)(e)}}(n);null!==b&&(m=u.length>1?b.multipleFiles:b.singleFile),d=Object(j.c)(f,c,m)}return{id:n,sharingTipString:d,actions:p,sharingTipActions:g,messageRank:function(e){switch(e){case w.a.noPermissionToShare:case w.a.noPermissionToShareExternally:case w.a.sharingWithLargeDL:case w.a.linkHasExpired:case w.a.externalRecipientCSL:case w.a.noPermissionSet:return E.b.Error;case w.a.linkWillExpire:case w.a.getSharingInfoFailed:return E.b.Info;default:return Object(i.a)(e)}}(n)}}function ge(e,n,t,r,i){var a=he(e,n,t,r,i);if(null===a)return null;var s={key:n,source:E.c.Compose,rank:a.messageRank,message:a.sharingTipString,messageParts:[a.sharingTipString]};return null!==a.actions&&a.actions.map((function(e){s.messageParts.push(e)})),function(e){return s}}var me=new Map;function be(e,n){var t=[];me.has(e)&&(t=me.get(e)),ve(t,[],e,n,"deleteLink")}function ve(e,n,t,r,i){void 0===i&&(i=null);var a=i||"UnknownActionSource",s=n.filter((function(n){return-1===e.indexOf(n)})),o=e.filter((function(e){return-1===n.indexOf(e)}));s.length>0&&(s.unshift(r),s.unshift(a),Object(le.r)("LinkSharingTipsAdded",s,{cosmosOnlyData:t})),o.length>0&&(o.unshift(r),o.unshift(a),Object(le.r)("LinkSharingTipsRemoved",o,{cosmosOnlyData:t}))}function Oe(e,n){var t,r,i,a,s=Object(w.b)().filter((function(n){return-1===e.sharingTipsIgnored.indexOf(n)})).map((function(t){return he([e],t,n,!0)})).filter((function(e){return null!==e}));if("string"==typeof e.id){var o=s.map((function(e){return e.id}));t=e.id,r=o,i=e.typeOfLink,a=[],me.has(t)&&(a=me.get(t)),ve(a,r,t,i),me.set(t,r)}return s}function xe(e){switch(e){case M:case W:case N:case G:case z:case V:case J:return!0;default:return!e||re(e)||function(e){switch(e){case $:case U:case H:return!0;default:return!1}}(e)||h.d("UnknownMailboxType: "+e),!1}}function Se(e){return e.filter((function(e){return e.totalMemberCount===D&&xe(e.recipient.persona.EmailAddress.MailboxType)}))}t.d(n,"getSharingInformation",(function(){return O})),t.d(n,"getInfoBarCreator",(function(){return ge})),t.d(n,"getSharingIssuesForSharingData",(function(){return Oe})),t.d(n,"hasGetRecipientPermissionFailed",(function(){return ne})),t.d(n,"hasLargeDLRecipient",(function(){return q})),t.d(n,"hasRecipientExpansionFailure",(function(){return ae})),t.d(n,"getGroupsAndSmallDLs",(function(){return ie})),t.d(n,"getInvididualRecipients",(function(){return Se})),t.d(n,"logSharingTipChangesForLinkRemoval",(function(){return be}))},342:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return s}));var r,i=t(0);function a(e){r=e}function s(){var e,n;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(a=r)?[4,r()]:[3,2];case 1:a=i.sent(),i.label=2;case 2:if((t=a)&&t.length>0){if("bearer"===(null===(e=null==t?void 0:t.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,t.split(" ")[1]];if("msauth1.0"===(null===(n=null==t?void 0:t.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return[2,t]}return[2,void 0]}}))}))}},424:function(e,n,t){"use strict";var r=function(){function e(e,n,t){this.maxParallelTasks=e,this.taskCallback=n,this.taskDelay=t,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();t.d(n,"a",(function(){return r}))},693:function(e,n,t){"use strict";function r(e){return e>=200&&e<300}t.d(n,"a",(function(){return r}))},7458:function(e){e.exports=JSON.parse('{"a":"Wla"}')},790:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(0);function i(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},8827:function(e){e.exports=JSON.parse('{"a":"Vla"}')}}]);
//# sourceMappingURL=owa.MailBoot~SharingData.js.map
self.scriptsLoaded['owa.MailBoot~SharingData.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SharingData.js'] = (new Date()).getTime();