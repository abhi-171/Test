self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[637],{1003:function(e,t,n){"use strict";var r=n(0),o=n(62),i=600,a=800,c=8,u=25,s={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},d=-1;function l(e,t,n){try{t=function(e){var t=u*(1+(d=(d+1)%c)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),i),width:Math.max(8*Math.pow(window.innerWidth,2/3),a)};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s),n),e)}(t);var l=(n||window).open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(o.e)()||Object(o.f)())&&l.moveTo(t.left,t.top),l}catch(e){return null}}var f=n(998);var b=n(2),v=n(495),O=n(670),p="version";var j=n(52),w=n(791),m=n(134);t.a=Object(j.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,o,i){return[(t||"").split("/")[0],i]}})((function(e,t,n,r,o,i,a){var c=function(e){var t=null,n=void 0,r=null,o=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,Object(f.b)().isAvailable&&(t=e.projectionTabId||null),r=e.projectionTargetWindow,o=e.projectionParentWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r,projectionParentWindow:o}}(n),u=c.deeplinkCallback,s=c.projectionTabId,d=c.projectionTargetWindow,j=c.projectionParentWindow,h=new m.b(s?"PopoutProjectionPerf":"PopoutDeeplinkPerf"),I=s?"about:blank":function(e,t,n,r){var o;void 0===r&&(r={});var i=((o={})[p]=Object(b.p)(),o[O.a]=O.b,o);return Object.keys(r).map((function(e){i[e]=r[e]})),Object(v.p)(e,t,n,i)}(e,t,o,a),g=d||l(I,r,j);g&&w.h.import().then((function(t){return t(e,g,s,u,h)}))}))},1256:function(e,t,n){var r=n(1257),o=n(107);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1257:function(e,t,n){(t=e.exports=n(106)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},12966:function(e){e.exports=JSON.parse('{"a":"bJc"}')},1655:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function o(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},1656:function(e,t,n){"use strict";var r=n(0),o=n(1697),i=n(346),a=n(609),c=n(134),u=n(5),s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function b(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,v,O,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(e)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return t?(n[s]=t,n[f]=t):b&&(n[s]=b.anchorMailbox),b?(v=b.token,!(O=Object(a.g)(b.tokenExpiry))&&v?[3,2]:(Object(c.r)("getAndUpdateAccessToken",{tokenExpiry:Object(u.y)(b.tokenExpiry,Object(u.Pb)()),isTokenExpired_1:O,isTokenInvalid_2:!v},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,e,v)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:p=void 0,"Outlook"==b.accountProviderType?(p='MSAuth1.0 usertoken="'+v+'", type="MSACT"',n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(p="Bearer "+v,n[l]=2..toString()),n[d]=p,r.label=3;case 3:return[2,n]}}))}))}var v=n(1655),O=n(34);function p(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(v.a)(),o=n,[4,j(e,t)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function j(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,b(e.mailboxInfo.userIdentity,w(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(v.b)(o,i),[2,o]}}))}))}function w(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&O.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return w}))},1657:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},1697:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(44),o=n(1657);n.d(t,"b",(function(){return o.a}));var i=new r.c((function(){return n.e(1261).then(n.bind(null,1903))})),a=new r.a(i,(function(e){return e.getAndUpdateAccessToken}))},1701:function(e,t,n){"use strict";var r=n(0),o=n(1655);function i(e){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":e}}function a(e,t){t&&e&&Object(o.b)(t,i(e))}function c(e,t){var n,o=null!=t?t:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",a(e,i),Object(r.__assign)(Object(r.__assign)({},o),{headers:i})}var u=n(346),s=n(1656),d=n(77),l=n(321);function f(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(n){return[2,Object(d.b)().then((function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e?Object(u.r)(e.userIdentity)?[4,Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return t=r.sent(),l(n,t),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(o=i(e.mailboxSmtpAddress),l(n,o)),r.label=3;case 3:return[2,n]}}))}))}))]}))}))}function b(){return Object(d.b)().then((function(e){return e.prefer='exchange.Behavior="CalendarInternal"',e}))}function v(e){return void 0===e&&(e=null),Object(u.r)(e)?b().then((function(t){return Object(s.a)(e).then((function(e){return Object.keys(e).forEach((function(n){return t[n]=e[n]})),t}))})):Promise.resolve({})}var O=n(47);function p(e,t,n){var r=new Headers;return n&&r.set("X-OWA-CANARY",Object(O.a)()),t&&r.set("X-OWA-ActionName",t),e&&a(e,r),r}n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return p}))},17126:function(e,t,n){"use strict";n.r(t);var r=n(957),o=n(3919),i=n(1633),a=n(40);function c(e){return Object(i.T)(Object(r.a)("inbox"))||Object(a.i)("rp-reactions")}var u=n(1653);function s(e){var t=Object(r.a)("inbox");return Object(i.T)(t)&&!Object(u.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}var d=n(495),l=n(7),f=n(12966);var b=n(9591),v=n(2904),O=n(3),p=n(2721),j=n(7361);Object(O.orchestrator)(j.a,(function(e){var t={Subject:e.taskNewEventTitle,IsAllDayEvent:!0};p.g.importAndExecute("GetStarted","GetStarted",t)}));var w=n(1857),m=n(8534);Object(O.orchestrator)(m.a,(function(){w.f.importAndExecute("mail","attachments")}));var h=n(8535);Object(O.orchestrator)(h.a,(function(){w.f.importAndExecute("mail","messageContent")}));var I=n(8532);Object(O.orchestrator)(I.a,(function(){w.f.importAndExecute("general","timeAndLanguage")}));var g=n(2158),S=n(8533),x=n(8539),E=n(2960);Object(O.orchestrator)(S.a,(function(e){g.c.importAndExecute("GetStarted",void 0,void 0,e.taskSendEmailSubject,e.taskSendEmailBody)})),Object(O.orchestrator)(E.a,(function(e){1==e.event&&Object(x.a)()}));var P=n(8536),y=n(8540),N=n(44),A=new N.c((function(){return Promise.all([n.e(188),n.e(285),n.e(683)]).then(n.bind(null,17290))})),C=new N.a(A,(function(e){return e.showPersonalizationCard}));Object(O.orchestrator)(P.a,(function(){C.importAndExecute(y.a)}));var k=n(6055),_=n(4291),R=new N.c((function(){return n.e(310).then(n.bind(null,17506))})),M=new N.a(R,(function(e){return e.loadSenders})),T=n(9781),D=n(2915),V=new N.c((function(){return n.e(832).then(n.bind(null,17230))})),L=new N.a(V,(function(e){return e.subscribeToHierarchyNotification}));Object(N.f)(D.a,V,(function(e){return e.onNewFolderNotificationOrchestrator})),Object(N.f)(D.b,V,(function(e){return e.onUpdateFolderNotificationOrchestrator}));var U=n(16),K=n(1638),F=n(3182),W=n(34);function G(e,t){var n=function(e){var t={},n=K.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){W.d("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(F.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(l.f)(n.parentInternetMessageId))break;n=K.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new U.ObservableMap({});return t.forEach((function(t){var r=K.a.conversationNodes.get(t),o=t===e?i.a.CheckMark:i.a.None;n.set(r.internetMessageId,o)})),n}(e,t);for(var r=new U.ObservableMap({}),o=!1,a=!1,c=0,u=0;u<t.length;u++){var s=K.a.conversationNodes.get(t[u]);s&&(n[s.internetMessageId]?(o?c+1===Object.keys(n).length?(r.set(s.internetMessageId,i.a.BusEnd),a=!0):r.set(s.internetMessageId,i.a.BusStop):(r.set(s.internetMessageId,i.a.BusStart),o=!0),c++):!o||a?r.set(s.internetMessageId,i.a.None):r.set(s.internetMessageId,i.a.NoStop))}return r}var B=n(1777),X=n(4368),z=Object(O.action)("FOCUS_ITEM_PART",(function(e,t){return{nodeId:e,mailListItemSelectionSource:t}})),H=n(1766),q=n(7343),J=n(1640),Y=n(2770);function Q(){var e=H.a.expandedConversationViewState;e.expandedRowKey=null,e.focusedNodeId=null,e.selectedNodeIds=[],e.allNodeIds=[],e.shouldBeExpanded=!1,e.busStopStateMap=new U.ObservableMap({}),e.latestNodeIdsInEachFork=null}Object(O.mutator)(B.s,(function(e){var t=e.nodeId,n=H.a.expandedConversationViewState,r=n.selectedNodeIds,o=n.allNodeIds;H.a.expandedConversationViewState.focusedNodeId=t,r.indexOf(t)>-1?r.splice(r.indexOf(t),1):r.push(t),1===r.length&&(H.a.expandedConversationViewState.busStopStateMap=G(r[0],o))})),Object(O.mutator)(B.h,(function(e){H.a.expandedConversationViewState.busStopStateMap=new U.ObservableMap({})})),Object(O.mutator)(z,(function(e){H.a.expandedConversationViewState.focusedNodeId=e.nodeId})),Object(O.mutator)(B.p,(function(e){var t=e.rowKey,n=e.nodeIdToSelect,r=e.allNodeIds,o=H.a.expandedConversationViewState;o.selectedNodeIds=[n],o.busStopStateMap=G(n,r),o.expandedRowKey=t,o.focusedNodeId=n,o.allNodeIds=r})),Object(O.mutator)(B.t,(function(e){e.mailListItemSelectionSource===J.b.MailListItemCheckbox&&Q()})),Object(O.mutator)(X.a,(function(e){Q()})),Object(O.mutator)(B.i,(function(e){Q()})),Object(O.mutator)(B.k,(function(e){Q()})),Object(O.mutator)(B.a,(function(e){Q();var t=H.a.expandedConversationViewState;t.latestNodeIdsInEachFork=e.latestItemIdsInForks,t.expandedRowKey=e.rowKey})),Object(O.mutator)(B.q,(function(e){var t=H.a.expandedConversationViewState,n=e.rowKey,r=e.mailListItemSelectionSource;t.expandedRowKey!=n?Object(Y.d)()?(t.shouldBeExpanded=!0,t.expandedRowKey=n,t.latestNodeIdsInEachFork=[]):r===J.b.MailListItemTwisty&&(t.shouldBeExpanded=!0,t.expandedRowKey=n,t.latestNodeIdsInEachFork=null):r===J.b.MailListItemTwisty&&Object(Y.a)(n)&&(Q(),t.shouldBeExpanded=!0,t.expandedRowKey=n)})),Object(O.mutator)(B.o,(function(e){Q(),H.a.expandedConversationViewState.expandedRowKey=e.rowKey})),Object(O.mutator)(q.a,(function(e){if(1===H.a.expandedConversationViewState.selectedNodeIds.length){var t=H.a.expandedConversationViewState.selectedNodeIds[0],n=J.u.conversations.get(e.conversationId).conversationNodeIds;H.a.expandedConversationViewState.busStopStateMap=G(t,n)}}));var Z,$=n(0),ee=n(3053),te=n(9783),ne=n(2023),re=n(1710),oe=n(5634),ie=n(1717),ae=n(1716),ce=n(9712),ue=n(9593),se=n(2119);Object(O.orchestrator)(B.b,(function(e){fe(e.itemId,e.tableView,e.nodeId,e.allNodeIds,e.mailListItemSelectionSource)}));Object(O.orchestrator)(B.e,(function(e){if(1!=e.listViewType){var t=i.X.expandedConversationViewState,n=e.mailListItemSelectionSource==J.b.MailListItemTwisty;Object(Y.d)()&&t.expandedRowKey!=e.rowKey?je(e.rowKey,e.tableView,n):t.expandedRowKey==e.rowKey&&(t.shouldBeExpanded?t.latestNodeIdsInEachFork?je(e.rowKey,e.tableView,n):Oe(e.rowKey,e.tableView):!t.latestNodeIdsInEachFork&&n&&pe())}})),Object(O.orchestrator)(B.c,(function(e){(Object(Y.a)(e.rowKey)||Object(Y.c)(e.rowKey))&&pe()})),Object(O.orchestrator)(B.m,(function(e){for(var t=i.b.getConversationId(e.rowKey,e.tableView),n=J.u.conversations.get(t),r=null,o=null,a=n.conversationNodeIds.indexOf(i.X.expandedConversationViewState.selectedNodeIds[0])+1;a<n.conversationNodeIds.length;a++){var c=n.conversationNodeIds[a],u=Object(ee.a)(c,Object(Y.a)(e.rowKey));if(u){o=u.ItemId.Id,r=c;break}}r?fe(o,e.tableView,r,n.conversationNodeIds,J.b.RowRemoval):ve(e.rowKey,e.tableView)}));var de=0,le=!0;function fe(e,t,n,r,o){if(Z&&(clearTimeout(Z),Z=null),Object(te.a)(t,!0,o,void 0),o!==J.b.KeyboardUpDown||Object(re.c)())be(e,t);else{var a=Date.now(),c=a-de;de=a,(le||c<=500)&&(le=!1,Z=setTimeout((function(){Z=null,le=!0,be(e,t)}),250))}var u=i.X.expandedConversationViewState;B.p(u.expandedRowKey,n,r,t.id,u.selectedNodeIds)}function be(e,t){if(Object(ie.a)())ne.o.importAndExecute({Id:e,mailboxInfo:Object(ae.b)(t)},!0,null,!1);else{var n=i.b.getRowClientItemId(i.X.expandedConversationViewState.expandedRowKey,t);ne.s.importAndExecute(null==n?void 0:n.Id,e,!0)}}function ve(e,t,n){var r,o,a=n;if(!a||0==a.length){var c=i.b.getConversationId(e,t);a=J.u.conversations.get(c).conversationNodeIds}try{for(var u=Object($.__values)(a),s=u.next();!s.done;s=u.next()){var d=s.value,l=Object(ee.a)(d,Object(Y.a)(e));if(l){fe(l.ItemId.Id,t,d,a,Object(ie.a)()&&Object(Y.d)()&&Object(se.a)()&&Object(re.c)()?J.b.MailListItemExpansion:J.b.RowRemoval);break}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}}function Oe(e,t){B.o(e),Object(oe.a)(t,!1),ve(e,t)}function pe(){B.i()}function je(e,t,n){var r=i.b.getRowClientItemId(e,t),o=r.Id;Object(ce.c)(o)?we(o,e,t,n):Object(ue.b)(r,"CreateConversationRelationMap").then((function(){we(o,e,t,n)}))}function we(e,t,n,r){return Object($.__awaiter)(this,void 0,void 0,(function(){var o,a;return Object($.__generator)(this,(function(c){switch(c.label){case 0:return o=Object(i.K)(t,n.id),[4,Object(ce.b)(e,o.itemIds)];case 1:return(a=c.sent()).length>1?(B.a(t,a),ve(t,n,a)):r?Oe(t,n):B.a(t,[]),[2]}}))}))}var me=n(6556),he=n(6582),Ie=(Object(O.orchestrator)(he.a,(function(e){Object(me.a)(),1===Object(i.J)().expandedConversationViewState.selectedNodeIds.length&&B.h()})),n(8478)),ge=n(2911),Se=(Object(O.orchestrator)(Ie.a,(function(e){if(i.X.expandedConversationViewState.expandedRowKey){var t=J.u.conversations.get(e.conversationId);B.p(i.X.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(ge.a)())}})),n(7375)),xe=n(4555),Ee=n(5746),Pe=n(1821),ye=Object(O.action)("FOCUS_ROW_IN_DIRECTION",(function(e,t,n){return{tableView:e,selectionDirection:t,mailListItemSelectionSource:n}}));function Ne(e,t,n){return Object(Pe.a)()?1===e&&n===i.d.Next||0===e&&n===i.d.Previous:e===t-1&&n===i.d.Next||e===t-2&&n===i.d.Previous}Object(O.orchestrator)(Se.a,(function(e){var t=e.selectionDirection,n=e.tableView,r=e.mailListItemSelectionSource,o=e.shouldSelect,a=Object($.__read)(function(e,t){var n=i.X.expandedConversationViewState,r=n.focusedNodeId,o=n.allNodeIds;if(!r)return[null,null];var a,c,u=o.indexOf(r);e===i.d.Next?(a=o.length-1,c=1):(a=0,c=-1);var s=Object(i.K)(t.focusedRowKey,t.id).id,d=i.X.conversationItems.get(s);for(;u!==a;){if(u+=c,Object(xe.a)(d.id)&&Ne(u,o.length,e))return Object(Ee.a)(d.clientId),["loading",null];var l=o[u],f=Object(ee.a)(l,Object(Y.a)(t.focusedRowKey));if(f)return[l,f]}return[null,null]}(t,n),2),c=a[0],u=a[1];"loading"!==c&&(c?o?B.b(c,u.ItemId.Id,i.X.expandedConversationViewState.allNodeIds,n,r):z(c,r):i.X.expandedConversationViewState.expandedRowKey&&t===i.d.Previous?B.c(i.X.expandedConversationViewState.expandedRowKey):o?B.n(n,t,r):ye(n,t,r))}));var Ae=n(9784),Ce=n(5125),ke=n(4736),_e=n(4735),Re=(Object(O.orchestrator)(ye,(function(e){var t=e.tableView,n=e.selectionDirection,r=Object(Ae.a)(t,n);if(null!==r){var o=t.rowKeys[r];Object(Ce.a)(t,o),Object(_e.a)(t,o),Object(ke.a)(t,null),B.i()}})),n(7376));Object(O.orchestrator)(Re.a,(function(e){var t=e.tableView,n=e.mailListItemSelectionSource,r=i.X.expandedConversationViewState.focusedNodeId;r?B.s(r):B.t(t,t.focusedRowKey,!0,n)}));var Me=n(1725),Te=n(5603),De=n(7377);Object(O.orchestrator)(De.a,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys,o=e.mailListItemSelectionSource;if(n.length>0&&o===Me.a.KeyboardEnter){if(1!==n.length)return;B.b(n[0],Object(Te.a)(n[0],Object(Y.a)(r[0])),i.X.expandedConversationViewState.allNodeIds,t,o)}else{if(1!==r.length)return;B.q(t,r[0],!0,o)}}));var Ve=n(28);var Le=n(296),Ue=n(2759),Ke=n(5967),Fe=n(3728),We=n(4395),Ge=n(8587),Be=n(3727),Xe=n(2409),ze=n(3076),He=n(3568),qe=new N.c((function(){return Promise.all([n.e(264),n.e(870)]).then(n.bind(null,17182))})),Je=new N.a(qe,(function(e){return e.evaluatePlaywrightMailActions})),Ye=n(25),Qe=n(7116),Ze=n(1970),$e=n(1652),et=n(2226);function tt(){var e;Object(Ye.a)().IsMonitoring&&Je.importAndExecute(),L.importAndExecute(),Object(b.a)(!0),Object(a.i)("fwk-mailtoProtocolHandler")&&(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)&&window.navigator.registerProtocolHandler("mailto",""+Object(d.l)()+Object(d.j)()+"deeplink/compose?mailtouri=%s",Object(l.b)(f.a)),ze.b.importAndExecute({condition:Object(a.i)("fwk-devTools")||Object(a.i)("sea-contextFeedback"),task:function(){return T.b.importAndExecute()}},{condition:Object(a.i)("fwk-nlqsFloodgateSurvey"),task:function(){return et.a.importAndExecute(null,!0)}},nt,{condition:Object(a.i)("sea-clientWarmup")&&Object($e.u)(),task:function(){return Ze.l.importAndExecute()}},{condition:Object(a.i)("tri-spotlight2"),task:function(){return Ue.i.importAndExecute()}},(function(){return We.a.importAndExecute()}),{condition:Object(Le.a)(),task:function(){return M.importAndExecute()}},(function(){return Ge.b.importAndExecute()}),(function(){return Ge.a.importAndExecute()}),{condition:Object(Be.j)(),task:function(){return Be.d.importAndExecute()}},(function(){return Be.e.importAndExecute()}),{condition:Object(Qe.a)(),task:function(){return k.c.importAndExecute()}},{condition:Object(a.i)("mc-personalization"),task:function(){Ke.b.importAndExecute()},idle:!0},{task:function(){return Fe.c.importAndExecute()},idle:!0},{condition:Object(ne.f)(),task:function(){return _.a.importAndExecute()},idle:!0},{task:function(){return v.d.importAndExecute()},idle:!0},{condition:Object(Xe.e)(window),task:function(){return Xe.j.importAndExecute(window)},idle:!0},{task:function(){return He.a.importAndExecute()},idle:!0},{condition:Object(a.i)("auth-activityFeed")&&Object(a.i)("auth-activityFeedWeveSignal"),task:function(){return v.e.importAndExecute()},idle:!0},{condition:Object(a.i)("rp-projectionPopout"),task:function(){return ne.h.importAndExecute()},idle:!0}).then((function(){ze.a.importAndExecute()}))}function nt(){var e,t;Object(o.g)(s),Object(o.f)(c),e={isOWALogon:!0},Object(Ve.a)("ConnectedAccountsNotification",e,t)}var rt=n(2117);Object(O.orchestrator)(o.c,(function(e){return Object($.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,o,a,c;return Object($.__generator)(this,(function(u){switch(u.label){case 0:return t=e.notification,Object(i.P)(Object(i.G)())?(n=Object(J.g)().conversations.get(t.conversationId),r={Id:t.conversationId,mailboxInfo:Object(ae.a)()},n?[3,2]:[4,rt.d.importAndExecute(r,"LoadLikedConversation")]):[3,3];case 1:u.sent(),u.label=2;case 2:return ot(r,t.subject),[3,6];case 3:return o=Object(J.g)().items.get(t.itemId),a={Id:t.itemId,mailboxInfo:Object(ae.a)()},(null==o?void 0:o.NormalizedBody)?(ot(a,t.subject),[3,6]):[3,4];case 4:return c={Id:t.itemId,mailboxInfo:Object(ae.a)()},[4,rt.e.importAndExecute(c,"LoadLikedItem")];case 5:u.sent(),ot(c,t.subject),u.label=6;case 6:return[2]}}))}))}));function ot(e,t){ne.p.importAndExecute(e,t,[],!0,null)}var it=n(8577),at=n(85);Object(O.orchestrator)(o.d,(function(e){var t=e.notification,n=1===Object(at.h)().UserOptions.GlobalListViewTypeReact?t.ItemId:t.ConversationId;Object(it.a)("inbox",n)}));n.d(t,"setupMailModulePostRender",(function(){return tt}))},1779:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return b}));var r=n(134),o="WebPushSetup";function i(e){O("vipMailEnabled",e)}function a(e){O("mailOption",e)}function c(e){O("reminderOption",e)}function u(e){O("enabled",e)}function s(e,t){O("disabled",e),O("allClients",t)}function d(e){(window.webPushOptics.enabled||window.webPushOptics.disabled)&&(O("result",e),v())}function l(){O("lightning","ignored"),v()}function f(e){O("permission",e)}function b(e){O("roaming",e)}function v(){Object(r.r)(o,window.webPushOptics,{isCore:!0}),window.webPushOptics={}}function O(e,t){window.webPushOptics[e]=t}window.webPushOptics={}},1824:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var r=n(44),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(23),n.e(789)]).then(n.bind(null,4646))})),i=new r.a(o,(function(e){return e.bootStrapWebPushService})),a=new r.b(o,(function(e){return e.userInitiatedWebPushSetupWorkflow})),c=new r.b(o,(function(e){return e.userInitiatedWebPushDisableWorkflow})),u=new r.b(o,(function(e){return e.unsubscribe})),s=new r.b(o,(function(e){return e.loadWebPushOptions})),d=Object(r.d)(o,(function(e){return e.WebPushDiscovery}))},1871:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1701);function o(e){return{headers:Object(r.e)(e,"GroupMailbox")}}},1914:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r,o=n(3),i=Object(o.createStore)("webPushStore",{currentView:0,webPushPermission:null===(r=window.Notification)||void 0===r?void 0:r.permission})(),a=Object(o.createStore)("localWebPushUserSettingStore",{userPreferenceIdentifier:null,lastSessionDate:null,uniqueDaysSessionCount:0,enabled:null,mailEnabled:null,reminderEnabled:null,vipMailEnabled:null,lastCheckboxUnchecked:null,promptCount:0,lastPromptDate:null})();function c(){return a}},1919:function(e,t,n){"use strict";n(1871);var r=n(1781),o=n(3),i=Object(o.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),a=Object(o.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),c=Object(o.action)("MEMBER_MANAGEMENT_SUCCESS",(function(e){return{groupSmtp:e}})),u=Object(o.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),s=Object(o.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),d=Object(o.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),l=n(1859);n.d(t,"m",(function(){return r.a})),n.d(t,"l",(function(){return i})),n.d(t,"j",(function(){return a})),n.d(t,"n",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return l.g})),n.d(t,"c",(function(){return l.c})),n.d(t,"d",(function(){return l.d})),n.d(t,"a",(function(){return l.a})),n.d(t,"e",(function(){return l.e})),n.d(t,"f",(function(){return l.f})),n.d(t,"i",(function(){return l.i})),n.d(t,"b",(function(){return l.b})),n.d(t,"h",(function(){return l.h}))},1940:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d}));var r=n(1914),o=n(2373),i=n(188),a=n(1943),c=Object(i.select)({store:function(){return r.b}})((function(e){return null!=e.store&&null==e.store.enabled&&e.store.uniqueDaysSessionCount>=a.b&&e.store.lastPromptDate!=Object(o.a)().toDateString()&&e.store.promptCount<=a.a})),u=Object(i.select)({store:function(){return r.b}})((function(e){return e.store.mailEnabled||e.store.reminderEnabled})),s=Object(i.select)({store:function(){return r.b}})((function(e){var t,n,r;return{newMail:null!==(t=e.store.mailEnabled)&&void 0!==t&&t,reminder:null!==(n=e.store.reminderEnabled)&&void 0!==n&&n,vipMailOnly:null!==(r=e.store.vipMailEnabled)&&void 0!==r&&r}})),d=Object(i.select)({store:function(){return r.b}})((function(e){return e.store.reminderEnabled&&e.store.enabled}))},1943:function(e,t,n){"use strict";var r=n(1914),o=n(2373),i=n(188),a=n(10),c="WebPushUserSettings",u=5;function s(e,t){for(var n=d(e),r=-1,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t.userPreferenceIdentifier){r=o;break}if(r>=0)n[r]=t;else{if(r=n.length,n.length>=u){r=0;var i=new Date(n[0].lastSessionDate);for(o=1;o<n.length;++o){var s=new Date(n[o].lastSessionDate);s.getTime()<i.getTime()&&(i=s,r=o)}}n[r]=t}!function(e,t){if(t.length>0){var n=JSON.stringify(t);Object(a.e)(e,c,n)}else Object(a.d)(e,c)}(e,n)}function d(e){var t=Object(a.a)(e,c),n=new Array;try{var r=JSON.parse(t);null!=r&&(n=r)}catch(t){Object(a.d)(e,c)}return n}var l=n(1940),f=n(40);n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return w})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return I}));var b=4,v=3,O=Object(i.select)({store:function(){return r.b}})(Object(i.action)("loadLocalWebPushUserSetting")((function(e,t,n){var r=function(e,t){for(var n=d(e),r=null,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t){r=n[o];break}return r}(e,t);if(null!=r)Object.keys(r).forEach((function(e){n.store[e]=r[e]})),I(e);else{var o=function(e,t){for(var n=d(e),r=null,o=0;o<n.length;++o)n[o].userPreferenceIdentifier<t&&(r?n[o].userPreferenceIdentifier>r.userPreferenceIdentifier&&(r=n[o]):r=n[o]);return r}(e,t);o&&(n.store.lastCheckboxUnchecked=o.lastCheckboxUnchecked,n.store.mailEnabled=o.mailEnabled,n.store.reminderEnabled=o.reminderEnabled,n.store.vipMailEnabled=o.vipMailEnabled),n.store.userPreferenceIdentifier=t,s(e,n.store)}}))),p=Object(i.select)({store:function(){return r.b}})(Object(i.action)("incrementUniqueDaysSessionCount")((function(e,t){var n=Object(o.a)().toDateString();t.store.lastSessionDate!=n&&(t.store.lastSessionDate=n,t.store.uniqueDaysSessionCount<b&&t.store.uniqueDaysSessionCount++,s(e,t.store))}))),j=Object(i.select)({store:function(){return r.b}})(Object(i.action)("resetLocalWebpushUserSetting")((function(e,t,n){n.store.userPreferenceIdentifier=t,n.store.enabled=!1,n.store.promptCount=0,n.store.lastPromptDate=null,n.store.uniqueDaysSessionCount=0,s(e,n.store)}))),w=Object(i.select)({store:function(){return r.b}})(Object(i.action)("updateLocalWebPushEnabledStatus")((function(e,t,n,r){r.store.enabled=t,r.store.userPreferenceIdentifier=n,t&&I(e),s(e,r.store)}))),m=Object(i.select)({store:function(){return r.b}})(Object(i.action)("incrementLocalWebPushPromptCount")((function(e,t){t.store.promptCount++,t.store.lastPromptDate=Object(o.a)().toDateString(),s(e,t.store)}))),h=Object(i.select)({store:function(){return r.b}})(Object(i.action)("resetLocalWebPushPromptCount")((function(e,t){t.store.promptCount=0,t.store.lastPromptDate=null,s(e,t.store)}))),I=Object(i.select)({store:function(){return r.b}})(Object(i.action)("validateAndUpdateCheckboxOptions")((function(e,t){if(t.store.enabled){if(!Object(l.b)())if(t.store.lastCheckboxUnchecked){switch(t.store.lastCheckboxUnchecked){case"NewMail":t.store.mailEnabled=!0;break;case"Reminder":t.store.reminderEnabled=!0}t.store.lastCheckboxUnchecked=null}else t.store.mailEnabled=!0,t.store.reminderEnabled=!0;1!=t.store.mailEnabled||null!=t.store.reminderEnabled&&null!=t.store.reminderEnabled||(t.store.reminderEnabled=!0)}Object(f.i)("auth-scheduleTimerForReminderWebPush")||Object(f.i)("auth-sendReminderWebPush")||(t.store.reminderEnabled=null,t.store.lastCheckboxUnchecked=null),s(e,t.store)})))},2226:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(44),o=new r.c((function(){return Promise.all([n.e(22),n.e(23),n.e(1302)]).then(n.bind(null,3718))})),i=new r.a(o,(function(e){return e.loadAndInitializeFloodgateEngine})),a=new r.b(o,(function(e){return e.logFloodgateActivity}))},2273:function(e,t,n){"use strict";function r(e,t){return e+"_"+(null!=t.enabledTimeInUTCMs?t.enabledTimeInUTCMs:"")}n.d(t,"a",(function(){return r}))},2293:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Unknown="Unknown",e.Like="Like",e.AtMention="AtMention",e.GroupMention="GroupMention",e.MeMention="MeMention",e.FileMention="FileMention",e.GroupAtAllMention="GroupAtAllMention",e.TxpRentalCarReservation="TxpRentalCarReservation",e.TxpFlightReservation="TxpFlightReservation",e.TxpLodgingReservation="TxpLodgingReservation",e.TxpFoodEstablishmentReservation="TxpFoodEstablishmentReservation",e.TxpEventReservation="TxpEventReservation",e.TxpParcelDelivery="TxpParcelDelivery",e.TxpInvoice="TxpInvoice",e.TxpServiceReservation="TxpServiceReservation",e.UserAtMentioned="UserAtMentioned",e.TaskNotificationInsight="TaskNotificationInsight",e.FollowUpNotificationInsight="FollowUpNotificationInsight",e.OutOfRoutineNotificationInsight="OutOfRoutineNotificationInsight",e.RealTimeFlightUpdate="RealTimeFlightUpdate",e.YammerLiveEventNotification="YammerLiveEventNotification",e.Reactions="Reactions"}(r||(r={}))},2330:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(40),o=n(62),i=n(25),a=n(614),c=function(e){return!(!Object(r.i)("fwk-webPushNotification")&&!Object(r.i)("fwk-webPushNotificationV2"))&&(!(!e.navigator||null==e.navigator.serviceWorker||null==e.PushManager)&&((Object(o.e)()||Object(o.h)()||Object(r.i)("fwk-webPushNotificationExtended")&&(Object(o.f)()||Object(o.j)()))&&!Object(i.a)().SessionSettings.IsUserCultureRightToLeft&&(1==Object(a.b)()||2==Object(a.b)())))}},2373:function(e,t,n){"use strict";function r(){return new Date}n.d(t,"a",(function(){return r}))},2409:function(e,t,n){"use strict";var r=n(1779);n.d(t,"m",(function(){return r.b})),n.d(t,"l",(function(){return r.a})),n.d(t,"q",(function(){return r.i})),n.d(t,"n",(function(){return r.d})),n.d(t,"p",(function(){return r.g})),n.d(t,"o",(function(){return r.f}));var o=n(2273);n.d(t,"b",(function(){return o.a}));var i=n(1914);n.d(t,"a",(function(){return i.a}));var a=n(1943);n.d(t,"k",(function(){return a.e})),n.d(t,"r",(function(){return a.i}));var c=n(1940);n.d(t,"c",(function(){return c.b})),n.d(t,"d",(function(){return c.c}));var u=n(2330);n.d(t,"e",(function(){return u.a}));var s=n(1824);n.d(t,"j",(function(){return s.f})),n.d(t,"i",(function(){return s.e})),n.d(t,"h",(function(){return s.d})),n.d(t,"g",(function(){return s.c})),n.d(t,"f",(function(){return s.b}))},2486:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25),o=n(40);function i(){var e;return(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(o.i)("cmp-proxy-address")}},2587:function(e,t,n){"use strict";var r=n(3),o=Object(r.createStore)("SkypeStore",{unreadConversationCount:0,isRecentsInitialized:!1,isSwcInitialized:!1,isGlimpseOpen:!1})();t.a=o},2721:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"g",(function(){return v}));var r=n(1995),o=n(44),i=new o.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6),n.e(20),n.e(25),n.e(28),n.e(31),n.e(42),n.e(79),n.e(131),n.e(164),n.e(278),n.e(929)]).then(n.bind(null,3866))}));Object(o.f)(r.d,i,(function(e){return e.openTimePanelOrchestrator}));var a=Object(o.d)(i,(function(e){return e.TimePanel})),c=Object(o.d)(i,(function(e){return e.TimePanelHeaderBar})),u=new o.a(i,(function(e){return e.loadTimePanelData})),s=new o.a(i,(function(e){return e.openEventDetailsView})),d=(new o.a(i,(function(e){return e.openAttendeeTrackingView})),new o.a(i,(function(e){return e.closeAttendeeTrackingView})),new o.a(i,(function(e){return e.openTasksView}))),l=new o.a(i,(function(e){return e.openCalendarView})),f=new o.a(i,(function(e){return e.openConflictsView})),b=new o.a(i,(function(e){return e.closeConflictsView})),v=new o.a(i,(function(e){return e.openEventQuickComposeView}))},2790:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("saveReadingPanePositionOption")},2835:function(e,t,n){"use strict";var r=n(3),o=Object(r.actionCreator)("ADD_CHAT_TAB",(function(e){return{chatConversationId:e}}));t.a=o},2904:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return s}));var r=n(44),o=n(2293);n.d(t,"c",(function(){return o.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(6),n.e(15),n.e(17),n.e(100),n.e(143),n.e(142),n.e(195),n.e(301)]).then(n.bind(null,4280))})),a=Object(r.d)(i,(function(e){return e.ActivityFeed})),c=new r.a(i,(function(e){return e.initializeActivityFeed})),u=Object(r.d)(i,(function(e){return e.ActivityFeedTitle})),s=new r.a(i,(function(e){return e.postWeveSignal}))},2960:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("OnComposeLifecycleEvent",(function(e,t){return{viewState:e,event:t}}));t.a=o},3004:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(40),o=n(614);function i(){return Object(r.i)("rp-skypeInTabs")&&1==Object(o.b)()}},3053:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1638),o=n(3182);function i(e,t){return t?r.a.items.get(e):Object(o.b)(e)}},3251:function(e,t,n){"use strict";var r=n(44),o=n(3),i=n(2790),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(15),n.e(17),n.e(20),n.e(21),n.e(22),n.e(24),n.e(28),n.e(29),n.e(27),n.e(33),n.e(36),n.e(45),n.e(48),n.e(863)]).then(n.bind(null,16826))})),c=(new r.a(a,(function(e){return e.saveReadingPaneOptionQuick})),n(2772)),u=n(2182),s=n(2398),d=n(2399),l=n(188),f=n(1710),b=Object(l.action)("onPrintRow")((function(){Object(f.c)()&&(Object(d.a)(!0),Object(s.a)(!1))})),v=Object(l.action)("onNewMessage")((function(e){e||(Object(d.a)(!0),Object(s.a)(!Object(f.c)()))})),O=n(3314);n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return O.a}));var p=new r.c((function(){return Promise.all([n.e(55),n.e(58),n.e(643)]).then(n.bind(null,17246))})),j=new r.a(p,(function(e){return e.onReplyOrReplyAllOrForwardMessage})),w=(new r.b(p,(function(e){return e.onSxSPreviewPaneClose})),new r.a(p,(function(e){return e.onReadingPanePositionOptionSaved}))),m=new r.a(p,(function(e){return e.onSelectMessageAd}));function h(){Object(o.orchestrator)(i.a,(function(){w.importAndExecute()}))}Object(r.f)(c.a,p,(function(e){return e.onClientReadingPanePositionChangeOrchestrator})),Object(r.f)(u.a,p,(function(e){return e.closeImmersiveReadingPaneOrchestrator}))},3263:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.createStore)("whatsNewStore",{cards:null,disablePauseInboxTryIt:!1})},3264:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("OPEN_PAUSE_INBOX")},3314:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("exitSearch",(function(e){return{actionSource:e}}))},3394:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_REMINDER_CLICKED",(function(e,t){return{itemId:e,reminderType:t}}))},3550:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_LIKE_NOTIFICATION_CLICKED",(function(e){return{notification:e}}))},3551:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_NEW_MAIL_NOTIFICATION_NAVIGATED",(function(e){return{notification:e}}))},3552:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},3727:function(e,t,n){"use strict";var r=n(44),o=n(3004),i=n(40),a=function(){return!Object(i.i)("fwk-partner-code-off")&&!Object(i.i)("fwk-skypeSuite")&&Object(i.i)("fwk-skypeConsumer")},c=n(2835),u=n(2587);n.d(t,"a",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"h",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return O})),n.d(t,"f",(function(){return p})),n.d(t,"c",(function(){return o.a})),n.d(t,"j",(function(){return a})),n.d(t,"b",(function(){return c.a})),n.d(t,"k",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(3),n.e(741)]).then(n.bind(null,17164))})),d=Object(r.d)(s,(function(e){return e.SkypeGlimpse})),l=new r.a(s,(function(e){return e.updateIsGlimpseOpen})),f=new r.b(s,(function(e){return e.shouldShowUnreadConversationCount})),b=new r.a(s,(function(e){return e.beginSkypeInitialization})),v=new r.a(s,(function(e){return e.createOnSwcReadyEvent})),O=new r.a(s,(function(e){return e.onNotificationReceived})),p=new r.a(s,(function(e){return e.onHideNotificationReceived}))},3728:function(e,t,n){"use strict";var r=n(44),o=n(3263),i=n(3552);function a(){var e=Object(o.a)();return e.cards?Object.keys(e.cards).filter((function(t){return e.cards[t].status===i.a.Unread})).length:0}var c=n(3264);n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(0),n.e(28),n.e(790)]).then(n.bind(null,17097))})),s=Object(r.d)(u,(function(e){return e.WhatsNewFluentPane})),d=new r.a(u,(function(e){return e.initializeWhatsNewIfNecessary})),l=new r.a(u,(function(e){return e.openPremiumDashboard}))},3745:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},3746:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},3919:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(44),o=n(3745);n.d(t,"g",(function(){return o.a}));var i=n(3746);n.d(t,"f",(function(){return i.a}));var a=n(3550);n.d(t,"c",(function(){return a.a}));var c=n(3551);n.d(t,"d",(function(){return c.a}));var u=n(3394);n.d(t,"e",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6),n.e(25),n.e(28),n.e(31),n.e(42),n.e(88),n.e(164),n.e(197),n.e(609)]).then(n.bind(null,7673))})),d=Object(r.d)(s,(function(e){return e.NotificationPane})),l=new r.b(s,(function(e){return e.onDismissAutomaticReplyNotification}))},4395:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(44),o=new r.c((function(){return Promise.all([n.e(131),n.e(277),n.e(791)]).then(n.bind(null,7005))})),i=new r.a(o,(function(e){return e.loadWorkloadScenarioSettings}))},4555:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1638);function o(e){var t=r.a.conversations.get(e);return null==t?void 0:t.canLoadMore}},4565:function(e){e.exports=JSON.parse('{"e":"b1a","a":"c1a","n":"e1a","p":"f1a","u":"h1a","q":"i1a","m":"j1a","j":"k1a","s":"l1a","r":"m1a","h":"n1a","o":"o1a","k":"p1a","t":"q1a","i":"r1a","g":"s1a","l":"t1a","f":"u1a","d":"v1a","b":"w1a","c":"x1a"}')},4909:function(e,t,n){"use strict";var r=n(3029),o=n(52);t.a=Object(o.d)("expandCollapsedItemsRollUp",r.a.RPCountExpCollItemsRollUp)((function(e,t){void 0===t&&(t=!1),e.conversationNodeIdsInCollapsedItemsRollUp=[]}))},496:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},566:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(496),o=n(3),i=n(670),a=n(4),c={state:r.a.NotStarted,isPopoutV2:Object(a.a)(i.a)==i.b},u=Object(o.createStore)("popoutChild",c);u()},574:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r,o=2,i=[window.location.origin];function a(e,t,n){var r={version:o,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function c(e){if(i.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&o==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow",e[e.DeeplinkReady=4]="DeeplinkReady"}(r||(r={}))},5746:function(e,t,n){"use strict";var r=n(4909),o=n(3029),i=n(1748),a=n(3194),c=n(134),u=n(52),s=n(2117),d=n(1638),l=n(3607),f=n(188);t.a=Object(u.d)("loadMore",o.a.RPCountLoadMore)(Object(f.select)({conversations:function(){return d.a.conversations},conversationReadingPaneViewState:function(e){return Object(i.a)(e.Id)}})((function(e,t){if(e&&t.conversations.has(e.Id)){var n=t.conversations.get(e.Id);n.isLoadMoreInProgress=!0,n.maxItemsToReturn=n.maxItemsToReturn+s.a,n.syncState="";var o=Object(c.t)();return o&&o.addCustomData([(i=n.maxItemsToReturn,u=Math.ceil((i-20)/10),Object(l.a)(u))]),Object(a.b)(t.conversationReadingPaneViewState)&&Object(r.a)(t.conversationReadingPaneViewState,!0),s.d.importAndExecute(e,"LoadMore")}var i,u;return Promise.resolve()})))},5772:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1777),o=n(1633),i=n(2034),a=n(1725);function c(e){var t=Object(i.a)(),n=Object(o.E)([e],t)[0];t.rowKeys.includes(n)&&Object(r.q)(t,n,!0,a.a.RouteHandler)}},5773:function(e,t,n){"use strict";var r=n(16),o=n(3),i={usageSuggestions:new r.ObservableMap},a=Object(o.createStore)("personalization",i)();t.a=a},5967:function(e,t,n){"use strict";var r=n(44),o=n(5773);function i(e){var t;return null===(t=o.a.usageSuggestions)||void 0===t?void 0:t.get(e)}n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return i}));var a=new r.c((function(){return n.e(873).then(n.bind(null,17220))})),c=new r.a(a,(function(e){return e.initializePersonalizationSuggestions})),u=(new r.a(a,(function(e){return e.postPersonalizationSuggestionFeedback})),new r.a(a,(function(e){return e.postPersonalizationUsageSignals})))},6556:function(e,t,n){"use strict";var r=n(0),o=n(4304),i=n(3881),a=n(4408),c=n(1780),u=n(1762),s=n(2323),d=n(1717),l=n(188),f=n(1633);t.a=Object(l.select)({composeViewState:function(){return u.a.viewStates.get(u.a.primaryComposeId)},conversationItems:function(){return f.X.conversationItems}})(Object(l.action)("reloadReadingPane")((function(e){var t,n,u=Object(f.G)(),l=u?Object(r.__spread)(u.selectedRowKeys.keys()):[];if(1==l.length){var b=f.b.getRowIdToShowInReadingPane(l[0],u),v=Object(s.a)(l,u)[0],O=u.tableQuery.listViewType;if(1===O||Object(d.a)())(null===(t=e.composeViewState)||void 0===t?void 0:t.isInlineCompose)?c.r.importAndExecute(e.composeViewState).then((function(){Object(i.a)(b,v,a.a)})):Object(i.a)(b,v,a.a);else if(0===O){var p=e.conversationItems.get(b.Id);(null===(n=e.composeViewState)||void 0===n?void 0:n.isInlineCompose)?c.r.importAndExecute(e.composeViewState).then((function(){Object(o.b)(b,v,p.subject)})):Object(o.b)(b,v,p.subject)}}})))},6582:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},7343:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",(function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}}))},7361:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),o=n(4565),i=n(7),a=Object(r.action)("ADD_FIRST_EVENT",(function(){return{taskNewEventTitle:Object(i.b)(o.l)}}))},7375:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{selectionDirection:e,tableView:t,mailListItemSelectionSource:n,shouldSelect:r}}))},7376:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_KEYBOARD_TOGGLE_SELECT",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}}))},7377:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n,mailListItemSelectionSource:r}}))},791:function(e,t,n){"use strict";var r=n(44),o=n(1003),i=n(808),a=n(32),c=n(1),u=n(807),s=n(566),d=n(40),l=n(496),f=n(1252),b=n(1256),v=Object(a.a)((function(e){c.useEffect((function(){Object(d.i)("rp-popoutsDebug")||O()}),[]);return c.createElement("div",{className:b.view},Object(s.a)().state==l.a.Loading?c.createElement("span",null,c.createElement(f.a,null),e.loadingString):c.createElement("button",{onClick:O},"Get Data"))}));function O(){Object(u.a)()}function p(e,t,n,r){var o="";if(r)o="readimid/",o+=encodeURIComponent(btoa(r));else{if(o=n?"readconv/":"read/",e&&"GroupMailbox"==e.type){o+="group/";var i=e.mailboxSmtpAddress.split("@");o+=i[1]+"/"+i[0]+"/"}o+=encodeURIComponent(n||t)}return o}var j=n(495);function w(e){var t=e&&e!==window;return Object(j.v)()||t}n.d(t,"h",(function(){return h})),n.d(t,"c",(function(){return o.a})),n.d(t,"i",(function(){return i.a})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return s.a})),n.d(t,"d",(function(){return u.b})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return w}));var m=new r.c((function(){return n.e(883).then(n.bind(null,17189))})),h=new r.b(m,(function(e){return e.bootPopout}))},807:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r,o=n(0),i=n(808),a=n(574),c=n(496),u=n(566),s=!1;function d(){Object(i.a)(c.a.Loading),r?r():s=!0}function l(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return s?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(u.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var o=Object(a.b)(n);if(o&&o.type==a.a.SetData){window.removeEventListener("message",r);var i=void 0;try{i=e?e(o.serializedData):JSON.parse(o.serializedData)}catch(e){}t(i)}};window.addEventListener("message",r);try{var o=window.opener;Object(a.c)(o,a.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},808:function(e,t,n){"use strict";var r=n(566),o=n(3),i=n(496),a=n(574);t.a=Object(o.mutatorAction)("setPopoutChildState",(function(e){var t=Object(r.a)();t.state=e,e==i.a.Ready&&t.isPopoutV2&&window.opener&&Object(a.c)(window.opener,a.a.DeeplinkReady,null)}))},8478:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_ITEM_PART_SELECTED",(function(e,t){return{conversationNodeId:e,conversationId:t}}))},8532:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("CONFIRM_TIMEZONE")},8533:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),o=n(4565),i=n(7),a=n(25),c=Object(r.action)("SEND_AN_EMAIL",(function(){return{taskSendEmailSubject:Object(i.c)(Object(i.b)(o.s),Object(a.a)().SessionSettings.UserEmailAddress),taskSendEmailBody:Object(i.c)(Object(i.b)(o.r),Object(a.a)().SessionSettings.UserEmailAddress)}}))},8534:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("ADD_STORAGE_ACCOUNT")},8535:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("SETUP_SIGNATURE")},8536:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("SHOW_PERSONALIZATION_MODAL")},8539:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("COMPLETE_SEND_AN_EMAIL")},8540:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("COMPLETE_PERSONALIZATION")},8577:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5633),o=n(5772);function i(e,t){Object(r.a)(e),Object(o.a)(t)}},8587:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(44),o=new r.c((function(){return Promise.all([n.e(0),n.e(219),n.e(454)]).then(n.bind(null,11076))})),i=new r.a(o,(function(e){return e.subscribeToBulkActionNotification})),a=new r.a(o,(function(e){return e.findBulkActionItemAction}))},9712:function(e,t,n){"use strict";var r,o,i=n(0),a=n(2117),c=n(1640),u=n(214);function s(e){var t,n;return Object(i.__awaiter)(this,void 0,void 0,(function(){var r;return Object(i.__generator)(this,(function(o){switch(o.label){case 0:r=null===(t=c.u.conversations)||void 0===t?void 0:t.get(e),o.label=1;case 1:return!r||null!=r&&r.canLoadMoreForRelationMap?(r&&(r.isLoadMoreInProgress=!0,r.maxItemsToReturn=r.maxItemsToReturn+a.a,r.syncState=""),[4,a.d.importAndExecute({Id:e,mailboxInfo:Object(u.d)()},"CreateConversationRelationMap")]):[3,3];case 2:return o.sent(),r||(r=null===(n=c.u.conversations)||void 0===n?void 0:n.get(e))?[3,1]:[3,3];case 3:return[2]}}))}))}function d(e){var t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,a,u,d,l,f,b,O;return Object(i.__generator)(this,(function(p){switch(p.label){case 0:return o==e?[3,2]:(o=e,[4,s(e)]);case 1:if(p.sent(),!(n=null===(t=c.u.conversations)||void 0===t?void 0:t.get(e)))return[2,null];if(a=null==n?void 0:n.conversationNodeIds,u=null==a?void 0:a.length,!a||!u||0==u)return[2,null];for(d=Object(i.__spread)(a),"ChronologicalNewestOnBottom"===n.conversationSortOrder||d.reverse(),l=c.u.conversationNodes.get(d[0]),f=new Map,l&&f.set(l.internetMessageId,{itemIds:l.itemIds,childrenImIds:[]}),b=1;b<u;)O=c.u.conversationNodes.get(d[b]),v(f,O),b+=1;r=f,p.label=2;case 2:return[2,r]}}))}))}function l(e){var t,n=null===(t=c.u.conversations)||void 0===t?void 0:t.get(e);if(!n)return!1;var r=n.conversationNodeIds,o=null==r?void 0:r.length;return!(!r||!o||0==o)}function f(e,t){var n;return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,d(e)];case 1:return(r=i.sent())?(o=[],r.forEach((function(e,n){if(0===e.childrenImIds.length){var i=O(t,e.itemIds);i&&o.push(i);for(var a=e;!i&&(null==a?void 0:a.parentImId);)a=r.get(null==a?void 0:a.parentImId),(i=O(t,null==a?void 0:a.itemIds))&&o.push(i)}})),[2,"ChronologicalNewestOnBottom"===(null==(a=null===(n=c.u.conversations)||void 0===n?void 0:n.get(e))?void 0:a.conversationSortOrder)?o:o.reverse()]):[2,[]]}}))}))}function b(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,u,s,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return r=[n],[4,d(t)];case 1:if((o=i.sent())&&(null==(a=c.u.items.get(n))?void 0:a.InternetMessageId))for(u=o.get(a.InternetMessageId),s=null==u?void 0:u.parentImId;s;)(l=o.get(s))?(l.itemIds.forEach((function(t){var n,o=c.u.items.get(t);(!e||o&&(null===(n=o.ParentFolderId)||void 0===n?void 0:n.Id)==e)&&r.push(t)})),s=l.parentImId):s=void 0;return[2,r]}}))}))}function v(e,t){if(t&&e){var n=t.internetMessageId,r=t.parentInternetMessageId;if(r){var o=e.get(r);o&&o.childrenImIds.push(n)}e.set(n,{itemIds:t.itemIds,parentImId:r,childrenImIds:[]})}}function O(e,t){if(t)for(var n=0;n<t.length;n++)if(e.includes(t[n]))return t[n];return null}n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return b}))}}]);
//# sourceMappingURL=owa.MailBoot~MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailBoot~MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();