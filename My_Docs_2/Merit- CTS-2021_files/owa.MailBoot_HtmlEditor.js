self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~HtmlEditor.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[599],{1826:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(0),i=n(44),r=n(2085);function a(e,t,n,a,s){return function(){function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.onImportedCallbacks=[],this.args=e,this.pluginName=n}return c.prototype.initialize=function(e){this.editor=e,this.pendingEvents=[],this.pluginInstance?this.initializeAndCallback():a||this.internalImport()},c.prototype.dispose=function(){this.pluginInstance&&(this.pluginInstance.dispose(),s||(this.pluginInstance=null)),this.editor=null,this.importPluginPromise=null,this.onImportedCallbacks=[]},c.prototype.getName=function(){return this.isImported()?this.pluginInstance.getName():this.pluginName},c.prototype.setPluginUtils=function(e){this.pluginUtils=e,Object(r.a)(this.pluginInstance)&&this.pluginInstance.setPluginUtils(this.pluginUtils)},c.prototype.getContextMenuItems=function(e){var t,n;return this.isImported()?null===(n=(t=this.pluginInstance).getContextMenuItems)||void 0===n?void 0:n.call(t,e):null},c.prototype.onPluginEvent=function(e){this.pluginInstance?this.pluginInstance.onPluginEvent&&this.pluginInstance.onPluginEvent(e):(null==a?void 0:a(e,this.editor))&&this.internalImport(e)},c.prototype.willHandleEventExclusively=function(e){return!(!this.pluginInstance||!this.pluginInstance.willHandleEventExclusively)&&this.pluginInstance.willHandleEventExclusively(e)},c.prototype.getPlugin=function(){return this.pluginInstance?Promise.resolve(this.pluginInstance):this.internalImport()},c.prototype.isImported=function(){return!!this.pluginInstance},c.prototype.addOnImportedCallback=function(e){this.isImported()&&this.editor?e(this.pluginInstance):this.onImportedCallbacks&&this.onImportedCallbacks.push(e)},c.prototype.initializeAndCallback=function(){var e=this;this.pluginInstance.initialize(this.editor),this.onImportedCallbacks.forEach((function(t){return t(e.pluginInstance)}))},c.prototype.internalImport=function(n){var r=this;return this.importPluginPromise||(this.importPluginPromise=new i.b(e,t).import().then((function(e){return r.pluginInstance=new(e.bind.apply(e,Object(o.__spread)([void 0],r.args))),r.setPluginUtils(r.pluginUtils),r.editor&&(r.initializeAndCallback(),r.pendingEvents.length>0&&r.pluginInstance.onPluginEvent&&r.pendingEvents.forEach((function(e){r.pluginInstance.onPluginEvent(e)})),r.pendingEvents=[]),r.pluginInstance})),this.importPluginPromise.catch((function(){r.pendingEvents=[]}))),n&&this.pendingEvents.push(n),this.importPluginPromise},c}()}},1977:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var o=n(0),i=n(2094),r=n(2420),a=n(134),s="EditorRibbonUsage";function c(e,t){for(var n,r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];return Object(i.b)(e,(function(e){var i;n=(i=e[t]).call.apply(i,Object(o.__spread)([e],r))}),null),n}function l(e,t,n,c){var l;void 0===n&&(n=[]),void 0===c&&(c=n);var u=r[t];return Object(i.b)(e,(function(e){l=u.apply(void 0,Object(o.__spread)([e],n)),(null==c?void 0:c.length)>0&&Object(a.r)(s+t,Object(o.__spread)(c.map((function(e){return JSON.stringify(e)})),[e.isDarkMode()]))}),null),l}},198:function(e,t,n){"use strict";var o=n(357),i=n(40);function r(){return Object(i.i)("fwk-suiteThemes")}var a=n(320);function s(){var e,t;return r()?null!==(t=null===(e=Object(a.d)())||void 0===e?void 0:e.Id)&&void 0!==t?t:"base":Object(o.a)()}function c(e,t){var n,i;if(r())return null!==(i=t?null===(n=Object(a.d)())||void 0===n?void 0:n.DarkTheme:Object(a.d)())&&void 0!==i?i:{};var s=Object(o.e)(e,t);return{BackgroundImageUrl:s.primary,BackgroundImageRepeat:s.repeat}}var l=n(89);function u(){if(r()){var e=Object(a.c)();if(Object(l.e)()){var t={};return Object.keys(e).forEach((function(e){t[e]="var(--"+e+")"})),t}return e}return Object(o.f)()}function d(e,t){return r()?Object(a.c)():Object(o.g)(e,t)}var f=n(179),p=n(53);function h(){var e=s(),t=Object(f.e)();return!t&&(e===p.a.BASE_OFFICE_THEME_ID||e==p.a.BASE_THEME_ID&&!Object(l.i)(e,t))}function v(){var e=s(),t=Object(f.e)();return t&&(e===p.a.BASE_OFFICE_THEME_ID||e==p.a.BASE_THEME_ID&&!Object(l.i)(e,t))}n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return"#0078D4"})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return h})),n.d(t,"f",(function(){return v})),n.d(t,"b",(function(){return l.c})),n.d(t,"j",(function(){return l.e})),n.d(t,"l",(function(){return l.g})),n.d(t,"k",(function(){return l.f})),n.d(t,"c",(function(){return l.d}))},2085:function(e,t,n){"use strict";function o(e){return e&&!!e.setPluginUtils}n.d(t,"a",(function(){return o}))},2094:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a}));var o={};function i(e,t,n){o[e.editorId]={htmlEditor:t,plainTextEditor:n}}function r(e,t,n){var i=o[e.editorId];i&&(i.htmlEditor==t&&(i.htmlEditor=null),i.plainTextEditor==n&&(i.plainTextEditor=null),i.htmlEditor||i.plainTextEditor||delete o[e.editorId])}function a(e,t,n,i){if(e){var r=e.bodyType,a=void 0===r||"HTML"===r,s="Text"===r,c=o[e.editorId]||{},l=c.htmlEditor,u=c.plainTextEditor;a&&t&&(l&&!l.isDisposed()||i)?t(l):s&&n&&(u||i)&&n(u)}}},2306:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return c}));var o="color",i="bgcolor",r="data-ogsc",a="data-ogac",s="data-ogsb",c="data-ogab"},2499:function(e,t,n){"use strict";var o=n(188),i=n(2963);t.a=Object(o.action)("updateContent")((function(e,t,n){e.content!=t&&(e.content=t,n||Object(i.a)(e,!0))}))},2646:function(e,t,n){"use strict";n.r(t);var ReactEditor=n(7698),o=n(1678),i="TD",r="TH";function a(e,t,n){e.contains(t)&&e.addUndoSnapshot((function(){var e=new o.VTable(t);e.row=0,e.forEachCellOfCurrentRow((function(e,t){e.td&&Object(o.changeElementTag)(e.td,n?i:r)}))}))}var s=n(2094),c=n(7288),l=n(7287);var u=n(8415),d=n(2499),f=n(7286),p=n(2420);function h(e,t,n){var i;Object(s.b)(e,t&&function(n){if(n){e.selectionPath&&(n.select(e.selectionPath),Object(f.a)(e,null));var r=t(n,n.getSelectionRange(),o,p);n.select(r),i=n.getContent()}else{var a=function(e){var t=document.createElement("div");return new c.Editor(t,{initialContent:e.content,undoSnapshotService:Object(l.a)(e)})}(e);a.select(e.selectionPath);r=t(a,a.getSelectionRange(),o,p);a.select(r),i=a.getContent(),Object(f.a)(e,a.getSelectionPath()),a.dispose()}},n&&function(t){var o;if(t){if(o=n(t.value,t.selectionStart,t.selectionEnd)){var r=o.value,a=o.selectionStart,s=o.selectionEnd,c=o.focus;if(i=t.value=r,c){t.focus();var l=a||0,d=s||0;t.selectionStart=l,t.selectionEnd=d,Object(u.a)(e,l,d)}}}else if(o=n(e.content,e.selectionStart||0,e.selectionEnd||0)){r=o.value,a=o.selectionStart,s=o.selectionEnd;i=r,Object(u.a)(e,a||0,s||0)}},!0),null!=i&&Object(d.a)(e,i)}function v(e){h(e,(function(e,t){return t||(e.focus(),t=e.getSelectionRange()),t}),(function(e,t,n){return{value:e,selectionStart:t,selectionEnd:n,focus:!0}}))}n.d(t,"ReactEditor",(function(){return ReactEditor.a})),n.d(t,"setTableHeaderRow",(function(){return a})),n.d(t,"operateContent",(function(){return h})),n.d(t,"focusToEditor",(function(){return v}))},2963:function(e,t,n){"use strict";var o=n(188);t.a=Object(o.action)("setIsDirty")((function(e,t){e.isDirty=t}))},299:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var o=n(4),i=n(37);function r(){var e,t=Object(i.a)("DefaultAnchorMailbox");return null==t||0==t.trim().length||(e=Object(o.b)(window.location),Object.keys(e).indexOf("anonRetry")>=0)}function a(){var e=Object(o.b)(window.location);return Object.keys(e).indexOf("anonymous")>=0}},2999:function(e,t,n){"use strict";var o=n(431),i=n.n(o),r=n(2306),a=4.5,s="";function c(e,t,n){try{var o=i()(t),a=!1,c=window.getComputedStyle(e),d=e.style.color,f=i()(c.color||void 0),p=e.getAttribute(r.b);(n?d||p:!l(f,o))&&(f=u(f,o,!!n,t),e.style.setProperty("color",f.rgb().string(),"important"),e.setAttribute(r.f,d||s),p&&(e.setAttribute(r.b,f.rgb().string()),e.setAttribute(r.d,p)),a=!0);var h=e.style.backgroundColor,v=c.backgroundColor?i()(c.backgroundColor):i()(h||void 0),g=e.getAttribute(r.a);if((n?h||g:!l(v,f))&&(v=u(v,f,!!n,t),e.style.setProperty("background-color",v.rgb().string(),"important"),e.setAttribute(r.e,h||s),g&&(e.setAttribute(r.a,v.rgb().string()),e.setAttribute(r.c,g)),a=!0),a)return{element:e,styleColor:d,attrColor:p,styleBGColor:h,attrBGColor:g}}catch(e){}return null}function l(e,t){return e.contrast(t)>=a}function u(e,t,n,o){var r,a=i()(o).lab().array()[0],s=e.lab().array();if(n)r=(100-s[0])*((100-a)/100)+a;else{var c=t.lab().array()[0],l=50+a,u=(l+50)/2;r=s[0]*((100-a)/100)+a,r=c>u?((r=Math.min(r,2*u-r))-a)*(50-a)/(u-a)+a:100-(100-(r=Math.max(r,2*u-r)))*(100-l)/(100-u)}return i.a.lab(r,s[1],s[2]).rgb().alpha(e.alpha())}n.d(t,"a",(function(){return c}))},3491:function(e,t,n){"use strict";var o=n(3),i=Object(o.mutatorAction)("SetShouldUpdateContentOnDispose",(function(e,t){e.shouldUpdateContentOnDispose=t}));t.a=i},4300:function(e,t,n){"use strict";function o(e){return e.localizedName?e.localizedName:e.name}var i=[{name:"Arial",family:"Arial,Helvetica,sans-serif"},{name:"Arial Black",family:"'Arial Black',Arial,sans-serif"},{name:"Calibri",family:"Calibri,Helvetica,sans-serif"},{name:"Calibri Light",family:"'Calibri Light','Helvetica Light',sans-serif"},{name:"Cambria",family:"Cambria,Georgia,serif"},{name:"Candara",family:"Candara,Optima,sans-serif"},{name:"Century Gothic",family:"'Century Gothic',sans-serif"},{name:"Comic Sans MS",family:"'Comic Sans MS',Chalkboard,cursive"},{name:"Consolas",family:"Consolas,Courier,monospace"},{name:"Constantia",family:"Constantia,'Hoefler Text',serif"},{name:"Corbel",family:"Corbel,Skia,sans-serif"},{name:"Courier New",family:"'Courier New',monospace"},{name:"Franklin Gothic Book",family:"'Franklin Gothic Book','Avenir Next Condensed',sans-serif"},{name:"Franklin Gothic Demi",family:"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif"},{name:"Franklin Gothic Medium",family:"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif"},{name:"Garamond",family:"Garamond,Georgia,serif"},{name:"Georgia",family:"Georgia,serif"},{name:"Impact",family:"Impact,Charcoal,sans-serif"},{name:"Lucida Console",family:"'Lucida Console',Monaco,monospace"},{name:"Lucida Handwriting",family:"'Lucida Handwriting','Apple Chancery',cursive"},{name:"Lucida Sans Unicode",family:"'Lucida Sans Unicode','Lucida Grande',sans-serif"},{name:"Palatino Linotype",family:"'Palatino Linotype','Book Antiqua',Palatino,serif"},{name:"Segoe UI",family:"'Segoe UI','Helvetica Neue',sans-serif"},{name:"Sitka Heading",family:"'Sitka Heading',Cochin,serif"},{name:"Sitka Text",family:"'Sitka Text',Cochin,serif"},{name:"Tahoma",family:"Tahoma,Geneva,sans-serif"},{name:"Times",family:"Times,'Times New Roman',serif"},{name:"Times New Roman",family:"'Times New Roman',Times,serif"},{name:"Trebuchet MS",family:"'Trebuchet MS',Trebuchet,sans-serif"},{name:"TW Cen MT",family:"'TW Cen MT','Century Gothic',sans-serif"},{name:"Verdana",family:"Verdana,Geneva,sans-serif"},{name:"-",family:"-"},{name:"Microsoft YaHei",family:"'Microsoft YaHei','微软雅黑',STHeiti,sans-serif",localizedName:"微软雅黑"},{name:"SimHei",family:"SimHei,'黑体',STHeiti,sans-serif",localizedName:"黑体"},{name:"NSimSun",family:"NSimSun,'新宋体',SimSun,'宋体',SimSun-ExtB,'宋体-ExtB',STSong,serif",localizedName:"新宋体"},{name:"FangSong",family:"FangSong,'仿宋',STFangsong,serif",localizedName:"仿宋"},{name:"SimLi",family:"SimLi,'隶书','Baoli SC',serif",localizedName:"隶书"},{name:"KaiTi",family:"KaiTi,'楷体',STKaiti,serif",localizedName:"楷体"},{name:"-",family:"-"},{name:"Microsoft JhengHei",family:"'Microsoft JhengHei','微軟正黑體','Apple LiGothic',sans-serif",localizedName:"微軟正黑體"},{name:"PMingLiU",family:"PMingLiU,'新細明體',PMingLiU-ExtB,'新細明體-ExtB','Apple LiSung',serif",localizedName:"新細明體"},{name:"DFKai-SB",family:"DFKai-SB,'標楷體','BiauKai',serif",localizedName:"標楷體"},{name:"-",family:"-"},{name:"Meiryo",family:"Meiryo,'メイリオ','Hiragino Sans',sans-serif",localizedName:"メイリオ"},{name:"MS PGothic",family:"'MS PGothic','ＭＳ Ｐゴシック','MS Gothic','ＭＳ ゴシック','Hiragino Kaku Gothic ProN',sans-serif",localizedName:"ＭＳ Ｐゴシック"},{name:"MS PMincho",family:"'MS PMincho','ＭＳ Ｐ明朝','MS Mincho','ＭＳ 明朝','Hiragino Mincho ProN',serif",localizedName:"ＭＳ Ｐ明朝"},{name:"Yu Gothic",family:"'Yu Gothic','游ゴシック','YuGothic',sans-serif",localizedName:"游ゴシック"},{name:"Yu Mincho",family:"'Yu Mincho','游明朝','YuMincho',serif",localizedName:"游明朝"},{name:"-",family:"-"},{name:"Malgun Gothic",family:"'Malgun Gothic','맑은 고딕',AppleGothic,sans-serif",localizedName:"맑은 고딕"},{name:"Gulim",family:"Gulim,'굴림','Nanum Gothic',sans-serif",localizedName:"굴림"},{name:"Dotum",family:"Dotum,'돋움',AppleGothic,sans-serif",localizedName:"돋움"},{name:"Batang",family:"Batang,'바탕',AppleMyungjo,serif",localizedName:"바탕"},{name:"BatangChe",family:"BatangChe,'바탕체',AppleMyungjo,serif",localizedName:"바탕체"},{name:"Gungsuh",family:"Gungsuh,'궁서',GungSeo,serif",localizedName:"궁서"},{name:"-",family:"-"},{name:"Leelawadee UI",family:"'Leelawadee UI',Thonburi,sans-serif"},{name:"Angsana New",family:"'Angsana New','Leelawadee UI',Sathu,serif"},{name:"Cordia New",family:"'Cordia New','Leelawadee UI',Silom,sans-serif"},{name:"DaunPenh",family:"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif"},{name:"-",family:"-"},{name:"Nirmala UI",family:"'Nirmala UI',sans-serif"},{name:"Gautami",family:"Gautami,'Nirmala UI','Telugu MN',sans-serif"},{name:"Iskoola Pota",family:"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif"},{name:"Kalinga",family:"Kalinga,'Nirmala UI','Oriya MN',sans-serif"},{name:"Kartika",family:"Kartika,'Nirmala UI','Malayalam MN',sans-serif"},{name:"Latha",family:"Latha,'Nirmala UI','Tamil MN',sans-serif"},{name:"Mangal",family:"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif"},{name:"Raavi",family:"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif"},{name:"Shruti",family:"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif"},{name:"Tunga",family:"Tunga,'Nirmala UI','Kannada MN',sans-serif"},{name:"Vrinda",family:"Vrinda,'Nirmala UI','Bangla MN',sans-serif"},{name:"-",family:"-"},{name:"Nyala",family:"Nyala,Kefa,sans-serif"},{name:"Sylfaen",family:"Sylfaen,Mshtakan,Menlo,serif"}];function r(e){for(var t=e.toUpperCase(),n=0;n<i.length;n++){var o=i[n];if(o.name.toUpperCase()==t||o.localizedName&&o.localizedName.toUpperCase()==t)return o.family}return null}var a="pt",s=[8,10,12,14,18,24,36],c=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],l=c.map((function(e){return e.toString()}));function u(e){return"number"==typeof e&&e<=7?s[e-1]:e}function d(e){var t=u(e).toString();return t?t+a:t}n.d(t,"g",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d}))},4537:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a}));var o=["#51a7f9","#6fc040","#f5d427","#f3901d","#ed5c57","#b36ae2","#0c64c0","#0c882a","#dcbe22","#de6a19","#c82613","#763e9b","#174e86","#0f5c1a","#c3971d","#be5b17","#861106","#5e327c","#002451","#06400c","#a37519","#934511","#570606","#3b204d","#ffffff","#cccccc","#999999","#666666","#333333","#000000"],i=["#0075c2","#207a00","#5d4d00","#ab5500","#df504d","#ab63da","#6da0ff","#3da848","#6d5c00","#d3610c","#ff6847","#d394f9","#93b8f9","#7fc57b","#946f00","#de7633","#ff9b7c","#dea9fd","#cedbff","#a3da9b","#b5852a","#ef935c","#ffc0b1","#eecaff","#333333","#535353","#777777","#a0a0a0","#cfcfcf","#ffffff"],r=["#00ffff","#00ff00","#ffff00","#ff8000","#ff0000","#ff00ff","#80ffff","#80ff80","#ffff80","#ffc080","#ff8080","#ff80ff","#ffffff","#cccccc","#999999","#666666","#333333","#000000"],a=["#005357","#005e00","#383e00","#bf4c00","#ff2711","#e700e8","#004c4f","#005400","#343c00","#77480b","#bc454a","#aa2bad","#333333","#535353","#777777","#a0a0a0","#cfcfcf","#ffffff"]},4873:function(e,t,n){"use strict";var o=n(5262),i=n.n(o),r=n(3);t.a=Object(r.mutatorAction)("Editor_Initialize_Undo_Snapshot",(function(e){e.undoSnapshot=i()(1e7)}))},4889:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(1977);function i(e,t){var n=e.selectedImage;if(!n&&t){var i=Object(o.a)(e,"queryElements","img",1);n=null==i?void 0:i[0]}return n}},5069:function(e,t,n){"use strict";var o=n(0),i=n(25),r=n(4300),a=n(4537);n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var s={fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000",bold:!1,italic:!1,underline:!1};function c(e){var t=Object(i.a)().UserOptions;return t?l(t.ComposeFontName,t.ComposeFontSize,t.ComposeFontColor,t.ComposeFontFlags,!!e):s}function l(e,t,n,i,c){var l=Object(o.__assign)({},s),u=e?Object(r.d)(e):null;u&&(l.fontFamily=u);var d,f=t?Object(r.f)(t):null;if(f&&(l.fontSize=f),n){if(c){var p=(d=n,a.b[a.d.indexOf(d)]);p?l.textColors={lightModeColor:n,darkModeColor:p}:l.textColor=n}l.textColor=n}return i&&(l.bold=1==(1&i),l.italic=2==(2&i),l.underline=4==(4&i)),l}},6503:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678);t.hasFocus=function(e){var t=e.contentDiv.ownerDocument.activeElement;return t&&o.contains(e.contentDiv,t,!0)}},717:function(e,t,n){"use strict";var o,i=n(720),r=n(3),a=Object(r.createStore)("nonBootUserConfiguration",{nonBootUserConfiguration:null})(),s=n(299),c=Object(r.mutatorAction)("setNonBootUserConfiguration",(function(e){a.nonBootUserConfiguration=e}));function l(){return Object(s.b)()?Promise.resolve({}):a.nonBootUserConfiguration?Promise.resolve(a.nonBootUserConfiguration):(o||(o=Object(i.a)().then((function(e){return c(e),e})).catch((function(e){throw o=void 0,e}))),o)}var u=l;function d(){return a.nonBootUserConfiguration||l(),a.nonBootUserConfiguration}function f(){var e=(d()||{}).IsEdu;return void 0!==e&&e}function p(){var e=(d()||{}).ExternalInOutlookEnabled;return void 0!==e&&e}n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return p}))},720:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(28);function i(e){return Object(o.a)("GetOwaNonBootUserConfiguration",{},e)}},7284:function(e,t,n){var o=n(8384),i=n(107);"string"==typeof o&&(o=[[e.i,o]]);for(var r=0;r<o.length;r++)i.loadStyles(o[r][1],!1);o.locals&&(e.exports=o.locals)},7286:function(e,t,n){"use strict";var o=n(3),i=Object(o.mutatorAction)("SetCachedSelection",(function(e,t){e.selectionPath=t}));t.a=i},7287:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(3),i=n(1678),r=n(4873),a=Object(o.mutatorAction)("Undo_Move",(function(e,t){Object(i.moveCurrentSnapsnot)(e,t)})),s=Object(o.mutatorAction)("Undo_AddSnapshot",(function(e,t,n){return Object(i.addSnapshot)(e,t,n)})),c=Object(o.mutatorAction)("Undo_ClearRedo",(function(e){return Object(i.clearProceedingSnapshots)(e)}));function l(e){e.undoSnapshot||Object(r.a)(e);var t=e.undoSnapshot;return{canMove:function(e){return Object(i.canMoveCurrentSnapshot)(t,e)},move:function(e){return a(t,e),t.snapshots[t.currentIndex]},addSnapshot:function(e,n){return s(t,e,n)},clearRedo:function(){return c(t)},canUndoAutoComplete:function(){return Object(i.canUndoAutoComplete)(t)}}}},7288:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(8388);t.Editor=o.default},7698:function(e,t,n){"use strict";var o=n(0),i=n(8385),r=n(7),a=n(692),s=n(1678),c=["lower-alpha","lower-roman","decimal"],l={keys:[257],shouldHandleEvent:function(e){return Object(s.safeInstanceOf)(e.data,"HTMLOListElement")},handleEvent:function(e,t){var n=e.data,o=t.getElementAtCursor("OL",n.parentNode);Object(s.safeInstanceOf)(o,"HTMLOListElement")&&(n.style.listStyle=c[(c.indexOf(o.style.listStyleType)+1)%c.length])}},u=n(5069),d=n(2094),f=n(2420);function p(e){return function(t,n){if("undefined"!=typeof MutationObserver){var o=new MutationObserver(t);return o.observe(e,n),function(){o.disconnect()}}return function(){}}}function h(e){return function(t,n){var o=e.parentElement;o&&t.observe(o,n)}}function v(e){return function(t,n){return t.spellCheck(e,n)}}var g=n(2085),m=n(2999),y=n(40),b=n(2963),S=n(7286),C=n(3491),E=n(3),w=Object(E.mutatorAction)("Editor_setAdditionalProps",(function(e,t,n){e.textDirection=t,e.keyStrokeCount=n})),k=n(2499),P=function(){function e(e,t,n){this.viewState=e,this.updateOnKeyPress=t,this.updateOnDispose=n}return e.prototype.getName=function(){return"ViewStateManage"},e.prototype.initialize=function(e){this.editor=e,this.keyStrokeCount=this.viewState.keyStrokeCount,Object(C.a)(this.viewState,this.updateOnDispose)},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){3==e.eventType?(this.updateOnKeyPress?this.updateContentToViewState():this.viewState.isDirty||Object(b.a)(this.viewState,!0),this.keyStrokeCount++,this.clearCachedSelection()):7==e.eventType?this.clearCachedSelection():12==e.eventType&&this.viewState.shouldUpdateContentOnDispose?(this.updateContentToViewState(),this.editor.getSelectionRange()&&Object(S.a)(this.viewState,this.editor.getSelectionPath())):8==e.eventType&&w(this.viewState,this.getTextDirection(),this.keyStrokeCount)},e.prototype.updateContentToViewState=function(e){this.editor&&Object(k.a)(this.viewState,this.editor.getContent(),e)},e.prototype.getTextDirection=function(){var e,t,n=null===(t=null===(e=this.editor)||void 0===e?void 0:e.getEditorDomAttribute("dir"))||void 0===t?void 0:t.toLowerCase();return"ltr"==n||"rtl"==n?n:null},e.prototype.clearCachedSelection=function(){this.viewState.selectionPath&&Object(S.a)(this.viewState,null)},e}(),O=Object(E.mutatorAction)("Editor_SelectImage",(function(e,t){e.selectedImage=t})),D=n(4889),T=function(){function e(e){this.viewState=e}return e.prototype.getName=function(){return"SelectImage"},e.prototype.initialize=function(e){var t=this;this.editor=e,O(this.viewState,null),this.editor.getDocument().execCommand("enableObjectResizing",!1,"false"),this.editor.addContentEditFeature({keys:[46,8],shouldHandleEvent:function(){return!!Object(D.a)(t.viewState)},handleEvent:function(e){e.rawEvent.stopPropagation(),e.rawEvent.preventDefault(),t.editor.addUndoSnapshot((function(){t.editor.deleteNode(Object(D.a)(t.viewState)),t.selectImage(null)}),"DeleteImage")}})},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(6===e.eventType&&0==e.rawEvent.button){var t=e.rawEvent.target;this.selectImage("IMG"==(null==t?void 0:t.nodeName)?t:null)}else 0===e.eventType&&this.selectImage(null)},e.prototype.selectImage=function(e){var t;O(this.viewState,null),"a"!==(null===(t=null==e?void 0:e.parentElement)||void 0===t?void 0:t.tagName.toLowerCase())&&(O(this.viewState,e),this.editor.focus(),this.editor.select(e,-3))},e}(),M=n(7287),N=n(76),I=n(1),j=n(7288);function A(e){var t=[];function n(e){(function(e){return e&&!!e.getUIComponentClass})(e)&&(r&&r.indexOf(e)<0?a(Object(o.__spread)(r,[e])):t&&t.indexOf(e)<0&&t.push(e))}(e.plugins||[]).forEach((function(e){!function(e){return e&&!!e.addOnImportedCallback}(e)?n(e):e.addOnImportedCallback(n)}));var i=Object(o.__read)(I.useState(t),2),r=i[0],a=i[1];return t=null,I.createElement(I.Fragment,null,r.map((function(e){return I.createElement(e.getUIComponentClass(),{viewState:e.adapter(),editorViewState:e.editorAdapter(),plugin:e,key:e.getName()})})))}var B=n(25),x=n(1826),R=new(n(44).c)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(22),n.e(40),n.e(601)]).then(n.bind(null,17392))})),F=Object(x.a)(R,(function(e){return e.ContentEdit}),"ContentEdit",W),U=Object(x.a)(R,(function(e){return e.HyperLink}),"HyperLink",W),_=Object(x.a)(R,(function(e){return e.Paste}),"Paste",W),L=Object(x.a)(R,(function(e){return e.TableResize}),"TableResize",W),H=Object(x.a)(R,(function(e){return e.OwaWatermark}),"Watermark",W),z=Object(x.a)(R,(function(e){return e.ImageResize}),"ImageResize",W),G=Object(x.a)(R,(function(e){return e.OwaContextMenu}),"ContextMenu",W),K=Object(x.a)(R,(function(e){return e.OwaCustomReplace}),"CustomReplace",W),V=Object(x.a)(R,(function(e){return e.CutPasteListChain}),"CutPasteListChain",W);function W(e){return 11==e.eventType}var q={getName:function(){return"CtsWorkaround"},initialize:function(){},dispose:function(){},onPluginEvent:function(e){10==e.eventType&&Object(s.chainSanitizerCallback)(e.sanitizingOption.cssStyleCallbacks,Y,(function(e,t,n){return n[Y]=e,"pre"!=e}))}},Y="white-space",J=q;var X=n(198),$=n(7284),Q=n(402).bind($),Z=function(e){function ReactEditor(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBlur=function(){t.updateContentToViewState(),t.props.onBlur&&t.props.onBlur()},t}return Object(o.__extends)(ReactEditor,e),ReactEditor.prototype.componentDidMount=function(){this.editor=new j.Editor(this.editorDiv,this.getEditorOptions()),this.updateContentToViewState(!0),this.props.focusOnInit&&this.editor.focus(),Object(d.a)(this.props.viewState,this.editor,null)},ReactEditor.prototype.componentWillUnmount=function(){this.editor&&this.editor.dispose(),Object(d.c)(this.props.viewState,this.editor,null),this.editor=null},ReactEditor.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.viewState!==this.props.viewState){this.updateContentToViewState(!1);var t=s.HtmlSanitizer.convertInlineCss(e.viewState.content);this.editor.setContent(t,!0),Object(k.a)(e.viewState,this.editor.getContent(),!0)}e.isDarkMode!==this.props.isDarkMode&&this.setDarkMode(e.isDarkMode)},ReactEditor.prototype.render=function(){var e=this,t=this.props,n=t.onFocus,o=t.classNames,i=t.viewState,r=t.watermark,a=t.ariaLabel,s=t.isDarkMode,c=t.plugins,l=t.deprecated_contentEditable,u=i.textDirection?"rtl"===i.textDirection:Object(B.a)().SessionSettings.IsUserCultureRightToLeft;return I.createElement(I.Fragment,null,I.createElement("div",{contentEditable:null==l||l,ref:function(t){return e.editorDiv=t},dir:u?"rtl":"ltr",className:Q(o,$.overflowHidden,$.textSelectable,{resetColors:!s,anchorReset:s}),onBlur:this.onBlur,onFocus:n,role:"textbox","aria-multiline":"true","aria-label":a||r}),I.createElement("div",null),I.createElement(A,{plugins:c}))},ReactEditor.prototype.focus=function(){this.editor&&this.editor.focus()},ReactEditor.prototype.updateContentToViewState=function(e){this.editor&&Object(k.a)(this.props.viewState,this.editor.getContent(),e)},ReactEditor.prototype.getEditorOptions=function(){var e,t=this.props,n=t.plugins,a=t.viewState,c=t.watermark,d=t.watermarkFormat,b=t.isDarkMode,S=t.scrollContainerSelector,C=t.updateOnKeyPress,E=t.updateOnDispose,w=Object(y.i)("cmp-editor-experimentFeatures"),k=Object(u.a)(b),O=Object(y.i)("cmp-markdownInline"),D=Object(r.c)(Object(r.b)(i.c),Object(N.l)()?Object(r.b)(i.a):Object(r.b)(i.b)),I=Object(o.__spread)(n||[],[new F({mergeInNewLineWhenBackspaceOnFirstChar:!0,markdownBold:O,markdownItalic:O,markdownStrikethru:O,markdownInlineCode:O},w?[]:[l]),new U((function(e){return D+"\r\n"+e})),new _,new L,new K,new V,c&&new H(c,d),new T(a),new z(10,10,Object(X.i)().themePrimary,!0),new P(a,C,E),new G,J]),j=(e=this.editorDiv,{replaceWithNode:f.replaceWithNode,editTable:f.editTable,formatTable:f.formatTable,createVTable:function(e){return new s.VTable(e)},observeMutation:p(e),observeResize:h(e),spellCheck:v(e)});I.forEach((function(e){return Object(g.a)(e)&&e.setPluginUtils(j)}));var A=s.HtmlSanitizer.convertInlineCss(a.content),B=w?["ListChain","MergePastedLine","NewBullet","NewIndentation","NewNumbering"]:[];return Object(y.i)("cmp-edgeLinkPreview")&&B.push("PasteWithLinkPreview"),Object(y.i)("cmp-singleDirImgResize")&&B.push("SingleDirectionResize"),{plugins:I,defaultFormat:k,undoSnapshotService:Object(M.a)(a),initialContent:A,inDarkMode:b,experimentalFeatures:B,allowKeyboardEventPropagation:!0,scrollContainer:S&&Object(s.findClosestElementAncestor)(this.editorDiv,this.editorDiv.ownerDocument.body,S),onExternalContentTransform:function(e){return Object(m.a)(e,Object(X.i)().white,!0)}}},ReactEditor.prototype.setDarkMode=function(e){this.editor.setDarkModeState(e)},ReactEditor=Object(o.__decorate)([a.observer],ReactEditor)}(I.Component);t.a=Z},8384:function(e,t,n){(t=e.exports=n(106)(!1)).push([e.i,"._2s9KmFMlfdGElivl0o-GZb{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._2s9KmFMlfdGElivl0o-GZb{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._17ghdPL1NLKYjRvmoJgpoK{user-select:text;-moz-user-select:text;-ms-user-select:text;-webkit-user-select:text}.CAUXSSmBTHvYTez0U6p3M{overflow:hidden}.yfRvh-CU21dFu_j7B1j_j a:link{color:#ba7cff}.yfRvh-CU21dFu_j7B1j_j a:visited{color:#e49fff}",""]),t.locals={resetColors:"_2s9KmFMlfdGElivl0o-GZb",textSelectable:"_17ghdPL1NLKYjRvmoJgpoK",overflowHidden:"CAUXSSmBTHvYTez0U6p3M",anchorReset:"yfRvh-CU21dFu_j7B1j_j"}},8385:function(e){e.exports=JSON.parse('{"c":"$ma","a":"ana","b":"bna"}')},8388:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(8389),r=n(8404),a=n(1678),s=function(){function e(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=a.getTagOfNode(e))throw new Error("contentDiv must be an HTML DIV element");var s=r.default(e,t),c=[];Object.keys(s).forEach((function(e){e==r.PLACEHOLDER_PLUGIN_NAME?a.arrayPush(c,t.plugins):c.push(s[e])})),this.core=o({contentDiv:e,api:o(o({},i.coreApiMap),t.coreApiOverride||{}),plugins:c.filter((function(e){return!!e}))},r.getPluginState(s)),this.core.plugins.forEach((function(e){return e.initialize(n)})),this.ensureTypeInContainer(new a.Position(this.core.contentDiv,0).normalize())}return e.prototype.dispose=function(){this.core.plugins.reverse().forEach((function(e){return e.dispose()})),this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){return!!e&&this.core.api.insertNode(this.core,e,t)},e.prototype.deleteNode=function(e){return!(!e||!this.contains(e))&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t,n){return!(!this.contains(e)||!t)&&(this.core.api.transformColor(this.core,n?t:null,!0,(function(){return e.parentNode.replaceChild(t,e)}),0),!0)},e.prototype.getBlockElementAtNode=function(e){return a.getBlockElementAtNode(this.core.contentDiv,e)},e.prototype.contains=function(e){return a.contains(this.core.contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var o=t instanceof Function?0:t;n=t instanceof Function?t:n;var i=0==o?null:this.getSelectionRange();return a.queryElements(this.core.contentDiv,e,n,o,i)},e.prototype.collapseNodes=function(e,t,n){return a.collapseNodes(this.core.contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return a.isNodeEmpty(this.core.contentDiv,e)},e.prototype.getContent=function(e){return void 0===e&&(e=0),this.core.api.getContent(this.core,e)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0),this.core.api.setContent(this.core,e,t)},e.prototype.insertContent=function(e,t){if(e){var n=this.getDocument(),o=a.fromHtml(e,n);t&&t.insertOnNewLine&&o.length>1&&(o=[a.wrap(o)]);var i=n.createDocumentFragment();o.forEach((function(e){return i.appendChild(e)})),this.insertNode(i,t)}},e.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed&&a.deleteSelectedContent(this.core.contentDiv,e)},e.prototype.paste=function(e,t,n){var o=this;if(e){e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(2);var i=this.getSelectionRange(),r=i&&a.Position.getStart(i),s=this.core.api.createPasteFragment(this.core,e,r,t,n);this.addUndoSnapshot((function(){return o.insertNode(s),e}),"Paste")}},e.prototype.getSelectionRange=function(e){return void 0===e&&(e=!0),this.core.api.getSelectionRange(this.core,e)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&a.getSelectionPath(this.core.contentDiv,e)},e.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},e.prototype.focus=function(){this.core.api.focus(this.core)},e.prototype.select=function(e,t,n,o){var i=e?a.safeInstanceOf(e,"Range")?e:Array.isArray(e.start)&&Array.isArray(e.end)?a.createRange(this.core.contentDiv,e.start,e.end):a.createRange(e,t,n,o):null;return this.contains(i)&&this.core.api.selectRange(this.core,i)},e.prototype.getFocusedPosition=function(){var e=this.getDocument().defaultView.getSelection();if(this.contains(e&&e.focusNode))return new a.Position(e.focusNode,e.focusOffset);var t=this.getSelectionRange();return t?a.Position.getStart(t):null},e.prototype.getElementAtCursor=function(e,t,n){var o=this;return n=t?null:n,a.cacheGetEventData(n,"GET_ELEMENT_AT_CURSOR_"+e,(function(){if(!t){var n=o.getFocusedPosition();t=n&&n.node}return t&&a.findClosestElementAncestor(t,o.core.contentDiv,e)}))},e.prototype.isPositionAtBeginning=function(e){return a.isPositionAtBeginningOf(e,this.core.contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0);var t=this.getSelectionRange();return t?a.getRegionsFromRange(this.core.contentDiv,t,e):[]},e.prototype.addDomEventHandler=function(e,t){var n,o="string"==typeof e?((n={})[e]=t,n):e;return this.core.api.attachDomEvent(this.core,o)},e.prototype.triggerPluginEvent=function(e,t,n){var i=o({eventType:e},t);return this.core.api.triggerEvent(this.core,i,n),i},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(7,{source:e,data:t})},e.prototype.undo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,-1)},e.prototype.redo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,1)},e.prototype.addUndoSnapshot=function(e,t,n){this.core.api.addUndoSnapshot(this.core,e,t,n)},e.prototype.getUndoState=function(){var e=this.core.undo,t=e.hasNewContent,n=e.snapshotsService;return{canUndo:t||n.canMove(-1),canRedo:n.canMove(1)}},e.prototype.getDocument=function(){return this.core.contentDiv.ownerDocument},e.prototype.getScrollContainer=function(){return this.core.domEvent.scrollContainer},e.prototype.getCustomData=function(e,t,n){return(this.core.lifecycle.customData[e]=this.core.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},e.prototype.isInIME=function(){return this.core.domEvent.isInIME},e.prototype.getDefaultFormat=function(){return this.core.lifecycle.defaultFormat},e.prototype.getBodyTraverser=function(e){return a.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},e.prototype.getSelectionTraverser=function(){return this.getSelectionRange()&&a.ContentTraverser.createSelectionTraverser(this.core.contentDiv,this.getSelectionRange())},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t&&a.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},e.prototype.getContentSearcherOfCursor=function(e){var t=this;return a.cacheGetEventData(e,"CONTENTSEARCHER",(function(){var e=t.getSelectionRange();return e&&new a.PositionContentSearcher(t.core.contentDiv,a.Position.getStart(e))}))},e.prototype.runAsync=function(e){var t=this;(this.core.contentDiv.ownerDocument.defaultView||window).requestAnimationFrame((function(){!t.isDisposed()&&e&&e(t)}))},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},e.prototype.addContentEditFeature=function(e){var t=this;null==e||e.keys.forEach((function(n){var o=t.core.edit.features[n]||[];o.push(e),t.core.edit.features[n]=o}))},e.prototype.getStyleBasedFormatState=function(e){if(!e){var t=this.getSelectionRange();e=t&&a.Position.getStart(t).normalize().node}return this.core.api.getStyleBasedFormatState(this.core,e)},e.prototype.ensureTypeInContainer=function(e,t){this.core.api.ensureTypeInContainer(this.core,e,t)},e.prototype.setDarkModeState=function(e){if(this.isDarkMode()!=e){var t=this.getContent(0);this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode"),this.setContent(t)}},e.prototype.isDarkMode=function(){return this.core.lifecycle.isDarkMode},e.prototype.isFeatureEnabled=function(e){return this.core.lifecycle.experimentalFeatures.indexOf(e)>=0},e}();t.default=s},8389:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(8390),i=n(8391),r=n(8392),a=n(8393),s=n(8394),c=n(8395),l=n(8396),u=n(8397),d=n(6503),f=n(8398),p=n(8399),h=n(8400),v=n(8401),g=n(8402),m=n(8403);t.coreApiMap={attachDomEvent:i.attachDomEvent,addUndoSnapshot:o.addUndoSnapshot,createPasteFragment:r.createPasteFragment,ensureTypeInContainer:a.ensureTypeInContainer,focus:s.focus,getContent:c.getContent,getSelectionRange:l.getSelectionRange,getStyleBasedFormatState:u.getStyleBasedFormatState,hasFocus:d.hasFocus,insertNode:f.insertNode,restoreUndoSnapshot:p.restoreUndoSnapshot,selectRange:h.selectRange,setContent:v.setContent,transformColor:g.transformColor,triggerEvent:m.triggerEvent}},8390:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678);t.addUndoSnapshot=function(e,t,n,i){var r,a=e.undo,s=a.isNested;s||(a.isNested=!0,a.snapshotsService.addSnapshot(e.api.getContent(e,2),i),a.hasNewContent=!1);try{var c;if(t)r=t((c=e.api.getSelectionRange(e,!0))&&o.Position.getStart(c).normalize(),c&&o.Position.getEnd(c).normalize()),s||(a.snapshotsService.addSnapshot(e.api.getContent(e,2),!1),a.hasNewContent=!1)}finally{s||(a.isNested=!1)}if(t&&n){var l={eventType:7,source:n,data:r};e.api.triggerEvent(e,l,!0)}i&&((c=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=o.Position.getStart(c)))}},8391:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachDomEvent=function(e,t){var n=Object.keys(t||{}).map((function(n){var o=function(e){var t={pluginEventType:null,beforeDispatch:null};"number"==typeof e?t.pluginEventType=e:"function"==typeof e?t.beforeDispatch=e:"object"==typeof e&&(t=e);return t}(t[n]),i=o.pluginEventType,r=o.beforeDispatch,a=function(t){r&&r(t),null!=i&&e.api.triggerEvent(e,{eventType:i,rawEvent:t},!1)};return e.contentDiv.addEventListener(n,a),function(){e.contentDiv.removeEventListener(n,a)}}));return function(){return n.forEach((function(e){return e()}))}}},8392:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678);function i(e,t){o.toArray(e.querySelectorAll("style")).forEach(t)}t.createPasteFragment=function(e,t,n,r,a){var s,c;if(!t)return null;var l,u=function(e,t){return{eventType:10,clipboardData:t,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:o.createDefaultHtmlSanitizerOptions(),htmlBefore:"",htmlAfter:"",htmlAttributes:{}}}(e,t),d=u.fragment,f=u.sanitizingOption,p=t.rawHtml,h=t.text,v=t.imageDataUri,g=e.contentDiv.ownerDocument;if(r||h||!v)if(!r&&p&&(null===(s=l=(new DOMParser).parseFromString(p,"text/html"))||void 0===s?void 0:s.body)){var m=null===(c=l.querySelector("html"))||void 0===c?void 0:c.attributes;(m?o.toArray(m):[]).reduce((function(e,t){return e[t.name]=t.value,e}),u.htmlAttributes),o.toArray(l.querySelectorAll("meta")).reduce((function(e,t){return e[t.name]=t.content,e}),u.htmlAttributes),i(l,(function(e){l.head.appendChild(e),f.additionalGlobalStyleNodes.push(e)}));var y=p.indexOf("\x3c!--StartFragment--\x3e"),b=p.lastIndexOf("\x3c!--EndFragment--\x3e");for(y>=0&&b>=y+"\x3c!--StartFragment--\x3e".length&&(u.htmlBefore=p.substr(0,y),u.htmlAfter=p.substr(b+"\x3c!--EndFragment--\x3e".length),l.body.innerHTML=t.html=p.substring(y+"\x3c!--StartFragment--\x3e".length,b),i(l.body,(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})));l.body.firstChild;)d.appendChild(l.body.firstChild);if(a&&n){var S=function(e,t){var n=o.getPendableFormatState(e.contentDiv.ownerDocument),i=e.api.getStyleBasedFormatState(e,t);return{fontFamily:i.fontName,fontSize:i.fontSize,textColor:i.textColor,backgroundColor:i.backgroundColor,textColors:i.textColors,backgroundColors:i.backgroundColors,bold:n.isBold,italic:n.isItalic,underline:n.isUnderline}}(e,n.node);o.applyTextStyle(d,(function(e){return o.applyFormat(e,S)}))}}else h&&h.split("\n").forEach((function(e,t,n){var i=""==(e=e.replace(/^ /g," ").replace(/\r/g,"").replace(/ {2}/g,"  "))?g.createElement("br"):g.createTextNode(e);d.appendChild(0==t||t==n.length-1?i:o.wrap(i))}));else{var C=g.createElement("img");C.style.maxWidth="100%",C.src=v,d.appendChild(C)}e.api.triggerEvent(e,u,!0);var E=new o.HtmlSanitizer(u.sanitizingOption);return E.convertGlobalCssToInlineCss(d),E.sanitize(d,n&&o.getInheritableStyles(n.element)),d}},8393:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678);t.ensureTypeInContainer=function(e,t,n){t=t.normalize();var i,r=o.getBlockElementAtNode(e.contentDiv,t.node);if(r){i=r.collapseToSingleElement();var a=o.isNodeEmpty(i)||n&&function(e,t){return o.safeInstanceOf(e.target,"Node")&&e.target.contains(t)&&e.key===t.innerText}(n,i);i=i&&a?i:null}else i=o.fromHtml(o.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",e.contentDiv.ownerDocument)[0],e.api.insertNode(e,i,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new o.Position(i.firstChild,0);i&&o.applyFormat(i,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode),n&&e.api.selectRange(e,o.createRange(t))}},8394:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678);t.focus=function(e){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0))){var t=o.getFirstLeafNode(e.contentDiv)||e.contentDiv;e.api.selectRange(e,o.createRange(t,0),!0)}e.domEvent.selectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}},8395:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678);t.getContent=function(e,t){var n="",i=0==t,r=2==t;if(3==t)n=o.getTextContent(e.contentDiv);else if(i||e.lifecycle.isDarkMode){var a=e.contentDiv.cloneNode(!0),s=e.api.getSelectionRange(e,!0),c=r&&s&&o.getSelectionPath(e.contentDiv,s),l=c&&o.createRange(a,c.start,c.end);e.api.transformColor(e,a,!1,null,1),i?(e.api.triggerEvent(e,{eventType:8,clonedRoot:a},!0),n=a.innerHTML):n=l?o.getHtmlWithSelectionPath(a,l):a.innerHTML}else n=o.getHtmlWithSelectionPath(e.contentDiv,r&&e.api.getSelectionRange(e,!0));return n}},8396:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678);t.getSelectionRange=function(e,t){var n=null;if(!t||e.api.hasFocus(e)){var i=e.contentDiv.ownerDocument.defaultView.getSelection();if(i&&i.rangeCount>0){var r=i.getRangeAt(0);o.contains(e.contentDiv,r)&&(n=r)}}return!n&&t&&(n=e.domEvent.selectionRange),n}},8397:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678);t.getStyleBasedFormatState=function(e,t){if(!t)return{};var n=t?o.getComputedStyles(t):[],i=e.lifecycle.isDarkMode,r=e.contentDiv,a=i&&o.findClosestElementAncestor(t,r,"[data-ogsc],[data-ogac]"),s=i&&o.findClosestElementAncestor(t,r,"[data-ogsb],[data-ogab]");return{fontName:n[0],fontSize:n[1],textColor:n[2],backgroundColor:n[3],textColors:a?{darkModeColor:n[2],lightModeColor:a.dataset.ogsc||a.dataset.ogac}:void 0,backgroundColors:s?{darkModeColor:n[3],lightModeColor:s.dataset.ogsb||s.dataset.ogab}:void 0}}},8398:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678),i=[function(e,t,n){var i=o.getBlockElementAtNode(e,n.node);if(i){var a=o.queryElements(e,"a[href]",null,1,o.createRange(n)).filter((function(e){return i.contains(e)}))[0];if(a&&o.isNodeEmpty(a)&&(n=new o.Position(a,-2),r(a),a=null),a&&t.querySelector&&t.querySelector("a[href]")){var s=n.normalize(),c=s.node.parentNode,l=3==s.node.nodeType?o.splitTextNode(s.node,s.offset,!1):s.isAtEnd?s.node.nextSibling:s.node,u=e.ownerDocument.createTextNode("");for(c.insertBefore(u,l);o.contains(a,u);)u=o.splitBalancedNodeRange(u);n=new o.Position(u,-2),r(u)}}return n},function(e,t,n){var i=t;if(11==i.nodeType){var a=o.toArray(i.childNodes).filter((function(e){return"BR"!=o.getTagOfNode(e)}));i=1==a.length?a[0]:null}var s=o.getTagOfNode(i),c=s&&"BR"==o.getTagOfNode(i.nextSibling),l=o.findClosestElementAncestor(n.node,e,"LI"),u=l&&o.findClosestElementAncestor(l,e,"OL,UL"),d=o.findClosestElementAncestor(n.node,e,"TD,TH"),f=d&&o.findClosestElementAncestor(d,e,"TR");"LI"==s&&(s=u?o.getTagOfNode(u):"UL",i=o.wrap(i,s));if("OL"!=s&&"UL"!=s||"LI"!=o.getTagOfNode(i.firstChild)){if("TABLE"==s&&f){var p=new o.VTable(i),h=new o.VTable(d);0==h.col&&d==h.getCell(h.row,0).td&&p.cells[0]&&p.cells[0].length==h.cells[0].length&&o.isPositionAtBeginningOf(n,d)&&("TBODY"!=o.getTagOfNode(i.firstChild)||i.firstChild.nextSibling||o.unwrap(i.firstChild),o.unwrap(i),n=new o.Position(f,-3))}}else{var v=!i.firstChild.nextSibling&&!c;c&&i.parentNode&&r(i.nextSibling),v?(o.unwrap(i.firstChild),o.unwrap(i)):o.getTagOfNode(u)==s&&(o.unwrap(i),n=new o.Position(l,o.isPositionAtBeginningOf(n,l)?-2:-3))}return n},function(e,t,n){if("P"==o.getTagOfNode(n.node)){var i=n.normalize(),r=o.changeElementTag(n.node,"div");i.node!=r&&(n=i)}return n},function(e,t,n){o.isVoidHtmlElement(n.node)&&(n=new o.Position(n.node,n.isAtEnd?-3:-2));return n}];function r(e){var t;null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}t.insertNode=function(e,t,n){n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var r=e.contentDiv;return n.updateCursor&&e.api.focus(e),4==n.position?(r.parentNode.insertBefore(t,r.nextSibling),!0):(e.api.transformColor(e,t,!0,(function(){switch(n.position){case 0:case 1:var a,s=0==n.position,c=o.getFirstLastBlockElement(r,s);if(c){var l=s?c.getStartNode():c.getEndNode();n.insertOnNewLine||3==l.nodeType||o.isVoidHtmlElement(l)?o.safeInstanceOf(t,"DocumentFragment")?(a=o.toArray(t.childNodes),l.parentNode.insertBefore(t,s?l:l.nextSibling)):a=l.parentNode.insertBefore(t,s?l:l.nextSibling):a=l.insertBefore(t,s?l.firstChild:null)}else a=r.appendChild(t);if(a&&n.insertOnNewLine){var u=Array.isArray(a)?a:[a];o.isBlockElement(u[0])&&o.isBlockElement(u[u.length-1])||o.wrap(u)}break;case 2:var d=r.appendChild(t);d&&n.insertOnNewLine&&!o.isBlockElement(d)&&o.wrap(d);break;case 5:case 3:var f=function(e,t){var n=e.api.getSelectionRange(e,!0),o=null;return 5==t.position?(o=n,n=t.range):n&&(o=n.cloneRange()),{range:n,rangeToRestore:o}}(e,n),p=f.range,h=f.rangeToRestore;if(!p)return;n.replaceSelection&&!p.collapsed&&p.deleteContents();var v=o.Position.getStart(p),g=void 0;n.insertOnNewLine&&(g=o.getBlockElementAtNode(r,v.normalize().node))?v=new o.Position(g.getEndNode(),-3):i.forEach((function(e){v=e(r,t,v)}));var m=11==t.nodeType?t.lastChild:t;(p=o.createRange(v)).insertNode(t),n.updateCursor&&m&&(h=o.createRange(new o.Position(m,-3).normalize())),e.api.selectRange(e,h)}}),0),!0)}},8399:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreUndoSnapshot=function(e,t){e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);var n=e.undo.snapshotsService.move(t);if(null!=n)try{e.undo.isRestoring=!0,e.api.setContent(e,n,!0)}finally{e.undo.isRestoring=!1}}},8400:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(6503),i=n(1678);t.selectRange=function(e,t,n){return!!i.contains(e.contentDiv,t)&&(i.addRangeToSelection(t,n),o.hasFocus(e)||(e.domEvent.selectionRange=t),t.collapsed&&function(e){var t=e.contentDiv,n=e.pendingFormatState,o=e.api.getSelectionRange;if(n.pendableFormatState){var r=t.ownerDocument,a=i.getPendableFormatState(r);Object.keys(i.PendableFormatCommandMap).forEach((function(e){!!n.pendableFormatState[e]!=a[e]&&r.execCommand(i.PendableFormatCommandMap[e],!1,null)}));var s=o(e,!0);n.pendableFormatPosition=s&&i.Position.getStart(s)}}(e),!0)}},8401:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678);t.setContent=function(e,t,n){var i=!1;if(e.contentDiv.innerHTML!=t){var r=o.setHtmlWithSelectionPath(e.contentDiv,t);e.api.selectRange(e,r),i=!0}e.api.transformColor(e,e.contentDiv,!1,null,0),n&&(i||e.lifecycle.isDarkMode)&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)}},8402:function(e,t,n){"use strict";var o,i;Object.defineProperty(t,"__esModule",{value:!0});var r=n(1678),a=((o={}).ogsc=function(e,t){return e.style.color=t},o.ogsb=function(e,t){return e.style.backgroundColor=t},o),s=((i={}).ogac="color",i.ogab="bgcolor",i);function c(e,t){return e&&"undefined"!=e&&"null"!=e?e:t}t.transformColor=function(e,t,n,o,i){var l=e.lifecycle.isDarkMode?function(e,t){var n=[];if(r.safeInstanceOf(e,"HTMLElement")){t&&n.push(e);var o=e.getElementsByTagName("*");r.arrayPush(n,r.toArray(o))}else if(r.safeInstanceOf(e,"DocumentFragment")){o=e.querySelectorAll("*");r.arrayPush(n,r.toArray(o))}return n}(t,n):[];null==o||o(),l.forEach((function(t){1==i&&(null==t?void 0:t.dataset)?(Object.keys(a).forEach((function(e){a[e](t,c(t.dataset[e],"")),delete t.dataset[e]})),Object.keys(s).forEach((function(e){var n=t.dataset[e];c(n,null)?t.setAttribute(s[e],n):t.removeAttribute(s[e]),delete t.dataset[e]}))):t&&(e.lifecycle.onExternalContentTransform?e.lifecycle.onExternalContentTransform(t):(t.style.color=null,t.style.backgroundColor=null))}))}},8403:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=function(e,t,n){!n&&e.plugins.some((function(e){return function(e,t){var n;if(t.onPluginEvent&&(null===(n=t.willHandleEventExclusively)||void 0===n?void 0:n.call(t,e)))return t.onPluginEvent(e),!0;return!1}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},8404:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(8405),i=n(8406),r=n(8407),a=n(8408),s=n(8409),c=n(8410),l=n(8411),u=n(8412),d=n(8413),f=n(8414);t.PLACEHOLDER_PLUGIN_NAME="_placeholder",t.default=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new d.default,edit:n.edit||new r.default,_placeholder:null,typeAfterLink:n.typeAfterLink||new u.default,undo:n.undo||new f.default(t),domEvent:n.domEvent||new i.default(t,e),pendingFormatState:n.pendingFormatState||new l.default,mouseUp:n.mouseUp||new c.default,copyPaste:n.copyPaste||new o.default,entity:n.entity||new a.default,lifecycle:n.lifecycle||new s.default(t,e)}},t.getPluginState=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState()}}},8405:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678),i=function(){function e(){var e=this;this.onPaste=function(t){o.extractClipboardEvent(t,(function(t){if(void 0===t.rawHtml){var n=e.editor.getSelectionRange(),o=e.getTempDiv();e.editor.runAsync((function(){t.rawHtml=o.innerHTML,e.cleanUpAndRestoreSelection(o,n),e.paste(t)}))}else e.paste(t)}),{allowLinkPreview:e.editor.isFeatureEnabled("PasteWithLinkPreview")})}}return e.prototype.getName=function(){return"CopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:this.onPaste,copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},e.prototype.onCutCopy=function(e,t){var n=this,i=this.editor.getSelectionRange();if(i&&!i.collapsed){var r=this.editor.getContent(2),a=this.getTempDiv(!0),s=o.setHtmlWithSelectionPath(a,r);s&&o.addRangeToSelection(s),this.editor.triggerPluginEvent(9,{clonedRoot:a,range:s,rawEvent:e,isCut:t}),this.editor.runAsync((function(e){n.cleanUpAndRestoreSelection(a,i),t&&e.addUndoSnapshot((function(){var t=n.editor.deleteSelectedContent();e.focus(),e.select(t)}),"Cut")}))}},e.prototype.paste=function(e){var t=this;e.image?o.readFile(e.image,(function(n){e.imageDataUri=n,t.editor.paste(e)})):this.editor.paste(e)},e.prototype.getTempDiv=function(e){var t=this,n=this.editor.getCustomData("CopyPasteTempDiv",(function(){var e=o.fromHtml('<div contenteditable style="width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text"></div>',t.editor.getDocument())[0];return t.editor.insertNode(e,{position:4}),e}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return e&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},e.prototype.cleanUpAndRestoreSelection=function(e,t){this.editor.select(t),e.style.backgroundColor="",e.style.color="",e.style.display="none",e.innerHTML=""},e}();t.default=i},8406:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678),i=function(){function e(e,t){var n,i=this;this.onDrop=function(e){i.editor.runAsync((function(e){e.addUndoSnapshot((function(){}),"Drop")}))},this.onFocus=function(){i.editor.select(i.state.selectionRange),i.state.selectionRange=null},this.onBlur=function(){i.state.selectionRange=i.editor.getSelectionRange(!1)},this.onScroll=function(e){i.editor.triggerPluginEvent(14,{rawEvent:e,scrollContainer:i.state.scrollContainer})},this.onKeybaordEvent=function(e){o.isCharacterValue(e)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t=[];i.state.contextMenuProviders.forEach((function(n){var i=n.getContextMenuItems(e.target);(null==i?void 0:i.length)>0&&(t.length>0&&t.push(null),o.arrayPush(t,i))})),i.editor.triggerPluginEvent(16,{rawEvent:e,items:t})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null===(n=e.plugins)||void 0===n?void 0:n.filter(r))||[]}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n=this;this.editor=e,this.disposer=e.addDomEventHandler(((t={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:5,contextmenu:this.onContextMenuEvent,compositionstart:function(){return n.state.isInIME=!0},compositionend:function(t){n.state.isInIME=!1,e.triggerPluginEvent(4,{rawEvent:t})},drop:this.onDrop,focus:this.onFocus})[o.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.onBlur,t[o.Browser.isIE?"textinput":"input"]=this.getEventHandler(3),t)),this.state.scrollContainer.addEventListener("scroll",this.onScroll)},e.prototype.dispose=function(){this.state.scrollContainer.removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getEventHandler=function(e){return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:3==e?this.onInputEvent:this.onKeybaordEvent}:e},e}();function r(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}t.default=i},8407:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678),i=function(){function e(){this.state={features:{}}}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){var t,n=!1,i=!1;if(0==e.eventType){var r=e.rawEvent,a=this.editor.getSelectionRange();n=(i=o.isCtrlOrMetaPressed(r))||r.altKey,t=this.state.features[r.which]||a&&!a.collapsed&&this.state.features[258]}else 7==e.eventType&&(t=this.state.features[257]);for(var s=0;s<(null==t?void 0:t.length);s++){var c=t[s];if((c.allowFunctionKeys||!n)&&c.shouldHandleEvent(e,this.editor,i)){c.handleEvent(e,this.editor);break}}},e}();t.default=i},8408:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678),i=/_\d{1,8}$/,r=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],a=function(){function e(){var e=this;this.handleCutEvent=function(t){var n=e.editor.getSelectionRange();n&&!n.collapsed&&e.checkRemoveEntityForRange(t)},this.state={clickingPoint:null,knownEntityElements:[]}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.state.knownEntityElements=[],this.state.clickingPoint=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 5:this.handleMouseDownEvent(e.rawEvent);break;case 6:this.handleMouseUpEvent(e.rawEvent);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.fragment,e.sanitizingOption);break;case 7:this.handleContentChangedEvent("SetContent"==e.source);break;case 11:this.handleContentChangedEvent(!0);break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent)}},e.prototype.handleContextMenuEvent=function(e){var t=e.target,n=t&&this.editor.getElementAtCursor(o.getEntitySelector(),t);n&&(e.preventDefault(),this.triggerEvent(n,2,e))},e.prototype.handleMouseDownEvent=function(e){var t=e.target,n=e.pageX,i=e.pageY,r=t,a=r&&this.editor.getElementAtCursor(o.getEntitySelector(),r);a&&!a.isContentEditable&&(e.preventDefault(),this.state.clickingPoint={pageX:n,pageY:i})},e.prototype.handleMouseUpEvent=function(e){var t,n=e.target,i=e.pageX,r=e.pageY,a=n;this.state.clickingPoint&&this.state.clickingPoint.pageX==i&&this.state.clickingPoint.pageY==r&&a&&(t=this.editor.getElementAtCursor(o.getEntitySelector(),a))&&(e.preventDefault(),this.triggerEvent(t,1,e),s(this.editor)),this.state.clickingPoint=null},e.prototype.handleKeyDownEvent=function(e){(o.isCharacterValue(e)||8==e.which||46==e.which)&&(this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(e))},e.prototype.handleBeforePasteEvent=function(e,t){this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(null),o.arrayPush(t.additionalAllowedCssClasses,r)},e.prototype.handleContentChangedEvent=function(e){var t=this;this.state.knownEntityElements=e?[]:this.state.knownEntityElements.filter((function(e){return t.editor.contains(e)}));var n=this.state.knownEntityElements.map((function(e){var t;return null===(t=o.getEntityFromElement(e))||void 0===t?void 0:t.id})).filter((function(e){return!!e}));this.editor.queryElements(o.getEntitySelector(),(function(e){if(t.state.knownEntityElements.indexOf(e)<0){t.state.knownEntityElements.push(e);var i=o.getEntityFromElement(e);t.hydrateEntity(i,n)}}))},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;o.toArray(e.querySelectorAll(o.getEntitySelector())).forEach((function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)}))},e.prototype.checkRemoveEntityForRange=function(e){var t=this,n=[],i=o.getEntitySelector();if(this.editor.queryElements(i,1,(function(o){o.isContentEditable?n.push(o):t.triggerEvent(o,6,e)})),n.length>0){var r=this.editor.queryElements(i,2);n.forEach((function(n){var o=r.indexOf(n)>=0;t.triggerEvent(n,o?6:7,e)}))}},e.prototype.hydrateEntity=function(e,t){for(var n=e.id,r=e.type,a=e.wrapper,s=e.isReadonly,c=i.exec(n),l=(c?n.substr(0,n.length-c[0].length):n)||r,u="",d=c&&parseInt(c[1])||0;;d++)if(u=d>0?l+"_"+d:l,t.indexOf(u)<0){t.push(u);break}o.commitEntity(a,r,s,u),this.triggerEvent(a,0)},e.prototype.triggerEvent=function(e,t,n){var i=e&&o.getEntityFromElement(e);i&&this.editor.triggerPluginEvent(15,{operation:t,rawEvent:n,entity:i})},e}();t.default=a;var s=o.Browser.isIE?function(e){e.runAsync((function(e){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=e.getDocument().createElement("button");return t.style.overflow="hidden",t.style.position="fixed",t.style.width="0",t.style.height="0",t.style.left="0",t.style.top="-1000px",t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:4}),t}));t.style.display="";var n=e.getDocument().createRange();n.setStart(t,0);try{window.getSelection().removeAllRanges(),window.getSelection().addRange(n)}catch(e){}}))}:function(){}},8409:function(e,t,n){"use strict";var o,i;Object.defineProperty(t,"__esModule",{value:!0});var r=n(1678),a="contenteditable",s=r.Browser.isFirefox?((o={}).enableObjectResizing=!1,o.enableInlineTableEditing=!1,o):r.Browser.isIE?((i={}).defaultParagraphSeparator="div",i.AutoUrlDetect=!1,i):{},c={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},l={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"},u=function(){function e(e,t){var n=this;this.initialContent=e.initialContent||t.innerHTML||"",this.contentDivFormat=r.getComputedStyles(t),null===t.getAttribute(a)&&(this.initializer=function(){t.contentEditable="true",n.setSelectStyle(t,"text")},this.disposer=function(){n.setSelectStyle(t,""),t.removeAttribute(a)}),this.state={customData:{},defaultFormat:e.defaultFormat||null,isDarkMode:!!e.inDarkMode,onExternalContentTransform:e.onExternalContentTransform,experimentalFeatures:e.experimentalFeatures||[]}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,this.recalculateDefaultFormat(),this.editor.setContent(this.initialContent,!1),null===(t=this.initializer)||void 0===t||t.call(this),this.adjustBrowserBehavior(),this.editor.triggerPluginEvent(11,{},!0)},e.prototype.dispose=function(){var e=this;this.editor.triggerPluginEvent(12,{},!0),Object.keys(this.state.customData).forEach((function(t){var n=e.state.customData[t];n&&n.disposer&&n.disposer(n.value),delete e.state.customData[t]})),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){7!=e.eventType||"SwitchToDarkMode"!=e.source&&"SwitchToLightMode"!=e.source||(this.state.isDarkMode="SwitchToDarkMode"==e.source,this.recalculateDefaultFormat())},e.prototype.adjustBrowserBehavior=function(){var e=this;Object.keys(s).forEach((function(t){try{e.editor.getDocument().execCommand(t,!1,s[t])}catch(e){}}))},e.prototype.setSelectStyle=function(e,t){e.style.userSelect=t,e.style.msUserSelect=t,e.style.webkitUserSelect=t},e.prototype.recalculateDefaultFormat=function(){var e=this.state,t=e.defaultFormat,n=e.isDarkMode;if(n&&t&&(t.backgroundColors||(t.backgroundColors=c),t.textColors||(t.textColors=l)),!t||0!==Object.keys(t).length){var o=t||{},i=o.fontFamily,r=o.fontSize,a=o.textColor,s=o.textColors,u=o.backgroundColor,d=o.backgroundColors,f=o.bold,p=o.italic,h=o.underline,v=this.contentDivFormat;this.state.defaultFormat={fontFamily:i||v[0],fontSize:r||v[1],get textColor(){return s?n?s.darkModeColor:s.lightModeColor:a||v[2]},textColors:s,get backgroundColor(){return d?n?d.darkModeColor:d.lightModeColor:u||""},backgroundColors:d,bold:f,italic:p,underline:h}}},e}();t.default=u},8410:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){var e=this;this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(6,{rawEvent:t}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){5!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0)},e.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=o},8411:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678),i=function(){function e(){this.state={pendableFormatPosition:null,pendableFormatState:null}}return e.prototype.getName=function(){return"PendingFormatState"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.clear()},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState;break;case 0:case 5:case 7:this.state.pendableFormatPosition&&!this.state.pendableFormatPosition.equalTo(this.getCurrentPosition())&&this.clear()}},e.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null},e.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&o.Position.getStart(e).normalize()},e}();t.default=i},8412:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678),i=function(){function e(){}return e.prototype.getName=function(){return"TypeAfterLink"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(o.Browser.isFirefox&&1==e.eventType||10==e.eventType){var t=this.editor.getSelectionRange();if(t&&t.collapsed&&this.editor.getElementAtCursor("A[href]")){var n=this.editor.getContentSearcherOfCursor(e).getInlineElementBefore();n instanceof o.LinkInlineElement&&this.editor.select(new o.Position(n.getContainerNode(),-3))}}},e}();t.default=i},8413:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678),i=function(){function e(){}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(1==e.eventType){var t=this.editor.getSelectionRange();if(!t||this.editor.contains(o.findClosestElementAncestor(t.startContainer)))return;t.collapsed?this.editor.ensureTypeInContainer(o.Position.getStart(t),e.rawEvent):this.editor.runAsync((function(t){t.ensureTypeInContainer(t.getFocusedPosition(),e.rawEvent)}))}},e}();t.default=i},8414:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1678),i=1e7,r=function(){function e(e){var t;this.state={snapshotsService:e.undoSnapshotService||(t=o.createSnapshots(i),{canMove:function(e){return o.canMoveCurrentSnapshot(t,e)},move:function(e){return o.moveCurrentSnapsnot(t,e)},addSnapshot:function(e,n){return o.addSnapshot(t,e,n)},clearRedo:function(){return o.clearProceedingSnapshots(t)},canUndoAutoComplete:function(){return o.canUndoAutoComplete(t)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&this.canUndoAutoComplete()},e.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.state.isRestoring||this.clearRedoForInput()}},e.prototype.onKeyDown=function(e){if(8==e.which||46==e.which)if(8==e.which&&this.canUndoAutoComplete())e.preventDefault(),this.editor.undo(),this.state.autoCompletePosition=null,this.lastKeyPress=e.which;else{var t=this.editor.getSelectionRange();!t||t.collapsed&&this.lastKeyPress==e.which&&!o.isCtrlOrMetaPressed(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0,this.lastKeyPress=e.which}else e.which>=33&&e.which<=40&&(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},e.prototype.onKeyPress=function(e){if(!e.metaKey){var t=this.editor.getSelectionRange();t&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(){var e;return this.state.snapshotsService.canUndoAutoComplete()&&(null===(e=this.state.autoCompletePosition)||void 0===e?void 0:e.equalTo(this.editor.getFocusedPosition()))},e.prototype.addUndoSnapshot=function(){this.editor.addUndoSnapshot(),this.state.autoCompletePosition=null},e}();t.default=r},8415:function(e,t,n){"use strict";var o=n(3);t.a=Object(o.mutatorAction)("setPlainTextEditorSelection",(function(e,t,n){e.selectionStart=t,e.selectionEnd=n}))}}]);
//# sourceMappingURL=owa.MailBoot~HtmlEditor.js.map
self.scriptsLoaded['owa.MailBoot~HtmlEditor.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~HtmlEditor.js'] = (new Date()).getTime();