self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ReadingPane~TabView.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[271],{10245:function(n){n.exports=JSON.parse('{"a":"yfc"}')},10278:function(n,t,e){"use strict";e.d(t,"a",(function(){return o}));var r=e(1698),i=e(40);function o(n){return!(!Object(i.i)("rp-persistedReadingPaneTabs")||!n)&&Object(r.b)().loadedItemReadingPaneViewStates.has(n)}},10279:function(n,t,e){"use strict";e.d(t,"a",(function(){return a}));var r=e(1698),i=e(3),o=e(2662),a=Object(i.mutatorAction)("updatePrimaryReadingPaneTabId",(function(n){r.a.primaryReadingPaneTabId=n}));Object(i.mutator)(o.a,(function(n){r.a.primaryReadingPaneTabId=null}))},10280:function(n,t,e){"use strict";e.d(t,"a",(function(){return u}));var r=e(1762),i=e(1720),o=e(2386),a=e(34);function u(n,t,e){var u,c=Object(r.b)();if(n){switch(n.type){case i.a.SecondaryReadingPane:n.data.listViewType==e&&(u=Object(o.a)(t,e));break;case i.a.Compose:u=c.viewStates.get(n.data);break;case i.a.Primary:u=t?Object(o.a)(t,e,!0):null;break;default:u=null}return u}return a.d("There is no active tab. Something went very wrong."),null}},1702:function(n,t,e){"use strict";var r=e(214),i=e(1634),o=new Map;var a=e(1781),u=e(1706),c=e(2142);function d(n){return n?s(n.tableQuery):Object(r.d)()}function s(n){var t=Object(u.b)(n),e=null==n?void 0:n.folderId;return null!=t?Object(a.a)(t):f(e)}function f(n){return Object(i.H)(n)?Object(c.a)(n):function(n){if(!n)return Object(r.d)();if(!o.has(n)){var t=Object(i.v)(n,!0);o.set(n,t)}return o.get(n)}(n)}function l(n){return{mailboxInfo:s(n)}}e.d(t,"a",(function(){return d})),e.d(t,"c",(function(){return s})),e.d(t,"b",(function(){return f})),e.d(t,"d",(function(){return l}))},1710:function(n,t,e){"use strict";e.d(t,"b",(function(){return a})),e.d(t,"c",(function(){return u})),e.d(t,"d",(function(){return c})),e.d(t,"a",(function(){return s}));var r=e(1999),i=e(25),o=e(1746);function a(){return d(r.a.Bottom)}function u(){return d(r.a.Off)}function c(){return d(r.a.Right)}function d(n){var t=Object(o.a)();return null!==t.clientReadingPanePosition?t.clientReadingPanePosition===n:Object(i.a)().UserOptions.GlobalReadingPanePositionReact==n}function s(){var n=Object(i.a)().UserOptions.GlobalReadingPanePositionReact;return n==r.a.Off||n==r.a.Bottom}},1716:function(n,t,e){"use strict";var r=e(1702),i=e(1633);function o(){return Object(r.a)(Object(i.G)())}e.d(t,"b",(function(){return r.a})),e.d(t,"d",(function(){return r.c})),e.d(t,"c",(function(){return r.b})),e.d(t,"e",(function(){return r.d})),e.d(t,"a",(function(){return o}))},1742:function(n,t,e){"use strict";var r=e(3),i=Object(r.action)("updateIsSuiteHeaderRendered",(function(n){return{isRendered:n}})),o=Object(r.action)("updateShySuiteHeaderMode",(function(n){return{isShy:n}})),a=Object(r.action)("setIsFlexPaneShown",(function(n){return{isShown:n}})),u=Object(r.createStore)("suiteHeaderStore",{isRendered:!1,isShy:!1,isFlexPaneShown:!1});Object(r.mutator)(i,(function(){u().isRendered=!0})),Object(r.mutator)(o,(function(n){var t=n.isShy;u().isShy=t})),Object(r.mutator)(a,(function(n){u().isFlexPaneShown=n.isShown}));function c(){return u().isShy}function d(){return u().isRendered}function s(){return u().isFlexPaneShown}e.d(t,"e",(function(){return i})),e.d(t,"f",(function(){return o})),e.d(t,"d",(function(){return a})),e.d(t,"b",(function(){return c})),e.d(t,"c",(function(){return d})),e.d(t,"a",(function(){return s}))},1746:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(3),i=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0})},1768:function(n,t,e){"use strict";var r=e(16),i=e(3),o={folderTable:new r.ObservableMap,rootFolder:null},a=Object(i.createStore)("publicFolderFavoriteStore",o)();t.a=a},1797:function(n,t,e){"use strict";e.d(t,"j",(function(){return r})),e.d(t,"l",(function(){return i})),e.d(t,"v",(function(){return o})),e.d(t,"t",(function(){return a})),e.d(t,"a",(function(){return u})),e.d(t,"p",(function(){return c})),e.d(t,"b",(function(){return d})),e.d(t,"c",(function(){return s})),e.d(t,"f",(function(){return f})),e.d(t,"g",(function(){return l})),e.d(t,"h",(function(){return b})),e.d(t,"i",(function(){return v})),e.d(t,"e",(function(){return m})),e.d(t,"m",(function(){return h})),e.d(t,"d",(function(){return O})),e.d(t,"k",(function(){return p})),e.d(t,"s",(function(){return g})),e.d(t,"o",(function(){return S})),e.d(t,"u",(function(){return I})),e.d(t,"r",(function(){return j})),e.d(t,"q",(function(){return w})),e.d(t,"n",(function(){return P}));var r="multipart/signed",i="application/pkcs7-mime",o="application/x-pkcs7-mime",a=".p7m",u="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",c="CLASSID",d="4",s="0800",f=57,l=78,b=16,v=11,m="IPM.Note.SMIME.MultipartSigned",h="smime-",O="image",p="OwaToSmime",g="SmimeToOwa",S="en-US",I=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],j="OwaSmimeEdgeExtension.appxbundle",w="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",P="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},1837:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(214);function i(n){return{type:"PublicMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:n}}},1850:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(2025);function i(n){return n&&Object(r.b)(n.ItemClass)}},1877:function(n,t,e){"use strict";e.d(t,"a",(function(){return o})),e.d(t,"c",(function(){return a})),e.d(t,"b",(function(){return u}));var r=e(44),i=new r.c((function(){return e.e(899).then(e.bind(null,2469))})),o=new r.a(i,(function(n){return n.subscribe})),a=new r.a(i,(function(n){return n.unsubscribe})),u=new r.a(i,(function(n){return n.trigger}));new r.a(i,(function(n){return n.removeResizeEventEmitter}))},1895:function(n,t,e){"use strict";e.d(t,"a",(function(){return r}));var r="IPM.Note.SMIME"},1999:function(n,t,e){"use strict";var r;!function(n){n[n.Off=0]="Off",n[n.Right=1]="Right",n[n.Bottom=2]="Bottom"}(r||(r={})),t.a=r},2025:function(n,t,e){"use strict";e.d(t,"d",(function(){return o})),e.d(t,"c",(function(){return a})),e.d(t,"b",(function(){return u})),e.d(t,"a",(function(){return c}));var r=e(1797),i=e(1895);function o(n){return n&&0===n.indexOf(r.e)}function a(n){return n&&0===n.indexOf(i.a)&&!o(n)}function u(n){return n&&0===n.indexOf(i.a)}function c(n){return n.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},2075:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(1746);function i(){return Object(r.a)().showReadingPane}},2105:function(n,t,e){"use strict";e.d(t,"a",(function(){return r})),e.d(t,"b",(function(){return i}));var r=20,i=10},2117:function(n,t,e){"use strict";var r=e(44),i=e(2204),o=e(1640),a=e(188),u=Object(a.action)("setIsPendingDeleteConversationItemParts")(Object(a.select)({conversationItemParts:function(n){return o.u.conversations.get(n)}})((function(n,t,e){var r=e.conversationItemParts;r&&(r.isPendingDelete=t)}))),c=e(2105);e.d(t,"c",(function(){return s})),e.d(t,"e",(function(){return f})),e.d(t,"d",(function(){return l})),e.d(t,"b",(function(){return i.a})),e.d(t,"f",(function(){return u})),e.d(t,"a",(function(){return c.b}));var d=new r.c((function(){return Promise.all([e.e(253),e.e(647)]).then(e.bind(null,17375))})),s=new r.a(d,(function(n){return n.loadAllRecipientsForItem})),f=new r.a(d,(function(n){return n.loadItem})),l=new r.a(d,(function(n){return n.loadConversation}))},2142:function(n,t,e){"use strict";var r=e(1633),i=e(1634);function o(){var n=Object(r.G)();return n&&0==n.tableQuery.type&&Object(i.H)(n.tableQuery.folderId)}function a(){var n=Object(r.G)();return n&&0==n.tableQuery.type&&Object(i.H)(n.tableQuery.folderId)?n.tableQuery.folderId:null}var u=e(3),c=e(1768),d=e(1837),s=e(16),f=Object(u.createStore)("publicFolderUtilsStore",new s.ObservableMap),l=e(85);function b(n){if(!f().has(n)){var t=c.a.folderTable.get(n),e=null!=t.ReplicaList?t.ReplicaList[0]:Object(l.h)().SessionSettings.DefaultPublicFolderMailbox,r=Object(d.a)(e);v(n,r)}return f().get(n)}var v=Object(u.mutatorAction)("addPublicFolderMailboxInfoToStore",(function(n,t){f().set(n,t)}));e.d(t,"b",(function(){return a})),e.d(t,"c",(function(){return o})),e.d(t,"a",(function(){return b}))},2200:function(n,t,e){"use strict";var r=e(3);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(n,t){return{itemIdToRemove:n,removeItemSource:t}}))},2204:function(n,t,e){"use strict";e.d(t,"a",(function(){return c}));var r=e(0),i=e(1640),o=e(2200),a=e(2663),u=e(3);function c(n){var t,e,u,c;if(i.u.conversations.has(n)){var f=i.u.conversations.get(n);try{for(var l=Object(r.__values)(f.conversationNodeIds),b=l.next();!b.done;b=l.next()){var v=b.value,m=i.u.conversationNodes.get(v);if(m)try{for(var h=(u=void 0,Object(r.__values)(m.itemIds)),O=h.next();!O.done;O=h.next()){var p=O.value;Object(o.a)(p,1)}}catch(n){u={error:n}}finally{try{O&&!O.done&&(c=h.return)&&c.call(h)}finally{if(u)throw u.error}}d(v)}}catch(n){t={error:n}}finally{try{b&&!b.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}s(n)}Object(a.a)()}var d=Object(u.mutatorAction)("deleteConversationNode",(function(n){i.u.conversationNodes.delete(n)})),s=Object(u.mutatorAction)("deleteConversation",(function(n){i.u.conversations.delete(n)}))},2323:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(3068);function i(n,t){return n.map((function(n){return Object(r.getInstrumentationContext)(n,t)})).filter((function(n){return n}))}},2340:function(n,t,e){"use strict";var r;e.d(t,"a",(function(){return r})),function(n){n[n.NoOp=0]="NoOp",n[n.AlwaysHidden=1]="AlwaysHidden",n[n.CopyMailReadingPaneContainer=2]="CopyMailReadingPaneContainer",n[n.LoadConversationReadingPane=3]="LoadConversationReadingPane",n[n.LoadItemReadingPane=4]="LoadItemReadingPane"}(r||(r={}))},2387:function(n,t,e){"use strict";var r=null,i={register:function(n){r=n},available:function(){return!!r},run:function(n,t){r&&r(n,t)}};t.a=i},2462:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(3),i=Object(r.action)("loadItemAttachment",(function(n,t){return{itemAttachmentId:n,perfDatapoint:t}}))},2559:function(n,t,e){"use strict";e.d(t,"e",(function(){return d})),e.d(t,"f",(function(){return s})),e.d(t,"g",(function(){return f})),e.d(t,"h",(function(){return l})),e.d(t,"d",(function(){return b}));var r=e(44),i=e(1722);e.d(t,"a",(function(){return i.b}));var o=e(2387);e.d(t,"c",(function(){return o.a}));var a=e(2340);e.d(t,"b",(function(){return a.a}));var u=e(2462);e.d(t,"i",(function(){return u.a}));var c=new r.c((function(){return Promise.all([e.e(3),e.e(32),e.e(63),e.e(64),e.e(68),e.e(146),e.e(207),e.e(486)]).then(e.bind(null,4648))})),d=new r.a(c,(function(n){return n.previewAttachment})),s=new r.a(c,(function(n){return n.previewAttachmentInSxS})),f=new r.a(c,(function(n){return n.previewImageInSxS})),l=new r.a(c,(function(n){return n.previewLinkInSxS})),b=new r.a(c,(function(n){return n.initializeItemReadingPaneInSxS}))},2662:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(3),i=Object(r.action)("ON_SELECT_FOLDER_COMPLETE",(function(n,t,e,r,i,o,a){return{selectedFolderId:n,previousFolderId:t,isExitingSearch:e,selectedTableViewId:r,mailListItemSelectionSource:i,isInImmersiveView:o,actionSource:a}}))},2663:function(n,t,e){"use strict";e.d(t,"a",(function(){return i})),e.d(t,"b",(function(){return o}));var r=e(3),i=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),o=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},2720:function(n,t,e){var r=e(2765),i=e(107);"string"==typeof r&&(r=[[n.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(n.exports=r.locals)},2726:function(n,t,e){"use strict";var r=e(3183);t.a=function(n){var t=function(n){var t;return(null===(t=null==n?void 0:n.Attachments)||void 0===t?void 0:t.length)&&n.Attachments[0]}(n);return Object(r.a)(t)?t:null}},2765:function(n,t,e){(t=n.exports=e(106)(!1)).push([n.i,"._2HTFmaDIVHVbnIkwPM9srx{height:100%;-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;position:relative;z-index:0}._2HTFmaDIVHVbnIkwPM9srx,._3KAPMPOz8KsW24ooeUflK2{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}._3KAPMPOz8KsW24ooeUflK2{height:auto;min-height:0;-webkit-box-flex:1;-ms-flex:1;flex:1;-webkit-box-orient:horizontal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}",""]),t.locals={appContainer:"_2HTFmaDIVHVbnIkwPM9srx",main:"_3KAPMPOz8KsW24ooeUflK2"}},3183:function(n,t,e){"use strict";e.d(t,"a",(function(){return c}));var r=e(1797),i=function(n,t){return n.substring(0,t.length)===t},o=function(n,t){return n.substring(n.length-t.length)===t},a=function(n){return n.ContentType&&(i(n.ContentType,r.v)||i(n.ContentType,r.l))},u=function(n){return n.ContentType&&n.ContentType===r.j};function c(n){return(null==n?void 0:n.Name)&&o(n.Name,r.t)&&(a(n)||u(n))}},3255:function(n,t,e){"use strict";var r=e(44),i=e(1633),o=e(1716),a=e(1640),u=e(1673),c=e(1895);var d=e(1850),s=e(188);function f(n,t){if(t.folderId&&"junkemail"==Object(u.a)(t.folderId))return!1;if(Object(d.a)(n))return!1;var e=a.u.items.get(n.ItemId.Id);return!(null==e||!e.shouldShowAttachmentPreviews)||!(!n.HasAttachments&&!n.HasProcessedSharepointLink)&&(m.importAndExecute(Object(o.d)(t),n.ConversationId,n.ItemId.Id),!0)}var l=Object(s.select)({listViewStore:function(){return i.X}})((function(n,t,e){var r,i,a,d=1==t.type,s=n.ConversationId,f=e.listViewStore.conversationItems.get(s.Id),l=n.HasProcessedSharepointLink;if(t.folderId&&"junkemail"==Object(u.a)(t.folderId))return!1;if((null==(r=n)?void 0:r.ItemClasses)&&r.ItemClasses.length>0&&r.ItemClasses.some((function(n){return 0===n.indexOf(c.a)})))return!1;if(d){if(f)return f.shouldShowAttachmentPreviews;i=a=!!n.HasAttachments}else{if(!n.HasAttachmentPreviews&&!l)return!1;f&&!l?(i=f.globalItemIds.length!=n.GlobalItemIds.length,a=f.shouldShowAttachmentPreviews):(i=!0,a=!0)}return i&&m.importAndExecute(Object(o.d)(t),n.ConversationId,null),a}));e.d(t,"b",(function(){return v})),e.d(t,"a",(function(){return m})),e.d(t,"c",(function(){return h})),e.d(t,"d",(function(){return O})),e.d(t,"e",(function(){return l})),e.d(t,"f",(function(){return f}));var b=new r.c((function(){return e.e(481).then(e.bind(null,17328))})),v=new r.a(b,(function(n){return n.getPreviews})),m=new r.a(b,(function(n){return n.add})),h=new r.a(b,(function(n){return n.getAttachmentsForConversationWell})),O=new r.a(b,(function(n){return n.removeAttachmentPreviewsForRow}))},4373:function(n,t,e){"use strict";e.d(t,"b",(function(){return o}));var r=e(1850),i=e(2025);t.a=function(n){var t;return Object(r.a)(n)?(null===(t=n.Smime)||void 0===t?void 0:t.SmimeType)?n.Smime.SmimeType:Object(i.d)(n.ItemClass)?11:-1:0};var o=function(n){return n&&n.length?n.reduce((function(n,t){return Object(i.c)(t)?-1:0===n&&Object(i.d)(t)?11:n}),0):0}},5344:function(n,t,e){"use strict";var r=e(3),i=Object(r.action)("MOVE_READING_PANE_TO_TAB",(function(n,t,e,r,i,o,a){return{id:n,subject:t,categories:e,makeActive:r,instrumentationContext:i,listViewType:o,makeHidden:a}}));t.a=i},703:function(n,t,e){"use strict";var r=e(0),i=e(1),o=e(396),a=e(517),u=e(516),c=e(12),d=e(220),s=e(397),f=e(453),l=Object(d.c)((function(n,t){var e,r=Object(s.a)(n),i=Object(f.a)(n),o=n.palette,a={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:n.semanticColors.link},rootHovered:{color:o.themeDarkAlt,backgroundColor:o.neutralLighter,selectors:(e={},e[c.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},e)},rootHasMenu:{width:"auto"},rootPressed:{color:o.themeDark,backgroundColor:o.neutralLight},rootExpanded:{color:o.themeDark,backgroundColor:o.neutralLight},rootChecked:{color:o.themeDark,backgroundColor:o.neutralLight},rootCheckedHovered:{color:o.themeDark,backgroundColor:o.neutralQuaternaryAlt},rootDisabled:{color:o.neutralTertiaryAlt}};return Object(c.concatStyleSets)(r,a,i,t)}));e.d(t,"a",(function(){return b}));var b=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Object(r.__extends)(t,n),t.prototype.render=function(){var n=this.props,t=n.styles,e=n.theme;return i.createElement(o.a,Object(r.__assign)({},this.props,{variantClassName:"ms-Button--icon",styles:l(e,t),onRenderText:a.b,onRenderDescription:a.b}))},t=Object(r.__decorate)([Object(u.a)("IconButton",["theme","styles"],!0)],t)}(i.Component)},7115:function(n,t,e){"use strict";e.d(t,"a",(function(){return o})),e.d(t,"b",(function(){return a}));var r=e(2034),i=e(5107),o=function(){var n=Object(r.a)();return a(n)},a=function(n){if(!n||!n.isInitialLoadComplete)return"Loading";var t=0==n.rowKeys.length;return 0!=n.loadErrorStatus&&(t||Object(i.a)(n))?"Error":t?"Empty":"Loaded"}},8499:function(n,t,e){"use strict";var r=e(4304),i=e(5344),o=e(10279),a=e(1748),u=e(1780),c=e(10280),d=e(1686),s=e(1640),f=e(1720),l=e(188),b=e(2325),v=e(40);t.a=Object(l.action)("loadConversationReadingPaneForSingleMailItemSelected")(Object(l.select)({conversationReadingPaneState:function(){return Object(a.a)()},hasConversationInMailStore:function(n){return s.u.conversations.has(null==n?void 0:n.Id)}})((function(n,t,e,a,s,l,m){var h,O,p,g;if(null===(O=null===(h=null==e?void 0:e.dp)||void 0===h?void 0:h.addCheckpoint)||void 0===O||O.call(h,"LCRPFSMIS"),!n)return Promise.resolve();var S=Object(f.d)(),I=m.conversationReadingPaneState?Object(c.a)(S,m.conversationReadingPaneState.conversationId.Id,0):null;if(I&&6!==I.asyncSendState&&!t)return Promise.resolve();if((null===(p=m.conversationReadingPaneState)||void 0===p?void 0:p.conversationId.Id)==n.Id&&(null===(g=m.conversationReadingPaneState)||void 0===g?void 0:g.currentSelectedFolderId)==Object(d.b)()&&m.hasConversationInMailStore)return Object(b.b)(),Promise.resolve();if(I)if(S.type==f.a.SecondaryReadingPane||I.isInlineCompose){if(!Object(v.i)("rp-smartMoveToTab")){var j=6==I.asyncSendState;Object(i.a)(m.conversationReadingPaneState.conversationId,m.conversationReadingPaneState.conversationSubject,m.conversationReadingPaneState.conversationCategories,!1,e,0,j)}}else u.k.importAndExecute(I,!0,!1);return Object(o.a)(n),Object(r.b)(n,e,a,s,l)})))}}]);
//# sourceMappingURL=owa.MailBoot~ReadingPane~TabView.js.map
self.scriptsLoaded['owa.MailBoot~ReadingPane~TabView.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ReadingPane~TabView.js'] = (new Date()).getTime();