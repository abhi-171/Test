self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[264],{10232:function(e,t,n){"use strict";var r=n(0),i=n(7304),a=n(5938),o=n(5324),c=n(877),u=n(1706),s=n(7),l=n(7078),d=n(1780),b=n(1762),f=n(3533),v=n(5104),m=n(1766),O=n(1970),j=n(1640),p=n(6519),y=n(6520),I=n(957),g=n(188),k=n(12327),h=n(1633),S=n(1634),T=n(1644);function _(e,t,n,i,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=Object(h.C)(e,t.id),a(o)?[4,d.f.importAndExecute(b.a.viewStates.get(b.a.primaryComposeId))]:[3,2];case 1:r.sent(),r.label=2;case 2:return a(o)||(c=e.filter((function(e){return t.rowKeys.indexOf(e)>=0}))).length>0&&i(c,n),[2]}}))}))}t.a=Object(g.select)({originalTableView:function(e,t){return m.a.tableViews.get(t)},folderTable:function(){return S.d.folderTable},searchStore:function(){return Object(O.i)()}})((function(e,t,n,r,o,d,b,v){var m,O,g=v.originalTableView,k=g.tableQuery,D=k.folderId;if(Object(i.a)(D,null))return null;var x=Object(u.e)(k),V=1==k.type,R=V&&0===g.selectedRowKeys.size&&"Hover"!==b,F=Object(S.H)(D),M=Object(h.Q)(k)||Object(f.c)(k);if(x)m=!1;else if(V){var A=v.searchStore.staticSearchScope;m=("PrimaryMailbox"==A.kind||"ArchiveMailbox"==A.kind)&&Object(j.j)(A.folderId),O=Object(s.b)(l.a)}else if(!M&&!F){var J=v.folderTable.get(D);m=Object(j.j)(D)||Object(j.p)(J),O=Object(S.j)(J)}var Q=n||m||x||F,E=e.length,P=E>=y.b,U=Object(h.u)(g),q=C(E,d),B=N(d,M,R,Q,g,O),H=w(Q,P,M,R,U);return Object(c.b)(q,B,H,{delayCallbackAfterAnimation:!0}).then((function(t){if(t===c.a.ok){var n=e.filter((function(e){return g.rowKeys.indexOf(e)>=0}));if(Object(S.D)(D,"SharedMailbox")){var i=Object(I.a)(T.g),u=Object(h.C)(e,g.id);return Object(a.a)(u,Object(p.a)(i),!0).then((function(){n.length>0&&_(n,g,"HardDelete",r,o)}))}var s=M?"HardDelete":Q?"SoftDelete":"MoveToDeletedItems";if(n.length>0)return _(n,g,s,r,o)}return Promise.resolve()}))}));var C=function(e,t){return e>1?Object(s.c)(t.deleteNumberOfRowsTitle,e):t.deleteOneRowTitle},N=function(e,t,n,r,i,a){if(n)return r?Object(s.b)(k.b):Object(s.b)(k.a);var c=Object(h.P)(i)?o.e:o.f;return r||t?e.confirmDeleteRows:Object(s.c)(Object(s.b)(c),Object(v.a)(i.tableQuery.type,i,a))},w=function(e,t,n,r,i){return!(i||e||t||n||r)}},10233:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1633);function i(e,t){var n=[],i={};return e.forEach((function(e){var a=Object(r.h)(e,t);i[a.conversationId]||(i[a.conversationId]=!0,n.push(a))})),n}},10234:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(6521),i=n(197),a=n(10235),o=n(10236),c=n(374);function u(e){var t=function(e){return Object(a.a)({MessageAction:Object(o.a)({Action:"Restore"}),Ids:e.map((function(e){return Object(c.a)({Id:e})}))})}(e);return Object(r.a)({Header:Object(i.b)(),Body:t}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}},10235:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyMessageActionRequest:#Exchange"},e)}},10236:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"MessageAction:#Exchange"},e)}},12326:function(e){e.exports=JSON.parse('{"a":"I4b","c":"J4b","b":"K4b","d":"L4b"}')},12327:function(e){e.exports=JSON.parse('{"b":"G4b","a":"H4b"}')},12328:function(e){e.exports=JSON.parse('{"a":"E4b","b":"F4b"}')},12329:function(e){e.exports=JSON.parse('{"b":"h4b","a":"i4b"}')},12330:function(e){e.exports=JSON.parse('{"b":"Q4b","a":"R4b","c":"S4b","d":"T4b"}')},2095:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},2214:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(44),i=n(2095);n.d(t,"d",(function(){return i.a}));var a=new r.c((function(){return n.e(466).then(n.bind(null,4101))})),o=new r.a(a,(function(e){return e.onKeyboardUpDown})),c=new r.a(a,(function(e){return e.onOpenEmail})),u=new r.a(a,(function(e){return e.onKeyboardToggleSelect}))},2700:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(0),i=n(5),a=n(1673),o=n(34),c=n(1633);function u(e){var t=c.X.tableViews.get(e),n=null;t&&(n=0==t.tableQuery.type||2==t.tableQuery.type?Object(c.I)(t).sortColumn:null);return n}function s(e,t){var n,i,a=[];if(e)try{for(var o=Object(r.__values)(e),u=o.next();!u.done;u=o.next()){var s=u.value,l=c.b.getItemIds(s,t);l&&a.push.apply(a,Object(r.__spread)(l))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return a}function l(e,t){var n,i,a=[];if(e)try{for(var o=Object(r.__values)(e),u=o.next();!u.done;u=o.next()){var s=u.value;a.push(c.b.getConversationId(s,t))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return a}t.a={blockSendersFromTable:{name:"TnS_BlockSendersFromListView",customData:function(e,t,n,r){return[n,e.length,t.tableQuery.type]}},setConversationsFlagState:{name:function(e,t,n,r,i){var a;switch(r.FlagStatus){case"Flagged":a="TnS_FlagConversation";break;case"NotFlagged":a="TnS_UnflagConversation";break;case"Complete":a="TnS_CompleteFlagConversation";break;default:o.d("Cannot log invalid flag type")}return a},customData:function(e,t,n,r,i){var a=c.X.tableViews.get(n);return[Object(c.l)(a),Object(c.O)(a)]},cosmosOnlyData:function(e,t,n,i,a){return function(e,t){var n,i,a=[],o=[],u=c.X.tableViews.get(t);try{for(var s=Object(r.__values)(e),l=s.next();!l.done;l=s.next()){var d=l.value;a.push(c.b.getItemIds(d,u)[0]),o.push(c.b.getConversationId(d,u))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return JSON.stringify({itemIds:a,conversationIds:o})}(e,n)},actionSource:function(e,t,n,r,i){return i},options:{isCore:!0}},setItemsFlagState:{name:function(e,t,n,r,i){var a;switch(n.FlagStatus){case"Flagged":a="TnS_FlagItem";break;case"NotFlagged":a="TnS_UnflagItem";break;case"Complete":a="TnS_CompleteFlagItem";break;default:o.d("Cannot log invalid flag type")}return a},customData:function(e,t,n,r,i){var a=c.X.tableViews.get(r);return[Object(c.l)(a),Object(c.O)(a)]},cosmosOnlyData:function(e,t,n,r,i){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r,i){return i},options:{isCore:!0}},archiveMailListRows:{name:"TnS_Archive",customData:function(e,t,n){return[t.tableQuery.folderId?Object(a.a)(t.tableQuery.folderId):null,t.tableQuery.type,t.tableQuery.listViewType,e.length,Object(c.l)(t),Object(c.O)(t)]},cosmosOnlyData:function(e,t,n){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0},actionSource:function(e,t,n){return n}},markItemsJunkNotJunk:{name:function(e,t,n,r,i,a){var o="TnS_MarkAs";return o+=t?"Junk":"NotJunk"},customData:function(e,t,n,r,i,a){return[e.length,Object(c.l)(r),Object(c.O)(r)]},cosmosOnlyData:function(e,t,n,r,i,a){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r,i,a){return n}},markItemsAsPhishing:{name:"TnS_MarkAsPhishing",customData:function(e,t,n,r){return[e.length,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r){return n}},moveConversation:{name:function(e,t,n,r){var i="TnS_MoveConversation";return i+=r?"":"Background"},customData:function(e,t,n,r){return[n.tableQuery.type,n.tableQuery.folderId?Object(a.a)(n.tableQuery.folderId):null,Object(a.a)(t),e.length,Object(c.l)(n),Object(c.O)(n)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,n),conversationIds:l(e,n)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},moveItems:{name:function(e,t,n,r){var i="TnS_MoveItem";return i+=r?"":"Background"},customData:function(e,t,n,r){return[n.tableQuery.type,n.tableQuery.folderId?Object(a.a)(n.tableQuery.folderId):null,Object(a.a)(t),e.length,Object(c.l)(n),Object(c.O)(n)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:e})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},copyMailListRows:{name:"TnS_Copy",customData:function(e,t,n,r,i){return[t.tableQuery.type,t.tableQuery.folderId?Object(a.a)(r):null,Object(a.a)(n),e.length,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r,i){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},actionSource:function(e,t,n,r,i){return i}},restoreConversation:{name:"TnS_RestoreConversation"},restoreItems:{name:"TnS_RestoreItem"},unsubscribe:{name:"TnS_Unsubscribe",customData:function(e,t,n,r){return[r,n,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemId:e.ItemId.Id})}},pinConversations:{name:function(e,t,n,r){var i="TnS_";return i+=n?"PinConversation":"UnpinConversation"},customData:function(e,t,n,r){return[e.length,Object(c.l)(t),Object(c.O)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},actionSource:function(e,t,n,r){return r},options:{isCore:!0}},pinItems:{name:function(e,t,n,r){var i="TnS_";return i+=n?"PinItem":"UnpinItem"},customData:function(e,t,n,r){return[e.length,Object(c.l)(t),Object(c.O)(t)]},cosmosOnlyData:function(e,t,n,r){var i=s(e,t);return JSON.stringify({itemIds:i})},actionSource:function(e,t,n,r){return r},options:{isCore:!0}},moveConversationToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_MoveConversationToFocused":"TnS_MoveConversationToOther"},customData:function(e,t,n,r){return[e.length,Object(c.l)(c.X.tableViews.get(t))]},cosmosOnlyData:function(e,t,n,r){var i=c.X.tableViews.get(t);return JSON.stringify({itemIds:s(e,i),conversationIds:l(e,i)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},moveItemToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_MoveItemToFocused":"TnS_MoveItemToOther"},customData:function(e,t,n,r){return[e.length,Object(c.l)(c.X.tableViews.get(t))]},cosmosOnlyData:function(e,t,n,r){var i=c.X.tableViews.get(t);return JSON.stringify({itemIds:s(e,i)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},alwaysMoveRowToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_AlwaysMoveToFocused":"TnS_AlwaysMoveToOther"},customData:function(e,t,n,r){return[e.length,Object(c.l)(t),t.tableQuery.listViewType]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},addCategories:{name:"TnS_AddCategory",customData:function(e,t,n,r){return[r,e.length,t.tableQuery.listViewType,Object(c.l)(t),Object(c.O)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},removeCategories:{name:"TnS_RemoveCategory",customData:function(e,t,n,r){return[r,e.length,t.tableQuery.listViewType,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},clearCategories:{name:"TnS_ClearCategory",customData:function(e,t,n){return[n,e.length,t.tableQuery.listViewType,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},scheduleItems:{name:"TnS_ScheduleItem",customData:function(e,t,n,r){return[e.length,t.tableQuery.listViewType,Object(c.l)(t),r?Object(i.tb)(r):null]},options:{isCore:!0},actionSource:function(e,t,n){return n}}}},3129:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemJsonRequest:#Exchange"},e)}},3164:function(e,t,n){"use strict";var r=n(1969);function i(e,t,n){n&&r.a.removeRowsFromTombstone(e,t)}var a=n(3571);function o(e){e&&Object(a.a)(e)}var c=n(1691),u=n(134);function s(e,t,n,r,a,s){var l=Object(u.t)();return e.then((function(e){return l&&l.addCheckpoint("PAPCARM"),i(t,n,a),s?void 0:Object(c.a)(e)})).catch((function(e){return i(t,n,a),o(r),Promise.reject(e)}))}var l=n(0);function d(e,t,n,r,a){return e.then((function(e){if(i(t,n,a),e.ResponseMessages){var c=function(e,t){var n,r;try{for(var i=Object(l.__values)(e),a=i.next();!a.done;a=i.next()){var c=a.value;if(c&&"Success"!=c.ResponseClass){o(t);var u=new Error("ResponseCode="+c.ResponseCode+", Stacktrace="+c.StackTrace);return u.fetchErrorType="ServerFailure",u}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return null}(e.ResponseMessages.Items,r);return c?Promise.reject(c):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))})).catch((function(e){return i(t,n,a),o(r),Promise.reject(e)}))}n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}))},3215:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemRequest:#Exchange"},e)}},3216:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28),i=n(3129);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("DeleteItem",e,t)}},3496:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(3215),i=n(374),a=n(3216),o=n(197);function c(e,t){return Object(r.a)({ItemIds:e.map((function(e){return t=e,Object(i.a)({Id:t.Id,ChangeKey:t.ChangeKey});var t})),DeleteType:t,SuppressReadReceipts:!0,ReturnMovedItemIds:!0,SendMeetingCancellations:"SendToNone",AffectedTaskOccurrences:"AllOccurrences"})}function u(e,t,n){var r=c(e,t);return Object(a.a)({Header:Object(o.b)(),Body:r},n).then((function(e){return e.Body.ResponseMessages.Items}))}},3812:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1633),i=n(1640);function a(e){return e.map((function(e){var t,n=i.u.items.get(e);return t=!Object(r.V)(n)||n.IsRead,{itemId:e,itemConversationId:n.ConversationId,isRead:t,mailboxInfo:n.MailboxInfo}}))}},4214:function(e){e.exports=JSON.parse('{"a":"aEa"}')},4901:function(e,t,n){"use strict";function r(e){return e?new Date(e).toISOString():null}n.d(t,"a",(function(){return r}))},5324:function(e){e.exports=JSON.parse('{"f":"j4b","d":"k4b","j":"l4b","c":"m4b","h":"n4b","e":"o4b","a":"p4b","i":"q4b","b":"r4b","g":"s4b","k":"t4b","p":"u4b","o":"v4b","m":"w4b","l":"y4b","n":"z4b"}')},5738:function(e,t,n){"use strict";n.d(t,"c",(function(){return Q})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return P}));var r=n(0),i=n(12330),a=n(5324),o=n(2767),c=n(7),u=n(1930),s=n(1762),l=n(5938),d=n(3812),b=n(2700),f=n(3496),v=n(1938),m=n(10232),O=n(957),j=n(6519),p=n(7304),y=n(1766),I=n(10234),g=n(8440),k=n(1640),h=n(877),S=n(1716),T=n(1633),_=n(1638),C=(n(1829),n(134)),N=n(2214),w=n(1634),D=n(1644),x=n(7306),V=n(3164),R=n(1691),F=n(52),M=n(3),A=n(347);function J(e){var t=s.a.primaryComposeId&&s.a.viewStates.get(s.a.primaryComposeId).itemId;return t&&e.indexOf(t.Id)>=0}var Q=Object(M.action)("deleteItemsWithoutConfirmDialog",(function(e,t,n,r,i,a,o){return Object(F.c)({name:"TnS_DeleteItem",options:{timeout:7e4},customData:[e.length,t],cosmosOnlyData:JSON.stringify({itemIds:e}),actionSource:r},{itemIds:e,disposalType:t,parentFolderId:n,actionSource:r,instrumentationContexts:i,requestInitOptions:a,allowUndoAction:o})}));function E(e,t,n,r,a,o){var s=Object(_.b)().items.get(e[0]).ParentFolderId.Id;if(Object(p.a)(s,null))return Promise.resolve();var d=Object(w.D)(s,"SharedMailbox"),b=Object(A.a)(a)||null,f=a&&"GroupMailbox"==a.type,v=Object(k.j)(s),m="SoftDelete"==t&&v||f||Object(w.H)(s);return Object(h.b)(f?Object(c.b)(i.b):"",f?Object(c.b)(i.a):Object(c.b)(i.c),!m,{delayCallbackAfterAnimation:!0}).then((function(i){var o=Object(u.c)(s,a)&&"MoveToDeletedItems"===t;if(i==h.a.ok){if(d){var c=Object(O.a)(D.g);return Object(l.a)(e,Object(j.a)(c),!0).then((function(){return Q(e,"HardDelete",s,r,n,b,o)}))}return Q(e,t,s,r,n,b,o)}return Promise.resolve()}))}function P(e,t,n,r,s){var l=y.a.tableViews.get(t),d={deleteNumberOfRowsTitle:Object(c.b)(a.m),deleteOneRowTitle:Object(c.b)(o.a),confirmDeleteRows:Object(c.b)(i.d)},f=y.a.tableViews.get(t);return Object(C.r)("TnS_DeleteItemsFromTable",[s,e.length,Object(b.b)(t),Object(T.u)(f)]),Object(m.a)(e,t,n,(function(e,n){var i=Object(T.C)(e,t);return Q(i,n,l.tableQuery.folderId,s,r,Object(A.a)(Object(S.b)(l)),Object(u.c)(l.tableQuery.folderId,Object(S.b)(l))&&"MoveToDeletedItems"==n)}),J,d,s)}Object(M.orchestrator)(Q,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,a,o,c,s,l,b,m,O,j,p,y;return Object(r.__generator)(this,(function(k){switch(k.label){case 0:return t=e.itemIds,n=e.disposalType,i=e.parentFolderId,a=e.actionSource,o=e.instrumentationContexts,c=e.requestInitOptions,s=e.allowUndoAction,l=Object(T.G)(),b=null,m=[],l&&(m=Object(T.E)(t,l),b=l.serverFolderId,Object(x.a)(l.tableQuery,!0)&&(O=Object(d.a)(t),Object(v.a)(O,i,"Delete"))),j=Object(C.t)(),[4,u.b()];case 1:return k.sent(),p=t.map((function(e){return{Id:e}})),(c=c||{}).timeoutMS=6e4,y=Object(f.a)(p,n,c),u.a((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,i,a,o,c,u;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return[4,y];case 1:if(e=l.sent(),s){t=[];try{for(n=Object(r.__values)(e),i=n.next();!i.done;i=n.next())a=i.value,"Success"==(o=a).ResponseClass&&t.push(o.MovedItemId.Id)}catch(e){c={error:e}}finally{try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}}if(t.length>0)return[2,Object(I.a)(t)]}return[2,Promise.resolve()]}}))}))}),b),a&&Object(g.a)(t.length,s),Object(N.d)("Delete",o,{itemIds:t}),j.markUserPerceivedTime(),[2,y.then((function(e){return j.addCheckpoint("di_then"),Object(V.a)(m,i,!!l),Object(R.a)(e)})).catch((function(e){return j.addCheckpoint("di_catch"),"ErrorItemNotFound"==e.responseCode&&(e.fetchErrorType="Expected"),Object(V.a)(m,i,!!l),Object(V.b)(l),Promise.reject(e)}))]}}))}))}))},5938:function(e,t,n){"use strict";var r=n(7305),i=n(0);var a=n(28);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"CopyItemJsonRequest:#Exchange"},n)),Object(a.a)("CopyItem",e,t)}var c=n(197);function u(e,t,n,a){var u=function(e,t,n){return a={ToFolderId:t,ItemIds:Object(r.a)(e),ReturnNewItemIds:!0,RemoteExecute:n},Object(i.__assign)({__type:"CopyItemRequest:#Exchange"},a);var a}(e,t,n);return o({Header:Object(c.b)(),Body:u},a).then((function(e){return e.Body}))}n.d(t,"a",(function(){return u}))},6518:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(9711),i=n(5738),a=n(1766),o=n(2323);function c(e,t,n,c){var u=a.a.tableViews.get(t),s=Object(o.a)(e,u);switch(u.tableQuery.listViewType){case 0:Object(r.a)(e,t,n,s,c);break;case 1:Object(i.b)(e,t,n,s,c)}}},6519:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(559),i=n(793);function a(e){return e?Object(i.a)({BaseFolderId:Object(r.a)({Id:e})}):null}},6520:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=1e4,i=25},6521:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28),i=n(6522);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("ApplyMessageAction",e,t)}},6522:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyMessageActionJsonRequest:#Exchange"},e)}},7304:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12326),i=n(7),a=n(877),o=n(1634),c=n(25);function u(e,t){if(!Object(c.a)().SessionSettings.IsShadowMailbox)return!1;var n,u=o.d.folderTable.get(e),s=o.d.folderTable.get(t),l=u.sourceWellKnownFolderType;if(87==l)n=Object(i.b)(r.a);else if(88==l)n=Object(i.b)(r.c);else if(null!=s){var d=s.sourceWellKnownFolderType;87==d?n=Object(i.b)(r.b):88==d&&(n=Object(i.b)(r.d))}return null!=n&&(Object(a.b)("",n,!1,{hideCancelButton:!0}),!0)}},7305:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(374);function i(e){return e.map((function(e){return Object(r.a)({Id:e})}))}},7306:function(e,t,n){"use strict";function r(e,t){switch(0==e.type?e.scenarioType:""){case"persona":case"privatedistributionlist":return!1;case"category":return t;default:return!0}}n.d(t,"a",(function(){return r}))},7767:function(e,t,n){"use strict";var r=n(0),i=n(2700),a=n(52),o=n(2059),c=n(1633),u=n(1766),s=n(5610),l=n(3164),d=n(380),b=n(4901),f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoDeleteConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoDeleteConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};n.d(t,"b",(function(){return v}));t.a=Object(a.d)("RestoreConversation",i.a.restoreConversation)((function(e,t){var n=Object(u.b)().tableViews.get(t),r=Object(s.a)(e,t,(function(e){return!!e})),i=Object(c.C)(r,t),a=r.map((function(e){return Object(c.h)(e,t)}));Object(o.a)(i,n,"Restore");var d=n.tableQuery.folderId,b=v.invokeUndoDeleteMutation(a,d);return Object(l.c)(b,r,n.serverFolderId,n,!1,!0)}));var v={invokeUndoDeleteMutation:function(e,t,n){var i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(b.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(d.a)()];case 1:return[4,r.sent().mutate({variables:{conversations:a,folderId:t,undoRequestId:n},mutation:f})];case 2:return o=r.sent(),[2,null===(i=null==o?void 0:o.data)||void 0===i?void 0:i.undoDeleteConversation]}}))}))}}},8440:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(7),i=n(4214),a=n(1844),o=n(1930),c=n(880),u=n(25),s=n(12328);function l(e,t){if(Object(u.a)().UserOptions.ShowNotificationBar){var n=1===e?Object(r.b)(s.a):Object(r.c)(Object(r.b)(s.b),e),l=Object(a.h)();c.e.importAndExecute("deleteNotification","MailModuleNotificationBarHost",n,{icon:"Delete",primaryActionText:t?Object(r.b)(i.a):null,allowClear:!0,minWidth:l.minWidth,maxWidth:l.maxWidth,notificationCallback:function(e){e===c.a.PrimaryActionClicked&&o.e.importAndExecute("NotificationBar")}})}}},9711:function(e,t,n){"use strict";var r=n(0),i=n(2700),a=n(10232),o=n(10233),c=n(7306),u=n(8440),s=n(7767),l=n(5324),d=n(134),b=n(52),f=n(380),v=n(1706),m=n(7),O=n(2767),j=n(2214),p=n(2059),y=n(1762),I=n(1766),g=n(1716),k=n(3164),h=n(4901),S=n(1930),T=n(957),_=n(3),C=n(1633),N=n(12329),w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposalType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposalType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"disposalType"},value:{kind:"Variable",name:{kind:"Name",value:"disposalType"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"undoRequestId"},arguments:[],directives:[]}]}}]}}]};n.d(t,"b",(function(){return D})),n.d(t,"a",(function(){return x})),n.d(t,"c",(function(){return R}));var D=Object(_.action)("deleteConversationsWithoutConfirmDialog",(function(e,t,n,r,a){var o=I.a.tableViews.get(t);return Object(b.c)({name:"TnS_DeleteConversation",options:{timeout:7e4},customData:[a,e.length,n,Object(i.b)(t),Object(C.l)(o),Object(C.O)(o),Object(C.u)(o)],cosmosOnlyData:JSON.stringify({conversationIds:e.map((function(e){return e.conversationId}))}),actionSource:a},{conversationActionContexts:e,originalTableViewId:t,disposalType:n,instrumentationContexts:r})}));Object(_.orchestrator)(D,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,a,o,l,b,f,v,m,O,y,h,_;return Object(r.__generator)(this,(function(N){switch(N.label){case 0:return t=e.conversationActionContexts,n=e.originalTableViewId,i=e.disposalType,a=e.instrumentationContexts,o=t.map((function(e){return e.conversationId})),l=Object(I.b)().tableViews.get(n),Object(c.a)(l.tableQuery,!0)&&Object(p.a)(o,l,"Delete"),b=Object(d.t)(),[4,S.b()];case 1:return N.sent(),f=Object(T.a)("deleteditems"),v=Object(C.E)(o,l),m=Object(g.b)(l),O=Object(C.k)(l,!0),y=Object(S.c)(l.tableQuery.folderId,m)&&"MoveToDeletedItems"===i,h={timeoutMS:6e4},_=R.invokeDeleteConversationMutation(t,O,i,m,h),y&&S.a((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,_];case 1:return(e=n.sent()).success?[4,s.b.invokeUndoDeleteMutation(t,f,e.undoRequestId)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2,Promise.resolve()]}}))}))}),l.serverFolderId,_),Object(u.a)(t.length,y),Object(j.d)("Delete",a,{conversationIds:o}),b.markUserPerceivedTime(),[2,Object(k.c)(_,v,l.serverFolderId,l,!0,!0)]}}))}))}));function x(e,t,n,r,i){var c=I.a.tableViews.get(t),u=Object(v.e)(c.tableQuery),s={deleteNumberOfRowsTitle:Object(m.b)(l.k),deleteOneRowTitle:Object(m.b)(O.a),confirmDeleteRows:u?Object(m.b)(N.b):Object(m.b)(N.a)};return Object(a.a)(e,t,n,(function(e,n){var a=Object(o.a)(e,t);D(a,t,n,r,i)}),V,s,i)}function V(e){var t=y.a.primaryComposeId&&y.a.viewStates.get(y.a.primaryComposeId).conversationId;return t&&e.indexOf(t)>=0}var R={invokeDeleteConversationMutation:function(e,t,n,i,a){var o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(h.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(f.a)()];case 1:return[4,r.sent().mutate({variables:{conversations:c,disposalType:n,folderId:t,mailboxInfo:i},context:{requestOptions:a},mutation:w})];case 2:return u=r.sent(),[2,null===(o=null==u?void 0:u.data)||void 0===o?void 0:o.deleteConversation]}}))}))}}}}]);
//# sourceMappingURL=owa.MailBoot~OwaMailPlaywright~TriageAction.js.map
self.scriptsLoaded['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = (new Date()).getTime();