self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupAddMemberV2~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[128],{2162:function(e,t,n){"use strict";var r;!function(e){e[e.Email=0]="Email",e[e.Files=1]="Files",e[e.Calendar=2]="Calendar",e[e.Members=3]="Members"}(r||(r={})),t.a=r},2225:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("REMOVE_ROWS_FROM_LISTVIEW_STORE",(function(e,t,n,r){return void 0===r&&(r=!0),{rowKeys:e,tableView:t,actionType:n,shouldRemoveFromAllTables:r}}))},2290:function(e,t,n){"use strict";var r=n(0),i=n(1740),a=n(2591),o=n(2594),c=n(1706),u=n(2438),d=n(2162),l=n(3890),s=n(3167),b=n(134),f=n(2592),v=n(2759),m=n(3376),O=n(1633);function y(e,t,n){e.currentLoadedIndex=Math.min(i.b,e.rowKeys.length),Object(f.a)(e);var r=0==e.tableQuery.type;Object(m.b)(e);var a=e.tableQuery.scenarioType;if(r){var o=Object(b.t)((function(e){return"SwitchMailFolder"==e.eventName}));o&&(o.addCustomProperty("isCached",e.isInitialLoadComplete),o.addCustomProperty("scenario",a))}if(r&&e.isInitialLoadComplete&&Object(O.T)(e.tableQuery.folderId))return Promise.resolve();var c="spotlight"===a?v.j.importAndExecute(e,t,n):Object(s.a)(e,!1,t);return e.isInitialLoadComplete?Promise.resolve():c}var p=n(1859);var j=n(2479),w=n(2034),k=n(3381),h=n(188),I=n(2121),g=n(1969);var N=n(1777),T=n(1640);t.a=Object(h.action)("loadTableViewFromTableQuery")(Object(h.select)({listViewStore:function(){return O.X}})((function(e,t,n,s){var f=Object(w.a)(),v=Object(i.c)(e);e=v.tableQuery,s.listViewStore.selectedTableViewId=v.id;var m,O=[];switch(f&&(O=Object(r.__spread)(f.selectedRowKeys.keys()),function(e,t){k.a.clear(),Object(N.j)(e,T.b.Reset)}(f)),e.type){case 1:m=o.d.importAndExecute(v,a.a,j.a,n,t);break;case 2:m=function(e,t,n){var r=Object(b.t)((function(e){return e.eventName==p.j||e.eventName==p.k})),i=u.a.navigationButtonSelected;if(r){r.addCustomProperty("GroupModule",d.a[i]);var a=Object(c.b)(e.tableQuery);if(Object(l.d)(a)){var o=Object(l.a)();r.addCustomProperty("TimeSinceWarmUp",Date.now()-o)}}var s=Promise.resolve();return i===d.a.Email&&(s=y(e,t,n)),s}(v,a.a,n);break;case 0:m=y(v,a.a,n);break;default:throw new Error("Only Folder, Group or Search Table types are supported in Table Loading")}return f&&function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 0===t.tableQuery.type&&g.a.clearMapForFolder(t.serverFolderId),[4,I.e.import()];case 1:return r.sent()(e,t,n),1===t.tableQuery.type&&t.id!==n.id&&(i=Object(b.t)(),Object(o.a)(t,i)),[2]}}))}))}(O,f,v),m})))},2438:function(e,t,n){"use strict";var r=n(3),i=n(2162);t.a=Object(r.createStore)("commandBarStore",{navigationButtonSelected:i.a.Email,hidden:!1})()},2479:function(e,t,n){"use strict";var r=n(1740),i=n(1791),a=n(1633),o=n(188);t.a=Object(o.action)("onLoadInitialRowsSucceeded")((function(e,t,n,o,c){2==e.tableQuery.type&&c&&(e.serverFolderId=c.Id),o&&(e.serverFolderId=o.Id);var u=Object(a.e)(e);Object(i.h)(t,e,n,u,e.isInitialLoadComplete,"MergeOnInitialRowsFetch"),e.currentLoadedIndex=Math.min(r.b,e.rowKeys.length)}))},2509:function(e,t,n){"use strict";var r=n(7),i=n(3),a=Object(i.createStore)("focusedInboxRollupStore",{uniqueSenders:null,unseenCountToDisplay:null,viewType:0})(),o=n(1633),c=n(559),u=n(793),d=n(25),l=n(34),s=n(188),b=n(28),f=n(0);function v(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(f.__assign)({__type:"GetFolderChangeDigestRequest:#Exchange"},n)),Object(b.a)("GetFolderChangeDigest",e,t)}var m=10;var O=99,y=Object(s.action)("getFolderChangeDigestAction")((function(e){var t=0==e.focusedViewFilter,n=t?1:2,i=t?Object(d.a)().ViewStateConfiguration.FocusedViewWatermark:Object(d.a)().ViewStateConfiguration.ClutterViewWatermark;a.viewType=n,function(e,t,n,r){return v({Folders:[{FolderId:e,IsConversationView:r,ViewType:t,Watermark:n}],MaxSendersCount:m}).then((function(e){return e}))}(Object(u.a)({BaseFolderId:Object(c.a)({Id:e.folderId})}),n,i,0==Object(o.A)(e.folderId)).then((function(e){return function(e){if(null==e.Folders||0==e.Folders.length)return void l.g.info("GetFolderChangeDigestResponse.Folders is null or empty");var t=e.Folders[0],n=t.RecentUniqueSenders||[];a.uniqueSenders=n.join("; ").toString(),a.unseenCountToDisplay=function(e){if(0===e)return null;if(e>O)return Object(r.c)("{0}+",O);return e.toString()}(t.UnseenCount)}(e)}))}));var p=n(3925);function j(e,t){var n,i=Object(o.A)(t);switch(e){case 1:n=0==i?Object(r.b)(p.a):Object(r.b)(p.b);break;case 2:n=0==i?Object(r.b)(p.c):Object(r.b)(p.d)}return n}var w=n(426),k=n(52),h=Object(i.action)("updateWatermarkAndResetRollup",(function(e,t){return Object(k.c)({name:"TnS_ResetFocusedOtherRollup",customData:[t,e]},{focusedViewFilter:e})}));Object(i.orchestrator)(h,(function(e){var t=e.focusedViewFilter,n=new Date(Date.now()).toUTCString();0==t?Object(w.a)((function(e){e.ViewStateConfiguration.FocusedViewWatermark=n}),[{key:"FocusedViewWatermark",valuetype:"String",value:[n]}],"OWA.ViewStateConfiguration"):1==t&&Object(w.a)((function(e){e.ViewStateConfiguration.ClutterViewWatermark=n}),[{key:"ClutterViewWatermark",valuetype:"String",value:[n]}],"OWA.ViewStateConfiguration")})),Object(i.mutator)(h,(function(){a.uniqueSenders=null,a.unseenCountToDisplay=null,a.viewType=0}));var I=h;n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return I})),n.d(t,"a",(function(){return a}))},2591:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(2592),i=n(1633),a=n(1740),o=n(2593),c=n(188);t.a=Object(c.action)("onInitialTableLoadComplete")((function(e,t,n,c){if(e.isLoading=!1,e.isInitialLoadComplete=!0,!c)if(t){e.loadErrorStatus=0;var d=e.selectedRowKeys.size>0;0!=e.tableQuery.type&&2!=e.tableQuery.type||(d||e!=Object(i.G)()||Object(r.a)(e),o.b.importAndExecute(e,10)),Object(a.d)(e)}else u(e,n)}));var u=Object(c.action)("setTableViewErrorState")((function(e,t){switch(t){case"ErrorAccessDenied":e.loadErrorStatus=1;break;case"UnexpectedClientError":e.loadErrorStatus=2;break;default:e.loadErrorStatus=3}}))},2592:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("INIT_TABLE_SELECTION_ON_LOAD",(function(e){return{tableView:e}}))},2593:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(44),i=new r.c((function(){return n.e(840).then(n.bind(null,5933))})),a=new r.a(i,(function(e){return e.prefetchRowInCache})),o=new r.a(i,(function(e){return e.prefetchSingleRow})),c=new r.a(i,(function(e){return e.prefetchFirstN})),u=new r.a(i,(function(e){return e.prefetchAdjacentRowsOnDelay}))},2594:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(20),n.e(41),n.e(44),n.e(58),n.e(726)]).then(n.bind(null,5908))})),a=new r.a(i,(function(e){return e.loadSearchTable})),o=new r.a(i,(function(e){return e.cleanSearchTableState})).importAndExecute,c=new r.b(i,(function(e){return e.loadMoreFindItemSearch})),u=new r.b(i,(function(e){return e.loadMoreSubstrateSearch}))},2711:function(e,t,n){"use strict";var r=n(0),i=n(2838),a=n(5),o=n(2225),c=n(3275),u=n(2509),d=n(1633),l=n(188),s=Object(l.action)("updateRollupOnAddOrUpdateRowNotification")((function(e){var t=Object(d.G)();if(null!=t){var n=Object(d.l)(e),r=Object(d.l)(t);(0==n&&1==r||1==n&&0==r)&&Object(u.b)(e.tableQuery)}})),b=n(1791),f=n(2428),v=n(2593),m=n(3404);var O=Object(l.action)("rowNotificationHandler.onAddOrUpdateRow")((function(e,t){var n=e.InstanceKey;if(!n)throw new Error("onAddOrUpdateNotification: Row instanceKey should not be null");if(Object(b.k)(e,t)){var r=Object(b.e)(e,t.tableQuery.listViewType),u=r.lastDeliveryOrRenewTimeStamp,l=r.lastDeliveryTimeStamp,O=Object(m.b)(u,l,t,0,n),y=Object(i.a)(n,t),p=y>=0;-1!=O?Object(d.T)(t.tableQuery.folderId)&&Object(a.Eb)(Object(a.lc)(l),d.X.inboxPausedDateTime)||(p?(y<O&&O--,function(e,t,n){Object(b.g)(e,t)?(f.a.updateRowData(e,t),Object(d.Z)(t,4)):(f.a.updateRow(n,e,t,"RowUpdateNotification"),Object(d.Z)(t,2)),Object(c.a)(e.InstanceKey,t)}(e,t,O)):function(e,t,n){f.a.addRow(n,e,t,"RowAddNotification"),Object(d.Z)(t,1),t.currentLoadedIndex++}(e,t,O),v.d.importAndExecute(n,t,!0),-1!=Object(d.l)(t)&&s(t),Object(b.d)(t)):p&&Object(o.a)([n],t,"UpdateNotification")}})),y=n(3260),p=n(3),j=Object(p.action)("TRY_REMOVE_ITEM_NORMALIZED_BODY",(function(e){return{item:e}})),w=n(1969),k=n(1640),h=n(1736),I=n(2023),g=n(1766),N=n(34),T=Object(l.select)({tableView:function(e){return g.a.tableViews.get(e.id)}})(Object(l.action)("handleRowNotification")((function(e,t){var n,r=t.tableView;if(r)if(r.isInitialLoadComplete)switch(e.EventType){case"RowAdded":n=S(e,r),V(n,r);break;case"RowModified":n=S(e,r),C(n,r);break;case"RowDeleted":n=S(e,r),F(n,r);break;case"QueryResultChanged":case"Reload":R(r);break;default:return}else N.g.info("Ignore row notifications as table has not loaded");else N.g.info("Received row notification for a deleted folder")})));function S(e,t){switch(t.tableQuery.listViewType){case 0:return e.Conversation?e.Conversation:(N.d("Conversation should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);case 1:return e.Item?e.Item:(N.d("Item should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);default:return N.d("rowNotificationStrategy: unsupported listViewType: "+t.tableQuery.listViewType),null}}var V=Object(l.action)("rowNotificationHandler.onAddRow")((function(e,t){Object(d.T)(t.tableQuery.folderId)||t.totalRowsInView++,O(e,t)})),C=Object(l.action)("rowNotificationHandler.onUpdateRow")((function(e,t){O(e,t)})),F=Object(l.action)("rowNotificationHandler.onDeleteRow")((function(e,t){var n=e.InstanceKey;if(!n)throw new Error("onDeleteNotification: Row instanceKey should not be null");(t.totalRowsInView--,Object(b.j)(e,t))&&(Object(i.a)(n,t)>=0&&(Object(o.a)([n],t,"DeleteNotification"),Object(d.Z)(t,3)))})),R=Object(l.select)({conversations:function(){return h.a},items:function(){return k.u.items}})(Object(l.action)("rowNotificationHandler.onReload")((function(e,t){!function(e,t){var n,i;switch(e.tableQuery.listViewType){case 0:t.conversations.clear();for(var a=t.conversations.getItemIds(),o=0,c=a.length;o<c;o++){var u=a[o];if(t.conversations.has(u)){var l=t.conversations.get(u);v.c.importAndExecute(l.conversationId,e)}}break;case 1:try{for(var s=Object(r.__values)(e.rowKeys),b=s.next();!b.done;b=s.next()){var f=b.value,m=d.b.getRowClientItemId(f,e),O=t.items.get(m.Id);j(O),t.items.get(m.Id).NormalizedBody&&v.c.importAndExecute(m,e)}}catch(e){n={error:e}}finally{try{b&&!b.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}}(e,t),Object(y.a)(e),w.a.clearMapForFolder(e.serverFolderId)})));Object(p.mutator)(j,(function(e){var t=e.item;Object(I.d)(t.ConversationId.Id,0)||Object(I.e)(t.ItemId.Id,0)||(t.NormalizedBody=void 0)}));var E=n(1634),D=n(3272),_=n(785),x=n(2001);var A=n(2535),Q=n(706),L=n(4725),P={kind:"Document",definitions:Object(r.__spread)([{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"subscribeToRowNotifications"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listViewType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ReactListViewType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TableQueryType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sortBy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SortByInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shapeName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subscribeToRowNotifications"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"subscriptionId"},value:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}}},{kind:"ObjectField",name:{kind:"Name",value:"listViewType"},value:{kind:"Variable",name:{kind:"Name",value:"listViewType"}}},{kind:"ObjectField",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"ObjectField",name:{kind:"Name",value:"categoryName"},value:{kind:"Variable",name:{kind:"Name",value:"categoryName"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"commonRowsOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"sortBy"},value:{kind:"Variable",name:{kind:"Name",value:"sortBy"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"shape"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ShapeName"},value:{kind:"Variable",name:{kind:"Name",value:"shapeName"}}},{kind:"ObjectField",name:{kind:"Name",value:"IsScheduledFolder"},value:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotificationPayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"EventType"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationChangePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ConversationTypeFragment"},directives:[]}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationDeletePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"InstanceKey"},arguments:[],directives:[]}]}}]}}]}}]}}],L.a.definitions)},U=n(380),K=n(1716),B=n(1673);var M=n(40),G={};function W(e){var t=G[e];if(t){var n=Object(d.J)().tableViews.get(e);Object(M.i)("mon-conv-useGqlForConvSubscription")&&n&&0==n.tableQuery.listViewType?function(e){e.unsubscribe()}(t):Q.g.importAndExecute(t,T),delete G[e]}}function q(e){if(!G[e.id]){if(0!=e.tableQuery.type&&2!=e.tableQuery.type)throw new Error("subscribeToRowNotifications should only be called for Folder or Group table type");var t=e.tableQuery;1!=t.sortBy.sortColumn||Object(k.m)(e.tableQuery.folderId)||Object(E.D)(e.tableQuery.folderId,"SharedMailbox")||"spotlight"!==t.scenarioType&&(Object(M.i)("mon-conv-useGqlForConvSubscription")&&0==t.listViewType?function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.tableQuery,[4,Object(U.a)()];case 1:return n=r.sent(),i=n.subscribe({query:P,variables:{subscriptionId:e.id,folderId:e.tableQuery.folderId,listViewType:Object(d.q)(t.listViewType),type:Object(d.s)(e.tableQuery.type),categoryName:t.categoryName,focusedViewFilter:Object(d.p)(t.focusedViewFilter),viewFilter:Object(d.t)(t.viewFilter),sortBy:{sortColumn:Object(d.r)(t.sortBy.sortColumn),sortDirection:t.sortBy.sortDirection,canSortByRenewTime:Object(b.l)(t)},shapeName:D.c(e.tableQuery.folderId,Object(d.R)(t.scenarioType)),isScheduledFolder:"scheduled"==Object(B.a)(e.tableQuery.folderId),mailboxInfo:Object(K.d)(t)}}),[2,i.subscribe({next:function(e){return T(e.data.subscribeToRowNotifications)},error:function(e){N.g.info("Row notification error "+e)}})]}}))}))}(e).then((function(t){G[e.id]=t})):Q.b.import().then((function(n){var r={NotificationType:"RowNotification",FolderId:H(e),FocusedViewFilter:t.focusedViewFilter,IsConversation:0==t.listViewType,CategoryFilter:t.categoryName,Filter:t.viewFilter,ChannelId:n(),MailboxId:Z(e)};!0===r.IsConversation?(r.ConversationShapeName=D.c(e.tableQuery.folderId,Object(d.R)(t.scenarioType)),r.ConversationResponseShape=D.b(e.tableQuery.folderId),r.SortBy=function(e){var t,n=e.sortBy;switch(e.sortBy.sortColumn){case 1:Object(b.l)(e)&&(t="ConversationLastDeliveryOrRenewTime");break;case 3:t="ConversationUniqueSenders";break;case 7:t="ConversationSize";break;case 8:t="ConversationTopic";break;case 5:t="ConversationImportance";break;default:throw new Error("getConversationSortByProperty: sort column is not supported "+n.sortColumn)}var r=[];t&&r.push(Object(x.a)({Order:n.sortDirection,Path:Object(_.a)({FieldURI:t})}));var i=1==e.sortBy.sortColumn?e.sortBy.sortDirection:d.c.DESCENDING_SORT_DIR;return r.push(Object(x.a)({Order:i,Path:Object(_.a)({FieldURI:"ConversationLastDeliveryTime"})})),r}(t)):r.SortBy=Object(A.a)(t);var i={subscriptionId:e.id,requiresExplicitSubscribe:!0,subscriptionParameters:r};Q.f.importAndExecute(i,T),G[e.id]=i})))}}function H(e){return 0==e.tableQuery.type?e.tableQuery.folderId:null}function Z(e){return 2==e.tableQuery.type?e.tableQuery.folderId:null}n.d(t,"a",(function(){return q})),n.d(t,"b",(function(){return W}))},2838:function(e,t,n){"use strict";function r(e,t){return t.rowKeys.indexOf(e)}n.d(t,"a",(function(){return r}))},3162:function(e,t,n){"use strict";var r=n(2711),i=n(44),a=n(2059),o=n(3570),c=n(1938),u=n(2047),d=n(3276),l=n(2201),s=n(3277),b=n(2202),f=n(3405),v=n(3755),m=n(2225),O=n(2596),y=n(3),p=n(1633);Object(y.orchestrator)(m.a,(function(e){var t=e.rowKeys,n=e.tableView,r=e.actionType,i=e.shouldRemoveFromAllTables,a=n.id,o=t.filter((function(e){return n.rowKeys.indexOf(e)>=0}));if(0!=o.length){var c=Object(p.C)(o,a);if(Object(v.a)(o,n,r),"All"==Object(p.O)(n)&&i){var u=Object(O.a)(n.tableQuery.folderId,!1),d=Object(p.l)(n);u.forEach((function(e){if(a!=e.id&&d===Object(p.l)(e)){var t=Object(p.E)(c,e);0!=t.length&&Object(v.a)(t,e,r)}}))}}}));function j(e,t){if(!t||0==t.length)return e;var n=[];return t.forEach((function(e){n.push(e)})),e.forEach((function(e){-1===t.indexOf(e)&&n.push(e)})),n}function w(e,t){return t&&0!=t.length?(e.forEach((function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)})),0===t.length&&(t=void 0),t):t}var k=n(3926),h=n(1640);Object(y.mutator)(k.a,(function(e){var t=e.conversationRowKeys,n=e.tableViewId,r=e.categoriesToAdd,i=e.categoriesToRemove,a=e.clearCategories;t.forEach((function(e){r&&function(e,t,n){var r=Object(p.K)(e,t);r.categories=j(n,r.categories);var i=Object(p.J)().tableViews.get(t);p.b.getItemIds(e,i).forEach((function(e){var t=Object(h.v)(e);t&&(t.Categories=j(n,t.Categories))}))}(e,n,r),i&&function(e,t,n){var r=Object(p.K)(e,t);r.categories=w(n,r.categories);var i=Object(p.J)().tableViews.get(t);p.b.getItemIds(e,i).forEach((function(e){var t=Object(h.v)(e);t&&(t.Categories=w(n,t.Categories))}))}(e,n,i),a&&function(e,t){Object(p.K)(e,t).categories=void 0;var n=Object(p.J)().tableViews.get(t);p.b.getItemIds(e,n).forEach((function(e){var t=Object(h.v)(e);t&&(t.Categories=void 0)}))}(e,n)}))}));var I=n(0),g=n(3927);Object(y.mutator)(g.a,(function(e){var t=e.itemIds,n=e.categoriesToAdd,r=e.categoriesToRemove,i=e.clearCategories;t.forEach((function(e){var t=Object(h.v)(e);n&&(t.Categories=j(n,t.Categories),function(e,t){var n,r,i=Object(O.a)(e.ParentFolderId.Id,!0),a=function(n){if(Object(p.P)(n)){var r=e.ConversationId.Id,i=Object(p.E)([r],n);if(0===i.length)return"continue";i.forEach((function(e){var r=Object(p.K)(e,n.id);r.categories=j(t,r.categories)}))}};try{for(var o=Object(I.__values)(i),c=o.next();!c.done;c=o.next()){var u=c.value;a(u)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}(t,n)),r&&(t.Categories=w(r,t.Categories),t.Categories||(t.Categories=[])),i&&(t.Categories=[])}))}));var N=new i.c((function(){return n.e(1408).then(n.bind(null,17169))}));Object(i.f)(b.a,N,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(i.f)(s.a,N,(function(e){return e.markItemsAsPinnedStoreUpdateOrchestrator})),Object(i.f)(l.a,N,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(i.f)(d.a,N,(function(e){return e.markConversationsAsPinnedStoreUpdateOrchestrator})),Object(i.f)(c.a,N,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(i.f)(a.a,N,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(i.f)(o.a,N,(function(e){return e.deleteFolderStoreUpdateOrchestrator})),Object(i.f)(u.a,N,(function(e){return e.markAllAsReadOrchestrator})),Object(i.f)(f.a,N,(function(e){return e.updateCategoriesInViewOrchestrator}));var T=new i.a(N,(function(e){return e.removeTableFromStore}));function S(e){Object(r.b)(e),T.importAndExecute(e)}n.d(t,"a",(function(){return S}))},3163:function(e,t,n){"use strict";var r=n(2290),i=n(2591),a=n(0),o=n(3756),c=n(1802),u=n(3);Object(u.orchestrator)(c.d,(function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.searchTableQuery,n=e.searchEndToEndPerformanceDatapoint,i=e.actionSource,[4,Object(r.a)(t,n,i)];case 1:return a.sent(),n.end(),Object(o.a)(t),[2]}}))}))}));var d=n(1638);var l=n(1740),s=n(2428),b=n(5114),f=n(1640),v=n(1777),m=function(e){var t=e.actionSource,n=e.row,i=e.searchTableQuery,o=e.referenceId,c=e.traceId,u=e.itemPartId,m=Object(l.c)(i);s.a.clear(m),s.a.addRow(0,n,m),Object(r.a)(i,null,t);var O={referenceKey:o,index:0,traceId:c};if(Object(b.a)(n.InstanceKey,m,O),Object(v.q)(m,m.rowKeys[0],!1,f.b.SearchSuggestionClick),0==i.listViewType&&u){var y=function(e,t){var n,r,i,o;if(d.a.conversations.has(e)){var c=d.a.conversations.get(e);try{for(var u=Object(a.__values)(c.conversationNodeIds),l=u.next();!l.done;l=u.next()){var s=l.value,b=d.a.conversationNodes.get(s);try{for(var f=(i=void 0,Object(a.__values)(b.itemIds)),v=f.next();!v.done;v=f.next()){if(v.value==t)return s}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}return null}(n.ConversationId.Id,u),p=Object(d.b)().conversations.get(n.ConversationId.Id),j=p?p.conversationNodeIds:[];Object(v.b)(y,u,j,m,f.b.MailListItemExpansion)}},O=(Object(u.orchestrator)(c.c,(function(e){m(e)})),n(2148)),y=n(2034),p=n(2509),j=n(1829);Object(u.orchestrator)(l.e,(function(e){var t=e.focusedViewFilter;return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var e,n,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return e=Object(y.a)(),Object(p.d)(t,"NonUserAction"),n=Object(O.a)(e.tableQuery.folderId,e.tableQuery.listViewType,"mail",t,null,null,null),[4,Object(r.a)(n)];case 1:return i=a.sent(),j.b.importAndExecute(),[2,i]}}))}))}));var w=n(2594),k=n(1973);Object(u.orchestrator)(k.a,(function(){w.d.import()}));var h=n(3187),I=n(44);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return i.b}));var g=new I.c((function(){return n.e(1449).then(n.bind(null,17507))}));Object(I.f)(h.a,g,(function(e){return e.onListViewTypeOptionSavedOrchestrator}))},3167:function(e,t,n){"use strict";var r=n(2479),i=n(1633),a=n(1716),o=n(1791),c=n(1740),u=n(2099),d=n(559),l=n(3014);var s=n(2535);var b=n(34),f=n(3);function v(e,t,n){switch(m(e),e.tableQuery.listViewType){case 0:return function(e,t,n){var s,b=e.tableQuery,f=null===(s=Object(i.j)(e,!0))||void 0===s?void 0:s.Id,v=b.viewFilter&&"All"!==b.viewFilter,m=i.c.getDefaultSortBy(),O=m.sortColumn,y=m.sortDirection,p=b.sortBy&&(b.sortBy.sortColumn!==O||b.sortBy.sortDirection!==y);return Object(u.d)(b.folderId,c.a,b.viewFilter,b.sortBy,Object(o.l)(b),b.focusedViewFilter,b.requestShapeName,Object(a.d)(b),void 0,b.categoryName,f,{datapoint:{customData:{scenarioType:b.scenarioType,isPrefetch:t,isFilter:v,isSort:p}}},b.shouldTryToUseSessionDataResponse).then((function(i){var a=[];return i.edges&&(a=i.edges.map((function(e){return e.node}))),Object(r.a)(e,a,i.totalConversationRowsInView,i.searchFolderId?Object(d.a)({Id:i.searchFolderId}):null,i.folderId?Object(d.a)({Id:i.folderId}):null),n(e,!0,"200",t),Promise.resolve()})).catch((function(r){var i=Object(l.a)(r);return n(e,!1,i,t),Promise.reject(r)}))}(e,t,n);case 1:return function(e,t,n){var o=e.tableQuery;return Object(u.c)(Object(i.i)(o),0,c.a,o.viewFilter,Object(s.a)(o),o.focusedViewFilter,o.requestShapeName,o.shouldTryToUseSessionDataResponse,Object(a.e)(o),o.categoryName,Object(i.j)(e,!0)).then((function(i){var a=Promise.resolve(),o="Success"==i.ResponseClass;if(o)Object(r.a)(e,i.RootFolder.Items,i.RootFolder.TotalItemsInView,i.SearchFolderId,null);else{var c=new Error("ResponseCode="+i.ResponseCode+", Stacktrace="+i.StackTrace);c.fetchErrorType="ServerFailure",a=Promise.reject(c)}return n(e,o,i.ResponseCode,t),a}),(function(r){var i,a=(null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.status)||"";return n(e,!1,a,t),Promise.reject(r)}))}(e,t,n);default:return b.g.warn("listViewType: "+e.tableQuery.listViewType+" is not supported."),Promise.resolve()}}n.d(t,"a",(function(){return v}));var m=Object(f.mutatorAction)("setTableViewLoading",(function(e){e.isLoading=!0,e.loadErrorStatus=0}))},3186:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n(2441),i=n(2148),a=n(1633),o=n(957),c=n(2654);function u(){var e=Object(o.a)("inbox"),t=Object(a.A)(e),n=Object(r.a)(e);return Object(i.a)(e,t,"mail",-1,null,null,n)}function d(){var e=u();return e.focusedViewFilter=0,e}function l(){var e=u();return e.focusedViewFilter=1,e}function s(){return Object(c.a)()?d():u()}},3187:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("ON_LIST_VIEW_TYPE_OPTION_SAVED",(function(e){return{newListViewType:e}}))},3275:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ROW_UPDATED",(function(e,t){return{rowKey:e,tableView:t}}))},3376:function(e,t,n){"use strict";var r=n(3162),i=n(2711),a=5,o=[];function c(e){o.unshift(e.id),Object(i.a)(e),function(){if(o.length>a)for(var e=a;e<o.length;e++)u(o[e])}()}function u(e){var t=o.indexOf(e);if(-1==t)throw new Error("TableViewId should be present in the mru list when remove is called");o.splice(t,1),Object(r.a)(e)}function d(e,t){void 0===t&&(t=!0);var n=o.indexOf(e.id);switch(n){case-1:t?c(e):function(e){l()&&(o.push(e.id),Object(i.a)(e))}(e);break;case 0:break;default:!function(e){var t=e.id;o.splice(o.indexOf(t),1),o.unshift(t)}(e)}return n}function l(){return o.length<a}var s=n(3888),b=n(2441),f=n(957),v=n(1633);function m(e,t){if(void 0===t&&(t=!0),1==e.tableQuery.type)throw new Error("updateTablesInCache should never be called for Search table");var n=e.tableQuery;if(e.tableQuery.folderId===Object(f.a)("inbox")&&"All"===Object(v.O)(e)&&"spotlight"!==n.scenarioType){var r=n.sortBy.sortColumn,i=n.sortBy.sortDirection,a=Object(b.a)(e.tableQuery.folderId);if(r===a.sortColumn&&i===a.sortDirection)return Object(s.a)(),0}return d(e,t)}function O(){Object(s.a)()}function y(){return l()}function p(e){u(e)}n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return O})),n.d(t,"a",(function(){return y})),n.d(t,"d",(function(){return p}))},3381:function(e,t,n){"use strict";var r=n(424),i=n(44),a=new i.c((function(){return Promise.all([n.e(3),n.e(691)]).then(n.bind(null,16807))})),o=new i.a(a,(function(e){return e.downloadPersonaPhoto})),c=n(215),u=n(981),d=new r.a(3,(function(e){var t=Object(u.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name),n=c.a.viewStates.get(t);return o.importAndExecute(n,!1,e.skipLoadingPhoto)}),500);t.a=d},3404:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(2468),i=n(1633),a=n(1791);function o(e,t,n,r){var o=new Date(i.b.getLastDeliveryTimeStamp(n,r)).getTime()-new Date(t).getTime();if(Object(a.l)(r.tableQuery)){var c=new Date(i.b.getLastDeliveryOrRenewTimeStamp(n,r)).getTime()-new Date(e).getTime();return 0!=c?c:o}return o}function c(e,t,n,i,o){return Object(r.a)(o,n.id,e)?Object(a.f)(n,0):u(e,t,n,i)}function u(e,t,n,a){var c=n.rowKeys.length;if(0==c)return 0;var u,d=Object(i.I)(n).sortDirection==i.c.DESCENDING_SORT_DIR;for(u=a;u<c;u++){var l=n.rowKeys[u];if(!Object(r.a)(l,n.id,e)){var s=o(e,t,l,n);if(d?s<=0:s>0)return u}}return c==n.totalRowsInView?c:-1}},3405:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateCategoriesInView",(function(e,t){return{modifiedCategoryName:e,newCategoryName:t}}))},3406:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("UPDATE_TABLE_CURRENT_LOADED_INDEX",(function(e,t){return{tableViewId:e,currentLoadedIndexToSet:t}}))},3570:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("DELETE_FOLDER_STORE_UPDATE",(function(e){return{folderIds:e}}))},3719:function(e,t,n){"use strict";var r=n(44),i=n(3571),a=n(1969),o=n(1920);function c(e){var t;if(Object(o.c)(e.serverFolderId,o.b.Running))return!1;if(e.currentLoadedIndex<e.rowKeys.length)return!0;if("spotlight"===(null===(t=null==e?void 0:e.tableQuery)||void 0===t?void 0:t.scenarioType))return!1;var n=a.a.getCount(e.serverFolderId,3);return e.rowKeys.length>0&&e.rowKeys.length<e.totalRowsInView-n}var u=n(1740);function d(e){(function(e){return e.rowKeys.length<u.a&&!e.isLoading&&c(e)})(e)&&b.importAndExecute(e)}var l=n(3);Object(l.orchestrator)(u.d,(function(e){var t=e.tableView;t&&c(t)&&b.import().then((function(e){c(t)&&e(t)}))})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return d}));var s=new r.c((function(){return n.e(1371).then(n.bind(null,17250))}));Object(r.f)(i.a,s,(function(e){return e.reloadTableOnTriageActionFailOrchestrator}));var b=new r.a(s,(function(e){return e.loadMoreInTable})),f=new r.a(s,(function(e){return e.reloadInboxPostBoot}))},3755:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),i=n(3719),a=n(1777),o=n(1633),c=n(2428),u=n(957),d=n(3406),l=n(2911),s=n(2182),b=n(2119);function f(e,t,n){var f,v;void 0===n&&(n="LocalUpdate");var m=-1,O=!1;try{for(var y=Object(r.__values)(e),p=y.next();!p.done;p=y.next()){var j=p.value;t.selectedRowKeys.has(j)&&(m=t.rowKeys.indexOf(j))>-1&&(O=o.b.getIsPinned(t.rowKeys[m],t)),c.a.removeRow(j,t,n)}}catch(e){f={error:e}}finally{try{p&&!p.done&&(v=y.return)&&v.call(y)}finally{if(f)throw f.error}}Object(d.a)(t.id,Math.min(t.currentLoadedIndex,t.rowKeys.length)),t.id===Object(l.a)()&&(Object(i.d)(t),m>-1&&t.tableQuery.folderId!=Object(u.a)("junkemail")&&t.rowKeys.length>0?Object(a.l)(t,m,O):Object(b.a)()&&Object(s.a)())}},3756:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("ON_MAIL_SEARCH_COMPLETE",(function(e){return{searchTableQuery:e}}))},3888:function(e,t,n){"use strict";var r=n(3162),i=n(2711),a=n(1740),o=[];function c(e,t){if(-1===d(e)){o.push(e);var n=Object(a.c)(t);Object(i.a)(n)}}function u(e,t){var n=d(e);if(-1!==n){o.splice(n,1);var i=Object(a.c)(t,!0);i&&Object(r.a)(i.id)}}function d(e){return o.indexOf(e)}var l=n(2509),s=n(2654),b=n(3186);n.d(t,"a",(function(){return O}));var f="FOCUSED",v="OTHER",m="ALL";function O(){var e=Object(b.c)(),t=Object(b.b)(),n=Object(b.d)();Object(s.a)()?(c(f,t),c(v,n),u(m,e),Object(l.b)(n)):(u(f,t),u(v,n),c(m,e))}},3890:function(e,t,n){"use strict";var r={warmedUpGroups:null,warmUpTime:0};function i(e){r.warmUpTime=e}function a(){return r.warmUpTime}function o(e){r.warmedUpGroups=e}function c(e){var t=e.toLowerCase();if(!r.warmedUpGroups)return!1;for(var n=0;n<r.warmedUpGroups.length;++n){if(r.warmedUpGroups[n].toLowerCase()==t)return!0}return!1}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c}))},3925:function(e){e.exports=JSON.parse('{"a":"Y1b","c":"Z1b","b":"_1b","d":"$1b"}')}}]);
//# sourceMappingURL=owa.MailBoot~GroupAddMemberV2~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule.js.map
self.scriptsLoaded['owa.MailBoot~GroupAddMemberV2~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupAddMemberV2~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();