self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentFilePicker.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[483],{1647:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1662:function(e,t,n){"use strict";var r=n(1641),i=n(1839),o=n(7);function a(e){var t;return e>=1073741824?(e/=1073741824,t=Object(o.b)(i.b)):e>=1048576?(e/=1048576,t=Object(o.b)(i.d)):e>=1024?(e/=1024,t=Object(o.b)(i.c)):t=Object(o.b)(i.a),Object(o.c)(t,Math.round(e))}var c,u=n(1709),l=n(40),s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(l.i)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&s.indexOf(t.toLowerCase())>=0}function d(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return c.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return c.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return c.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(c||(c={}));var p=n(1676);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return f})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return p.b})),n.d(t,"a",(function(){return c}))},1676:function(e,t,n){"use strict";function r(e){return t=e||"",(n=o.exec(t))&&n.length>1&&i[n[1].toLowerCase()];var t,n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},o=/^\s*([^;\s]*)(?:;|\s|$)/;function a(e){var t="";return Object.entries(i).forEach((function(n){n[1]===e&&(t=n[0])})),t}},1709:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(1641),i=n(1676),o=n(76),a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function u(e,t,n){return void 0===n&&(n=!0),l(Object(r.a)(e)||Object(i.a)(t),n)}function l(e,t){return void 0===t&&(t=!0),!!e&&(a.indexOf(e.toLowerCase())>=0||t&&c.indexOf(e.toLowerCase())>=0&&(Object(o.e)()||Object(o.d)()||Object(o.h)()||Object(o.g)()&&!Object(o.l)()))}},1715:function(e,t,n){"use strict";var r=n(1647),i=n(1662);function o(e){return e.map((function(e){return{fileType:r.a.Uri,name:e.name,type:Object(i.b)(e.url)||"",size:0,uri:e.url}}))}var a=n(34);function c(e,t,n){if(e.length!=t.length)return a.d("The sizes of subjects and latestItemIds are different"),null;for(var i=[],o=0;o<e.length;o++){var c={fileType:r.a.MailItem,name:e[o],size:(null==n?void 0:n[o])||0,itemId:t[o]};i.push(c)}return i}function u(e,t,n){var i=[],o={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return i.push(o),i}function l(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var i=e[n],o={fileType:r.a.Local,name:i.name,size:i.size,type:i.type,fileObject:i};t.push(o)}return t}function s(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function f(e){var t,n;return null===e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function d(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function h(e){switch(e?e.toLowerCase():null){case p.ONE_DRIVE_PRO.toLowerCase():return 0;case p.GDRIVE.toLowerCase():return 5;case p.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.DROPBOX.toLowerCase():return 2;case p.BOX.toLowerCase():return 3;case p.WOPI_BOX.toLowerCase():return 7;case p.WOPI_EGNYTE.toLowerCase():return 8;case p.MAILBOX.toLowerCase():return 4;case p.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"i",(function(){return o})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return r.a}))},1839:function(e){e.exports=JSON.parse('{"b":"Hca","d":"Ica","c":"Jca","a":"Kca"}')},5530:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1715),o=n(40),a=n(1756);function c(e,t,n,r){u(e,Object(i.f)(t),r,n)}function u(e,t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=null),e({files:t,shouldShare:n,isInline:r,dataProviderType:i})}function l(e,t,n,r,l,s,f,d){if(r===a.i.LocalComputerFiles)l===a.b.Share&&d&&t?t({files:Object(i.f)(n),dataProviderType:null,targetWindow:f}):c(e,n,l===a.b.Insert,l===a.b.Share);else if(r===a.i.ProviderFiles){n[0].model.ProviderType;if(t&&function(e,t,n){return!!e&&(Object(o.i)("doc-hyperlinkContextMenu-originalPosition")||Object(o.i)("doc-hyperlinkContextMenu-newPosition")||Object(o.i)("doc-attachInsert-linkIcon")||Object(o.i)("doc-attachInsert-cloudLinkIcon")?t===a.b.InsertAsLink:t===a.b.Share&&Object(o.i)("doc-link-filePicker"))}(s,l))!function(e,t,n,r){if(t&&0!==t.length&&n===a.i.ProviderFiles){var o=t,c=o[0].model.ProviderType;e({files:o.map((function(e){return Object(i.e)(e.model)})),dataProviderType:c,targetWindow:r})}}(t,n,r,f);else{var p=n;l!==a.b.AttachAndShare?function(e,t,n){if(t&&0!==t.length){var r=t[0].model.ProviderType,o=null;if(r&&10===r){var a=[],c=[];t.forEach((function(e){a.push(e.model.Subject),c.push(e.model.Id)})),o=Object(i.h)(a,c)}else o=t.map((function(e){return Object(i.e)(e.model)}));u(e,o,n,!1,r)}}(e,p,l===a.b.Share):function(e,t){var n=t.length>0?t[0].model.ProviderType:null,r=t.filter((function(e){return null!==e.location})),o=t.filter((function(e){return null===e.location}));r.length>0&&u(e,r.map((function(e){return Object(i.e)(e.model)})),!0,!1,n),o.length>0&&u(e,o.map((function(e){return Object(i.c)(e.model)})),!1,!1,n)}(e,p)}}}var s=n(25),f=n(296),d=1,p=2,h=3;function m(){switch(Object(s.a)().ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse){case d:return a.d.List;case p:return a.d.Tile;default:return Object(f.a)()?a.d.Tile:a.d.List}}var b=n(105);var v=n(85),O=n(134);function g(e){var t=function(e){switch(e){case a.d.List:return d;case a.d.Tile:return p;case a.d.Groups:return h;default:return Object(b.a)(e)}}(e);Object(O.r)("AFPChangePreferredViewType",[]),Object(v.z)((function(e){e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse=t}),[{key:"AttachmentsFilePickerViewTypeForMouse",valuetype:"Integer32",value:[""+t]}],"OWA.ViewStateConfiguration")}var I="OWA.ViewStateConfiguration";function j(e){Object(O.r)("AFPSetUserPrefferdAction",[e]),Object(v.z)((function(t){t.ViewStateConfiguration.AttachOrShareCloudFiles=e}),[{key:"AttachOrShareCloudFiles",valuetype:"Integer32",value:[""+e]}],I)}function C(e){Object(O.r)("AFPSetUserPreferredActionGroups",[e]),Object(v.z)((function(t){t.ViewStateConfiguration.AttachOrShareGroupsFiles=e}),[{key:"AttachOrShareGroupsFiles",valuetype:"Integer32",value:[""+e]}],I)}function S(){var e=Object(s.a)();return{preferredViewType:{value:m(),valueSetter:g},attachOrShareCloudFiles:{value:e.ViewStateConfiguration.AttachOrShareCloudFiles,valueSetter:j},attachOrShareGroupsFiles:{value:e.ViewStateConfiguration.AttachOrShareGroupsFiles,valueSetter:C}}}var w=n(34);function P(e,t,n,i,o,c,u,s,f){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a.l.import()];case 1:d=r.sent(),p=S();try{if(!n||0==n.length)throw new Error("files length cannot be 0.");return[2,d(n,c,i,n[0].type===a.e.Group,n.length>1,o,s,p,u).then((function(r){l(e,t,n,o,r,!0,s,f)})).catch((function(){}))]}catch(e){w.d("Error creating the action panel. Attaching or sharing files might not work! "+e)}return[2]}}))}))}function y(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a.m.import()];case 1:i=r.sent(),n.userConfiguration||(n.userConfiguration=S());try{return[2,i(n).then((function(r){l(e,t,r.files,r.source,r.action,r.supportsInsertLink,n.targetWindow,!1)})).catch((function(){}))]}catch(e){w.d("Error creating the file picker. Attaching or sharing files might not work! "+e)}return[2]}}))}))}var F=n(692),A=n(2376),T=n(1),x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.localComputerFilePicker=T.createRef(),t.onFilesSelected=function(e){var n=t.props,r=n.action;c(n.createAttachmentHandler,e,r===A.c.Insert,r===A.c.Share)},t}return Object(r.__extends)(t,e),t.prototype.render=function(){return T.createElement(a.h,{ref:this.localComputerFilePicker,onFilesSelected:this.onFilesSelected,fileSelectionFilter:this.props.fileSelectionFilter})},t.prototype.click=function(){this.localComputerFilePicker.current&&this.localComputerFilePicker.current.click()},t=Object(r.__decorate)([F.observer],t)}(T.Component),E=n(1662);function k(e,t){for(var n=e.files,r=e.shouldShare,i=e.isInline,o=e.dataProviderType,a=[],c=0;n[c];)a=a.concat(n[c].size),c++;var u=function(e){for(var t=[],n=0;e[n];)t=t.concat(Object(E.b)(e[n].name)),n++;return t}(n);Object(O.r)("AFPAttachOrShare",[r,i,a.join(","),n.length,o,u.join(","),!1,t],{isCore:!0,isCosmosDatapoint:!0})}n.d(t,"attachmentActionsPanel",(function(){return P})),n.d(t,"attachmentFilePicker",(function(){return y})),n.d(t,"AttachmentLocalComputerFilePicker",(function(){return x})),n.d(t,"logAttachOrShareDatapoint",(function(){return k}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentFilePicker.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentFilePicker.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentFilePicker.js'] = (new Date()).getTime();