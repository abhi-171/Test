self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~filesView~smime.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[148],{10387:function(t){t.exports=JSON.parse('{"a":"P7a"}')},10388:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(13576),i=n(1864),c=n(7),a=n(5577),u=n(1715),o=n(1662);function s(t,e,n,r){var c=[],a=[];if(t.forEach((function(t){n(t)?c.push(t):a.push(t)})),a.length>0){var u=r(a.map((function(t){return t.name})).join(", ")),o=u.messageId,s=u.message;Object(i.a)(e,o,[s])}return c}function f(t,e,n){Object(a.a)(n);for(var i=[],f=0;f<t.length;f++)i.push(t[f]);return i=function(t,e){return s(t,e,(function(t){return!(t.fileType===u.a.Local&&0===t.size)}),(function(t){return{messageId:"WarningEmptyFilesCanNotBeAttached",message:Object(c.c)(Object(c.b)(r.a),t)}}))}(i,n),e&&(i=function(t,e){return s(t,e,(function(t){return Object(o.g)(t.name,t.type)}),(function(t){return{messageId:"WarningInlineImageTypeNotSupported",message:Object(c.c)(Object(c.b)(r.b),t)}}))}(i,n)),i}},10389:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(13577),i=n(7),c=n(34),a=n(3311),u=n(8732),o=n(1864);function s(t,e,n){for(var s=0,f=0,l=void 0;l=t[f];f++)s+=l.size;var d=Object(u.a)(n);if(s>d){var m=Math.floor(d/a.b),b=void 0,h=void 0;return t.length>1?(h="ErrorTooLargeForLocalAttachmentMultiple",b=Object(i.c)(Object(i.b)(r.a),m)):(h="ErrorTooLargeForLocalAttachmentSingle",b=Object(i.c)(Object(i.b)(r.b),m)),Object(o.a)(e,h,[b]),!0}return c.g.info("Attachment: TotalSize = "+Math.floor(n.totalClassicAttachmentSize/1048576)),!1}},13576:function(t){t.exports=JSON.parse('{"a":"_7a","b":"$7a"}')},13577:function(t){t.exports=JSON.parse('{"a":"Y7a","b":"Z7a"}')},1822:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(105);function i(t){switch(t){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(t)}}},1921:function(t,e,n){"use strict";var r=n(1674);function i(){var t=Object(r.a)();return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var c=n(1822),a=n(1793);function u(){return i()}function o(t){return(t&&t.length>0&&function(t){return t.some((function(t){return!((e=t).IsInline&&!Object(a.a)(e));var e}))}(t)?i():[]).map(c.a)}n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return o}))},195:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,i=!1;function c(e){r--,delete t[e]}this.put=function(e,n,i,a){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var u=t[e];u?clearTimeout(u.timeout):r++;var o={value:n,expire:i+Date.now()};return isNaN(o.expire)||(o.timeout=setTimeout(function(){c(e),a&&a(e,n)}.bind(this),i)),t[e]=o,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&c(e),n},this.clear=function(){for(var c in t)clearTimeout(t[c].timeout);r=0,t=Object.create(null),i&&(e=0,n=0)},this.get=function(c){var a=t[c];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return i&&e++,a.value;i&&n++,r--,delete t[c]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){i=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),i=Date.now(),c=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(c)if(t[a])continue;var u=r[a],o=u.expire-i;if(o<=0){this.del(a);continue}o=o>0?o:void 0,this.put(a,u.value,o)}return this.size()}}t.exports=new r,t.exports.Cache=r},2140:function(t,e,n){"use strict";var r=n(44),i=[0,1],c=n(2208),a=n(2165),u=n(7),o=n(105),s=n(1682);function f(t){switch(t){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(u.b)(a.a),messageParts:[Object(u.b)(a.a),l()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(u.b)(c.b),messageParts:[Object(u.b)(c.b),l()],color:s.a.Red};default:return Object(o.a)(t)}}function l(){return{text:Object(u.b)(c.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var d=n(1921),m=n(1822),b=n(0),h=n(40),p=n(1674);function g(){var t=Object(p.a)();if(Object(h.i)("fwk-devTools")){if(Object(h.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(b.__assign)(Object(b.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(h.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(b.__assign)(Object(b.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return t}function O(){var t=g();return t.DirectFileAccessOnPrivateComputersEnabled&&t.DirectFileAccessOnPublicComputersEnabled?2:t.WacViewingOnPrivateComputersEnabled&&t.WacViewingOnPublicComputersEnabled?0:1}n.d(e,"g",(function(){return C})),n.d(e,"a",(function(){return i})),n.d(e,"f",(function(){return f})),n.d(e,"b",(function(){return d.a})),n.d(e,"e",(function(){return m.a})),n.d(e,"d",(function(){return O})),n.d(e,"c",(function(){return g}));var v=new r.c((function(){return n.e(1686).then(n.bind(null,16825))})),C=new r.b(v,(function(t){return t.getAccessIssuesForAttachments}))},2165:function(t){t.exports=JSON.parse('{"a":"nla"}')},2208:function(t){t.exports=JSON.parse('{"a":"lla","b":"mla"}')},2447:function(t,e,n){"use strict";n.d(e,"n",(function(){return s})),n.d(e,"m",(function(){return f})),n.d(e,"j",(function(){return l})),n.d(e,"i",(function(){return d})),n.d(e,"k",(function(){return m})),n.d(e,"f",(function(){return b})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return p})),n.d(e,"g",(function(){return g})),n.d(e,"d",(function(){return O})),n.d(e,"h",(function(){return v})),n.d(e,"e",(function(){return A})),n.d(e,"l",(function(){return j})),n.d(e,"b",(function(){return y}));var r=n(3097),i=n(2851),c=n(62),a=n(1797),u=n(1895),o=n(2674);function s(){return Object(c.e)()||Object(c.f)()}function f(t){return function(t){if(t.length<2)return!1;var e=t[0]-parseInt(a.b),n=t[1]-parseInt(a.c);return 0==e&&n>=0}("string"==typeof t?t.split(".").map((function(t){return parseInt(t)})):[])}function l(t){var e="string"==typeof t?t.split("."):[];return e.length&&e[0]!=a.b}function d(){return Object(c.r)()&&(Object(c.i)()&&Object(c.b)()[0]==a.i&&Object(i.a)()||Object(r.a)())}function m(t){return 0!==t}function b(t){var e=[];e.push(t.UserEmailAddress),e.push(t.LogonEmailAddress),e.push(t.UserPrincipalName),e.push(t.UserLegacyExchangeDN);var n=t.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(t){e.indexOf(t)>=0||e.push(t)})),e}function h(t){var e=65001;return t.UseGB18030?e=54936:t.UseISO885915&&(e=28605),e}function p(t){return{AllowUserChoiceOfSigningCertificate:t.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:t.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:t.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:t.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:t.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:t.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:t.CopyRecipientHeaders,OnlyUseSmartCard:t.OnlyUseSmartCard,EncryptionAlgorithms:t.EncryptionAlgorithms,SigningAlgorithms:t.SigningAlgorithms}}function g(t,e){var n=Object(o.a)().ClearSign;return e||t&&!n?u.a:a.e}function O(t){return btoa(unescape(encodeURIComponent(t)))}function v(t,e){var n=Object(o.a)();return t&&e?n.TripleWrapSignedEncryptedMail?14:12:t?n.ClearSign?11:10:6}function C(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function A(){return a.m+C()+C()+C()+C()}function j(t,e){return e.IsInline&&-1===t.indexOf(e.ContentId)}function y(){return a.d+C()+"@"+C()+"."+C()}},2674:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(335);function i(){return Object(r.a)().smime}},2851:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(62);function i(){if(Object(r.i)())try{return new ActiveXObject("htmlfile"),!0}catch(t){return!1}return!1}},3097:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(62),i=n(1797);function c(){return Object(r.e)()&&Object(r.o)([i.f])||Object(r.g)()&&Object(r.o)([i.h])||Object(r.f)()&&Object(r.o)([i.g])}},3183:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1797),i=function(t,e){return t.substring(0,e.length)===e},c=function(t,e){return t.substring(t.length-e.length)===e},a=function(t){return t.ContentType&&(i(t.ContentType,r.v)||i(t.ContentType,r.l))},u=function(t){return t.ContentType&&t.ContentType===r.j};function o(t){return(null==t?void 0:t.Name)&&c(t.Name,r.t)&&(a(t)||u(t))}},3311:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return a}));var r="ReferenceAttachment:#Exchange",i=1024,c=1048576,a="Not support special characters"},342:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return a}));var r,i=n(0);function c(t){r=t}function a(){var t,e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(c=r)?[4,r()]:[3,2];case 1:c=i.sent(),i.label=2;case 2:if((n=c)&&n.length>0){if("bearer"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},347:function(t,e,n){"use strict";var r=n(0);function i(t,e){return t?Object(r.__assign)({mailboxInfo:t},e):null!=e?e:void 0}n.d(e,"a",(function(){return i}))},4541:function(t,e,n){"use strict";var r=n(4542),i=n(4540),c=n(1675),a=n(188);e.a=Object(a.action)("removeAttachmentFromWell")((function(t,e){var n=Object(c.a)(e.attachmentId);if(n){var a,u;1===e.attachmentType?(a=t.inlineAttachments,u=!0):a=t.imageViewAttachments.some((function(t){return t.attachmentId===e.attachmentId}))?t.imageViewAttachments:t.docViewAttachments;for(var o=!1,s=0;s<a.length;s++)if(a[s].attachmentId===e.attachmentId){a.splice(s,1),o=!0;break}!o||!u&&e.isCloudy||Object(r.a)(t,-1*n.model.Size,n.model.AttachmentId),Object(i.a)(e.attachmentId)}}))},4542:function(t,e,n){"use strict";var r=n(188);e.a=Object(r.action)("changeTotalClassicAttachmentSize")((function(t,e,n){t.totalClassicAttachmentSize+=e}))},5325:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"Item:#Exchange"},t)}},5577:function(t,e,n){"use strict";var r=n(1860),i=["ErrorTooLargeForLocalAttachmentSingle","ErrorTooLargeForLocalAttachmentMultiple","WarningFilesCanNotBeAttachedGenericError","WarningEmptyFilesCanNotBeAttached","WarningFilesCanNotBeAttachedWithNamesGenericError","WarningFilesCannotBeAttachedFromOtherMailboxes","WarningSeveralFilesCanNotBeAttachedGenericError","WarningInlineImageTypeNotSupported","WarningAttachmentsCanNotBeDeleted","InfoIncludeMostRecentAttachmentsMessage","ErrorSmimeHasCloudOrUriAttachments","ErrorAttachmentDownloadFailed","ErrorAttachmentDownloadFailedMultipleFiles","WarningSpecialCharactersAreNotSupported"];function c(t){t&&Object(r.a)(t,i)}n.d(e,"a",(function(){return c}))},616:function(t,e,n){"use strict";function r(t){void 0===t&&(t={}),function(t){t.timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4}}(t);var e=t.maximumAttempts,n=t.timeBetweenRetryInMS;return function(t){var r=0,i=!1,c=function(a,u){i?u(new Error("The function retry was cancelled")):(r++,t().then((function(t){return a(t)})).catch((function(t){e&&r>=e?u(t):setTimeout((function(){return c(a,u)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(t,e){return c(t,e)}))},cancel:function(){return i=!0}}}}function i(t){return function(e){return Math.pow(2,e)*t}}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},6713:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"ItemIdAttachment:#Exchange"},t)}},8732:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(34);function i(t){var e=t.maxTotalClassicAttachmentSize-t.totalClassicAttachmentSize;return e<0?(r.d("AttachmentWellAvailableSize is smaller than zero: "+t.composeId),0):e}},8735:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"ItemAttachment:#Exchange"},t)}},8736:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"MimeContentType:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~filesView~smime.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~filesView~smime.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~filesView~smime.js'] = (new Date()).getTime();