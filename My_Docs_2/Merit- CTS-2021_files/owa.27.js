self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.27.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[27],{1634:function(e,n,r){"use strict";var t=r(44),o=r(1910),i=r(3),d=r(6027),u=r(2246),a=(Object(i.mutator)(d.a,(function(e){var n=e.folderTreeId,r=e.userIdentity,t=e.loadingState;Object(u.a)(r).get(n).loadingState=t})),r(0)),l=Object(i.action)("PERSONA_SEARCH_FOLDERS_LOADED",(function(e,n){return{existingFolders:e,personaOrPdlFavorites:n}})),c=r(2147),f=r(2511),s=r(214),b=(Object(i.mutator)(l,(function(e){e.existingFolders.forEach((function(n){if(n){var r=n.FolderId.Id,t=e.personaOrPdlFavorites.filter((function(e){return e.searchFolderId===r}));if(1===t.length){var o=t[0].displayName,i=Object(a.__assign)(Object(a.__assign)({},Object(f.c)(n,Object(s.d)())),{DisplayName:o});Object(c.a)().set(n.FolderId.Id,i)}}}))})),r(34)),v=r(2723),I=r(188);function O(e,n){n.forEach((function(n){e.folderTable.delete(n)}))}var F=Object(I.action)("removeFolderFromParentFolder")((function(e,n){if(n.ParentFolderId){var r=e.folderTable.get(n.ParentFolderId.Id).childFolderIds;r.splice(r.indexOf(n.FolderId.Id),1)}}));function h(e,n,r){for(var t=n.folderTable.get(r).childFolderIds,o=!1,i=X(e).toLowerCase(),d=0;d<t.length&&!o;d++){X(n.folderTable.get(t[d])).toLowerCase()>i&&(t.splice(d,0,e.FolderId.Id),o=!0)}o||t.push(e.FolderId.Id)}var g=Object(I.action)("moveFolderToParentFolder")((function(e,n,r){h(n,e,r),n.ParentFolderId={Id:r,__typename:"FolderId"},n.mailboxInfo.mailboxType=Object(v.c)(r,e)})),j=r(7074),p=r(2768);Object(i.mutator)(p.a,(function(e){!function(e,n,r,t){var o=Object(j.a)(r),i=Object(c.a)().get(r);i||b.g.warn("addFolderToStore: parent folder was not found");var d=Object(a.__assign)(Object(a.__assign)({},Object(f.c)(n,i.mailboxInfo)),{DisplayName:t});e.folderTable.set(n.FolderId.Id,d),h(d,e,o.Id)}(e.folderStore,e.folder,e.parentFolderId,e.displayName)}));var m=r(16),T=Object(i.mutatorAction)("addFoldersToFolderTableMutator",(function(e){0==Object(c.a)().size?Object(o.a)().folderTable=new m.ObservableMap(e):Object.keys(e).forEach((function(n){Object(c.a)().set(n,e[n])}))})),E=r(1644),S=r(85),y=Object(i.action)("REMOVE_FOLDERTREE_DATA",(function(e,n){return{folderTreeId:e,userIdentity:n}})),_=r(4349),D=Object(i.mutatorAction)("setFolderTreeData",(function(e,n,r,t,o,i){void 0===t&&(t=!1),void 0===o&&(o=0);var d={id:e,rootFolder:n,loadingState:r,hasMoreData:t,currentLoadedIndex:o};Object(u.a)(i).set(e,d)}));function x(e,n){return Object(c.a)().has(e.FolderId.Id)?Object(c.a)().get(e.FolderId.Id):Object(a.__assign)({childFolderIds:[],principalSMTPAddress:n},e)}Object(i.orchestrator)(p.f,(function(){var e={DistinguishedFolderId:E.d,DisplayName:Object(S.h)().SessionSettings.ArchiveDisplayName,mailboxInfo:{type:"ArchiveMailbox",mailboxSmtpAddress:Object(S.h)().SessionSettings.ArchiveMailboxGuid,userIdentity:Object(s.d)().userIdentity}};D(E.d,e,_.a.Uninitialized)})),Object(i.mutator)(y,(function(e){Object(u.a)(e.userIdentity).delete(e.folderTreeId)}));var R=Object(i.mutatorAction)("updateFolder",(function(e,n,r,t){n&&(e.DisplayName=n),t.forEach((function(e){var n=r[e],t=r[n.ParentFolderId.Id]||Object(c.a)().get(n.ParentFolderId.Id);t&&t.childFolderIds.push(e)}))})),P=r(4130);function w(e,n,r,t){for(var o={},i=o[n.FolderId.Id]=t(n),d=[],u=0;u<r.length;u++){var a=r[u],l=a.FolderId.Id,c=a.DistinguishedFolderId;Object(P.a)(c)&&(o[l]=t(a),d.push(l))}R(i,e,o,d),T(o)}var A=r(7075);Object(i.orchestrator)(A.b,(function(e){var n=e.rootFolder,r=e.folders,t=e.principalSMTPAddress;w(null,n,r,(function(e){return x(e,t)}))}));var L=r(6028),M=r(7),N=(Object(i.orchestrator)(L.a,(function(e){var n=e.displayName,r=e.folders,t=e.folderTreeIdentifier,o=e.includesLastItemInRange,i=e.indexedPagingOffset,d=e.principalSMTPAddress,u=e.rootFolder,a=e.userIdentity;if(w(n,u,r,(function(e){return x(e,d)})),D(t,Object(c.a)().get(u.FolderId.Id),_.a.Loaded,!o,i,a),"UserMailbox"===u.mailboxInfo.type){for(var l=0;l<r.length;l++){var f=r[l],s=f.FolderId.Id,b=f.DistinguishedFolderId;Object(M.f)(b)||Object(S.a)(b,s)}Object(S.a)(u.DistinguishedFolderId,u.FolderId.Id)}})),r(957));function C(e,n,r){var t,o=Object(N.a)(r)||r;if(t=e.folderTable.get(o))for(var i=t.childFolderIds,d=n.toLowerCase(),u=0;u<i.length;u++){var a=i[u],l=e.folderTable.get(a);if(l&&l.DisplayName.toLowerCase()==d)return!0}return!1}function U(e,n){var r=[e];return n.folderTable.get(e).childFolderIds.forEach((function(e){Array.prototype.push.apply(r,U(e,n))})),r}function k(e){var n=Object(c.a)().get(e);return!!n.childFolderIds&&n.childFolderIds.map((function(e){return!!Object(c.a)().get(e)})).length>0}function G(e,n){return function e(n,r,t){var o=[];if(0===r){var i=e(n,r+1,t);o.push.apply(o,Object(a.__spread)(i))}else n.forEach((function(n){var i=Object(c.a)().get(n);if(i&&(o.push(Object(a.__assign)(Object(a.__assign)({},i),{depth:r})),k(n)&&t(n))){var d=e(i.childFolderIds,r+1,t);o.push.apply(o,Object(a.__spread)(d))}}));return o}(e,0,n)}var H,V={folderTable:new m.ObservableMap,mailboxFolderTreeData:new m.ObservableMap};var z=function(e,n){V.folderTable.set(e.FolderId.Id,e),e.ParentFolderId&&V.folderTable.get(e.ParentFolderId.Id).childFolderIds.push(e.FolderId.Id),e.DistinguishedFolderId&&(H[e.DistinguishedFolderId]=e.FolderId.Id)};z=Object(I.action)("addFolderToStore-TestMethod")(z);var W=Object(i.action)("INITIALIZE_SHARED_FOLDERS"),B=r(2530),K=r(2529),q=r(7076);function Y(e){var n=Object(u.a)(),r=n&&n.get(e);return null==r?void 0:r.hasMoreData}var Z=r(7077),J=r(2531),Q=r(25);function X(e){return e?Object(Q.a)().SessionSettings.IsShadowMailbox&&e.remoteFolderDisplayName?e.remoteFolderDisplayName:e.DisplayName:""}var $=r(134);var ee=Object(i.mutatorAction)("setMailboxFolderTreeData",(function(e,n){Object(o.a)().mailboxFolderTreeData.set(e,n)})),ne=new t.b(new t.c((function(){return r.e(238).then(r.bind(null,17167))})),(function(e){return e.fetchPrimaryMailFolders})),re=r(40),te=r(4350);function oe(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,t,o;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:if(n=Object(s.d)(),r=n.userIdentity,Object(u.b)(r)||ee(r,function(){var e;return{folderTreeTable:new m.ObservableMap((e={},e[E.j]={id:E.j,rootFolder:{DistinguishedFolderId:E.j,DisplayName:E.j,mailboxInfo:Object(s.d)()},loadingState:_.a.Uninitialized},e)),sharedFolderUserEmails:[]}}()),(t=Object(q.a)(E.j,r))==_.a.Loading||t==_.a.Loaded&&!e)return[2];Object(d.a)(E.j,_.a.Loading,r),o=!Object(re.i)("tri-disableSDFolders")&&Object(te.f)(n),i.label=1;case 1:return i.trys.push([1,5,,6]),o?[3,4]:[4,ne.import()];case 2:return[4,i.sent()(n)];case 3:o=i.sent(),i.label=4;case 4:return[3,6];case 5:return i.sent(),Object(d.a)(E.j,_.a.ErrorLoading,r),[2];case 6:return o?(Object(L.a)(o.RootFolder,o.Folders,E.j,r,Object(Q.a)().SessionSettings.UserDisplayName,E.j,r,o.IncludesLastItemInRange,o.IndexedPagingOffset),function(){var e,n,r=null===(e=Object(c.a)().get(Object(N.a)("inbox")))||void 0===e?void 0:e.childFolderIds.length,t=null===(n=Object(c.a)().get(Object(N.a)("msgfolderroot")))||void 0===n?void 0:n.TotalCount;Object($.r)("TnS_LoadFolders",[r,t])}(),[2]):(Object(d.a)(E.j,_.a.ErrorLoading,r),[2])}}))}))}var ie=r(6029),de=Object(I.select)({folderTable:function(){return o.b.folderTable}})((function(e,n){return Object(ie.c)(e,"msgfolderroot",n)}));function ue(e){return Object(ie.a)(o.b.folderTable.get(e),"msgfolderroot")}var ae=r(4351),le=r(7830),ce=r(7829);r.d(n,"L",(function(){return se})),r.d(n,"M",(function(){return be})),r.d(n,"P",(function(){return ve})),r.d(n,"Q",(function(){return Ie})),r.d(n,"J",(function(){return Oe})),r.d(n,"N",(function(){return Fe})),r.d(n,"O",(function(){return he})),r.d(n,"K",(function(){return ge})),r.d(n,"z",(function(){return o.a})),r.d(n,"b",(function(){return T})),r.d(n,"f",(function(){return C})),r.d(n,"h",(function(){return U})),r.d(n,"k",(function(){return G})),r.d(n,"A",(function(){return k})),r.d(n,"a",(function(){return _.a})),r.d(n,"s",(function(){return j.a})),r.d(n,"U",(function(){return l})),r.d(n,"e",(function(){return O})),r.d(n,"V",(function(){return F})),r.d(n,"R",(function(){return g})),r.d(n,"c",(function(){return p.a})),r.d(n,"B",(function(){return p.f})),r.d(n,"n",(function(){return p.e})),r.d(n,"m",(function(){return p.d})),r.d(n,"ab",(function(){return p.k})),r.d(n,"Z",(function(){return p.i})),r.d(n,"S",(function(){return p.g})),r.d(n,"C",(function(){return W})),r.d(n,"W",(function(){return y})),r.d(n,"T",(function(){return L.a})),r.d(n,"Y",(function(){return d.a})),r.d(n,"i",(function(){return B.a})),r.d(n,"w",(function(){return K.a})),r.d(n,"o",(function(){return c.a})),r.d(n,"r",(function(){return q.a})),r.d(n,"q",(function(){return Y})),r.d(n,"p",(function(){return Z.a})),r.d(n,"y",(function(){return J.a})),r.d(n,"j",(function(){return X})),r.d(n,"X",(function(){return D})),r.d(n,"x",(function(){return oe})),r.d(n,"G",(function(){return de})),r.d(n,"F",(function(){return ue})),r.d(n,"I",(function(){return ie.c})),r.d(n,"E",(function(){return ie.a})),r.d(n,"l",(function(){return v.a})),r.d(n,"t",(function(){return v.b})),r.d(n,"D",(function(){return v.d})),r.d(n,"v",(function(){return ae.a})),r.d(n,"H",(function(){return le.b})),r.d(n,"u",(function(){return u.b})),r.d(n,"g",(function(){return ce.a}));n.d=o.b;var fe=new t.c((function(){return r.e(238).then(r.bind(null,17167))})),se=new t.b(fe,(function(e){return e.getArchiveFolders})),be=new t.b(fe,(function(e){return e.getFolderPermissions})),ve=new t.b(fe,(function(e){return e.updateFolderPermissions})),Ie=new t.b(fe,(function(e){return e.updateFolderPermissionsInStore})),Oe=new t.b(fe,(function(e){return e.arePermissionArraysEqual})),Fe=(new t.b(fe,(function(e){return e.arePermissionsEqual})),new t.b(fe,(function(e){return e.getSharedFolders}))),he=new t.a(fe,(function(e){return e.updateFolder})),ge=new t.a(fe,(function(e){return e.createNewFolder}))},1644:function(e,n,r){"use strict";r.d(n,"f",(function(){return t})),r.d(n,"d",(function(){return o})),r.d(n,"j",(function(){return i})),r.d(n,"a",(function(){return d})),r.d(n,"g",(function(){return u})),r.d(n,"b",(function(){return a})),r.d(n,"h",(function(){return l})),r.d(n,"l",(function(){return c})),r.d(n,"k",(function(){return f})),r.d(n,"i",(function(){return s})),r.d(n,"c",(function(){return b})),r.d(n,"e",(function(){return v}));var t=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",d="archivedeleteditems",u="deleteditems",a="archiverecoverableitemsdeletions",l="recoverableitemsdeletions",c="msgfolderroot",f="sharedFolderTree",s="primaryFolderTree",b="archiveFolderTree",v="favorites"},1673:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(48);function o(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return t.a.defaultFolderIdToNameMap.get(e)||"none"}},1910:function(e,n,r){"use strict";r.d(n,"b",(function(){return d}));var t=r(3),o=r(16),i=Object(t.createStore)("folderStore",{folderTable:new o.ObservableMap,mailboxFolderTreeData:new o.ObservableMap}),d=i();n.a=i},1998:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(2246);function o(e,n){var r=Object(t.a)(n),o=r&&r.get(e);return null==o?void 0:o.rootFolder}},2147:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(1910);function o(){return Object(t.a)().folderTable}},2183:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(296),o=r(40);function i(){var e=Object(t.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(o.i)("notes-folder-view")&&e.push("notes"),e}},2246:function(e,n,r){"use strict";r.d(n,"a",(function(){return i})),r.d(n,"b",(function(){return d}));var t=r(1910),o=r(85);function i(e){return d(e).folderTreeTable}function d(e){return e||(e=Object(o.b)()),Object(t.a)().mailboxFolderTreeData.get(e)}},2435:function(e,n,r){"use strict";r.d(n,"b",(function(){return d}));var t=r(9),o=r(2183);r.d(n,"a",(function(){return o.a}));var i=new t.b((function(){return Promise.all([r.e(9),r.e(12),r.e(16),r.e(18),r.e(19),r.e(677)]).then(r.bind(null,3889))})),d=new t.a(i,(function(e){return e.bootstrapFolderHierarchyCache}))},2511:function(e,n,r){"use strict";var t=function(e,n){var r,t;if(e.ExtendedProperty)for(var o=0;o<e.ExtendedProperty.length;o++){var i=e.ExtendedProperty[o];if((null===(r=null==i?void 0:i.ExtendedFieldURI)||void 0===r?void 0:r.PropertyTag)===n||(null===(t=null==i?void 0:i.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===n)return i.Value}},o=function(e){var n=t(e,"SourceWellKnownFolderType");return n&&parseInt(n,10)||-1},i=function(e){return t(e,"0x7018")||null},d=function(e){return"false"!==t(e,"0x10f4")},u=r(1644),a=r(34);function l(e,n,r,t,o,i,a){var l,f=e.RootFolder;if(!f||!f.Folders||!f.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");var s=[];null==f||f.Folders.forEach((function(e){if(e&&function(e,n,r){if(t=null==e?void 0:e.__type,"Folder:#Exchange"!=t)return!1;var t;if((null==e?void 0:e.DistinguishedFolderId)&&u.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(d(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!n;if("notes"===e.DistinguishedFolderId)return!!r;return!0}(e,t,o)){var r=c(e,n);if(r&&(s.push(r),null==a?void 0:a[r.FolderId.Id])){var i=a[r.FolderId.Id];r.ReplicaList=i,r.mailboxInfo.auxiliaryMailboxGuid=i[0]}}}));var b=function(e,n){return"SharedMailbox"===n?void 0:e}((null===(l=null==f?void 0:f.ParentFolder)||void 0===l?void 0:l.DistinguishedFolderId)||"none",n.type);f.ParentFolder.DistinguishedFolderId=b;var v=c(f.ParentFolder,n);return i&&function(e,n,r){if(e){var t={},o={},i=[];t[e.FolderId.Id]=e,i.push(e.FolderId.Id),n.forEach((function(e){e&&(t[e.FolderId.Id]=e,i.push(e.FolderId.Id))})),i.forEach((function(e){var n,r=t[e],i=null===(n=r.ParentFolderId)||void 0===n?void 0:n.Id;r.DistinguishedFolderId&&(o[r.DistinguishedFolderId]=e);var d=i&&t[i];d&&d.childFolderIds.push(e)}));var d=[];r.forEach((function(e){var n=o[e];n&&d.push(n)}));for(var u=e.childFolderIds||[],a=0;a<u.length;a++){var l=u[a]||null;l&&-1==d.indexOf(l)&&d.push(l)}e.childFolderIds=d}}(v,s,r),{__typename:"FolderHierarchyResult",Folders:s,RootFolder:v,IndexedPagingOffset:f.IndexedPagingOffset,TotalItemsInView:f.TotalItemsInView,IncludesLastItemInRange:f.IncludesLastItemInRange}}function c(e,n){var r=e,t=r.FolderId,d=r.ParentFolderId,u=r.DisplayName,l=r.ArchiveTag,c=r.PolicyTag,v=r.ChildFolderCount,I=r.UnreadCount,O=r.TotalCount,F=r.FolderClass,h=r.DistinguishedFolderId;if(!t||!d)return a.g.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;var g=v||0,j=s(t);return{id:j.Id,__typename:"MailFolder",type:r.__type,FolderId:j,ParentFolderId:s(d),DisplayName:u||"",DistinguishedFolderId:h||null,FolderClass:F||"IPF.Note",UnreadCount:I||0,TotalCount:O||0,ArchiveTag:l?b(l):null,PolicyTag:c?b(c):null,hasChildren:g>0,remoteFolderDisplayName:i(r),sourceWellKnownFolderType:o(r),ReplicaList:r.ReplicaList,PermissionSet:r.PermissionSet,size:f(r),childFolderIds:[],pausedTotalCount:null,principalSMTPAddress:null,mailboxInfo:{type:n.type,userIdentity:n.userIdentity,mailboxSmtpAddress:n.mailboxSmtpAddress,auxiliaryMailboxGuid:n.auxiliaryMailboxGuid}}}function f(e){var n,r;return null===(r=null===(n=e.ExtendedProperty)||void 0===n?void 0:n[0])||void 0===r?void 0:r.Value}function s(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function b(e){return{__typename:"RetentionTagType",IsExplicit:e.IsExplicit,Value:e.Value}}r.d(n,"a",(function(){return o})),r.d(n,"b",(function(){return l})),r.d(n,"c",(function(){return c}))},2529:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(1998),o=r(1644);function i(e){return Object(t.a)(o.j,e)}},2530:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(1998),o=r(1644);function i(e){return Object(t.a)(o.d,e)}},2531:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(1998);function o(e){return Object(t.a)(e)}},2723:function(e,n,r){"use strict";r.d(n,"a",(function(){return f})),r.d(n,"b",(function(){return s})),r.d(n,"d",(function(){return b})),r.d(n,"c",(function(){return v}));var t=r(957),o=r(1673),i=r(1910),d=r(2529),u=r(2147),a=r(2530),l=r(2531),c=r(2435);function f(e){var n=Object(u.a)(),r=Object(t.a)(e);return r?n.get(r):void 0}function s(e,n){if("SharedMailbox"===e&&!n)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var r,t=[];switch(e){case"ArchiveMailbox":r=Object(a.a)();break;case"SharedMailbox":r=Object(l.a)(n);break;default:r=Object(d.a)()}var u=Object(c.a)();"UserMailbox"==e&&r.DistinguishedFolderId==Object(d.a)().DistinguishedFolderId&&r.FolderId&&u.forEach((function(e){var n=f(e);(null==n?void 0:n.ParentFolderId.Id)===r.FolderId.Id&&t.push(n.FolderId.Id)}));for(var s=function(e){var n=[];(null==e?void 0:e.childFolderIds)&&e.childFolderIds.map((function(e){var r=i.b.folderTable.get(e);n.push(r.FolderId.Id)}));return n}(r),b=0;b<s.length;b++)-1==u.indexOf(Object(o.a)(s[b]))&&t.push(s[b]);return t}function b(e,n){var r=Object(u.a)().get(e);return(null==r?void 0:r.mailboxInfo.type)===n}function v(e,n){var r=n.folderTable.get(e);return r?r.mailboxInfo.type:null}},2768:function(e,n,r){"use strict";r.d(n,"b",(function(){return o})),r.d(n,"f",(function(){return i})),r.d(n,"c",(function(){return d})),r.d(n,"e",(function(){return u})),r.d(n,"d",(function(){return a})),r.d(n,"h",(function(){return l})),r.d(n,"j",(function(){return c})),r.d(n,"k",(function(){return f})),r.d(n,"i",(function(){return s})),r.d(n,"a",(function(){return b})),r.d(n,"g",(function(){return v}));var t=r(3),o=Object(t.action)("GET_ARCHIVE_FOLDERS",(function(e,n){return{source:e,isLoadingMore:n}})),i=Object(t.action)("INITIALIZE_ARCHIVE_FOLDER_TREE_FROM_SESSIONDATA"),d=Object(t.action)("GET_FOLDER_PERMISSIONS",(function(e){return{folderId:e}})),u=Object(t.action)("GET_FOLDER_PERMISSIONS_SUCCESS"),a=Object(t.action)("GET_FOLDER_PERMISSIONS_FAILED"),l=Object(t.action)("UPDATE_FOLDER_PERMISSIONS",(function(e,n,r){return{folderId:e,permissions:n,mailboxInfo:r}})),c=Object(t.action)("UPDATE_FOLDER_PERMISSIONS_IN_STORE",(function(e,n){return{folderId:e,permissions:n}})),f=Object(t.action)("UPDATE_FOLDER_PERMISSIONS_SUCCESS"),s=Object(t.action)("UPDATE_FOLDER_PERMISSIONS_FAILED"),b=Object(t.action)("ADD_NEW_FOLDER_TO_STORE",(function(e,n,r,t){return{folderStore:e,folder:n,parentFolderId:r,displayName:t}})),v=Object(t.action)("ON_CREATE_NEW_FOLDER_INBOX_RULES_RESPONSE",(function(e,n,r,t){return{folderStore:e,folderId:n,parentFolderId:r,displayName:t}}))},2769:function(e,n,r){"use strict";r.d(n,"c",(function(){return O})),r.d(n,"d",(function(){return F})),r.d(n,"f",(function(){return h})),r.d(n,"e",(function(){return g})),r.d(n,"g",(function(){return j})),r.d(n,"h",(function(){return p})),r.d(n,"a",(function(){return m})),r.d(n,"b",(function(){return T}));var t,o,i,d,u,a,l,c=r(0),f=r(11),s=r(2511),b=r(4130),v=r(767),I=r(34);function O(){return a}function F(e,n){var r,c;t=l?void 0:e.findConversation,o=l?void 0:null==n?void 0:n.conversationRows,u=l?void 0:e.findMailFolderItem,a=null===(c=null===(r=e.findFolders)||void 0===r?void 0:r.Header)||void 0===c?void 0:c.ServerVersionInfo,i=e.findFolders,d=null==n?void 0:n.folderHierarchy}function h(e,n){var r,i=T(t,(function(e){return e.Body}),"fcr");if(t=void 0,o=void 0,l=!0,i){var d=void 0;if(e!=(null===(r=i.FolderId)||void 0===r?void 0:r.Id)?d="wf":i.Conversations?"number"==typeof i.IndexedOffset&&n===i.Conversations.length-i.IndexedOffset||(d="wi"):d="ni",Object(f.b)("fcr",d||"s"),!d)return i}return null}function g(e,n){return Object(c.__awaiter)(this,void 0,void 0,(function(){var r,i,d,u;return Object(c.__generator)(this,(function(a){switch(a.label){case 0:return r="fcr",i=o,d=t,t=void 0,o=void 0,l=!0,i||!d?[3,2]:[4,v.b.importAndExecute(d)];case 1:i=a.sent(),a.label=2;case 2:return i?(e!=i.folderId?u="wf":0!==n&&(u="wi"),Object(f.b)(r,u||"s"),[2,u?null:i]):[2,null]}}))}))}function j(e,n,r){var t=T(u,(function(e){var n,r,t;return null===(t=null===(r=null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===r?void 0:r.Items)||void 0===t?void 0:t[0]}),"fir");if(u=void 0,l=!0,t){var o=void 0,i=null==t?void 0:t.RootFolder;if(e!=r?o="wf":(null==i?void 0:i.Items)?"number"==typeof i.IndexedPagingOffset&&n===i.Items.length-i.IndexedPagingOffset||(o="wi"):o="ni",Object(f.b)("fir",o||"s"),!o)return t}return null}function p(e){var n=d,r=i;return d=void 0,i=void 0,!n&&r&&(n=function(e,n){var r=m(e);if(!r)return;try{return Object(s.b)(r,n,[],Object(b.a)("junkemail"),Object(b.a)("notes"),!1)}catch(e){return void I.g.warn("tryGetFolderHierarchyFromResponse: "+e.message)}}(r,e)),n&&Object(f.b)("ffr","s"),n}function m(e){return T(e,(function(e){var n,r,t;return null===(t=null===(r=null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===r?void 0:r.Items)||void 0===t?void 0:t[0]}),"ffr")}function T(e,n,r){var t="njr";if(e){var o=n(e);if(o){if("Error"!=o.ResponseClass)return o;t="e",Object(f.b)(r+"_c",o.ResponseCode||"un")}else t="nrm"}return Object(f.b)(r,t),null}},4130:function(e,n,r){"use strict";var t=r(85),o=r(40);function i(e){var n=Object(t.h)().SegmentationSettings;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&Object(o.i)("cal-stickyNotesFolder")}r.d(n,"a",(function(){return i}))},4349:function(e,n,r){"use strict";var t;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(t||(t={})),n.a=t},4350:function(e,n,r){"use strict";var t=r(2769);r.d(n,"a",(function(){return t.a})),r.d(n,"b",(function(){return t.c})),r.d(n,"d",(function(){return t.f})),r.d(n,"c",(function(){return t.e})),r.d(n,"e",(function(){return t.g})),r.d(n,"f",(function(){return t.h}))},4351:function(e,n,r){"use strict";r.d(n,"a",(function(){return a}));var t=r(214),o=r(2147),i=r(1644),d=r(25),u=r(7829);function a(e,n){var r,a,l,c,f,s=Object(o.a)(),b=null==s?void 0:s.get(e),v=Object(d.a)().SessionSettings,I=Object(t.d)();return"SharedMailbox"===(null==b?void 0:b.mailboxInfo.type)?(a=b.principalSMTPAddress,f="SharedMailbox"):e==i.d||e==i.b||"ArchiveMailbox"==(null==b?void 0:b.mailboxInfo.type)?((c=null===(r=null==b?void 0:b.ReplicaList)||void 0===r?void 0:r[0])&&n?l=c:(l=v.ArchiveMailboxGuid,c=void 0),f="ArchiveMailbox",a=Object(u.a)(l,v.OrganizationDomain)):(a=I.mailboxSmtpAddress,f="UserMailbox"),{type:f,userIdentity:I.userIdentity,mailboxSmtpAddress:a,auxiliaryMailboxGuid:c}}},6027:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(3),o=Object(t.action)("SET_LOADING_STATE_FOR_FOLDER_TREE",(function(e,n,r){return{folderTreeId:e,loadingState:n,userIdentity:r}}))},6028:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(3),o=Object(t.action)("ON_QUERY_FOLDERHIERARCHY",(function(e,n,r,t,o,i,d,u,a){return{rootFolder:e,folders:n,distinguishedFolderId:r,principalSMTPAddress:t,displayName:o,folderTreeIdentifier:i,userIdentity:d,includesLastItemInRange:u,indexedPagingOffset:a}}))},6029:function(e,n,r){"use strict";r.d(n,"b",(function(){return i})),r.d(n,"c",(function(){return d}));var t=r(1910),o=r(188);function i(e){return"msgfolderroot"===e.DistinguishedFolderId}var d=Object(o.select)({folderTable:function(){return t.b.folderTable}})((function(e,n,r){var t=!!e&&e.ParentFolderId;if(!t)return!1;for(var o=r.folderTable.get(t.Id);o;){if(o.DistinguishedFolderId==n)return!0;if(!o.ParentFolderId)return!1;o=r.folderTable.get(o.ParentFolderId.Id)}return!1}));n.a=Object(o.select)({folderTable:function(){return t.b.folderTable}})((function(e,n,r){return function(e,n){return!!e&&e.DistinguishedFolderId==n}(e,n)||d(e,n,r)}))},7074:function(e,n,r){"use strict";r.d(n,"a",(function(){return d}));var t=r(957),o=r(1910),i=r(559);function d(e){var n=Object(t.a)(e);return n||(n=e),Object(o.a)().folderTable.get(n)?Object(o.a)().folderTable.get(n).FolderId:Object(i.a)({Id:n,__type:"FolderId:#Exchange"})}},7075:function(e,n,r){"use strict";r.d(n,"a",(function(){return o})),r.d(n,"c",(function(){return i})),r.d(n,"b",(function(){return d}));var t=r(3),o=Object(t.action)("FETCH_ARCHIVE_DUMPSTER_FOLDER"),i=Object(t.action)("SET_REPLICA_LIST",(function(e,n){return{folderId:e,replicaList:n}})),d=Object(t.action)("ON_FIND_DUMPSTER_FOLDER_SUCCESS",(function(e,n,r){return{rootFolder:e,folders:n,principalSMTPAddress:r}}))},7076:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(4349),o=r(2246);function i(e,n){var r=Object(o.a)(n),i=r&&r.get(e);return(null==i?void 0:i.loadingState)||t.a.Uninitialized}},7077:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(2246);function o(e,n){var r=Object(t.a)(n),o=r&&r.get(e);return(null==o?void 0:o.currentLoadedIndex)||0}},767:function(e,n,r){"use strict";r.d(n,"a",(function(){return o})),r.d(n,"b",(function(){return i}));var t=r(9),o=new t.a(new t.b((function(){return Promise.all([r.e(38),r.e(733)]).then(r.bind(null,1315))})),(function(e){return e.stashSessionDataResponses})),i=new t.a(new t.b((function(){return Promise.all([r.e(38),r.e(748)]).then(r.bind(null,1314))})),(function(e){return e.tryGetConversationRowsFromResponse}))},7829:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(7);r(7830),r(34);function o(e,n){if(!e||!n)return null;return t.c("{0}@{1}",e,n)}},7830:function(e,n,r){"use strict";r.d(n,"a",(function(){return o})),r.d(n,"b",(function(){return i}));var t=r(34);function o(e){if(!e)return null;var n=e,r=0;if(1==n[0]){if(!(n=d(n)))return null}else r=1;var o=n[++r]+(n[r+1]>>8);return function(e,n,r){if(n+r>e.length)return t.d("ConvertByteArrayToString: offset + count must not exceed byte array length."),null;for(var o="",i=n;i<n+r;i++)o+=String.fromCharCode(e[i]);return o}(n,r+=2,o)}function i(e){if(!e)return!1;try{for(var n=atob(e),r=new Uint8Array(n.length),t=0;t<n.length;t++)r[t]=n.charCodeAt(t);var o=0;return 1===r[0]?r=d(r):o=1,r&&1===r[o]}catch(e){return!1}}function d(e){var n=u(e,null);if(0==n)return t.d("rleDecompress : Invalid id"),null;var r=new Uint8Array(n);return u(e,r),r}function u(e,n){for(var r=0,o=1;o<e.length;++o)if(o==e.length-1||e[o]!=e[o+1])null!=n&&(n[r]=e[o]),r++;else{if(o==e.length-2)return t.d("decompressEx : Invalid id"),null;for(var i=e[o+2],d=0;d<i+2;d++)null!=n&&(n[r]=e[o]),r++;o+=2}return r}}}]);
//# sourceMappingURL=owa.27.js.map
self.scriptsLoaded['owa.27.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.27.js'] = (new Date()).getTime();