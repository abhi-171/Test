self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~TriageAction.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[779],{101:function(e,t,n){"use strict";var r=n(64),i={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,DaysInOneWeek:7,AllDaysOfWeek:[r.c.Sunday,r.c.Monday,r.c.Tuesday,r.c.Wednesday,r.c.Thursday,r.c.Friday,r.c.Saturday]};t.a=i},10237:function(e){e.exports=JSON.parse('{"u":"Z4b","s":"_4b","q":"$4b","m":"a5b","o":"b5b","t":"c5b","r":"d5b","p":"e5b","l":"f5b","n":"g5b","j":"h5b","f":"i5b","d":"j5b","b":"k5b","h":"l5b","i":"m5b","e":"n5b","a":"o5b","g":"p5b","c":"q5b","k":"r5b"}')},10238:function(e){e.exports=JSON.parse('{"a":"Y4b"}')},1087:function(e,t,n){"use strict";var r=n(0);function i(e){return e>0}var a=n(3),o=n(52),c=Object(a.action)("UNSUBSCRIBE_FROM_BRAND_SUBSCRIPTION",(function(e,t,n,r,i,a){return Object(o.c)({name:"UnsubscribeSubscription",customData:{unsubscribeSourceType:e}},{unsubscribeSourceType:e,smtpAddress:t,smtpIdentifier:n,unsubscribeSilentUris:r,unsubscribeHttpUri:i,completedCallback:a})})),u=Object(a.action)("AFTER_UNSUBSCRIBE",(function(e,t,n,r,i){return{smtpIdentifier:e,unsubscribeSourceType:t,responseType:n,debugMessage:r,completedCallback:i}})),s=n(7),d=n(178),l="ows/api/beta/subscriptions/{0}/unsubscribe";var b,f=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(d.c)(Object(s.c)(l,e),{unsubscribeSilentUris:t},null,!0)];case 1:return[2,n.sent()]}}))}))};!function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success"}(b||(b={}));var v=b,m=n(16),O=Object(a.createStore)("BrandSubscription",{subscriptions:new m.ObservableMap({}),unsubscribedSubscriptions:new m.ObservableMap({})})();function j(e){return e&&O.subscriptions.has(e.toLowerCase())?O.subscriptions.get(e.toLowerCase()):null}var p=Object(a.mutatorAction)("unsubscribeFromCache",(function(e){var t=Object(r.__assign)({},j(e));t?(O.subscriptions.delete(e.toLowerCase()),O.unsubscribedSubscriptions.set(e.toLowerCase(),t)):g()})),k=n(218);Object(a.orchestrator)(c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,o,c,s,d,l,b,m,O,j;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.unsubscribeSourceType,n=e.smtpAddress,a=e.smtpIdentifier,o=e.unsubscribeSilentUris,c=e.unsubscribeHttpUri,s=e.completedCallback,c&&0!==c.length||o&&0!==o.length?(o&&i(o.length)||!c?d="No unsubscribe URIs provided":(window.open(c,"_blank"),d="Opened unsubscribe URI in new tab"),[4,f(a,o)]):(d="No unsubscribe URIs or SilentURIs provided",l=v.Fail,u(a,t,l,d,s),[2,Promise.reject("No unsubscribe URIs or SilentURIs provided")]);case 1:return b=r.sent(),m=null,Object(k.a)(b.status)?(d="Unsubscribe service called successfully. "+d,l=v.Success,p(n),[3,4]):[3,2];case 2:return d="Unsubscribe service failed. "+d,l=v.Fail,[4,b.text().then((function(e){return e?JSON.parse(e):{}}))];case 3:O=r.sent(),(m=new Error("ResponseCode="+b.status+", ErrorMessage="+(null===(j=null==O?void 0:O.error)||void 0===j?void 0:j.message))).fetchErrorType="ServerFailure",r.label=4;case 4:return u(a,t,l,d,s),m?[2,Promise.reject(m)]:[2,Promise.resolve()]}}))}))}));Object(a.mutator)(u,(function(e){var t=e.unsubscribeSourceType,n=e.responseType,r=e.debugMessage,i=e.completedCallback;"BrandCard"===t&&i&&i(n===v.Success,r)}));var h=Object(a.mutatorAction)("populateSubscriptionStore",(function(e){e.subscriptions.forEach((function(e){var t;(null===(t=null==e?void 0:e.smtpInfo)||void 0===t?void 0:t.smtpAddress)&&O.subscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)})),e.unsubscribedSubscriptions.forEach((function(e){var t;(null===(t=null==e?void 0:e.smtpInfo)||void 0===t?void 0:t.smtpAddress)&&O.unsubscribedSubscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)}))})),y="ows/api/beta/subscriptions?orderBy=name, asc";var g=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(d.b)(e?y+"&noResolveBrand=true":y,void 0,!0)];case 1:return t=r.sent(),Object(k.a)(t.status)?[4,t.json()]:[3,3];case 2:return n=r.sent(),h(n),[2,n];case 3:return[2,null]}}))}))};n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return j})),n.d(t,"f",(function(){return i}))},12331:function(e){e.exports=JSON.parse('{"a":"M4b","b":"N4b","c":"O4b","d":"P4b"}')},12332:function(e){e.exports=JSON.parse('{"a":"A4b","b":"B4b","c":"C4b","d":"D4b"}')},12333:function(e){e.exports=JSON.parse('{"a":"p6b","b":"q6b"}')},12334:function(e){e.exports=JSON.parse('{"a":"j6b","b":"k6b"}')},12335:function(e){e.exports=JSON.parse('{"a":"l6b"}')},12336:function(e){e.exports=JSON.parse('{"b":"m6b","a":"n6b"}')},12337:function(e){e.exports=JSON.parse('{"a":"i6b"}')},12338:function(e){e.exports=JSON.parse('{"a":"L5b","b":"M5b"}')},12339:function(e){e.exports=JSON.parse('{"a":"t5b","c":"u5b","b":"v5b","d":"w5b"}')},12340:function(e){e.exports=JSON.parse('{"a":"U4b","b":"V4b","c":"W4b","d":"X4b"}')},12341:function(e){e.exports=JSON.parse('{"h":"Q5b","t":"R5b","p":"S5b","e":"T5b","l":"U5b","g":"V5b","s":"W5b","o":"X5b","d":"Y5b","k":"Z5b","f":"_5b","r":"$5b","n":"a6b","c":"b6b","j":"c6b","a":"d6b","q":"e6b","m":"f6b","b":"g6b","i":"h6b"}')},12342:function(e){e.exports=JSON.parse('{"b":"O5b","a":"P5b"}')},12343:function(e){e.exports=JSON.parse('{"b":"B5b","a":"C5b","c":"D5b","d":"E5b"}')},12344:function(e){e.exports=JSON.parse('{"b":"z5b","a":"A5b"}')},12345:function(e){e.exports=JSON.parse('{"b":"x5b","a":"y5b"}')},12346:function(e){e.exports=JSON.parse('{"b":"F5b","c":"G5b","e":"H5b","f":"I5b","a":"J5b","d":"K5b"}')},12347:function(e){e.exports=JSON.parse('{"a":"f4b","b":"g4b"}')},1249:function(e,t,n){"use strict";var r=n(469),i=n(701),a=n(0),o=n(12),c=n(382),u={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"};n.d(t,"a",(function(){return s}));var s=Object(r.a)(i.a,(function(e){var t,n,r,i,s,d,l,b,f,v,m,O,j,p,k,h,y,g,I=e.className,S=e.theme,w=e.reversed,_=e.checked,N=e.disabled,T=e.isUsingCustomLabelRender,C=e.indeterminate,E=S.semanticColors,A=S.effects,x=S.palette,F=S.fonts,R=Object(o.getGlobalClassNames)(u,S),M=E.inputForegroundChecked,V=x.neutralSecondary,D=x.neutralPrimary,P=E.inputBackgroundChecked,L=E.inputBackgroundChecked,B=E.disabledBodySubtext,U=E.inputBorderHovered,K=E.inputBackgroundCheckedHovered,W=E.inputBackgroundChecked,J=E.inputBackgroundCheckedHovered,H=E.inputBackgroundCheckedHovered,Q=E.inputTextHovered,q=E.disabledBodySubtext,G=E.bodyText,z=E.disabledText,X=[(t={content:'""',borderRadius:A.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:N?B:P,transitionProperty:"border-width, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)"},t[o.HighContrastSelector]={borderColor:"WindowText"},t)];return{root:[R.root,{position:"relative",display:"flex"},w&&"reversed",_&&"is-checked",!N&&"is-enabled",N&&"is-disabled",!N&&[!_&&(n={},n[":hover ."+R.checkbox]=(r={borderColor:U},r[o.HighContrastSelector]={borderColor:"Highlight"},r),n[":focus ."+R.checkbox]={borderColor:U},n[":hover ."+R.checkmark]=(i={color:V,opacity:"1"},i[o.HighContrastSelector]={color:"Highlight"},i),n),_&&!C&&(s={},s[":hover ."+R.checkbox]={background:J,borderColor:H},s[":focus ."+R.checkbox]={background:J,borderColor:H},s[o.HighContrastSelector]=(d={},d[":hover ."+R.checkbox]={background:"Highlight",borderColor:"Highlight"},d[":focus ."+R.checkbox]={background:"Highlight"},d[":focus:hover ."+R.checkbox]={background:"Highlight"},d[":focus:hover ."+R.checkmark]={color:"Window"},d[":hover ."+R.checkmark]={color:"Window"},d),s),C&&(l={},l[":hover ."+R.checkbox+", :hover ."+R.checkbox+":after"]=(b={borderColor:K},b[o.HighContrastSelector]={borderColor:"WindowText"},b),l[":focus ."+R.checkbox]={borderColor:K},l[":hover ."+R.checkmark]={opacity:"0"},l),(f={},f[":hover ."+R.text+", :focus ."+R.text]=(v={color:Q},v[o.HighContrastSelector]={color:N?"GrayText":"WindowText"},v),f)],I],input:(m={position:"absolute",background:"none",opacity:0},m["."+c.a+" &:focus + label::before"]=(O={outline:"1px solid "+S.palette.neutralSecondary,outlineOffset:"2px"},O[o.HighContrastSelector]={outline:"1px solid ActiveBorder"},O),m),label:[R.label,S.fonts.medium,{display:"flex",alignItems:T?"center":"flex-start",cursor:N?"default":"pointer",position:"relative",userSelect:"none"},w&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[R.checkbox,Object(a.__assign)((j={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:"20px",width:"20px",border:"1px solid "+D,borderRadius:A.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)",overflow:"hidden",":after":C?X:null},j[o.HighContrastSelector]={borderColor:"WindowText"},j),Object(o.getEdgeChromiumNoHighContrastAdjustSelector)()),C&&{borderColor:P},w?{marginLeft:4}:{marginRight:4},!N&&!C&&_&&(p={background:W,borderColor:L},p[o.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},p),N&&(k={borderColor:B},k[o.HighContrastSelector]={borderColor:"GrayText"},k),_&&N&&(h={background:q,borderColor:B},h[o.HighContrastSelector]={background:"Window"},h)],checkmark:[R.checkmark,(y={opacity:_?"1":"0",color:M},y[o.HighContrastSelector]={color:N?"GrayText":"Window",MsHighContrastAdjust:"none"},y)],text:[R.text,Object(a.__assign)((g={color:N?z:G,fontSize:F.medium.fontSize,lineHeight:"20px"},g[o.HighContrastSelector]={color:N?"GrayText":"WindowText"},g),Object(o.getEdgeChromiumNoHighContrastAdjustSelector)()),w?{marginRight:4}:{marginLeft:4}]}}),void 0,{scope:"Checkbox"})},140:function(e,t,n){"use strict";var r=n(505),i=n(5);function a(){var e=Object(i.Pb)(),t=Object(i.f)(Object(i.kc)(),12),n=Object(i.f)(Object(i.kc)(),18),r="Evening";return Object(i.y)(t,e)>0?r="Morning":Object(i.y)(n,e)>0&&(r="Afternoon"),r}function o(e,t,n){return Object(i.Mb)(e,t,n)}var c=n(101);function u(e,t){return function(e){var t=e%c.a.SecondsInOneMinute;return e-t+c.a.SecondsInOneMinute}(Object(i.y)(e,t))}var s=15*c.a.SecondsInOneMinute;function d(e,t){return u(e,t)<=s}var l=n(64),b=function(e,t,n){switch(n){case l.d.FirstFullWeek:return f(e,t,c.a.DaysInOneWeek);case l.d.FirstFourDayWeek:return f(e,t,4);default:return function(e,t){var n=v(e)-1,r=(Object(i.nb)(e)-n%c.a.DaysInOneWeek-t+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek;return Math.floor((n+r)/c.a.DaysInOneWeek+1)}(e,t)}};function f(e,t,n){var r=v(e)-1,a=Object(i.nb)(e)-r%c.a.DaysInOneWeek,o=v(Object(i.lc)(Object(i.Cb)(e)-1,l.e.December,31))-1,u=(t-a+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek;0!==u&&u>=n&&(u-=c.a.DaysInOneWeek);var s=r-u;return s<0&&(0!==(u=(t-(a-=o%c.a.DaysInOneWeek)+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek)&&u+1>=n&&(u-=c.a.DaysInOneWeek),s=o-u),Math.floor(s/c.a.DaysInOneWeek+1)}function v(e){for(var t=Object(i.xb)(e),n=Object(i.Cb)(e),r=0,a=0;a<t;a++)r+=m(a+1,n);return r+=Object(i.lb)(e)}function m(e,t){return Object(i.ob)(Object(i.lc)(t,e,0))}function O(e){for(var t=[],n=0;n<c.a.DaysInOneWeek;n++)e&1<<n&&t.push(n);return t}function j(e,t,n){for(var a=[],o=n.sort((function(e,t){var n=Object(i.p)(e.start,t.start);return 0!==n?n:Object(i.p)(e.end,t.end)})),c=Object(i.Wb)(e),u=0;Object(i.p)(c,t)<0&&u<o.length;){var s={start:c,end:Object(i.A)(c)},d=Object(r.h)(o[u],s,!1);d<=0?(0===d&&a.push(c),c=Object(i.e)(c,1)):u++}return a}n.d(t,"h",(function(){return r.g})),n.d(t,"g",(function(){return r.f})),n.d(t,"n",(function(){return r.k})),n.d(t,"d",(function(){return r.c})),n.d(t,"e",(function(){return r.d})),n.d(t,"s",(function(){return r.n})),n.d(t,"o",(function(){return r.l})),n.d(t,"p",(function(){return r.m})),n.d(t,"b",(function(){return r.a})),n.d(t,"j",(function(){return r.h})),n.d(t,"c",(function(){return r.b})),n.d(t,"f",(function(){return r.e})),n.d(t,"l",(function(){return r.j})),n.d(t,"k",(function(){return r.i})),n.d(t,"t",(function(){return r.o})),n.d(t,"w",(function(){return a})),n.d(t,"u",(function(){return o})),n.d(t,"v",(function(){return d})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return b})),n.d(t,"a",(function(){return c.a})),n.d(t,"i",(function(){return O})),n.d(t,"m",(function(){return j}))},1708:function(e,t,n){"use strict";n.d(t,"k",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return b})),n.d(t,"l",(function(){return f})),n.d(t,"n",(function(){return v})),n.d(t,"h",(function(){return m})),n.d(t,"f",(function(){return O})),n.d(t,"g",(function(){return j})),n.d(t,"e",(function(){return p})),n.d(t,"m",(function(){return k})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return y}));var r=n(44),i=n(2056),a=n(1973),o=n(2057),c=n(2532),u=new r.c((function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(15),n.e(17),n.e(20),n.e(21),n.e(22),n.e(26),n.e(25),n.e(28),n.e(29),n.e(31),n.e(32),n.e(33),n.e(42),n.e(41),n.e(44),n.e(45),n.e(48),n.e(842)]).then(n.bind(null,3864))})),s=Object(r.d)(u,(function(e){return e.SearchHeaderFirstRowContent})),d=Object(r.d)(u,(function(e){return e.SearchFiltersContainer})),l=Object(r.d)(u,(function(e){return e.AdvancedSearchWrapper})),b=Object(r.d)(u,(function(e){return e.FolderScopePicker})),f=new r.b(u,(function(e){return e.setStaticSearchScopeData})),v=new r.b(u,(function(e){return e.startSearchWithCategory})),m=new r.a(u,(function(e){return e.findEmailFromSender})),O=(new r.b(u,(function(e){return e.initializeLivePersonaCard})),new r.b(u,(function(e){return e.personaControlStore})),new r.b(u,(function(e){return e.createFallbackPersonaSearchTableQuery}))),j=new r.b(u,(function(e){return e.createFallbackPrivateDistributionListSearchTableQuery})),p=new r.b(u,(function(e){return e.createFallbackCategorySearchTableQuery})),k=new r.b(u,(function(e){return e.shouldShowInScopeSelector}));Object(r.f)(i.a,u,(function(e){return e.getSuggestionsOrchestrator})),Object(r.f)(a.a,u,(function(e){return e.searchSessionStartedOrchestrator})),Object(r.f)(o.a,u,(function(e){return e.startSearchOrchestrator}),{captureBundleTime:!0}),Object(r.f)(c.a,u,(function(e){return e.startAnswerSearchSessionOrchestrator}));var h=new r.b(u,(function(e){return e.getNaturalLanguageGhostText})),y=new r.a(u,(function(e){return e.initializeSearch}))},1713:function(e,t,n){"use strict";var r=n(0),i=n(16),a=n(3),o=n(2724);function c(e){return Math.floor(Math.random()*e+1)}var u=n(2725);n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return f}));var s=4,d=8,l={toDate:null,fromDate:null,includeAttachments:!1,initialSearchScope:null,isSearchHistoryDirty:!1,isAnswerInitialized:!1,isAnswerLocalizationCompleted:!1,isUnread:!1,previousNode:null,searchNumber:0,staticSearchScope:null,staticSearchScopeList:null,shouldShowAdvancedSearch:!1,shouldShowTimeFilterCallout:!1,advancedSearchViewState:Object(o.a)(),initialAdvancedSearchViewState:Object(o.a)(),legacySuggestions:new i.ObservableMap({}),recipientForPersonalizedGhostTextIndex:c(u.a-1),generalizedGhostTextBankIndex:c(s-1),personalizedGhostTextBankIndex:c(d-1),usePersonalGhostText:!1,isAnswerAvailable:!1},b=Object(r.__assign)({},l),f=Object(a.createStore)("mailSearchStore",b),v=f();t.c=v},1730:function(e,t,n){"use strict";n.d(t,"q",(function(){return a})),n.d(t,"z",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"u",(function(){return u})),n.d(t,"x",(function(){return s})),n.d(t,"y",(function(){return d})),n.d(t,"w",(function(){return l})),n.d(t,"v",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return v})),n.d(t,"h",(function(){return m})),n.d(t,"m",(function(){return O})),n.d(t,"A",(function(){return j})),n.d(t,"r",(function(){return p})),n.d(t,"j",(function(){return k})),n.d(t,"s",(function(){return h})),n.d(t,"t",(function(){return y})),n.d(t,"a",(function(){return g})),n.d(t,"l",(function(){return I})),n.d(t,"p",(function(){return S})),n.d(t,"i",(function(){return w})),n.d(t,"b",(function(){return _})),n.d(t,"n",(function(){return N})),n.d(t,"c",(function(){return T})),n.d(t,"g",(function(){return C})),n.d(t,"o",(function(){return E})),n.d(t,"k",(function(){return A}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(6),n.e(8),n.e(20),n.e(21),n.e(25),n.e(27),n.e(36),n.e(61),n.e(82),n.e(116),n.e(144),n.e(201),n.e(200),n.e(475)]).then(n.bind(null,3363))})),a=new r.b(i,(function(e){return e.removeExtensibilityNotification})),o=new r.b(i,(function(e){return e.updatePersistentNotifications})),c=new r.b(i,(function(e){return e.closeTaskPaneAddinCommand})),u=new r.b(i,(function(e){return e.triggerAppointmentTimeChangedEvent})),s=new r.b(i,(function(e){return e.triggerRecipientsChangedEvent})),d=new r.b(i,(function(e){return e.triggerRecurrenceChangedEvent})),l=new r.b(i,(function(e){return e.triggerLocationsChangedEvent})),b=new r.b(i,(function(e){return e.triggerAttachmentsChangedEvent})),f=new r.b(i,(function(e){return e.deinitializeAddinsForItem})),v=new r.b(i,(function(e){return e.initializeAddinsForItem})),m=new r.a(i,(function(e){return e.initializeExtensibilityContext})),O=new r.b(i,(function(e){return e.onHostItemChanged})),j=new r.b(i,(function(e){return e.whenItemHasContextualAddinKeywords})),p=new r.b(i,(function(e){return e.runContextualEvaluationAndUpdate})),k=new r.b(i,(function(e){return e.launchTranslateCommand})),h=new r.b(i,(function(e){return e.setPersistedAddin})),y=new r.b(i,(function(e){return e.shouldForceOnSendCompliantBehavior})),g=(Object(r.d)(i,(function(e){return e.AddinBarView})),Object(r.d)(i,(function(e){return e.TaskPaneCollection}))),I=new r.b(i,(function(e){return e.onComposeClose})),S=new r.b(i,(function(e){return e.openContextualCallout})),w=new r.b(i,(function(e){return e.launchAddinCommand})),_=new r.b(i,(function(e){return e.observeAddinCommandSurfaceItems})),N=new r.b(i,(function(e){return e.onItemNavigation})),T=new r.b(i,(function(e){return e.allowItemSendEvent})),C=new r.a(i,(function(e){return e.ExecuteEntryPoint})),E=new r.a(i,(function(e){return e.onLaunchEventTriggered})),A=new r.a(i,(function(e){return e.logAppTeachingUICalloutTelemetry}))},1743:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return c}));var r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",a="ItemIdAttachment:#Exchange",o="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},1777:function(e,t,n){"use strict";n.d(t,"q",(function(){return d})),n.d(t,"t",(function(){return l})),n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return f})),n.d(t,"i",(function(){return v})),n.d(t,"o",(function(){return m})),n.d(t,"b",(function(){return O})),n.d(t,"m",(function(){return j})),n.d(t,"f",(function(){return p})),n.d(t,"p",(function(){return k})),n.d(t,"s",(function(){return h})),n.d(t,"r",(function(){return y})),n.d(t,"g",(function(){return g})),n.d(t,"j",(function(){return I})),n.d(t,"k",(function(){return S})),n.d(t,"n",(function(){return w})),n.d(t,"d",(function(){return _})),n.d(t,"c",(function(){return N})),n.d(t,"h",(function(){return T})),n.d(t,"l",(function(){return C}));var r=n(0),i=n(52),a=n(1633),o=n(1640),c=n(3),u=n(1710),s=n(25),d=Object(c.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(E(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(c.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(E(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),b=Object(c.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,i){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:i}})),f=Object(c.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,t){return{rowKey:e,latestItemIdsInForks:t}})),v=Object(c.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),m=Object(c.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),O=Object(c.action)("ITEM_PART_SELECTED",(function(e,t,n,r,i){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:i}})),j=Object(c.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),p=Object(c.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),k=Object(c.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,i){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:i}})),h=Object(c.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),y=Object(c.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),g=Object(c.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),I=Object(c.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),S=Object(c.action)("RESET_SELECTION",(function(e){return{tableView:e}})),w=Object(c.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(i.c)(E(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),_=Object(c.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),N=Object(c.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),T=Object(c.action)("RESET_BUS_STOP_STATE_MAP"),C=Object(c.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function E(e,t,n,i){return{name:function(e,t,n,i){return!(function(e){return e===o.b.MailListItemRichPreview||e===o.b.KeyboardShiftEnter||e===o.b.MailListItemBodyDoubleClick}(e)||Object(u.c)()&&!function(e){var t;return e===o.b.KeyboardEnter||e===o.b.MailListItemBody||e===o.b.RouteHandler||e===o.b.CommandBarArrows||e===o.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,i){if(Object(u.c)())return!1;if(e===o.b.KeyboardUpDown){var c=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==c&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return i===a.d.Next?s===c+1||s===t.rowKeys.length-1&&c===t.rowKeys.length-1:s===c-1||0===s&&0===c}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,i))}(e,t,n,i)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},178:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return d}));var r=n(44),i=new r.c((function(){return Promise.all([n.e(3),n.e(23),n.e(877)]).then(n.bind(null,1247))})),a=new r.a(i,(function(e){return e.makePostRequest})).importAndExecute,o=new r.a(i,(function(e){return e.makePatchRequest})).importAndExecute,c=new r.a(i,(function(e){return e.makePutRequest})).importAndExecute,u=new r.a(i,(function(e){return e.makeGetRequest})).importAndExecute,s=new r.a(i,(function(e){return e.makeDeleteRequest})).importAndExecute,d=new r.a(i,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},1786:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r,i=n(268),a=n(85);function o(){var e,t,n=d();return s()&&n?r.ToDo:(t=Object(a.h)(),(null===(e=t.SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)||n?r.None:r.LegacyTasks)}function c(){return s()&&d()}function u(){return s()&&d(!0)}function s(){var e,t,n=Object(a.h)(),r=Object(i.a)("todoIsExplicitLogon")&&(null===(e=n.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon),o=null===(t=n.SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return!r&&!o}function d(e){var t=Object(a.h)(),n=t.UserOptions,r=t.PolicySettings;return!!((null==n?void 0:n.ReactOptinSettings)&&(n.ReactOptinSettings.TasksGraduatedFromBeta||n.ReactOptinSettings.TasksEnabled&&(e||function(e){var t;return(null===(t=null==e?void 0:e.ReactOptinSettings)||void 0===t?void 0:t.TasksShouldUseSharedToggle)?1!==e.ClientTypeOptInState:1!==e.TasksClientTypeOptInState}(n))&&function(e){if(e&&!1===e.OutlookBetaToggleEnabled)return!1;return!0}(r))&&null!==n.ReactOptinSettings.TasksRedirectUrl)}!function(e){e[e.None=0]="None",e[e.LegacyTasks=1]="LegacyTasks",e[e.ToDo=2]="ToDo"}(r||(r={}))},1793:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1743);function i(e){return(e.__type||e.OwsTypeName)===r.e}},1802:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return d}));var r=n(3),i=Object(r.action)("CLEAR_SEARCH_SCOPE",(function(e,t,n){return{actionSource:e,shouldStartSearch:t,searchScopeKind:n}})),a=Object(r.action)("LOAD_MESSAGE_SUGGESTION_INTO_TABLE",(function(e,t,n,r,i,a){return{actionSource:e,row:t,searchTableQuery:n,referenceId:r,traceId:i,itemPartId:a}})),o=Object(r.action)("LOAD_TABLE_VIEW_FROM_SEARCH_TABLE_QUERY",(function(e,t,n){return{searchTableQuery:e,searchEndToEndPerformanceDatapoint:t,actionSource:n}})),c=Object(r.action)("SET_STATIC_SEARCH_SCOPE",(function(e){return{searchScope:e}})),u=Object(r.action)("START_SEARCH_WITH_CATEGORY",(function(e,t){return{actionSource:e,categoryName:t}})),s=Object(r.action)("FIND_EMAIL_FROM_SENDER_CLICKED",(function(e,t){return{senderName:e,senderEmail:t}})),d=Object(r.action)("ON_ANSWER_RENDERED")},1829:function(e,t,n){"use strict";var r=n(44),i={sequentialIndex:"0",nonSequentialIndex:"-1"};n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return i}));var a=new r.c((function(){return n.e(830).then(n.bind(null,17475))})),o=new r.a(a,(function(e){return e.registerComponent})),c=new r.a(a,(function(e){return e.resetFocus})),u=new r.a(a,(function(e){return e.setFocusToSynchronous}))},1857:function(e,t,n){"use strict";var r=n(2032),i=n(44),a=n(1862);function o(){var e=Object(a.a)();return{isFullOptionsShown:e.isFullOptionsShown,areAllAllowedSubCategoriesLoaded:e.areAllAllowedSubCategoriesLoaded,currentCategoryKey:e.currentCategoryKey,currentSubCategoryKey:e.currentSubCategoryKey,currentOptionKey:e.currentOptionKey}}n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return o}));var c=new i.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(15),n.e(17),n.e(20),n.e(21),n.e(22),n.e(24),n.e(28),n.e(29),n.e(27),n.e(33),n.e(36),n.e(45),n.e(48),n.e(863)]).then(n.bind(null,17340))})),u=new i.a(c,(function(e){return e.mountAndShowFullOptions})),s=new i.b(c,(function(e){return e.hideFullOptions})),d=new i.b(c,(function(e){return e.confirmDirtyOptionsAndPerformAction})),l=new i.b(c,(function(e){return e.exitOptionsFullPage})),b=Object(i.d)(c,(function(e){return e.QuickOptions}));Object(i.f)(r.a,c,(function(e){return e.mountFullOptionsOrchestrator}))},1860:function(e,t,n){"use strict";var r=n(0),i=n(2302),a=n(3);var o=Object(a.mutatorAction)("removeInfoBarMessages",(function(e,t){e&&(Array.isArray(t)?t:t?[t]:e.infoBarIds?Object(r.__spread)(e.infoBarIds):[]).forEach((function(t){return function(e,t){var n=e.infoBarIds&&e.infoBarIds.indexOf(t);n>=0&&e.infoBarIds.splice(n,1);var r=e.infoBarHostKey;i.b[r]&&(delete i.b[r][t],0===Object.keys(i.b[r]).length&&delete i.b[r])}(e,t)}))}));t.a=o},1862:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),i=n(16),a=Object(r.createStore)("optionsViewState",{isFullOptionsShown:!1,areAllAllowedSubCategoriesLoaded:!1,isSaving:!1,currentCategoryKey:null,currentSubCategoryKey:null,subCategoryLoadState:new i.ObservableMap,currentOptionKey:null,allowedOptions:[]})},1878:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1938:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",(function(e,t,n){return{itemContexts:e,parentFolderId:t,actionType:n}}))},1970:function(e,t,n){"use strict";var r=n(44),i=n(2294),a=n(1713),o=n(1802);function c(e){var t=e.tableQuery;return 0===t.type?t.folderId:function(e){if(1!=e.type)return!1;var t=e.searchScope;return["PrimaryMailbox","ArchiveMailbox","SharedFolders"].indexOf(t.kind)>-1}(t)?t.searchScope.folderId:null}var u=n(2247),s=n(2248),d=n(1708);n.d(t,"a",(function(){return b})),n.d(t,"m",(function(){return f})),n.d(t,"c",(function(){return i.b})),n.d(t,"q",(function(){return a.c})),n.d(t,"i",(function(){return a.e})),n.d(t,"f",(function(){return o.a})),n.d(t,"s",(function(){return o.f})),n.d(t,"r",(function(){return o.e})),n.d(t,"g",(function(){return c})),n.d(t,"j",(function(){return u.a})),n.d(t,"h",(function(){return s.a})),n.d(t,"n",(function(){return d.k})),n.d(t,"e",(function(){return d.d})),n.d(t,"d",(function(){return d.c})),n.d(t,"b",(function(){return d.b})),n.d(t,"o",(function(){return d.l})),n.d(t,"p",(function(){return d.n})),n.d(t,"k",(function(){return d.h})),n.d(t,"l",(function(){return d.j}));var l=new r.c((function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(15),n.e(17),n.e(20),n.e(21),n.e(22),n.e(26),n.e(25),n.e(28),n.e(29),n.e(31),n.e(32),n.e(33),n.e(42),n.e(41),n.e(44),n.e(45),n.e(48),n.e(842)]).then(n.bind(null,3864))})),b=Object(r.d)(l,(function(e){return e.AnswersContainer})),f=new r.a(l,(function(e){return e.initializeAndWarmupAnswers}))},1973:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("SEARCH_SESSION_STARTED",(function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}}))},2015:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},2032:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("mountFullOptions",(function(e,t,n){return{category:e,subcategory:t,option:n}}))},2035:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(i||(i={}))},2047:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(function(e,t,n){return{tableView:e,markAsRead:t,rowIdsToExclude:n}}))},2049:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},2056:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),i=n(52),a=Object(r.action)("GET_SUGGESTIONS",(function(e){return Object(i.c)({name:"Search_SuggestionsE2E"},{scenarioId:e})}))},2057:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("START_SEARCH",(function(e,t,n,r,i,a){return void 0===n&&(n=!1),void 0===r&&(r=[]),void 0===a&&(a="All"),{actionSource:e,scenarioId:t,explicitSearch:n,connectedAccountInfo:r,searchProvider:i,filter:a}}))},2059:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("DELETE_CONVERSATION_STORE_UPDATE",(function(e,t,n){return{conversationIds:e,tableView:t,actionType:n}}))},2080:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1698),i=n(40),a=n(2048);function o(e){return Object(i.i)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedItemReadingPaneViewStates.get(e||Object(a.a)()):Object(r.b)().itemReadingPaneViewState}},2159:function(e,t,n){"use strict";var r=n(28),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return a}))},2163:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(40);function i(){return Object(r.i)("rp-linkedInViewProfile")||Object(r.i)("rp-linkedInViewProfileV1_1")}},2164:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="displaylinkedindataprebind"},2168:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},2171:function(e){e.exports=JSON.parse('{"a":"Qea"}')},218:function(e,t,n){"use strict";var r=n(693);n.d(t,"a",(function(){return r.a}))},2185:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},2201:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",(function(e,t,n,r){return{conversationIds:e,tableViewId:t,isReadValue:n,isExplicit:r}}))},2202:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",(function(e,t,n,r){return{itemIds:e,isReadValue:t,isExplicit:n,tableViewId:r}}))},2247:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(40),i=n(2357),a=n(430);function o(){return Object(i.a)()&&(Object(r.i)("sea-fetchPeople2")||Object(r.i)("sea-fetchEvents2")||Object(r.i)("sea-calendarTriggerControl2")||Object(r.i)("sea-fetchFlights2")||Object(r.i)("sea-flightTriggerControl2")||Object(r.i)("sea-fetchFiles4")||Object(r.i)("sea-fileTriggerControl4")||Object(r.i)("sea-peopleTriggerControl2"))||Object(i.a)()&&Object(a.a)()&&(Object(r.i)("sea-fetchBookmarks2")||Object(r.i)("sea-bookmarkTriggerControl2")||Object(r.i)("sea-fetchAcronyms2")||Object(r.i)("sea-fetchLinks2")||Object(r.i)("sea-linkTriggerControl2")||Object(r.i)("sea-acronymTriggerControl2"))}},2248:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1713),i=n(40),a=n(2357),o=n(85),c=n(1644),u=n(1673);function s(){var e=Object(r.e)().staticSearchScope,t=null==e?void 0:e.kind;if(Object(o.h)().SessionSettings.IsExplicitLogon)return"ArchiveMailbox"===t?2:Object(i.i)("sea-3s-explicitLogon")&&Object(a.a)()?0:1;if("PrimaryMailbox"===t)return Object(a.a)()?0:1;if("ArchiveMailbox"===t){var n=Object(u.a)(e.folderId);return Object(i.i)("sea-archive-mailbox-3S")&&Object(a.a)()&&n==c.d?0:1}return"Group"===t?1:"SharedFolders"===t?2:null}},2268:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateInternetMessageId",(function(e,t,n){return{conversationId:e,itemId:t,internetMessageId:n}}))},2294:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(2035),i=[r.b.File,r.b.People,r.b.Keywords],a=[r.b.File,r.b.People,r.b.Keywords,r.b.Message,r.b.Event,r.b.Category,r.b.TrySuggestion,r.b.Setting]},2302:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r={};function i(e,t){var n,i=e.infoBarHostKey;return null===(n=r[i])||void 0===n?void 0:n[t]}},2323:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3068);function i(e,t){return e.map((function(e){return Object(r.getInstrumentationContext)(e,t)})).filter((function(e){return e}))}},2325:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o}));var r=n(3),i=Object(r.action)("CONVERSATION_READY_TO_LOAD",(function(e,t){return{conversationId:e,nodeIdCollectionChange:t}})),a=Object(r.action)("UPDATE_ATTACHMENTS"),o=Object(r.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(function(e,t){return{conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:t}}))},2357:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25);function i(){return Object(r.a)().SessionSettings.IsSubstrateSearchServiceAvailable}},2418:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateMailtips",(function(e,t,n){return{composeId:e,fromEmailAddress:t,recipients:n}}))},2439:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(function(e,t,n){return{conversationIds:e,flagType:t,tableViewId:n}}))},2440:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("initializeExtendedCardForItemReadingPane",(function(e,t){return{itemReadingPaneViewState:e,loadedItem:t}}))},2498:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("onMailTipRetrieved",(function(e,t){return{composeId:e,fromAddress:t}}))},2512:function(e,t,n){"use strict";var r=n(197),i=n(28),a=n(0);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetMailTipsJsonRequest:#Exchange"},n)),Object(i.a)("GetMailTips",e,t)}var c=n(347),u=n(214);function s(e,t){var n,i=Object(c.a)(Object(u.d)(e));return o({Header:Object(r.b)(),Body:(n={MailTipsRequested:1,SendingAs:{EmailAddress:e},Recipients:t.map((function(e){return{EmailAddress:e}}))},Object(a.__assign)({__type:"GetMailTipsRequest:#Exchange"},n))},i).then((function(e){return(null==e?void 0:e.Body)&&"Success"==e.Body.ResponseClass?e.Body:null})).catch((function(e){return Promise.resolve(null)}))}n.d(t,"a",(function(){return s}))},2517:function(e,t,n){"use strict";var r;!function(e){e.CustomMailTip="CustomMailTip",e.DeliveryRestricted="DeliveryRestricted",e.ExternalMemberCount="ExternalMemberCount",e.GuestMailTipStatus="GuestMailTipStatus",e.IsModerated="IsModerated",e.MailboxFull="MailboxFull",e.MaxMessageSize="MaxMessageSize",e.OutOfOffice="OutOfOffice",e.PreferAccessibleContent="PreferAccessibleContent",e.RecipientAddress="RecipientAddress",e.TotalMemberCount="TotalMemberCount"}(r||(r={}));var i=r,a=n(2632);n.d(t,"a",(function(){return u}));var o=/<!--((.|\n)*?)-->/gi,c=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t};function u(e){if(!e)return null;var t=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes;return c(t).reduce((function(e,t){switch(t.localName){case i.RecipientAddress:t.childNodes.length>1&&(e.RecipientAddress=t.childNodes[1].textContent);break;case i.MailboxFull:e.MailboxFull="true"===t.textContent;break;case i.IsModerated:e.IsModerated="true"===t.textContent;break;case i.TotalMemberCount:e.TotalMemberCount=parseInt(t.textContent)||0;break;case i.ExternalMemberCount:e.ExternalMemberCount=parseInt(t.textContent)||0;break;case i.MaxMessageSize:e.MaxMessageSize=parseInt(t.textContent)||0;break;case i.DeliveryRestricted:e.DeliveryRestricted="true"===t.textContent;break;case i.PreferAccessibleContent:e.PreferAccessibleContent="true"===t.textContent;break;case i.OutOfOffice:e.OutOfOffice=s(t);break;case i.CustomMailTip:e.CustomMailTip=b(t);break;case i.GuestMailTipStatus:e.GuestStatus=l(t.textContent)}return e}),{})}var s=function(e){return e.childNodes?b(c(e.childNodes).filter((function(e){return"ReplyBody"===e.localName}))[0]):""},d=function(e){return e.replace(o,"")},l=function(e){var t=e.split(" "),n=a.a.None;return t.map((function(e){n|=a.a[e]})),n};function b(e){var t;if(e){var n=d(e.textContent).replace(/<\/a>/gi,"</a> "),r=(new DOMParser).parseFromString(n,"text/html");if((null===(t=null==r?void 0:r.childNodes)||void 0===t?void 0:t.length)&&r.childNodes[0].textContent)return r.childNodes[0].textContent.replace(/\s\s+/g," ").trim()}return""}},2532:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("startAnswersSearchSession",(function(e){return{scenarioId:e}}))},2632:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.IsCalculated=1]="IsCalculated",e[e.GuestsEnabled=2]="GuestsEnabled",e[e.GroupHasGuests=4]="GroupHasGuests"}(r||(r={}))},2701:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyConversationActionRequest:#Exchange"},e)}},2702:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ConversationAction:#Exchange"},e)}},2724:function(e,t,n){"use strict";function r(){return{selectedSearchScope:null,subjectFieldText:"",keywordsFieldText:"",fromDate:null,toDate:null,hasAttachments:null,fromPeopleSuggestions:[],toPeopleSuggestions:[],ccPeopleSuggestions:[]}}n.d(t,"a",(function(){return r}))},2725:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=10},2726:function(e,t,n){"use strict";var r=n(3183);t.a=function(e){var t=function(e){var t;return(null===(t=null==e?void 0:e.Attachments)||void 0===t?void 0:t.length)&&e.Attachments[0]}(e);return Object(r.a)(t)?t:null}},2767:function(e){e.exports=JSON.parse('{"a":"jga"}')},2779:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},2830:function(e,t,n){"use strict";var r=n(28),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"ApplyConversationActionJsonRequest:#Exchange"},n)),Object(r.a)("ApplyConversationAction",e,t)}n.d(t,"a",(function(){return a}))},2839:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("EMPTY_FOLDER_STORE_UPDATE",(function(e,t,n,r){return{folder:e,clientLastSyncTime:t,deletedItemsFolderId:n,rowKeysToExclude:r}}))},3011:function(e,t,n){"use strict";function r(e){var t=e?e.RightsManagementLicenseData:null,n={ReplyAllowed:!0,ReplyAllAllowed:!0,ForwardAllowed:!0,PrintAllowed:!0,CopyAllowed:!0};!t||t.RightsManagedMessageDecryptionStatus&&0!=t.RightsManagedMessageDecryptionStatus||(n={ReplyAllowed:t.ReplyAllowed,ReplyAllAllowed:t.ReplyAllAllowed,ForwardAllowed:t.ForwardAllowed,PrintAllowed:t.PrintAllowed,CopyAllowed:t.ExtractAllowed});var r=e,i=null==r?void 0:r.DoNotForwardMeeting;return n.ForwardAllowed=n.ForwardAllowed&&!i,n}n.d(t,"a",(function(){return r}))},3052:function(e,t,n){"use strict";var r=n(2517);n.d(t,"a",(function(){return r.a}));var i=n(2512);n.d(t,"b",(function(){return i.a}));var a=n(2418);n.d(t,"d",(function(){return a.a}));var o=n(2498);n.d(t,"c",(function(){return o.a}))},3053:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1638),i=n(3182);function a(e,t){return t?r.a.items.get(e):Object(i.b)(e)}},3183:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1797),i=function(e,t){return e.substring(0,t.length)===t},a=function(e,t){return e.substring(e.length-t.length)===t},o=function(e){return e.ContentType&&(i(e.ContentType,r.v)||i(e.ContentType,r.l))},c=function(e){return e.ContentType&&e.ContentType===r.j};function u(e){return(null==e?void 0:e.Name)&&a(e.Name,r.t)&&(o(e)||c(e))}},3273:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("UPDATE_FOLDER_COUNTS",(function(e,t,n,r){return{unreadCount:e,totalCount:t,folderId:n,isDeltaChange:r}}))},3345:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(3),i=Object(r.createStore)("mruFolderCache",{mruFolders:[],isInitialized:!1}),a=i();t.a=a},347:function(e,t,n){"use strict";var r=n(0);function i(e,t){return e?Object(r.__assign)({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return i}))},3493:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1878),i=n(785),a=n(2049);function o(e,t){var n;return Object(a.a)({Path:Object(i.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},3568:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var r=n(44),i=new r.c((function(){return n.e(959).then(n.bind(null,7722))})),a=new r.a(i,(function(e){return e.getAccountInformation})),o=new r.b(i,(function(e){return e.getStore})),c=new r.b(i,(function(e){return e.tryValidateDumpsterQuota}))},3764:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"MoveItemRequest:#Exchange"},e)}},3813:function(e,t,n){"use strict";var r=n(4547),i=n(3),a={sweepDestinationFolderId:null,isSweepDialogShown:!1,sweepOptionType:r.a.All,sweepRequestStatus:0};t.a=Object(i.createStore)("sweepStore",a)()},3892:function(e,t,n){"use strict";var r=n(28),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"MoveItemJsonRequest:#Exchange"},n)),Object(r.a)("MoveItem",e,t)}n.d(t,"a",(function(){return a}))},3923:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r="report",i="report.ipm.note.ndr",a="report.ipm.note.dr";function o(e){return!!e&&(e.ItemClass&&0==e.ItemClass.toLowerCase().indexOf(r))}function c(e){return!!e&&(e.ItemClass&&0==e.ItemClass.toLowerCase().indexOf(i))}function u(e){return!!e&&(e.ItemClass&&0==e.ItemClass.toLowerCase().indexOf(a))}},3924:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2726),i=n(1850);function a(e,t){return Object(i.a)(e)&&t&&!!Object(r.a)(e)}},4050:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2476);function i(e,t){var n={};return e.forEach((function(e){var i,a=null===(i=Object(r.a)(e,t))||void 0===i?void 0:i.itemIds;a&&a.forEach((function(e){n[e]||(n[e]=!0)}))})),Object.keys(n)}},4124:function(e,t,n){"use strict";var r=n(44),i=n(28);function a(){return Object(i.a)("GetFolderMruConfiguration",{},e).then((function(e){return e}));var e}var o=n(3345),c=n(957),u=n(188),s=Object(u.action)("getMoveToMruList")((function(){o.a.isInitialized||a().then((function(e){return function(e){if(null==e.FolderMruEntries||0==e.FolderMruEntries.length)o.a.mruFolders.push(Object(c.a)("inbox")),o.a.mruFolders.push(Object(c.a)("deleteditems")),o.a.mruFolders.push(Object(c.a)("archive"));else for(var t=0;t<e.FolderMruEntries.length;t++){var n=e.FolderMruEntries[t].EwsFolderIdEntry;o.a.mruFolders.push(n)}o.a.isInitialized=!0}(e)}))}));n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return s}));var d=new r.c((function(){return n.e(852).then(n.bind(null,17279))})),l=new r.a(d,(function(e){return e.addFolderIdToMoveToMruList})),b=new r.a(d,(function(e){return e.removeFolderIdFromMoveToMruList}))},4158:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3923),i=n(3011),a=n(3924);function o(e,t){var n=Object(i.a)(e),o=Object(a.a)(e,t),c=Object(r.c)(e);return[!n.ReplyAllowed||c||o,!n.ReplyAllAllowed||c||o,!n.ForwardAllowed||o]}},4528:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28);function i(e){return Object(r.a)("GetMailboxJunkEmailConfiguration",{},e)}},4547:function(e,t,n){"use strict";var r;!function(e){e[e.All=0]="All",e[e.AllCurrentAndFuture=1]="AllCurrentAndFuture",e[e.AllButOne=2]="AllButOne",e[e.AllOlderThan=3]="AllOlderThan"}(r||(r={})),t.a=r},4902:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(34),i=n(25);function a(e){var t=Object(i.a)().SessionSettings,n=t.UserEmailAddress;return n?!e||(e.toLowerCase()==n.toLowerCase()||t.UserProxyAddresses&&t.UserProxyAddresses.some((function(t){return t.toLowerCase()==e}))):(r.d("User email address from session data is null."),!1)}},505:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"n",(function(){return l})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return f})),n.d(t,"a",(function(){return v})),n.d(t,"h",(function(){return m})),n.d(t,"b",(function(){return O})),n.d(t,"e",(function(){return j})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return k})),n.d(t,"o",(function(){return h}));var r=n(101),i=n(64),a=n(5);function o(e,t){return void 0===t&&(t=Object(a.Pb)()),s(Object(a.ac)(t,e),r.a.DaysInOneWeek)}function c(e,t){var n=u(e,t),r=Object(a.B)(e),i=Object(a.e)(Object(a.C)(r,t),1);return s(n,Math.abs(Object(a.s)(n,i)-1))}function u(e,t){var n=Object(a.Zb)(e);return Object(a.ac)(n,t)}function s(e,t){return{start:e,end:Object(a.e)(e,t-1)}}function d(e,t,n,r,c){switch(void 0===c&&(c=1),e){case i.b.Day:return s(Object(a.Wb)(t),c);case i.b.Month:var u=Object(a.Zb)(t),d=Object(a.B)(t);return s(u,Math.abs(Object(a.s)(u,d)-1));case i.b.Week:return o(n,t);case i.b.WorkWeek:return function(e,t,n){void 0===n&&(n=Object(a.Pb)());for(var r,i,c=o(e,n),u=0;u<=p(c);u++){var s=Object(a.e)(c.start,u);if(!r&&t.includes(Object(a.nb)(s))&&(r=s),s=Object(a.e)(c.end,-u),!i&&t.includes(Object(a.nb)(s))&&(i=s),r&&i)break}return{start:r,end:i}}(n,r,t)}}function l(e,t){var n=c(e,t);return Object(a.t)(n.end,n.start,t)}function b(e,t){var n;return s(n=t==i.b.WorkWeek?Object(a.k)(e.start,1):Object(a.e)(e.end,1),t==i.b.Month?Object(a.ob)(n):Object(a.s)(e.end,e.start)+1)}function f(e,t){var n,r;if(t==i.b.WorkWeek)n=Object(a.k)(e.start,-1),r=Object(a.k)(e.end,-1);else{r=Object(a.e)(e.start,-1);var o=t==i.b.Month?-Object(a.ob)(r):Object(a.s)(e.start,e.end)-1;n=Object(a.e)(e.start,o)}return{start:n,end:r}}function v(e,t){return e&&t&&0==Object(a.p)(e.start,t.start)&&0==Object(a.p)(e.end,t.end)}function m(e,t,n){if(!e||!t)throw new Error("Date ranges cannot be null in call to areDateRangesOverlapping");return n?Object(a.p)(e.start,t.start)<=0?Object(a.p)(e.end,t.start)>=0?0:1:Object(a.p)(t.end,e.start)>=0?0:-1:Object(a.p)(e.start,t.start)<0?Object(a.p)(e.end,t.start)>0?0:1:Object(a.p)(t.end,e.start)>0?0:-1}function O(e,t,n){return!(!e||!t)&&(n?Object(a.p)(e.start,t.start)<=0&&Object(a.p)(e.end,t.end)>=0:Object(a.p)(e.start,t.start)<0&&Object(a.p)(e.end,t.end)>0)}function j(e,t){return e&&t?{start:Object(a.p)(e.start,t.start)<0?e.start:t.start,end:Object(a.p)(e.end,t.end)>0?e.end:t.end}:null}function p(e){return Object(a.s)(e.end,e.start)}function k(e){return Math.floor(Object(a.v)(e.end,e.start)/24)+(Object(a.v)(e.end,e.start)%24>0?1:0)}function h(e,t){return Object(a.s)(e.start,t)<=0&&Object(a.s)(e.end,t)>=0}},5126:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("DISMISS_NUDGE",(function(e,t,n,r){return{rowKey:e,tableViewId:t,actionSource:n,itemOrConversationId:r}}))},5282:function(e){e.exports=JSON.parse('{"a":"iHa"}')},5283:function(e){e.exports=JSON.parse('{"a":"jHa"}')},5739:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(3053);function a(e,t){var n,a,o=[];try{for(var c=Object(r.__values)(e),u=c.next();!u.done;u=c.next()){var s=u.value,d=Object(i.a)(s,t);d&&o.push(d.ItemId.Id)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}return o}},5900:function(e,t,n){"use strict";n.r(t);var r=n(52),i=n(3),a=Object(i.action)("ADD_MAILBOX_TO_SAFE_SENDERS",(function(e,t,n){return Object(r.c)({name:"TnS_AddToSafeSenders",customData:[n],cosmosOnlyData:JSON.stringify({itemId:t}),actionSource:"ReadingPane"},{mailbox:e,itemId:t,actionSource:n})})),o=Object(i.action)("ADD_MAILBOX_TO_TRUSTED_SENDERS_LIST",(function(e,t){return{mailbox:e,junkEmailConfiguration:t}})),c=n(6518),u=n(7767),s=n(2700),d=n(3812),l=n(10234),b=n(1938),f=n(1633),v=n(1766),m=n(3164),O=n(1691),j=Object(r.d)("RestoreItem",s.a.restoreItems)((function(e,t){var n=v.a.tableViews.get(t),r=n.tableQuery.folderId,i=Object(f.C)(e,t),a=Object(d.a)(i);return Object(b.a)(a,r,"Restore"),Object(l.a)(i).then((function(e){return Object(O.a)(e)})).catch((function(e){return Object(m.b)(n),Promise.reject(e)}))}));function p(e,t,n){switch(v.a.tableViews.get(t).tableQuery.listViewType){case 0:Object(u.a)(e,t);break;case 1:j(e,t)}}var k=n(5738),h=Object(i.action)("DELETE_ITEMS_BASED_ON_NODE_OR_THREAD_IDS",(function(e,t,n){return{nodeIds:e,tableViewId:t,actionSource:n}})),y=Object(i.action)("SCHEDULE_ROWS",(function(e,t,n,r){return{rowKeys:e,tableViewId:t,actionSource:n,scheduleReturnTime:r}})),g=n(8441),I=n(0),S=n(7),w=n(1640),_=n(12331);function N(e,t){"Flagged"===e?w.s.importAndExecute(t?Object(S.b)(_.a):Object(S.b)(_.c)):"NotFlagged"===e&&w.s.importAndExecute(t?Object(S.b)(_.b):Object(S.b)(_.d))}var T=n(2214);function C(e,t,n,r){var i;switch(e.FlagStatus){case"Flagged":i="Flag";break;case"NotFlagged":i="FlagCleared";break;case"Complete":i="FlagComplete"}Object(T.d)(i,t,{rowKeys:n})}var E=n(2439),A=n(188),x=Object(A.select)({tableViewConversationRelations:function(){return f.X.tableViewConversationRelations},tableViews:function(){return f.X.tableViews}})((function(e,t,n,r,i){e.forEach((function(e){i.tableViews.forEach((function(i){i.serverFolderId==t&&Object(f.E)([e],i).forEach((function(e){var t=Object(f.K)(e,i.id);t&&t.itemIds.forEach((function(e){n.indexOf(e)>-1&&r(t,e)}))}))}))}))})),F=Object(A.select)({tableViews:function(){return f.X.tableViews}})(Object(A.action)("ApplyConversationFlagInListViewStore")((function(e,t,n,r){if(!t||!t.FlagStatus)throw new Error("Invalid flag type.");var i=r.tableViews.get(n),a=Object(f.y)(t,e,i),o=Object(f.C)(e,i.id);x(o,i.serverFolderId,a,(function(e,n){e.flagStatus=t.FlagStatus}))}))),R=n(1716),M=n(4901),V=n(2701),D=n(2702),P=n(559),L=n(374),B=n(793),U=n(6523);function K(e,t,n){var r=e.map((function(e){return function(e,t,n){var r=Object(D.a)({Action:"Flag",ConversationId:Object(L.a)({Id:e.conversationId}),Flag:t,ConversationLastSyncTime:Object(M.a)(e.conversationLastSyncTimeStamp)});if(n){var i=Object(B.a)({BaseFolderId:Object(P.a)({Id:n})});r.ContextFolderId=i}return r}(e,t,n)}));return Object(V.a)({ConversationActions:r})}var W=n(3493),J=n(2015),H=n(2168),Q=n(2159),q=n(197);function G(e,t,n){var r=function(e,t){var n=Object(W.a)("Flag",t),r=[];return e.forEach((function(e){return r.push(Object(J.a)({Updates:[n],ItemId:Object(L.a)({Id:e})}))})),Object(H.a)({ItemChanges:r,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}(e,t);return Object(Q.a)({Header:Object(q.b)(),Body:r},n).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var z=n(1930),X=n(347),Y=Object(r.d)("setConversationsFlagState",s.a.setConversationsFlagState)((function(e,t,n,r,i){return Object(I.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(I.__generator)(this,(function(o){switch(o.label){case 0:return[4,z.b()];case 1:return o.sent(),i=v.a.tableViews.get(n),C(r,t,e),a=Object(f.C)(e,n),F(e,r,n),Object(E.a)(a,r,n),Object(f.e)(i)?[2,Z(i,r,e)]:[2,$(i,r,e)]}}))}))}));function Z(e,t,n){var r=Object(X.a)(Object(R.b)(e));return G(Object(f.y)(t,n,e),t,r).then((function(e){return Object(O.a)(e)})).catch((function(e){return Promise.reject(e)}))}function $(e,t,n){var r=Object(f.k)(e),i=function(e,t,n){var r=K(e,t,n);return Object(U.a)(r)}(n.map((function(t){return Object(f.h)(t,e.id)})),t,r);return Object(m.c)(i,n,r,e,!1)}var ee=n(1638),te=n(2476),ne=n(2596),re=Object(i.action)("FLAG_ITEMS_STORE_UPDATE",(function(e,t,n){return{itemIds:e,flagTypeToSet:t,parentFolderId:n}}));Object(i.mutator)(re,(function(e){var t,n,r,i;e.itemIds.forEach((function(t){var n=ee.a.items.get(t);n&&(n.Flag={FlagStatus:e.flagTypeToSet.FlagStatus})}));var a=Object(ne.a)(e.parentFolderId,!0);try{for(var o=Object(I.__values)(a),c=o.next();!c.done;c=o.next()){var u=c.value;if(Object(f.P)(u))try{for(var s=(r=void 0,Object(I.__values)(e.itemIds)),d=s.next();!d.done;d=s.next()){ie(d.value,u,e.flagTypeToSet.FlagStatus)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}));function ie(e,t,n){var r,i,a=Object(w.v)(e),o=Object(f.E)([a.ConversationId.Id],t);try{for(var c=Object(I.__values)(o),u=c.next();!u.done;u=c.next()){var s=u.value;Object(te.a)(s,t.id).flagStatus=n}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}var ae=Object(r.d)("setItemsFlagState",s.a.setItemsFlagState)((function(e,t,n,r,i){return Object(I.__awaiter)(this,void 0,void 0,(function(){var i,a,o;return Object(I.__generator)(this,(function(c){switch(c.label){case 0:return i=Object(f.J)().tableViews.get(r),a=[],i&&(a=Object(f.E)(e,i)),[4,z.b()];case 1:return c.sent(),C(n,t,a),re(e,n,i&&i.tableQuery.folderId),o=Object(X.a)(Object(R.b)(i)),[2,G(e,n,o)]}}))}))}));function oe(e,t,n,r,i){return Object(I.__awaiter)(this,void 0,void 0,(function(){var a;return Object(I.__generator)(this,(function(o){switch(o.label){case 0:return(a=e.filter((function(e){return!!Object(w.v)(e)}))).length>0?[4,ae(a,t,n,r,i)]:[3,2];case 1:o.sent(),N(n.FlagStatus,!1),o.label=2;case 2:return[2]}}))}))}var ce=n(2323);function ue(e,t,n,r,i){var a=v.a.tableViews.get(t),o=Object(ce.a)(e,a);switch(a.tableQuery.listViewType){case 0:!function(e,t,n,r,i,a,o){var c=[];c=o?e:a(e,n,r),c.length>0&&(Y(c,t,n,r,i),N(r.FlagStatus,!0))}(e,o,t,n,r,se,i);break;case 1:!function(e,t,n,r,i,a,o){Object(I.__awaiter)(this,void 0,void 0,(function(){var c,u,s;return Object(I.__generator)(this,(function(d){switch(d.label){case 0:return c=[],o?c=e:(u=a(e,n,r),c=u),c.length>0?(s=Object(f.C)(c,n),[4,ae(s,t,r,n,i)]):[3,2];case 1:d.sent(),N(r.FlagStatus,!1),d.label=2;case 2:return[2]}}))}))}(e,o,t,n,r,se,i)}}function se(e,t,n){var r=Object(f.J)().tableViews.get(t);return e.filter((function(e){return f.b.getFlagStatus(e,r)!=n.FlagStatus}))}var de=n(85);var le=Object(A.action)("toggleRowsFlagState")((function(e,t,n){ue(e,t,function(e,t){for(var n,r=0;r<e.length;r++){switch(f.b.getFlagStatus(e[r],t)){case"Flagged":n=Object(de.s)()?Object(g.b)(g.a.clear):Object(g.b)(g.a.complete);break;case"Complete":case"NotFlagged":default:n=Object(g.b)(g.a.noDate)}}return n}(e,f.X.tableViews.get(t)),n)})),be=Object(i.action)("SET_ITEMS_FLAG_STATE_BASED_ON_NODE_IDS",(function(e,t,n,r){return{nodeIds:e,tableViewId:t,flagStatusToSet:n,actionSource:r}})),fe=n(7304),ve=n(134),me=n(1634),Oe=n(2427),je=n(4124),pe=n(1970),ke=n(1858),he=Object(A.select)({sourceFolder:function(e,t,n){return me.d.folderTable.get(n.tableQuery.folderId)},destinationFolder:function(e,t,n){return me.d.folderTable.get(t)}})((function(e,t,n,r,i,a){return Object(I.__awaiter)(this,void 0,void 0,(function(){var o,c,u,s,d,l,b,v,m=this;return Object(I.__generator)(this,(function(O){switch(O.label){case 0:return o=a.sourceFolder,c=a.destinationFolder,u=function(e,t){return e&&"SharedMailbox"===e.mailboxInfo.type||t&&"SharedMailbox"===t.mailboxInfo.type?1:0}(o,c),s=n.tableQuery.folderId,d=Object(ve.t)(),Object(fe.a)(s,t)?(d&&d.endWithError("UserError",new Error("Action not supported for shadow mailbox")),[2,Promise.resolve()]):[4,z.b()];case 1:if(O.sent(),l=e.filter((function(e){return n.rowKeys.indexOf(e)>=0&&t!=f.b.getParentFolderId(e,n)})),b=[],1==n.tableQuery.type&&l.forEach((function(e){var t=f.b.getInstrumentationContext(e,n);t&&b.push(t)})),Object(T.d)("Move",b),0==l.length)return d&&d.endWithError("UserError",new Error("no conversations to move")),[2,Promise.resolve()];switch(u){case 1:if(!Object(Oe.h)(Object(pe.g)(n),t))return Object(Oe.j)(t),[2,Promise.resolve()];switch(n.tableQuery.listViewType){case 0:Object(I.__awaiter)(m,void 0,void 0,(function(){return Object(I.__generator)(this,(function(e){switch(e.label){case 0:return[4,ke.z.import()];case 1:return e.sent()(l,t,n),[2]}}))}));break;case 1:Object(I.__awaiter)(m,void 0,void 0,(function(){return Object(I.__generator)(this,(function(e){switch(e.label){case 0:return[4,ke.A.import()];case 1:return e.sent()(l,n.id,t,s),[2]}}))}))}break;case 0:default:je.b.importAndExecute(t),v=r(l,t,n,i,d)}return[2,v]}}))}))})),ye=n(8440),ge=n(4214),Ie=n(1844),Se=n(880),we=n(25),_e=n(1673),Ne=n(12332);function Te(e,t,n){if(Object(we.a)().UserOptions.ShowNotificationBar){var r=Object(me.j)(me.d.folderTable.get(t)),i="archive"===Object(_e.a)(t);if("deleteditems"===Object(_e.a)(t))Object(ye.a)(e,n);else{var a;a=i?1===e?Object(S.b)(Ne.a):Object(S.c)(Object(S.b)(Ne.b),e):1===e?Object(S.c)(Object(S.b)(Ne.c),r):Object(S.c)(Object(S.b)(Ne.d),e,r);var o=Object(Ie.h)();Se.e.importAndExecute("moveOrArchiveNotification","MailModuleNotificationBarHost",a,{icon:i?"Archive":"FabricMoveToFolder",primaryActionText:n?Object(S.b)(ge.a):null,allowClear:!0,minWidth:o.minWidth,maxWidth:o.maxWidth,notificationCallback:function(e){e===Se.a.PrimaryActionClicked&&z.e.importAndExecute("NotificationBar")}})}}}var Ce=n(3273);function Ee(e,t){var n=e.filter((function(e){return!e.isRead})).length,r=e.length;Object(Ce.a)(n,r,t,!0)}function Ae(e,t,n){var r=0,i=0;e.forEach((function(e){var n=Object(f.K)(e,t.id);r+=n.unreadCount,i+=n.itemIds.length})),Object(Ce.a)(r,i,n,!0)}function xe(e){var t=me.d.folderTable.get(e);return Object(w.j)(e)||Object(w.p)(t)}var Fe=n(7306),Re=n(380),Me=n(2059),Ve={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MoveConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"moveConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"destinationFolderId"},value:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"undoRequestId"},arguments:[],directives:[]}]}}]}}]},De={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoMoveConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoMoveConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"destinationFolderId"},value:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},Pe=Object(r.d)("moveConversations",s.a.moveConversation)((function(e,t,n,r){return he(e,t,n,Le,r)}));function Le(e,t,n,r,i){var a=this,o="category"!==n.tableQuery.scenarioType?n.tableQuery.folderId:null,c=e.map((function(e){return Object(f.h)(e,n.id)})),u=Object(f.C)(e,n.id),s=Object(z.c)(o,Object(R.b)(n));Object(w.m)(t)&&Ae(e,n,t),Object(Fe.a)(n.tableQuery,xe(t))&&Object(Me.a)(u,n,"Move");var d=Be.invokeMoveConversationMutation(c,t,o);return s&&z.a((function(){return Object(I.__awaiter)(a,void 0,void 0,(function(){var e;return Object(I.__generator)(this,(function(n){switch(n.label){case 0:return[4,d];case 1:return(e=n.sent()).success?[4,Be.invokeUndoMoveConversationMutation(c,o,t,e.undoRequestId)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2,Promise.resolve()]}}))}))}),n.serverFolderId,d),Te(c.length,t,s),i.markUserPerceivedTime(),Object(m.c)(d,e,o,n,!0,!0)}var Be={invokeMoveConversationMutation:function(e,t,n){var r;return Object(I.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(I.__generator)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(M.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(Re.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:n,destinationFolderId:t},mutation:Ve})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.moveConversation]}}))}))},invokeUndoMoveConversationMutation:function(e,t,n,r){var i;return Object(I.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(I.__generator)(this,(function(c){switch(c.label){case 0:return a=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(M.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(Re.a)()];case 1:return[4,c.sent().mutate({variables:{conversations:a,folderId:n,destinationFolderId:t,undoRequestId:r},mutation:De})];case 2:return o=c.sent(),[2,null===(i=null==o?void 0:o.data)||void 0===i?void 0:i.undoMoveConversation]}}))}))}},Ue=n(6519),Ke=n(7305),We=n(3764),Je=n(3892),He=n(1702);function Qe(e,t,n){var r=function(e,t){return Object(We.a)({ToFolderId:Object(Ue.a)(t),ItemIds:Object(Ke.a)(e),ReturnNewItemIds:!0})}(e,t);return Object(Je.a)({Header:Object(q.b)(),Body:r},Object(X.a)(Object(He.b)(t))).then((function(e){return e.Body}))}var qe=n(8442),Ge=Object(r.d)("moveItemsFromItemIds",s.a.moveItems)((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var r,i,a,o,c,u,s=this;return Object(I.__generator)(this,(function(l){switch(l.label){case 0:return r="category"!==n.tableQuery.scenarioType?n.tableQuery.folderId:null,i=Object(z.c)(r,Object(R.b)(n)),a=Object(ve.t)(),Object(fe.a)(r,t)?(a.endWithError("UserError",new Error("Action not supported for shadow mailbox")),[2,Promise.resolve()]):(o=Object(f.E)(e,n),[4,z.b()]);case 1:return l.sent(),c=Object(d.a)(e),Object(qe.a)(t)&&Ee(c,t),Object(Fe.a)(n.tableQuery,xe(t))&&Object(b.a)(c,r,"Move"),u=Qe(e,t),i&&z.a((function(){return Object(I.__awaiter)(s,void 0,void 0,(function(){var e,t,n,i,a,o,c,s;return Object(I.__generator)(this,(function(d){switch(d.label){case 0:return[4,u];case 1:if((e=d.sent()).ResponseMessages){t=e.ResponseMessages.Items,n=[];try{for(i=Object(I.__values)(t),a=i.next();!a.done;a=i.next())"Success"==(o=a.value).ResponseClass&&n.push(o.Items[0].ItemId.Id)}catch(e){c={error:e}}finally{try{a&&!a.done&&(s=i.return)&&s.call(i)}finally{if(c)throw c.error}}if(n.length>0)return[2,Qe(n,r)]}return[2,Promise.resolve()]}}))}))}),n.serverFolderId),Te(e.length,t,i),a.markUserPerceivedTime(),[2,Object(m.d)(u,o,r,n,!0)]}}))}))}));function ze(e,t,n,r){return he(e,t,n,Xe,r)}function Xe(e,t,n,r){var i=Object(f.C)(e,n.id);return Ge(i,t,n,r)}function Ye(e,t,n,r){var i=f.X.tableViews.get(n);return(0==i.tableQuery.listViewType?Pe:ze)(e,t,i,r)}var Ze=n(12333),$e=n(5938);function et(e,t,n){var r=Object(B.a)({BaseFolderId:Object(P.a)({Id:t})}),i=null==n?null:Object(B.a)({BaseFolderId:Object(P.a)({Id:n})}),a=e.map((function(e){return function(e,t,n){return Object(D.a)({Action:"Copy",ConversationId:Object(L.a)({Id:e.conversationId}),ContextFolderId:t,DestinationFolderId:n,ConversationLastSyncTime:Object(M.a)(e.conversationLastSyncTimeStamp)})}(e,i,r)}));return Object(V.a)({ConversationActions:a,ReturnMovedItemIds:!0})}function tt(e,t,n){var r=et(e,t,n);return Object(U.a)(r)}var nt=Object(r.d)("copyMailListRows",s.a.copyMailListRows)((function(e,t,n,r,i){switch(t.tableQuery.listViewType){case 0:var a=tt(e.map((function(e){return Object(f.h)(e,t.id)})),n,r);return rt(e.length),Object(m.c)(a,e,r,t,!1);case 1:var o=Object(f.C)(e,t.id),c=Object($e.a)(o,Object(Ue.a)(n),!1,Object(X.a)(Object(R.b)(t)));return rt(e.length),Object(m.d)(c,e,r,t,!1);default:return Promise.reject(new Error("ListViewType not support: "+t.tableQuery.listViewType))}}));function rt(e){var t=1===e?Object(S.b)(Ze.a):Object(S.c)(Object(S.b)(Ze.b),e),n=Object(Ie.h)();Se.e.importAndExecute("copyNotification","MailModuleNotificationBarHost",t,{icon:"Copy",minWidth:n.minWidth,maxWidth:n.maxWidth})}var it=Object(i.action)("MOVE_ITEMS_BASED_ON_NODE_IDS",(function(e,t,n,r){return{nodeIds:e,destinationFolderId:t,tableViewId:n,actionSource:r}})),at=Object(A.select)({archiveFolderId:function(){return Object(we.a)().UserOptions.ArchiveFolderId}})(Object(r.d)("archiveMailListRowsFromTable",s.a.archiveMailListRows)((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){return Object(I.__generator)(this,(function(n){switch(n.label){case 0:return r.archiveFolderId?[4,Ye(e,r.archiveFolderId,t.id)]:[3,2];case 1:return n.sent(),[3,3];case 2:throw new Error("Archive folder id should always be set");case 3:return[2]}}))}))}))),ot=n(2779),ct=n(785),ut=n(3396);function st(e,t,n){var r=function(e,t){var n,r,i=[];try{for(var a=Object(I.__values)(e),o=a.next();!o.done;o=a.next()){var c=o.value,u=void 0;u=t?Object(W.a)("RenewTime",ut.e):Object(ot.a)({Path:Object(ct.a)({FieldURI:"RenewTime"})});var s=Object(J.a)({Updates:[u],ItemId:Object(L.a)({Id:c})});i.push(s)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return Object(H.a)({ItemChanges:i,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}(e,t),i=Object(q.b)();return i.TimeZoneContext.TimeZoneDefinition.Id="UTC",Object(Q.a)({Header:i,Body:r},n).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var dt=n(3276);function lt(e,t){return e&&Object(f.x)(e)!=t}var bt=Object(r.d)("pinConversations",s.a.pinConversations)((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var r,i,a,o;return Object(I.__generator)(this,(function(c){switch(c.label){case 0:return[4,z.b()];case 1:return c.sent(),r=Object(f.g)(e,t.id,lt,n),0==(i=function(e,t,n){for(var r={},i=0;i<e.length;i++){var a=Object(f.K)(e[i],t);if(n){var o=a.itemIds[0];r[o]||(r[o]=!0)}else a.itemIds.forEach((function(e){r[e]||(r[e]=!0)}))}return Object.keys(r)}(r,t.id,n)).length?[2,Promise.resolve()]:(Object(dt.a)(r,t.id,n),a=Object(ce.a)(e,t),o={itemIds:i},Object(T.d)(n?"Pin":"Unpin",a,o),[2,st(i,n)])}}))}))})),ft=n(3277),vt=Object(r.d)("pinItems",s.a.pinItems)((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var r,i,a,o,c;return Object(I.__generator)(this,(function(u){switch(u.label){case 0:return[4,z.b()];case 1:return u.sent(),r=function(e,t,n){var r=[];return e.forEach((function(e){(f.b.getIsPinned(e,t)&&!n||!f.b.getIsPinned(e,t)&&n)&&r.push(e)})),r}(e,t,n),0==(i=Object(f.C)(r,t.id)).length?[2,Promise.resolve()]:(Object(ft.a)(r,t.id,n),n&&(a=Object(ce.a)(e,t),o={rowKeys:r},Object(T.d)("Pin",a,o)),c=Object(X.a)(Object(R.b)(t)),[2,st(i,n,c)])}}))}))}));function mt(e,t,n){var r=f.X.tableViews.get(t),i=f.b.getIsPinned(e,r);switch(r.tableQuery.listViewType){case 0:bt([e],r,!i,n);break;case 1:vt([e],r,!i,n)}}function Ot(e,t,n,r){var i=f.X.tableViews.get(t);switch(i.tableQuery.listViewType){case 0:bt(e,i,n,r);break;case 1:vt(e,i,n,r)}}var jt=n(5324),pt=n(12334),kt=n(877);function ht(e){return Object(I.__awaiter)(this,void 0,void 0,(function(){return Object(I.__generator)(this,(function(t){switch(t.label){case 0:return[4,z.b()];case 1:return t.sent(),Object(we.a)().SegmentationSettings.ReportJunkEmailEnabled?[2,Object(kt.b)(Object(S.b)(pt.a),Object(S.b)(pt.b),!1,{okText:Object(S.b)(jt.p),cancelText:Object(S.b)(jt.o),delayCallbackAfterAnimation:!0}).then((function(t){t===kt.a.ok&&e()}))]:(e(),[2,Promise.resolve()])}}))}))}function yt(e,t){return e.filter((function(e){return t.rowKeys.indexOf(e)>=0}))}var gt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkItemAsPhishing"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markItemAsPhishing"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},It=Object(r.d)("markItemsAsPhishing",s.a.markItemsAsPhishing)((function(e,t,n,r){if(Object(we.a)().SegmentationSettings.ReportJunkEmailEnabled)try{St.invokeMarkItemAsPhishingMutation(e,Object(R.b)(t))}catch(e){}return r(),Promise.resolve()})),St={invokeMarkItemAsPhishingMutation:function(e,t){var n;return Object(I.__awaiter)(this,void 0,void 0,(function(){var r;return Object(I.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(Re.a)()];case 1:return[4,i.sent().mutate({variables:{ids:e,mailboxInfo:t},mutation:gt})];case 2:return r=i.sent(),[2,null===(n=null==r?void 0:r.data)||void 0===n?void 0:n.markItemAsPhishing]}}))}))}},wt=n(4050);function _t(e,t,n){ht((function(){!function(e,t,n){var r=yt(e,t);if(0==r.length)return;var i=Object(ce.a)(e,t),a=Object(f.C)(r,t.id),o=Object(wt.a)(r,t.id);It(o,t,n,(function(){Object(Me.a)(a,t,"MarkAsPhishing")})),Object(T.d)("MarkAsPhishing",i,{conversationIds:a})}(e,t,n)}))}function Nt(e,t,n){ht((function(){!function(e,t,n){var r=yt(e,t);if(0==r.length)return;var i=Object(ce.a)(e,t),a=Object(f.C)(r,t.id);It(a,t,n,(function(){var e=Object(d.a)(a);Object(b.a)(e,t.tableQuery.folderId,"MarkAsPhishing")})),Object(T.d)("MarkAsPhishing",i,{itemIds:a})}(e,t,n)}))}function Tt(e,t,n){switch(t.tableQuery.listViewType){case 0:_t(e,t,n);break;case 1:Nt(e,t,n)}}function Ct(e,t,n){var r=w.u.items.get(e);return ht((function(){It([e],t,n,(function(){var t=Object(d.a)([e]);Object(b.a)(t,r.ParentFolderId.Id,"MarkAsPhishing")}))}))}var Et={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SetInferenceClassificationOnConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"inferenceClassification"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InferenceClassification"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setInferenceClassificationOnConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"inferenceClassification"},value:{kind:"Variable",name:{kind:"Name",value:"inferenceClassification"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},At=Object(r.d)("moveConversationToFocusedOrOtherAction",s.a.moveConversationToFocusedOrOther)((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var r,i,a,o,c;return Object(I.__generator)(this,(function(u){switch(u.label){case 0:return r=v.a.tableViews.get(t),i=0==n,a=Object(f.C)(e,t),o=Object(ve.t)(),[4,z.b()];case 1:return u.sent(),c=function(e,t,n){var r;return Object(I.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(I.__generator)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e}})),[4,Object(Re.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:t,inferenceClassification:n},mutation:Et})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.setInferenceClassificationOnConversation]}}))}))}(a,r.tableQuery.folderId,i?"Focused":"Other"),o.markUserPerceivedTime(),Object(Me.a)(a,r,"Move"),[2,c]}}))}))}));var xt=n(2185);function Ft(e,t){var n=function(e,t){var n,r,i=[];try{for(var a=Object(I.__values)(e),o=a.next();!o.done;o=a.next()){var c=o.value,u=Object(W.a)("InferenceClassification",t),s=Object(J.a)({Updates:[u],ItemId:Object(L.a)({Id:c})});i.push(s)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return Object(H.a)(Object(I.__assign)({ConflictResolution:"AlwaysOverwrite",ItemChanges:i,MessageDisposition:"SaveOnly"},Object(xt.a)()))}(e,t),r=Object(q.b)();return r.TimeZoneContext.TimeZoneDefinition.Id="UTC",Object(Q.a)({Header:r,Body:n}).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))}var Rt=Object(r.d)("moveItemsToFocusedOrOther",s.a.moveItemToFocusedOrOther)((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var r,i,a,o,c,u;return Object(I.__generator)(this,(function(s){switch(s.label){case 0:return r=v.a.tableViews.get(t),i=0==n,a=Object(f.C)(e,t),o=Object(ve.t)(),[4,z.b()];case 1:return s.sent(),c=Object(d.a)(a),u=Ft(a,i?"Focused":"Other"),Object(b.a)(c,r.tableQuery.folderId,"Move"),o.markUserPerceivedTime(),[2,u.then((function(e){return Object(O.a)(e)}))]}}))}))}));function Mt(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var i;return Object(I.__generator)(this,(function(a){switch(a.label){case 0:switch(i=v.a.tableViews.get(t),i.tableQuery.listViewType){case 0:return[3,1];case 1:return[3,3]}return[3,5];case 1:return[4,At(e,t,n,r)];case 2:return a.sent(),[3,5];case 3:return[4,Rt(e,t,n,r)];case 4:return a.sent(),[3,5];case 5:return[2]}}))}))}var Vt=n(12335),Dt=n(28);function Pt(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(I.__assign)({__type:"ApplyBulkItemActionJsonRequest:#Exchange"},n)),Object(Dt.a)("ApplyBulkItemAction",e,t)}function Lt(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(I.__assign)({__type:"CreateOrUpdateFocusedOtherOverrideJsonRequest:#Exchange"},n)),Object(Dt.a)("CreateOrUpdateFocusedOtherOverride",e,t)}function Bt(e,t){var n={SenderSmtpAddress:e,AlwaysClassifyAs:t};return Lt({Header:Object(q.b)(),Body:n}).then((function(e){return e.Body})).catch((function(e){return Promise.reject(e)}))}var Ut=n(5604),Kt=n(5605),Wt=Object(r.d)("alwaysMoveRowToFocusedOrOtherInternal",s.a.alwaysMoveRowToFocusedOrOther)((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var r,i,a,o=this;return Object(I.__generator)(this,(function(c){switch(c.label){case 0:if(null==(r=f.b.getLastSenderSMTP(e[0],t)))return[2];switch(n){case 0:a="Focused",i=Object(S.b)(Kt.a);break;case 1:a="Other",i=Object(S.b)(Ut.a);break;case-1:throw new Error("FocusedViewFilter.None is not supported for this action")}return[4,Object(kt.b)(null,Object(S.c)(Object(S.b)(Vt.a),r,i)).then((function(i){return Object(I.__awaiter)(o,void 0,void 0,(function(){return Object(I.__generator)(this,(function(o){switch(o.label){case 0:return i!==kt.a.ok?[3,2]:t.rowKeys.indexOf(e[0])>-1?[4,Jt(e[0],r,a,t,n)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))}))];case 1:return c.sent(),[2]}}))}))}));function Jt(e,t,n,r,i){return Object(I.__awaiter)(this,void 0,void 0,(function(){return Object(I.__generator)(this,(function(a){switch(a.label){case 0:return[4,Mt([e],r.id,i)];case 1:return a.sent(),[4,Bt(t,n).then((function(e){return Object(O.a)(e)}))];case 2:return a.sent(),[4,(o={Id:r.serverFolderId},c=[{EmailAddress:t}],u=Object(W.a)("InferenceClassification",n),s={SourceFolderId:o,EmailAddresses:c,ActionType:3,ItemPropertyToUpdate:u},Pt({Header:Object(q.b)(),Body:s}).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))).then((function(e){return Object(O.a)(e)}))];case 3:return a.sent(),[2]}var o,c,u,s}))}))}var Ht=n(620),Qt=n(8443),qt=n(1690),Gt=n(790),zt=n(12336),Xt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UnsubscribeEmail"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isTrustedUnsubscribe"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"unsubscribeEmail"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isTrustedUnsubscribe"},value:{kind:"Variable",name:{kind:"Name",value:"isTrustedUnsubscribe"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},Yt=new RegExp("List-Unsubscribe:[ ]+<mailto:"),Zt=Object(r.d)("unsubscribeWithoutConfirmDialog",s.a.unsubscribe)((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var t;return Object(I.__generator)(this,(function(r){switch(r.label){case 0:return t={itemId:e.ItemId.Id,itemConversationId:e.ConversationId,isRead:e.IsRead,mailboxInfo:e.MailboxInfo},Object(b.a)([t],e.ParentFolderId.Id,"Unsubscribe"),[4,tn.invokeUnsubscribeEmailMutation([e.ItemId.Id],n,e.MailboxInfo)];case 1:return r.sent(),[2]}}))}))})),$t=Object(A.action)("showUnsubscribeDialog")((function(e,t,n,r){var i=this;return Object(kt.b)(Object(S.b)(zt.b),Object(S.c)(Object(S.b)(zt.a),e.From.Mailbox.Name),!1,{okText:Object(S.b)(Qt.a),cancelText:Object(S.b)(Ht.a)}).then((function(a){return Object(I.__awaiter)(i,void 0,void 0,(function(){return Object(I.__generator)(this,(function(i){return a===kt.a.ok?[2,Zt(e,t,n,r)]:[2]}))}))}))})),en=Object(A.select)({message:function(e,t){return ee.a.items.get(e)},originalTableView:function(e,t){return f.X.tableViews.get(t)},reportToExternalSender:function(){return Object(we.a)().SafetyUserOptions.ReportToExternalSender}})(Object(A.action)("unsubscribeEmail")((function(e,t,n,r){var i=r.message,a=r.originalTableView,o=r.reportToExternalSender,c=i.MessageSafety&&(2==i.MessageSafety.MessageSafetyLevel||1==i.MessageSafety.MessageSafetyLevel);if(!o||!c)return $t(i,a,!1,n);var u=Object(Gt.a)({BaseShape:"IdOnly"});return Object(qt.a)(i.ItemId.Id,u,"MessageDetails").then((function(e){if("Success"==e[0].ResponseClass){var t=e[0],r=t.Items[0].ExtendedProperty&&t.Items[0].ExtendedProperty[0].Value;return $t(i,a,Yt.test(r),n)}throw new Error(e[0].MessageText)}))}))),tn={invokeUnsubscribeEmailMutation:function(e,t,n){var r;return Object(I.__awaiter)(this,void 0,void 0,(function(){var i;return Object(I.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(Re.a)()];case 1:return[4,a.sent().mutate({variables:{ids:e,isTrustedUnsubscribe:t,mailboxInfo:n},mutation:Xt})];case 2:return i=a.sent(),[2,null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.unsubscribeEmail]}}))}))}},nn=Object(i.action)("unsubscribeEmailV2",(function(e,t,n,r){return{message:e,cacheEntry:t,actionSource:n,itemViewState:r}}));function rn(e,t,n,r,i,a){var o,c=(o={ActionType:0,DestinationFolderId:{Id:t},EmailAddresses:e,SourceFolderId:{Id:n},CountType:r,KeepNCount:i,BulkActionRequest:!0,BulkActionCustomData:a&&JSON.stringify(a)},Object(I.__assign)({__type:"ApplyBulkItemActionRequest:#Exchange"},o));return Pt({Header:Object(q.b)(),Body:c}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var an=n(12337);function on(e){return Object(I.__assign)({__type:"CreateSweepRuleForSenderRequest:#Exchange"},e)}function cn(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(I.__assign)({__type:"CreateSweepRuleForSenderJsonRequest:#Exchange"},n)),Object(Dt.a)("CreateSweepRuleForSender",e,t)}function un(e){return e.map((function(e){return Object(S.c)(Object(S.b)(an.a),e.Name)}))}function sn(e,t,n,r,i){var a=on({EmailAddresses:e,ActionType:0,RuleName:null,RuleNames:un(e),SourceFolderId:{Id:n},DestinationFolderId:{Id:t},CountType:r,KeepNCount:i});return cn({Header:Object(q.b)(),Body:a}).then((function(e){return e.Body}))}var dn=n(7001),ln=n(1920),bn={};bn[dn.a.All]={keepNType:1,keepNCount:0},bn[dn.a.AllCurrentAndFuture]={keepNType:1,keepNCount:0},bn[dn.a.AllButOne]={keepNType:1,keepNCount:1},bn[dn.a.AllOlderThan]={keepNType:0,keepNCount:10};var fn=Object(A.action)("sweepConversations")((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var i,a,o,c,u,s,d;return Object(I.__generator)(this,(function(l){return i=function(e){return bn[e]}(n),a=i.keepNType,o=i.keepNCount,c=t.tableQuery.folderId,u=e.map((function(e){return e.EmailAddress})).join(", "),s=u.length>70?u.slice(0,70)+"...":u,d={Scenario:"Sweep",senderSMTPs:s,destinationFolderId:r},ln.i.importAndExecute(t.tableQuery.folderId,"Sweep",d),rn(e,r,c,a,o,d),n==dn.a.All?[2]:(Object(dn.e)(1),[2,sn(e,r,c,a,o).then((function(e){"Success"==e.ResponseMessages.Items[0].ResponseClass&&Object(dn.e)(2)})).catch((function(){Object(dn.e)(3)}))])}))}))})),vn=n(10237),mn=n(2767),On=n(6520),jn=n(34);function pn(e,t,n){var r,i="ContextFolder"===e||1===t;return n<0?(Object(jn.d)("totalCount should not be negative."),i?Object(S.b)(jt.n):Object(S.b)(jt.l)):0==n?(jn.g.warn("getDeleteAllConfirmText should not be called."),""):1==n?Object(S.b)(mn.a):(r=n<On.a?n:"10000+",i?Object(S.c)(Object(S.b)(jt.m),r):Object(S.c)(Object(S.b)(jt.k),r))}var kn=n(296),hn=n(957),yn=n(1644);var gn=n(7307),In=n(5104);function Sn(e,t,n,r){switch(e){case"Unread":return t?r?vn.j:vn.u:r?vn.i:vn.t;case"Flagged":return t?r?vn.h:vn.s:r?vn.g:vn.r;case"ToOrCcMe":return t?r?vn.f:vn.q:r?vn.e:vn.p;case"All":default:return function(e,t,n){return e?t?n?vn.d:vn.o:n?vn.b:vn.m:t?n?vn.c:vn.n:n?vn.a:vn.l}(t,n,r)}}function wn(e,t,n){switch(e){case"Unread":return t?jt.j:jt.i;case"Flagged":return t?jt.c:jt.b;case"ToOrCcMe":return t?jt.h:jt.g;case"All":default:return function(e,t){return e?t?jt.f:jt.d:t?jt.e:jt.a}(t,n)}}var _n=n(3568),Nn=Object(A.action)("emptyFolderAction")((function(e,t,n,r,i,a,o){return Object(I.__awaiter)(this,void 0,void 0,(function(){var c,u,s,d,l,b,v,m,O,j,p,k,h,y,g,_,N;return Object(I.__generator)(this,(function(T){switch(T.label){case 0:return c=e.FolderId.Id,u=!1,function(e){return Object(I.__awaiter)(this,void 0,void 0,(function(){return Object(I.__generator)(this,(function(t){switch(t.label){case 0:return[4,_n.c.import()];case 1:return[2,t.sent()(e)]}}))}))}(c).then((function(e){u=e})),u?[2,null]:[4,z.b()];case 1:return T.sent(),b=Object(In.a)(0,o&&f.X.tableViews.get(o),Object(me.j)(e)),v=i?i.length:0,O=e,j=!0,p=e.TotalCount-v,o&&(k=f.X.tableViews.get(o),O=me.d.folderTable.get(k.tableQuery.folderId),j=1===k.tableQuery.listViewType,Object(f.S)(k,t)&&(p=k.totalRowsInView-v)),h=function(e){if(!e)throw new Error("MailFolder should not be null at getEmptyFolderHelperProperties");var t={};return Object(w.m)(e.FolderId.Id)?(t.shouldSupportBulkActions=!1,t.deletedItemsFolderId=Object(hn.a)(yn.a)):(t.shouldSupportBulkActions=!0,t.deletedItemsFolderId=Object(hn.a)(yn.g)),t.isFolderDeletedItemsFolder=Object(w.j)(e.FolderId.Id),t.isFolderDumpsterFolder=Object(w.k)(e.FolderId.Id),t}(O),y=h.isFolderDeletedItemsFolder,g=h.isFolderDumpsterFolder,_=h.deletedItemsFolderId,N=h.shouldSupportBulkActions,g?(m=Object(S.b)(Sn(t,j,v>0,!1)),l=!1,d="HardDelete"):y||"junkemail"==e.DistinguishedFolderId?(m=Object(S.b)(Sn(t,j,v>0,!1)),l=!Object(kn.a)(),a=l?null:a,d="SoftDelete"):Object(w.p)(e)?(m=Object(S.b)(Sn(t,j,v>0,!0)),l=!1,d="SoftDelete"):(n?(m=Object(S.b)(Sn(t,j,v>0,!1)),d="SoftDelete"):(m=Object(S.b)(wn(t,j,v>0)),d="MoveToDeletedItems"),l=!1),s=Object(S.c)(m,b),[2,Object(kt.b)(pn(r,Object(f.A)(c),p),s,!1,{delayCallbackAfterAnimation:!0,okText:Object(S.b)(vn.k)}).then((function(t){t===kt.a.ok&&(N&&ln.i.importAndExecute(c,"EmptyFolder",null,p),Object(gn.a)(e,d,l,a,i,o,_,N))}))]}}))}))}));function Tn(e){return Object(c.a)(e.rowKeys,e.id,!1)}var Cn=n(5),En=Object(A.action)("emptyTableView")(Object(A.select)({folderToBeEmptied:function(e){return me.d.folderTable.get(e.tableQuery.folderId)}})((function(e,t,n,r,i){var a=i.folderToBeEmptied,o=e.selectAllModeTimeStamp,c=e.id,u=e.serverFolderId,s=e.totalRowsInView;if(Object(w.k)(a.FolderId.Id)||Object(w.j)(a.FolderId.Id)||"junkemail"===a.DistinguishedFolderId)Nn(a,Object(f.O)(e),t,n,r,o,c);else{var d=Object(I.__assign)({},a);d.FolderId={Id:u},d.TotalCount=s;var l=o;if(Object(f.T)(a.FolderId.Id)){var b=f.X.inboxPausedDateTime;Object(Cn.Gb)(b,o)&&(l=b)}Nn(d,Object(f.O)(e),t,n,r,l,c)}}))),An=Object(i.mutatorAction)("updateMessageLikers",(function(e,t,n,r,i){var a,o;if(n?e.LikeCount>1?(e.LikeCount--,e.Likers=e.Likers.filter((function(e){return e.EmailAddress!==r}))):(e.LikeCount=null,e.Likers=null):(e.LikeCount?e.LikeCount++:(e.LikeCount=1,e.Likers=[]),e.Likers.push({EmailAddress:r,Name:i,MailboxType:"Mailbox",RoutingType:"SMTP"})),t&&Object(f.P)(t)&&e.ConversationId){var c=Object(f.E)([e.ConversationId.Id],t);try{for(var u=Object(I.__values)(c),s=u.next();!s.done;s=u.next()){var d=s.value;Object(te.a)(d,t.id).globalLikeCount+=n?-1:1}}catch(e){a={error:e}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}}}));function xn(e){return Object(I.__assign)({__type:"LikeItemJsonRequest:#Exchange"},e)}function Fn(e,t){var n;return n={IsUnlike:t,ItemId:e},Object(I.__assign)({__type:"LikeItemRequest:#Exchange"},n)}function Rn(e,t,n){var r,i,a=Fn(e,t);return(r=xn({Header:Object(q.b)(),Body:a}),i=n,void 0===r||r.__type||(r=xn(r)),Object(Dt.a)("LikeItem2",r,i)).then((function(e){return e.Body}))}var Mn=n(12338),Vn=Object(i.action)("likeItem",(function(e,t,n,i,a){return Object(r.c)({name:"LikeItem",actionSource:"ReadingPane"},{itemId:e,message:t,tableView:n,isLocalUpdateOnly:i,instrumentationContext:a})}));Object(i.orchestrator)(Vn,(function(e){var t=e.tableView,n=e.itemId,r=e.message,i=e.instrumentationContext,a=Object(we.a)().SessionSettings.UserEmailAddress,o=!!r.Likers&&r.Likers.some((function(e){return e.EmailAddress===a}));An(r,t,o,a,Object(we.a)().SessionSettings.UserDisplayName),e.isLocalUpdateOnly||Rn(n,o,n.mailboxInfo.requestOptions),o||Object(T.d)("Like",[i],{itemIds:[r.ItemId.Id],conversationIds:[r.ConversationId.Id]}),w.s.importAndExecute(o?Object(S.b)(Mn.b):Object(S.b)(Mn.a))}));var Dn=Vn;function Pn(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(I.__assign)({__type:"ReactToItemJsonRequest:#Exchange"},n)),Object(Dt.a)("ReactToItem",e,t)}function Ln(e,t){return n={ItemIds:[e],ReactionType:t},Object(I.__assign)({__type:"ReactToItemRequest:#Exchange"},n);var n}var Bn=Object(i.action)("reactToItem",(function(e,t,n,i,a,o,c){return Object(r.c)({name:"ReactToItem",actionSource:"ReadingPane"},{message:e,itemId:t,conversationId:n,reactionType:i,instrumentationContext:a,actionAnnouncementString:o,ownerCurrentReactionType:c})})),Un=Object(i.mutatorAction)("updateMessageReactors",(function(e,t,n,r,i){e.Reactions||(e.Reactions=[]),e.OwnerReactionType=i;var a=e.OwnerReactionType===t,o=!1;e.Reactions.forEach((function(i){i.ReactionType===e.OwnerReactionType&&(i.Count--,i.Reactors=i.Reactors.filter((function(e){return e.ReactorEmail.EmailAddress!==n})),0===i.Count&&(i.Count=null,i.Reactors=null)),i.ReactionType!==t||a||(o=!0,i.Count++,i.Reactors.push({ReactorEmail:{EmailAddress:n,Name:r,MailboxType:"Mailbox",RoutingType:"SMTP"}}))})),o||a||e.Reactions.push({Count:1,ReactionType:t,Reactors:[{ReactorEmail:{EmailAddress:n,Name:r,MailboxType:"Mailbox",RoutingType:"SMTP"}}]}),e.Reactions=e.Reactions.filter((function(e){return null!==e.Reactors})),e.OwnerReactionType=a?null:t}));Object(i.orchestrator)(Bn,(function(e){var t=e.itemId,n=e.message,r=e.reactionType,i=e.conversationId,a=e.instrumentationContext,o=e.actionAnnouncementString,c=e.ownerCurrentReactionType,u=Object(we.a)().SessionSettings.UserEmailAddress,s=Object(we.a)().SessionSettings.UserDisplayName;Un(n,r,u,s,c),function(e,t){var n=Ln(e,t),r=Object(q.b)();r.TimeZoneContext.TimeZoneDefinition.Id="UTC",Pn({Header:r,Body:n}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}(t,null!==n.OwnerReactionType?r:"0"),Object(T.d)("Reaction",[a],{itemIds:[null==t?void 0:t.Id],conversationIds:[null==i?void 0:i.Id]}),w.s.importAndExecute(o)}));var Kn=Bn,Wn=n(12339);var Jn=n(1249),Hn=n(10238),Qn=n(426),qn=n(1),Gn=n(12340),zn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkItemAsJunk"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isJunk"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportToSafety"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markItemAsJunk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isJunk"},value:{kind:"Variable",name:{kind:"Name",value:"isJunk"}}},{kind:"ObjectField",name:{kind:"Name",value:"reportToSafety"},value:{kind:"Variable",name:{kind:"Name",value:"reportToSafety"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"movedItemIds"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"undoRequestId"},arguments:[],directives:[]}]}}]}}]},Xn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoMarkItemAsJunk"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isJunk"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportToSafety"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoMarkItemAsJunk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isJunk"},value:{kind:"Variable",name:{kind:"Name",value:"isJunk"}}},{kind:"ObjectField",name:{kind:"Name",value:"reportToSafety"},value:{kind:"Variable",name:{kind:"Name",value:"reportToSafety"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"movedItemIds"},arguments:[],directives:[]}]}}]}}]},Yn=Object(r.d)("markItemsJunkNotJunkBasedOnItemIds",s.a.markItemsJunkNotJunk)((function(e,t,n,r,i,a){var o;return Object(I.__awaiter)(this,void 0,void 0,(function(){var c,u,s,d,l,b,f,v,m,O,j=this;return Object(I.__generator)(this,(function(p){switch(p.label){case 0:return c=z.c(null===(o=null==r?void 0:r.tableQuery)||void 0===o?void 0:o.folderId,Object(R.b)(r)),[4,z.b()];case 1:p.sent(),u=Object(we.a)().SegmentationSettings.ReportJunkEmailEnabled,s=Object(we.a)().UserOptions.ReportJunkSelected,d=Object(we.a)().UserOptions.CheckForReportJunkDialog,l=!1,b=function(){l=!l},f=Promise.resolve(),m=!1,O=Object(R.b)(r);try{Object(kn.a)()||d&&s&&u&&t?(v=$n.invokeMarkItemAsJunkMutation(e,t,!0,O),m=!0):!u||d&&t?v=$n.invokeMarkItemAsJunkMutation(e,t,!1,O):f=Object(kt.b)(t?Object(S.b)(Gn.a):Object(S.b)(Gn.b),kn.a?Object(S.b)(Gn.c):Object(S.b)(Gn.d),!1,{okText:Object(S.b)(jt.p),cancelText:Object(S.b)(jt.o),bodyElement:t?qn.createElement(Jn.a,{label:Object(S.b)(Hn.a),onChange:b}):null}).then((function(n){if(t){var r=n===kt.a.ok;Object(Qn.a)((function(e){e.UserOptions.ReportJunkSelected=r,e.UserOptions.CheckForReportJunkDialog=l}),[{key:"CheckForReportJunkDialog",valuetype:"Boolean",value:[String(l)]},{key:"ReportJunkSelected",valuetype:"Boolean",value:[String(r)]}])}n==kt.a.ok?(v=$n.invokeMarkItemAsJunkMutation(e,t,!0,O),m=!0):v=$n.invokeMarkItemAsJunkMutation(e,t,!1,O)}))}catch(e){}return c&&z.a((function(){return Object(I.__awaiter)(j,void 0,void 0,(function(){var e;return Object(I.__generator)(this,(function(n){switch(n.label){case 0:return[4,v];case 1:return(e=n.sent()).success?[4,Zn(m,t,e.movedItemIds,r,e.undoRequestId)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2,Promise.resolve()]}}))}))}),r.serverFolderId,v),n&&f.then((function(){return function(e,t,n){if(Object(we.a)().UserOptions.ShowNotificationBar){var r;r=n?1===e?Object(S.b)(Wn.a):Object(S.c)(Object(S.b)(Wn.c),e):1===e?Object(S.b)(Wn.b):Object(S.c)(Object(S.b)(Wn.d),e);var i=Object(Ie.h)();Se.e.importAndExecute("markAsJunkNotification","MailModuleNotificationBarHost",r,{icon:"Blocked",primaryActionText:t?Object(S.b)(ge.a):null,allowClear:!0,minWidth:i.minWidth,maxWidth:i.maxWidth,notificationCallback:function(e){e===Se.a.PrimaryActionClicked&&z.e.importAndExecute("NotificationBar")}})}}(e.length,c,t)})),a(),t&&Object(T.d)("MarkAsJunk",i,{itemIds:e}),[2,f]}}))}))}));function Zn(e,t,n,r,i){return Object(I.__awaiter)(this,void 0,void 0,(function(){var a,o,c,u,s;return Object(I.__generator)(this,(function(d){switch(d.label){case 0:return n.length>0?(a=Object(R.b)(r),o=$n.invokeUndoMarkItemAsJunkMutation(n,!t,e,a,i),c=Object(hn.a)("inbox"),t&&c!==r.tableQuery.folderId?[4,o]:[3,2]):[3,3];case 1:if(u=d.sent(),(s=u.movedItemIds).length>0)return[2,Qe(s,r.tableQuery.folderId)];d.label=2;case 2:return[2,o];case 3:return[2,Promise.resolve()]}}))}))}var $n={invokeMarkItemAsJunkMutation:function(e,t,n,r){var i;return Object(I.__awaiter)(this,void 0,void 0,(function(){var a;return Object(I.__generator)(this,(function(o){switch(o.label){case 0:return[4,Object(Re.a)()];case 1:return[4,o.sent().mutate({variables:{ids:e,isJunk:t,reportToSafety:n,mailboxInfo:r},mutation:zn})];case 2:return a=o.sent(),[2,null===(i=null==a?void 0:a.data)||void 0===i?void 0:i.markItemAsJunk]}}))}))},invokeUndoMarkItemAsJunkMutation:function(e,t,n,r,i){var a;return Object(I.__awaiter)(this,void 0,void 0,(function(){var o;return Object(I.__generator)(this,(function(c){switch(c.label){case 0:return[4,Object(Re.a)()];case 1:return[4,c.sent().mutate({variables:{ids:e,isJunk:t,reportToSafety:n,mailboxInfo:r,undoRequestId:i},mutation:Xn})];case 2:return o=c.sent(),[2,null===(a=null==o?void 0:o.data)||void 0===a?void 0:a.undoMarkItemAsJunk]}}))}))}};function er(e,t,n,r){switch(t.tableQuery.listViewType){case 0:!function(e,t,n,r){var i=Object(wt.a)(e,t.id),a=Object(ce.a)(e,t);Yn(i,n,r,t,a,(function(){var n=Object(f.C)(e,t.id);Object(Me.a)(n,t,"MarkAsJunk")}))}(e,t,n,r);break;case 1:!function(e,t,n,r){var i=Object(f.C)(e,t.id),a=Object(ce.a)(e,t);Yn(i,n,r,t,a,(function(){var e=Object(d.a)(i);Object(b.a)(e,t.tableQuery.folderId,"MarkAsJunk")}))}(e,t,n,r)}}var tr=Object(i.action)("MARK_ITEMS_JUNK_NOT_JUNK_BASED_ON_NODE_IDS",(function(e,t,n,r){return{nodeIds:e,tableViewId:t,isJunkValueToSet:n,actionSource:r}})),nr=n(1749),rr=Object(A.select)({item:function(e){return ee.a.items.get(e)}})((function(e,t,n,r,i){var a=i.item,o=Object(nr.a)(a.ParentFolderId.Id,"junkemail");return Yn([e],!o,n,t,r,(function(){var t=Object(d.a)([e]);Object(b.a)(t,a.ParentFolderId.Id,"MarkAsJunk")}))})),ir=Object(i.action)("ON_KEYBOARD_MARK_AS_JUNK_NOT_JUNK",(function(e,t,n){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n}})),ar=Object(i.action)("ON_KEYBOARD_TOGGLE_FLAG_STATE",(function(e,t,n){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n}})),or=Object(i.action)("ON_KEYBOARD_ARCHIVE",(function(e,t,n){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n}})),cr=Object(i.action)("ON_KEYBOARD_DELETE",(function(e,t,n,r,i){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n,isInVirtualSelectAllMode:r,isExplicitSoftDelete:i}})),ur=n(9711),sr=n(12341);function dr(e){return fr(e,(function(e){return e.Name}),Object(S.b)(sr.h),Object(S.b)(sr.t),Object(S.b)(sr.p),Object(S.b)(sr.e),Object(S.b)(sr.l))}function lr(e){var t=Object(kn.a)();return fr(e,(function(e){return e.EmailAddress}),t?Object(S.b)(sr.f):Object(S.b)(sr.g),t?Object(S.b)(sr.r):Object(S.b)(sr.s),t?Object(S.b)(sr.n):Object(S.b)(sr.o),t?Object(S.b)(sr.c):Object(S.b)(sr.d),t?Object(S.b)(sr.j):Object(S.b)(sr.k))}function br(e){return function(e,t,n,r,i,a){switch(e.length){case 0:throw new Error("formatDomains: no email addresses");case 1:return Object(S.c)(t,e[0]);case 2:return Object(S.c)(n,e[0],e[1]);case 3:return Object(S.c)(r,e[0],e[1]);case 4:case 5:case 6:return Object(S.c)(i,e[0],e[1],e.length-2);default:return Object(S.c)(a,e[0],e[1],e.length-2)}}(e,Object(S.b)(sr.a),Object(S.b)(sr.q),Object(S.b)(sr.m),Object(S.b)(sr.b),Object(S.b)(sr.i))}function fr(e,t,n,r,i,a,o){switch(e.length){case 0:throw new Error("formatSenders: no email addresses");case 1:return Object(S.c)(n,t(e[0]));case 2:return Object(S.c)(r,t(e[0]),t(e[1]));case 3:return Object(S.c)(i,t(e[0]),t(e[1]));case 4:case 5:case 6:return Object(S.c)(a,t(e[0]),t(e[1]),e.length-2);default:return Object(S.c)(o,t(e[0]),t(e[1]),e.length-2)}}function vr(e){return e.map((function(e){return""}))}var mr=Object(i.action)("ADD_DOMAINS_TO_BLOCKED_LIST",(function(e){return{domains:e}})),Or=n(3052),jr=n(12342),pr=n(40),kr=!1;function hr(e,t){return Object(I.__awaiter)(this,void 0,void 0,(function(){var n,r,i,a,o,c;return Object(I.__generator)(this,(function(u){switch(u.label){case 0:return e?[4,gr(e)]:[2];case 1:return u.sent()?[4,Object(kt.b)(Object(S.b)(jr.b),Object(S.b)(jr.a),!1,{hideCancelButton:!0})]:[3,3];case 2:return u.sent(),[2];case 3:return kr=!1,n=function(e){var t=e.map((function(e){return e.EmailAddress.split("@")[1]}));return t.filter((function(e,n){return t.indexOf(e)===n}))}(e),r=Object(I.__read)(function(e,t){return[dr(e),lr(e),br(t)]}(e,n),3),i=r[0],a=r[1],o=r[2],c=qn.createElement(Jn.a,{key:"blockDomainCheckbox",defaultChecked:kr,label:o,onChange:yr}),[4,Object(kt.b)(i,a,!1,{bodyElement:Object(pr.i)("tri-blockDomain")?c:null})];case 4:if(u.sent()!==kt.a.ok)return[2];kr&&(mr(n),Object(ve.r)("BlockDomain",[n.length]));try{d=on({EmailAddresses:s=e,ActionType:2,RuleName:null,RuleNames:vr(s)}),cn({Header:Object(q.b)(),Body:d}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}catch(e){}return t(),[2]}var s,d}))}))}function yr(){kr=!kr}function gr(e){return Object(I.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,a,o;return Object(I.__generator)(this,(function(c){switch(c.label){case 0:return Object(kn.a)()?[2,Promise.resolve(!1)]:[4,Object(Or.b)(Object(we.a)().SessionSettings.UserEmailAddress,e.map((function(e){return e.EmailAddress})))];case 1:if(t=c.sent()){n=t.ResponseMessages.map((function(e){return Object(Or.a)(e.MessageText)})).filter((function(e){return!!e}));try{for(r=Object(I.__values)(n),i=r.next();!i.done;i=r.next())if(0===i.value.ExternalMemberCount)return[2,Promise.resolve(!0)]}catch(e){a={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(a)throw a.error}}}return[2,Promise.resolve(!1)]}}))}))}var Ir=n(7308),Sr=n(10233),wr=n(2095);function _r(e,t,n){if(e&&0!=e.length){var r=Object(ce.a)(e,t);hr(Object(Ir.a)(e,t),(function(){Nr(e,t,n,r)})),Object(wr.a)("Block",r,{rowKeys:e})}else jn.d("Block button should not be exposed when there is nothing selected in list view.")}var Nr=Object(r.d)("deleteRowsUponBlocking",s.a.blockSendersFromTable)((function(e,t,n,r){var i=e.filter((function(e){return t.rowKeys.indexOf(e)>=0}));switch(t.tableQuery.listViewType){case 0:var a=Object(Sr.a)(i,t.id);Object(ur.b)(a,t.id,"MoveToDeletedItems",r);break;case 1:var o=Object(f.C)(e,t.id);Object(k.c)(o,"MoveToDeletedItems",t.tableQuery.folderId,null,r,null,Object(z.c)(t.tableQuery.folderId,Object(R.b)(t)))}}));function Tr(e,t,n){e?(hr(Object(Ir.b)([e]),(function(){Cr(e,t,n)})),Object(wr.a)("Block",t,{itemIds:[e]})):jn.d("blockLastSendersFromReadingPane should not be called on invalid items.")}var Cr=Object(r.d)("deleteItemUponBlock",{name:"TnS_BlockSenderFromReadingPane",actionSource:function(e,t,n){return n}})((function(e,t,n){return Object(k.a)([e],"MoveToDeletedItems",t)}));function Er(e,t,n,r){if(!e||0===e.length)throw new Error("Update category action should not be exposed.");if(r&&(t||n))throw new Error("When clearCategories is true, categoriesToAdd and categoriesToRemove both have to be null.");if(t&&n)throw new Error("Can only add or remove categories at one time.")}var Ar=n(3926),xr=n(1969),Fr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CategorizeConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoriesToAdd"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoriesToRemove"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clearAllCategories"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"processRightAway"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"categorizeConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"categoriesToAdd"},value:{kind:"Variable",name:{kind:"Name",value:"categoriesToAdd"}}},{kind:"ObjectField",name:{kind:"Name",value:"categoriesToRemove"},value:{kind:"Variable",name:{kind:"Name",value:"categoriesToRemove"}}},{kind:"ObjectField",name:{kind:"Name",value:"clearAllCategories"},value:{kind:"Variable",name:{kind:"Name",value:"clearAllCategories"}}},{kind:"ObjectField",name:{kind:"Name",value:"processRightAway"},value:{kind:"Variable",name:{kind:"Name",value:"processRightAway"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};function Rr(e,t,n,r,i,a){return Object(Ar.a)(e,t.id,n,r,i),function(e,t){xr.a.add(e,t,0)}(e,t),function(e,t,n,r,i,a){var o=Object(f.k)(t,!0),c=e.map((function(e){return Object(f.h)(e,t.id)})),u=Mr.invokeCategorizeConversationMutation(c,o,n,r,i);return Object(m.c)(u,e,t.serverFolderId,t,!1,!0)}(e,t,n,r,i)}var Mr={invokeCategorizeConversationMutation:function(e,t,n,r,i){var a;return Object(I.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(I.__generator)(this,(function(u){switch(u.label){case 0:return o=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(M.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(Re.a)()];case 1:return[4,u.sent().mutate({variables:{conversations:o,categoriesToAdd:n,categoriesToRemove:r,clearAllCategories:i,processRightAway:Object(pr.i)("tri-processConversationCategoriesRightAway"),folderId:t},mutation:Fr})];case 2:return c=u.sent(),[2,null===(a=null==c?void 0:c.data)||void 0===a?void 0:a.categorizeConversation]}}))}))}},Vr=n(3927),Dr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CategorizeItem"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"items"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CategorizeItemSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"categorizeItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"items"},value:{kind:"Variable",name:{kind:"Name",value:"items"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};function Pr(e,t,n,r,i){var a=Object(f.C)(e,t.id);return Object(Vr.a)(a,n,r,i),xr.a.add(e,t,0),function(e,t,n){return Object(I.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(I.__generator)(this,(function(a){switch(a.label){case 0:r=Object(R.b)(t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Lr.invokeCategorizeItemMutation(n,r)];case 2:return a.sent(),Object(m.a)(e,t.serverFolderId,!0),[3,4];case 3:return i=a.sent(),Object(m.a)(e,t.serverFolderId,!0),Object(m.b)(t),[2,Promise.reject(i)];case 4:return[2]}}))}))}(e,t,function(e){var t=[];return e.forEach((function(e){var n=Object(w.v)(e);t.push({id:n.ItemId.Id,categories:n.Categories})})),t}(a))}var Lr={invokeCategorizeItemMutation:function(e,t){var n;return Object(I.__awaiter)(this,void 0,void 0,(function(){var r;return Object(I.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(Re.a)()];case 1:return[4,i.sent().mutate({variables:{items:e,mailboxInfo:t},mutation:Dr})];case 2:return r=i.sent(),[2,null===(n=null==r?void 0:r.data)||void 0===n?void 0:n.categorizeItem]}}))}))}},Br=n(884),Ur=Object(r.d)("addCategories",s.a.addCategories)((function(e,t,n,r,i){var a=Jr(e,t,n,null,!1,r,i);Br.A.importAndExecute(n);var o=Object(ce.a)(e,t);return Object(T.d)("Categorize",o,{rowKeys:e}),a})),Kr=Object(r.d)("clearCategories",s.a.clearCategories)((function(e,t,n){return Jr(e,t,null,null,!0,n)})),Wr=Object(r.d)("removeCategoriesFromTable",s.a.removeCategories)((function(e,t,n,r){return Jr(e,t,null,n,!1,r)}));function Jr(e,t,n,r,i,a,o){return Object(f.P)(t)?function(e,t,n,r,i,a,o){return Object(I.__awaiter)(this,void 0,void 0,(function(){return Object(I.__generator)(this,(function(c){switch(c.label){case 0:return Er(e,n,r,i),[4,z.b()];case 1:return c.sent(),o?[2,o.then((function(o){return Rr(e,t,n,r,i,a)}))]:[2,Rr(e,t,n,r,i,a)]}}))}))}(e,t,n,r,i,a,o):function(e,t,n,r,i,a,o){return Object(I.__awaiter)(this,void 0,void 0,(function(){return Object(I.__generator)(this,(function(a){switch(a.label){case 0:return Er(e,n,r,i),[4,z.b()];case 1:return a.sent(),o?[2,o.then((function(a){return Pr(e,t,n,r,i)}))]:[2,Pr(e,t,n,r,i)]}}))}))}(e,t,n,r,i,0,o)}var Hr=n(1668),Qr=n(2023),qr=Object(A.action)("translateFromTable")((function(e,t,n){return Object(I.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(I.__generator)(this,(function(i){switch(i.label){case 0:if(n=f.b.getRowClientItemId(e[0],t),!e||0==e.length)return jn.d("Translate button should not show when empty list"),[2];switch(t.tableQuery.listViewType){case 0:return[3,1];case 1:return[3,6]}return[3,8];case 1:return[4,Qr.j.import()];case 2:return[4,i.sent()(n)];case 3:return(null==(r=i.sent())?void 0:r.Id)?[4,Hr.z.import()]:[3,5];case 4:i.sent()(Object(Hr.p)(r.Id)),i.label=5;case 5:return[3,8];case 6:return[4,Hr.z.import()];case 7:return i.sent()(Object(Hr.p)(n.Id)),[3,8];case 8:return[2]}}))}))})),Gr=Object(i.action)("toggleIgnoreConversations",(function(e,t,n,r){return{rowKeysToIgnore:e,tableViewId:t,shouldIgnore:n,actionSource:r}})),zr=Object(i.action)("INTERNAL_TOGGLE_IGNORE_CONVERSATION",(function(e,t,n,i){return Object(r.c)({name:"TnS_Ignore",customData:[i,n],options:{isCore:!0}},{rowKeysToIgnore:e,tableViewId:t,shouldIgnore:n,actionSource:i})})),Xr=Object(i.action)("MOVE_SHARED_FOLDER_ITEMS",(function(e,t,n,r,i){return{rowKeys:e,originalTableViewId:t,destinationFolderId:n,parentFolderId:r,actionSource:i}})),Yr=Object(i.action)("MOVE_SHARED_FOLDER_CONVERSATIONS",(function(e,t,n){return{rowKeys:e,destinationFolderId:t,originalTableView:n}})),Zr=Object(i.action)("ON_REMOVE_MEETING",(function(e,t){return{tableViewId:e,conversationId:t}})),$r=n(5126),ei=Object(i.action)("removeSpotlight",(function(e,t,n,r){return{rowKey:e,tableViewId:t,actionSource:n,itemOrConversationId:r}})),ti=n(12343),ni=n(1857),ri=n(6524),ii=n(8445);var ai=90,oi=98;function ci(){var e;(e=Object(ri.a)({Header:Object(q.b)()}),Object(ii.a)(e)).then((function(e){var t,n;if(e.AccountInfo.Statistics&&e.AccountInfo.Mailbox){var r=e.AccountInfo.Statistics.TotalItemSize.Value,i=Object(de.h)(),a=r/(n=!(null===(t=null==i?void 0:i.SessionSettings)||void 0===t?void 0:t.IsBposUser)&&e.AccountInfo.Mailbox.UseDatabaseQuotaDefaults?e.AccountInfo.Statistics.DatabaseProhibitSendQuota:e.AccountInfo.Mailbox.ProhibitSendQuota).Value*100;if(!(a<ai||n.IsUnlimited)){Object(ve.r)("TnS_MailboxQuotaWarning",[Math.round(a)]);var o=Object(S.c)(Object(S.b)(ti.b),a.toFixed(2));o+=a>=oi?Object(S.b)(ti.a):Object(S.b)(ti.c),Se.e.importAndExecute("mailboxQuotaWarningNotification","MailModuleNotificationBarHost",o,{primaryActionText:Object(S.b)(ti.d),allowAutoDismiss:!1,shouldShowDismissIcon:!0,minWidth:0,notificationCallback:function(e){e===Se.a.PrimaryActionClicked&&(Object(ve.r)("MailboxCleanup_NavigateTo",["OldMailboxQuotaWarning"]),ni.f.importAndExecute("general","storage"))}})}}}))}var ui=n(12344),si=n(2171),di=n(1087),li=n(1860);Object(i.orchestrator)(nn,(function(e){Object(kt.b)(Object(S.b)(ui.b),Object(S.c)(Object(S.b)(ui.a),e.message.From.Mailbox.Name),!1,{okText:Object(S.b)(si.a),cancelText:Object(S.b)(Ht.a)}).then((function(t){var n,r;t===kt.a.ok&&(n=e.cacheEntry,r=e.itemViewState,Object(di.e)("ReadingPaneInfoBar",n.smtpInfo.smtpAddress,n.smtpInfo.smtpIdentifier,n.unsubscribeSilentUris,n.unsubscribeHttpUris[0],(function(){Object(li.a)(r,"unsubscribeInfoBar")})))}))}));var bi=n(12345),fi=n(4528);function vi(){return Object(fi.a)().then((function(e){if(e.WasSuccessful)return e.Options;throw new Error("getMailboxJunkEmailConfigurationOperation "+e.ErrorCode+" "+e.ErrorMessage)}))}var mi=n(7046);function Oi(e){return Object(mi.a)({Header:Object(q.b)(),Options:e})}function ji(e,t,n){var r=null==t?null:Object(B.a)({BaseFolderId:Object(P.a)({Id:t})}),i=e.map((function(e){return function(e,t,n){return Object(D.a)({Action:"AlwaysDelete",ConversationId:Object(L.a)({Id:e}),ContextFolderId:t,EnableAlwaysDelete:n,ProcessRightAway:Object(pr.i)("tri-processIgnoreRightAway")})}(e,r,n)}));return Object(V.a)({ConversationActions:i,ReturnMovedItemIds:!0})}Object(i.orchestrator)(a,(function(e){return Object(I.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(I.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(kt.b)(Object(S.c)(Object(S.b)(bi.b),e.mailbox.EmailAddress),Object(S.c)(Object(S.b)(bi.a),e.mailbox.EmailAddress))];case 1:return n.sent()!==kt.a.ok?[3,3]:[4,vi()];case 2:t=n.sent(),o(e.mailbox,t),Oi(t),n.label=3;case 3:return[2]}}))}))}));var pi=function(){function e(e,t,n,r){var i=this;this.checkboxToggled=function(){i.isChecked=!i.isChecked},this.title=e,this.subtext=t,this.isChecked=!1,this.onConfirm=n,this.onDismiss=r,this.dialogOptions={okText:Object(S.b)(si.a),cancelText:Object(S.b)(Ht.a),bodyElement:qn.createElement(Jn.a,{label:Object(S.b)(Hn.a),onChange:this.checkboxToggled})}}return e.prototype.show=function(){var e=this;return Object(kt.b)(this.title,this.subtext,!1,this.dialogOptions).then((function(t){return t===kt.a.ok?e.onConfirm(e.isChecked):e.onDismiss()}))},e}(),ki=n(12346);Object(i.orchestrator)(Gr,(function(e){var t=e.shouldIgnore,n=e.rowKeysToIgnore,r=t?128:256;if((r&Object(we.a)().UserOptions.NewEnabledPonts)==r){var i=void 0;i=t?1==n.length?Object(S.b)(ki.b):Object(S.c)(Object(S.b)(ki.c),n.length):1==n.length?Object(S.b)(ki.e):Object(S.c)(Object(S.b)(ki.f),n.length);var a=t?Object(S.b)(ki.a):Object(S.b)(ki.d);new pi(i,a,(function(n){n&&function(e){var t=Object(we.a)().UserOptions.NewEnabledPonts&~e;Object(Qn.a)((function(e){e.UserOptions.NewEnabledPonts=t}),[{key:"NewEnabledPonts",valuetype:"Integer32",value:[""+t]}])}(r),zr(e.rowKeysToIgnore,e.tableViewId,t,e.actionSource)}),(function(){})).show()}else zr(e.rowKeysToIgnore,e.tableViewId,t,e.actionSource)}));Object(i.orchestrator)(zr,(function(e){var t,n,r=e.shouldIgnore,i=e.tableViewId,a=e.rowKeysToIgnore,o=[],c=f.X.tableViews.get(i);try{for(var u=Object(I.__values)(a),s=u.next();!s.done;s=u.next()){var l=s.value;o.push(f.b.getConversationId(l,c))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}if(r){var v=Object(ce.a)(a,c);Object(T.d)("Ignore",v,{rowKeys:a})}if(Object(f.P)(c))Object(Me.a)(o,c,"Ignore");else{var O=Object(f.C)(a,i),j=Object(d.a)(O);Object(b.a)(j,c.tableQuery.folderId,"Ignore")}var p=function(e,t,n){var r=ji(e,t,n);return Object(U.a)(r)}(o,c.tableQuery.folderId,r);return Object(m.c)(p,a,c.tableQuery.folderId,i,!1)}));var hi=n(1777),yi=n(5739),gi=n(2770);Object(i.orchestrator)(h,(function(e){var t=f.X.tableViews.get(e.tableViewId),n=Object(I.__spread)(t.selectedRowKeys.keys()),r=Object(yi.a)(e.nodeIds,Object(gi.a)(n[0]));f.X.expandedConversationViewState.selectedNodeIds.indexOf(e.nodeIds[0])>-1&&Object(hi.m)(f.X.expandedConversationViewState.expandedRowKey,t),Object(k.a)(r,t.tableQuery.folderId&&Object(nr.a)(t.tableQuery.folderId,"deleteditems")||function(e){var t,n;try{for(var r=Object(I.__values)(e),i=r.next();!i.done;i=r.next()){var a=i.value,o=w.u.items.get(a);if((null==o?void 0:o.ParentFolderId)&&"deleteditems"==Object(_e.a)(o.ParentFolderId.Id))return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!1}(r)?"SoftDelete":"MoveToDeletedItems",null,e.actionSource,Object(R.b)(t))}));Object(i.orchestrator)(it,(function(e){var t=f.X.tableViews.get(e.tableViewId),n=Object(I.__spread)(t.selectedRowKeys.keys()),r=Object(yi.a)(e.nodeIds,Object(gi.a)(n[0]));Object(hi.m)(f.X.expandedConversationViewState.expandedRowKey,t),Ge(r,e.destinationFolderId,t,e.actionSource)})),Object(i.orchestrator)(tr,(function(e){var t=f.X.tableViews.get(e.tableViewId),n=Object(I.__spread)(t.selectedRowKeys.keys()),r=Object(yi.a)(e.nodeIds,Object(gi.a)(n[0]));Object(hi.m)(f.X.expandedConversationViewState.expandedRowKey,t),Yn(r,e.isJunkValueToSet,e.actionSource,t,null,(function(){var e=Object(d.a)(r);Object(b.a)(e,t.tableQuery.folderId,"MarkAsJunk")}))})),Object(i.orchestrator)(ir,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys;if(n.length>0)tr(n,t.id,!0,"Keyboard");else{if(0===r.length)return;er(r,t,!0,"Keyboard")}}));var Ii=n(3053);Object(i.orchestrator)(ar,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys;if(Object(Oe.b)(11))if(n.length>0){var i=function(e,t){var n,r;try{for(var i=Object(I.__values)(e),a=i.next();!a.done;a=i.next()){var o=a.value;if("Flagged"!==Object(Ii.a)(o,t).Flag.FlagStatus)return"Flagged"}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return Object(de.s)()?"NotFlagged":"Complete"}(n,Object(gi.a)(r[0]));be(n,t.id,i,"Keyboard")}else{if(0===r.length)return;le(r,t.id,"Keyboard")}}));var Si=n(1829),wi=(Object(i.orchestrator)(or,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys;if(n.length>0)it(n,Object(hn.a)("archive"),t.id,"Keyboard"),Si.b.importAndExecute();else{if(0===r.length)return;at(r,t,"Keyboard")}})),Object(i.orchestrator)(cr,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys,i=e.isInVirtualSelectAllMode,a=e.isExplicitSoftDelete;if(Object(Oe.b)(9)){if(i)En(t,a,"Keyboard",t.virtualSelectAllExclusionList);else{if(n.length>0)return h(n,t.id,"Keyboard"),void Si.b.importAndExecute();r.length>0&&Object(c.a)(r,t.id,a,"Keyboard")}0==t.rowKeys.length&&Si.b.importAndExecute()}})),Object(i.orchestrator)(be,(function(e){var t=f.X.tableViews.get(e.tableViewId),n=Object(I.__spread)(t.selectedRowKeys.keys());oe(Object(yi.a)(e.nodeIds,Object(gi.a)(n[0])),null,{FlagStatus:e.flagStatusToSet},e.tableViewId,e.actionSource)})),n(3496)),_i=n(3260),Ni=(Object(i.orchestrator)(Xr,(function(e){return Object(I.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,a,o,c,u,l,v,m,O,j,p;return Object(I.__generator)(this,(function(k){switch(k.label){case 0:return t=e.rowKeys,n=e.originalTableViewId,r=e.destinationFolderId,i=e.parentFolderId,a=e.actionSource,o=Object(f.C)(t,n),c=Object(d.a)(o),u=Object(f.G)(),Object(ve.r)(s.a.moveItems.name(t,r,u,a),s.a.moveItems.customData(t,r,u,a)),Ee(c,r),Object(b.a)(c,i,"Move"),[4,z.b()];case 1:k.sent(),l=o.map((function(e){return{Id:e}})),k.label=2;case 2:return k.trys.push([2,7,,8]),[4,Object($e.a)(o,Object(Ue.a)(r),!0)];case 3:return v=k.sent(),(m=(null===(p=v.ResponseMessages)||void 0===p?void 0:p.Items)?v.ResponseMessages.Items[0]:null)&&"Success"==m.ResponseClass?[4,Object(wi.a)(l,"HardDelete",null)]:[3,5];case 4:return O=k.sent(),Ni(u,t),"Success"!==O[0].ResponseClass?(Object(_i.a)(u),Object(Oe.j)(r)):Te(o.length,r,!1),[3,6];case 5:Ni(u,t),Object(_i.a)(u),Object(Oe.j)(r),k.label=6;case 6:return[3,8];case 7:return j=k.sent(),jn.d("Shared Folder move item action failed : "+JSON.stringify(j)),[3,8];case 8:return[2]}}))}))})),function(e,t){var n=e.tableQuery.folderId;xr.a.removeRowsFromTombstone(t,n)}),Ti=(Object(i.orchestrator)(Yr,(function(e){return Object(I.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,a,o,c,u,s;return Object(I.__generator)(this,(function(d){switch(d.label){case 0:t=e.rowKeys,n=e.originalTableView,r=e.destinationFolderId,i=t.map((function(e){return Object(f.h)(e,n.id)})),a=Object(f.C)(t,n.id),Ae(t,n,r),Object(Me.a)(a,n,"Move"),d.label=1;case 1:return d.trys.push([1,6,,7]),[4,tt(i,r,n.tableQuery.folderId)];case 2:return(o=d.sent())&&"Success"==o.ResponseClass?(c=Object(R.b)(n),[4,ur.c.invokeDeleteConversationMutation(i,Object(f.k)(n),"HardDelete",c)]):[3,4];case 3:return u=d.sent(),Ni(n,t),u.success?Te(i.length,r,!1):(Object(_i.a)(n),Object(Oe.j)(r)),[3,5];case 4:Ni(n,t),Object(_i.a)(n),Object(Oe.j)(r),d.label=5;case 5:return[3,7];case 6:return s=d.sent(),jn.d("Shared Folder move conversation action failed : "+JSON.stringify(s)),[3,7];case 7:return[2]}}))}))})),n(7042)),Ci=n(2839);var Ei=n(10239);Object(i.orchestrator)(gn.a,(function(e){var t=[];if(e.rowKeysToExclude.length>0){var n=f.X.tableViews.get(e.tableViewId);switch(n.tableQuery.listViewType){case 0:t=Object(wt.a)(e.rowKeysToExclude,e.tableViewId);break;case 1:t=function(e,t){var n={};return e.forEach((function(e){var r=f.b.getRowClientItemId(e,t).Id;n[r]||(n[r]=!0)})),Object.keys(n)}(e.rowKeysToExclude,n)}}var r=f.X.tableViews.get(e.tableViewId),i=Object(Ti.a)(e.folder.FolderId.Id,e.disposalType,e.deleteSubFolders,e.clientLastSyncTime,t,e.shouldSupportBulkActions).then((function(){r&&Object(Ei.a)(r)})).catch((function(e){return r&&Object(Ei.a)(r),Promise.reject(e)}));return Object(Ci.a)(e.folder,e.clientLastSyncTime,e.deletedItemsFolderId,e.rowKeysToExclude),i}));var Ai=n(12347);function xi(e,t){if(Object(de.h)().UserOptions.ShowNotificationBar){var n=t?Object(S.b)(Ai.a):Object(S.b)(Ai.b),r=Object(Ie.h)();Se.e.importAndExecute("scheduleNotification","MailModuleNotificationBarHost",n,{icon:"Clock",primaryActionText:e?Object(S.b)(ge.a):null,minWidth:r.minWidth,maxWidth:r.maxWidth,notificationCallback:function(e){e===Se.a.PrimaryActionClicked&&z.e.importAndExecute("NotificationBar")}})}}var Fi={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ScheduleConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scheduleReturnTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"scheduleConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"scheduleReturnTime"},value:{kind:"Variable",name:{kind:"Name",value:"scheduleReturnTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"undoRequestId"},arguments:[],directives:[]}]}}]}}]},Ri={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoScheduleConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoScheduleConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},Mi=Object(r.d)("ScheduleConversation",s.a.scheduleItems)((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var n,i,a,o,c,u,s,d,l=this;return Object(I.__generator)(this,(function(b){switch(b.label){case 0:return n=t.id,0==(i=Object(f.g)(e,n,(function(e){return!!e}))).length?[2,Promise.resolve()]:(a=Object(f.C)(i,n),o=i.map((function(e){return Object(f.h)(e,n)})),c=t.tableQuery.folderId,u=Object(hn.a)("scheduled"),s=c===u,[4,z.b()]);case 1:return b.sent(),xi(!s,r),s||Object(Me.a)(a,t,"Snooze"),d=function(e,t,n){var r;return Object(I.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(I.__generator)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e.conversationId}})),[4,Object(Re.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:t,scheduleReturnTime:n?Object(Cn.tb)(n):null},mutation:Fi})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.scheduleConversation]}}))}))}(o,c,r),s||z.a((function(){return Object(I.__awaiter)(l,void 0,void 0,(function(){var e;return Object(I.__generator)(this,(function(t){switch(t.label){case 0:return[4,d];case 1:return(e=t.sent()).success?[4,Vi(o,u,e.undoRequestId)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2,Promise.resolve()]}}))}))}),t.serverFolderId,d),[2,Object(m.c)(d,i,t.serverFolderId,t,!1,!0)]}}))}))}));function Vi(e,t,n){var r;return Object(I.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(I.__generator)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e.conversationId}})),[4,Object(Re.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:t,undoRequestId:n},mutation:Ri})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.undoScheduleConversation]}}))}))}var Di=n(10235),Pi=n(10236),Li=n(6521);function Bi(e,t){var n=function(e,t){return Object(Di.a)({MessageAction:Object(Pi.a)({Action:t?"Schedule":"Unschedule",ScheduleReturnTime:t?Object(Cn.tb)(t):null}),Ids:e.map((function(e){return Object(L.a)({Id:e})}))})}(e,t);return Object(Li.a)({Header:Object(q.b)(),Body:n}).then((function(e){return e.Body.ResponseMessages.Items}))}var Ui=Object(r.d)("scheduleItems",s.a.scheduleItems)((function(e,t,n,r){return Object(I.__awaiter)(this,void 0,void 0,(function(){var n,i,a,o,c,u=this;return Object(I.__generator)(this,(function(s){switch(s.label){case 0:return 0===(n=Object(f.C)(e,t.id)).length?[2,Promise.resolve()]:(i=t.tableQuery.folderId,a="scheduled"===Object(_e.a)(i),[4,z.b()]);case 1:return s.sent(),xi(!a,r),a||(o=Object(d.a)(n),Object(b.a)(o,i,"Snooze")),c=Bi(n,r),a||z.a((function(){return Object(I.__awaiter)(u,void 0,void 0,(function(){var e,t,n,r,i,a,o;return Object(I.__generator)(this,(function(u){switch(u.label){case 0:return e=[],[4,c];case 1:t=u.sent();try{for(n=Object(I.__values)(t),r=n.next();!r.done;r=n.next())"Success"===(i=r.value).ResponseClass&&e.push(i.Item.ItemId.Id)}catch(e){a={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(a)throw a.error}}return e.length>0?[4,Bi(e)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[2,Promise.resolve()]}}))}))}),t.serverFolderId),[2,c.then((function(e){return Object(O.a)(e)})).catch((function(e){return Promise.reject(e)}))]}}))}))}));Object(i.orchestrator)(y,(function(e){var t=e.rowKeys,n=e.actionSource,r=e.scheduleReturnTime,i=e.tableViewId,a=Object(f.J)().tableViews.get(i);switch(Object(T.d)("Snooze",null,{rowKeys:t}),a.tableQuery.listViewType){case 0:return void Mi(t,a,n,r);case 1:return void Ui(t,a,n,r);default:throw new Error("scheduleRows: Invalid listView type")}})),Object(i.mutator)(o,(function(e){e.junkEmailConfiguration.TrustedSendersAndDomains.push(e.mailbox.EmailAddress)}));var Ki=n(5282),Wi=n(5283);Object(i.orchestrator)(di.d,(function(e){"ReadingPaneInfoBar"===e.unsubscribeSourceType&&(e.responseType===di.a.Success?e.completedCallback&&e.completedCallback():Object(kt.b)(Object(S.b)(Wi.a),Object(S.b)(Ki.a),!1,{hideCancelButton:!0}))})),Object(i.orchestrator)(Zr,(function(e){var t=e.tableViewId,n=e.conversationId,r=f.X.tableViews.get(t);if(Object(f.P)(r)){var i=Object(f.E)([n],r);if(0===i.length)return;xr.a.add(i,r,4)}}));Object(i.orchestrator)(mr,(function(e){return Object(I.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(I.__generator)(this,(function(n){switch(n.label){case 0:return[4,vi()];case 1:return t=n.sent(),e.domains.forEach((function(e){-1===t.BlockedSendersAndDomains.indexOf(e)&&t.BlockedSendersAndDomains.push(e)})),Oi(t),[2]}}))}))})),n.d(t,"addMailboxToSafeSenders",(function(){return a})),n.d(t,"deleteMailListRows",(function(){return c.a})),n.d(t,"restoreMailListRows",(function(){return p})),n.d(t,"deleteItems",(function(){return k.a})),n.d(t,"deleteItemsBasedOnNodeOrThreadIds",(function(){return h})),n.d(t,"scheduleRows",(function(){return y})),n.d(t,"toggleRowsFlagState",(function(){return le})),n.d(t,"setMailListRowsFlagState",(function(){return ue})),n.d(t,"setItemsFlagStateFromItemIds",(function(){return oe})),n.d(t,"setItemsFlagStateBasedOnNodeIds",(function(){return be})),n.d(t,"moveMailListRows",(function(){return Ye})),n.d(t,"copyMailListRows",(function(){return nt})),n.d(t,"moveItemsFromItemIds",(function(){return Ge})),n.d(t,"moveItemsBasedOnNodeIds",(function(){return it})),n.d(t,"archiveMailListRowsFromTable",(function(){return at})),n.d(t,"toggleRowPinnedState",(function(){return mt})),n.d(t,"markRowsPinnedUnpinned",(function(){return Ot})),n.d(t,"markRowsAsPhishingFromTable",(function(){return Tt})),n.d(t,"markItemAsPhishingFromReadingPane",(function(){return Ct})),n.d(t,"restoreConversations",(function(){return u.a})),n.d(t,"moveMailListRowsToFocusedOrOther",(function(){return Mt})),n.d(t,"alwaysMoveRowToFocusedOrOther",(function(){return Wt})),n.d(t,"unsubscribeEmail",(function(){return en})),n.d(t,"unsubscribeEmailV2",(function(){return nn})),n.d(t,"sweepConversations",(function(){return fn})),n.d(t,"emptyFolder",(function(){return Nn})),n.d(t,"emptySearchTableView",(function(){return Tn})),n.d(t,"emptyTableView",(function(){return En})),n.d(t,"likeItem",(function(){return Dn})),n.d(t,"reactToItem",(function(){return Kn})),n.d(t,"markRowsJunkNotJunkFromTable",(function(){return er})),n.d(t,"markItemsJunkNotJunkBasedOnNodeIds",(function(){return tr})),n.d(t,"markItemJunkNotJunkFromReadingPane",(function(){return rr})),n.d(t,"onKeyboardMarkAsJunkNotJunk",(function(){return ir})),n.d(t,"onKeyboardToggleFlagState",(function(){return ar})),n.d(t,"onKeyboardArchive",(function(){return or})),n.d(t,"onKeyboardDelete",(function(){return cr})),n.d(t,"blockLastSendersFromTable",(function(){return _r})),n.d(t,"blockLastSenderFromReadingPane",(function(){return Tr})),n.d(t,"addCategoriesFromTable",(function(){return Ur})),n.d(t,"removeCategoriesFromTable",(function(){return Wr})),n.d(t,"clearCategoriesFromTable",(function(){return Kr})),n.d(t,"translateFromTable",(function(){return qr})),n.d(t,"toggleIgnoreConversations",(function(){return Gr})),n.d(t,"moveSharedFolderItems",(function(){return Xr})),n.d(t,"moveSharedFolderConversations",(function(){return Yr})),n.d(t,"onRemoveMeeting",(function(){return Zr})),n.d(t,"dismissNudge",(function(){return $r.a})),n.d(t,"removeSpotlight",(function(){return ei})),n.d(t,"showNotificationOnMailboxQuotaWarning",(function(){return ci}))},620:function(e){e.exports=JSON.parse('{"a":"kaa"}')},64:function(e,t,n){"use strict";var r,i,a,o;n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(r||(r={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(i||(i={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(a||(a={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(o||(o={}));var c=7},6523:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(197),a=n(2830);function o(e,t,n){if(void 0===t&&(t=Object(i.b)()),!e||!e.ConversationActions||0===e.ConversationActions.length)throw new Error("ApplyConversationAction requestBody is invalid!");n=n||{};var o=Object(r.__assign)({},n),c=o.headers?new Headers(o.headers):new Headers;return c.set("X-OWA-ActionSource","ApplyConversationAction_"+e.ConversationActions[0].Action),o.headers=c,Object(a.a)({Header:t,Body:e},o).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))}},6524:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetAccountInformationRequest:#Exchange"},e)}},693:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},7001:function(e,t,n){"use strict";var r=n(3813),i=n(4547),a=n(188),o=Object(a.action)("setSweepOptionType")(Object(a.select)({sweepStore:function(){return r.a}})((function(e,t){t.sweepStore.sweepOptionType=e}))),c=n(7),u=n(34);var s=Object(a.action)("setSweepRequestStatus")(Object(a.select)({sweepStore:function(){return r.a}})((function(e,t){var n,r,i,a=t.sweepStore;a.isSweepDialogShown&&(n=a.sweepRequestStatus,i="Invalid state transition {0} to {1}",1==(r=e)&&0!=n&&u.d(Object(c.c)(i,n,r)),2!=r&&3!=r||1==n||u.d(Object(c.c)(i,n,r)),a.sweepRequestStatus=e)}))),d=Object(a.action)("showHideSweepDialog")(Object(a.select)({sweepStore:function(){return r.a}})((function(e,t){t.sweepStore.isSweepDialogShown=e,e||(t.sweepStore.sweepOptionType=i.a.All,t.sweepStore.sweepRequestStatus=0)}))),l=n(44);n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return v})),n.d(t,"g",(function(){return r.a})),n.d(t,"a",(function(){return i.a})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return d}));var b=new l.c((function(){return n.e(927).then(n.bind(null,17384))})),f=new l.b(b,(function(e){return e.onSweepMoveToFolderClicked})),v=new l.b(b,(function(e){return e.setSweepDestinationFolderId}))},701:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),i=n(1),a=n(209),o=n(507),c=n(502),u=n(310),s=n(262),d=n(348),l=n(465),b=Object(a.a)(),f=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._checkBox=i.createRef(),a._renderContent=function(e,t,n){void 0===n&&(n={});var u=a.props,s=u.disabled,l=u.inputProps,b=u.name,f=u.ariaLabel,v=u.ariaLabelledBy,m=u.ariaDescribedBy,O=u.onRenderLabel,j=void 0===O?a._onRenderLabel:O,p=u.checkmarkIconProps,k=u.ariaPositionInSet,h=u.ariaSetSize,y=u.title,g=u.label;return i.createElement("div",{className:a._classNames.root,title:y},i.createElement(o.a,null),i.createElement("input",Object(r.__assign)({type:"checkbox"},l,{"data-ktp-execute-target":n["data-ktp-execute-target"],checked:e,disabled:s,className:a._classNames.input,ref:a._checkBox,name:b,id:a._id,title:y,onChange:a._onChange,onFocus:a._onFocus,onBlur:a._onBlur,"aria-disabled":s,"aria-label":f||g,"aria-labelledby":v,"aria-describedby":Object(c.a)(m,n["aria-describedby"]),"aria-posinset":k,"aria-setsize":h,"aria-checked":t?"mixed":e?"true":"false"})),i.createElement("label",{className:a._classNames.label,htmlFor:a._id},i.createElement("div",{className:a._classNames.checkbox,"data-ktp-target":n["data-ktp-target"]},i.createElement(d.a,Object(r.__assign)({iconName:"CheckMark"},p,{className:a._classNames.checkmark}))),j(a.props,a._onRenderLabel)))},a._onFocus=function(e){var t=a.props.inputProps;t&&t.onFocus&&t.onFocus(e)},a._onBlur=function(e){var t=a.props.inputProps;t&&t.onBlur&&t.onBlur(e)},a._onChange=function(e){var t=a.props.onChange,n=a.state,r=n.isChecked;n.isIndeterminate?(t&&t(e,r),void 0===a.props.indeterminate&&a.setState({isIndeterminate:!1})):(t&&t(e,!r),void 0===a.props.checked&&a.setState({isChecked:!r}))},a._onRenderLabel=function(e){var t=e.label,n=e.title;return t?i.createElement("span",{"aria-hidden":"true",className:a._classNames.text,title:n},t):null},Object(u.a)(a),a._id=a.props.id||Object(s.a)("checkbox-"),a.state={isChecked:!!(void 0!==t.checked?t.checked:t.defaultChecked),isIndeterminate:!!(void 0!==t.indeterminate?t.indeterminate:t.defaultIndeterminate)},a}return Object(r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n={};return void 0!==e.indeterminate&&(n.isIndeterminate=!!e.indeterminate),void 0!==e.checked&&(n.isChecked=!!e.checked),Object.keys(n).length?n:null},t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.disabled,a=t.boxSide,o=t.theme,c=t.styles,u=t.onRenderLabel,s=void 0===u?this._onRenderLabel:u,d=t.keytipProps,f=this.state,v=f.isChecked,m=f.isIndeterminate;return this._classNames=b(c,{theme:o,className:n,disabled:r,indeterminate:m,checked:v,reversed:"start"!==a,isUsingCustomLabelRender:s!==this._onRenderLabel}),d?i.createElement(l.a,{keytipProps:d,disabled:r},(function(t){return e._renderContent(v,m,t)})):this._renderContent(v,m)},Object.defineProperty(t.prototype,"indeterminate",{get:function(){return!!this.state.isIndeterminate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checked",{get:function(){return!!this.state.isChecked},enumerable:!0,configurable:!0}),t.prototype.focus=function(){this._checkBox.current&&this._checkBox.current.focus()},t.defaultProps={boxSide:"start"},t}(i.Component)},7042:function(e,t,n){"use strict";var r=n(0),i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"EmptyFolder"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposalType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposalType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deleteSubFolder"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bulkActionInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmptyFolderBulkActionInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"emptyFolder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"disposalType"},value:{kind:"Variable",name:{kind:"Name",value:"disposalType"}}},{kind:"ObjectField",name:{kind:"Name",value:"deleteSubFolder"},value:{kind:"Variable",name:{kind:"Name",value:"deleteSubFolder"}}},{kind:"ObjectField",name:{kind:"Name",value:"clientLastSyncTime"},value:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipt"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}}},{kind:"ObjectField",name:{kind:"Name",value:"bulkActionInput"},value:{kind:"Variable",name:{kind:"Name",value:"bulkActionInput"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}}]}}]}}]}}]},a=n(380),o=n(1920),c=n(5),u=n(40),s=n(1634),d=n(25),l=n(4351),b=n(1673);function f(e,t,n,i,a,f,m){return Object(r.__awaiter)(this,void 0,void 0,(function(){var O,j,p,k,h;return Object(r.__generator)(this,(function(r){return null,O="AlwaysSend"!=Object(d.a)().UserOptions.ReadReceipt||Object(s.D)(e,"SharedMailbox"),j=Object(b.a)(e),p="none"==j?e:j,k=Object(l.a)(p,!1),h={id:e,disposalType:t,deleteSubFolder:n,clientLastSyncTime:i&&Object(c.tb)(i),itemIdsToExclude:a,suppressReadReceipt:O,bulkActionInput:{supportBulkActions:f,bulkActionBatchSize:Object(u.i)("tri-emptyFolderBulkActionBatchSize")?200:10,bulkActionCustomData:m&&JSON.stringify(m)},mailboxInfo:k},[2,v.invokeEmptyFolderMutation(h).then((function(){o.k.importAndExecute()}))]}))}))}n.d(t,"a",(function(){return f}));var v={invokeEmptyFolderMutation:function(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(a.a)()];case 1:return[4,r.sent().mutate({variables:e,mutation:i})];case 2:return n=r.sent(),[2,null===(t=null==n?void 0:n.data)||void 0===t?void 0:t.emptyFolder]}}))}))}}},7046:function(e,t,n){"use strict";var r=n(28),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"SetMailboxJunkEmailConfigurationRequest:#Exchange"},n)),Object(r.a)("SetMailboxJunkEmailConfiguration",e,t)}n.d(t,"a",(function(){return a}))},7307:function(e,t,n){"use strict";var r=n(52),i=n(3),a=n(1673),o=Object(i.action)("emptyFolderWithoutConfirmation",(function(e,t,n,i,o,c,u,s){var d=e.TotalCount,l=Object(a.a)(e.FolderId.Id);return Object(r.c)({name:"TnS_EmptyFolderAction",customData:{folderTotalCount:d,disposalType:t,deleteSubFolders:n,folderName:l}},{folder:e,disposalType:t,deleteSubFolders:n,clientLastSyncTime:i,rowKeysToExclude:o,tableViewId:c,deletedItemsFolderId:u,shouldSupportBulkActions:s})}));t.a=o},7308:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(8444),i=n(7),a=n(877),o=n(1633),c=n(1638),u=n(4902);function s(e){for(var t={},n=[],o=0;o<e.length;o++){var c=e[o].EmailAddress;if(c){if(Object(u.a)(c))return Object(a.b)(Object(i.c)(Object(i.b)(r.a),c),null,!1,{hideCancelButton:!0}),null;var s=c.toLowerCase();t[s]||(t[s]=!0,n.push(e[o]))}}return n.length>0?n:null}function d(e,t){var n=[];return e.forEach((function(e){var r=o.b.getLastSenderMailbox(e,t);r&&n.push(r)})),s(n)}function l(e){var t=[];return e.forEach((function(e){var n=c.a.items.get(e);n&&Object(o.V)(n)&&t.push(n.From.Mailbox)})),s(t)}},793:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},e)}},8441:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return u}));var r,i=n(105),a=n(5),o=n(140),c=n(25);function u(e){var t,n,u,s,d,l=Object(c.a)().UserOptions,b=l.WorkingHours.WorkDays,f=Object(a.Pb)();switch(e){case r.today:t=n=Object(a.tb)(f),d="Flagged";break;case r.tomorrow:t=n=Object(a.tb)(Object(a.e)(Object(a.Wb)(f),1)),d="Flagged";break;case r.thisWeek:s=function(e,t){var n=7-Object(a.nb)(t),r=2;0<n&&n<=2&&(r=n-1);var i=Object(a.e)(Object(a.Wb)(t),r),c=Object(o.i)(e);for(;t<i&&!c.includes(Object(a.nb)(i));)i=Object(a.e)(Object(a.Wb)(i),-1);var u=Object(a.e)(Object(a.Wb)(t),n-1);for(;i<u&&!c.includes(Object(a.nb)(u));)u=Object(a.e)(Object(a.Wb)(u),-1);return[Object(a.tb)(i),Object(a.tb)(u)]}(b,f),n=s[0],t=s[1],d="Flagged";break;case r.nextWeek:s=function(e,t,n){for(var r=Object(a.e)(n,7),i=Object(a.ac)(r,e),c=Object(o.i)(t),u=0;u<7&&!c.includes(Object(a.nb)(i));++u)i=Object(a.e)(Object(a.Wb)(i),1);var s=Object(a.C)(r,e);for(;i<s&&!c.includes(Object(a.nb)(s));)s=Object(a.e)(Object(a.Wb)(s),-1);return[Object(a.tb)(i),Object(a.tb)(s)]}(l.WeekStartDay,b,f),n=s[0],t=s[1],d="Flagged";break;case r.noDate:d="Flagged";break;case r.complete:u=Object(a.tb)(f),d="Complete";break;case r.clear:d="NotFlagged";break;default:Object(i.a)(e)}return{FlagStatus:d,StartDate:n,DueDate:t,CompleteDate:u}}!function(e){e[e.today=0]="today",e[e.tomorrow=1]="tomorrow",e[e.thisWeek=2]="thisWeek",e[e.nextWeek=3]="nextWeek",e[e.noDate=4]="noDate",e[e.complete=5]="complete",e[e.clear=6]="clear"}(r||(r={}))},8442:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1634);function i(e){return Object(r.D)(e,"ArchiveMailbox")||Object(r.D)(e,"SharedMailbox")}},8443:function(e){e.exports=JSON.parse('{"a":"o6b"}')},8444:function(e){e.exports=JSON.parse('{"a":"N5b"}')},8445:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28),i=n(6524);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("GetAccountInformation",e,t)}},877:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(44),i=n(968);n.d(t,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(184),n.e(527)]).then(n.bind(null,1572))})),o=new r.b(a,(function(e){return e.confirmAction}));function c(e,t,n,r){return o.import().then((function(i){return i(e,t,n,r)}))}},968:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(r||(r={}))}}]);
//# sourceMappingURL=owa.MailBoot~TriageAction.js.map
self.scriptsLoaded['owa.MailBoot~TriageAction.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~TriageAction.js'] = (new Date()).getTime();