self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AgendaView~CalendarSublimity~CalendarSublimityOpx~MailFilterActions~MailFlaggedEmailLightni~92f35d5c.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[79],{1162:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(615);function u(e){var t={viewmodel:"ReadMessageItem",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(n.a)(t)}},187:function(e,t,r){"use strict";var n,u,i;!function(e){e[e.CompletedDateTime=0]="CompletedDateTime",e[e.OrderDateTime=1]="OrderDateTime",e[e.CommittedOrder=2]="CommittedOrder"}(n||(n={})),function(e){e.LinkedEntities="LinkedEntities"}(u||(u={})),function(e){e[e.MyDay=0]="MyDay",e[e.DueDate=1]="DueDate",e[e.FolderId=2]="FolderId"}(i||(i={}));var a=r(134),o=r(7),c=r(178),l=r(34),d="/ows/todo/api/v1",s="tasks",m=d+"/tasks/{0}",f=d+"/tasks/{0}",O=d+"/taskfolders/{0}",p=d+"/taskfolders",b=d+"/taskfolders/{0}/tasks",D=d+"/tasks/{0}/subtasks",T=f+"/subtasks/{1}",y=m+"/subtasks/{1}",j=r(5),v=r(628),I=r(383),S=r(1162);var C={OrderDateTime:{propertyName:"OrderDateTime",getValue:function(e){return e?e.toISOString():null}},IsReminderOn:{propertyName:"IsReminderOn"},ReminderDateTime:{propertyName:"ReminderDateTime",getValue:function(e){return h(e)}},CompletedDateTime:{propertyName:"CompletedDateTime",getValue:function(e){return h(e)}},DueDateTime:{propertyName:"DueDateTime",getValue:function(e){return h(e)}},IsCompleted:{propertyName:"IsCompleted"},Subject:{propertyName:"Subject"},Status:{propertyName:"Status"},Importance:{propertyName:"Importance"},Note:{propertyName:"Body",getValue:function(e){return function(e){return{Content:e||"",ContentType:"Text"}}(e)}},LinkedEmail:{propertyName:"LinkedEntity",getValue:function(e){return function(e){if(!e)return null;return function(e){return{Id:Object(v.a)(e.Id),WebLink:Object(S.a)(e.Id),EntityType:I.c,EntitySubtype:e.EntitySubtype,DisplayName:e.DisplayName,Preview:{RestId:Object(v.a)(e.Id)}}}(e)}(e)}},CommittedDay:{propertyName:"CommittedDay",getValue:function(e){return e?Object(j.sb)(e):null}},CommittedOrder:{propertyName:"CommittedOrder",getValue:function(e){return e?e.toISOString():null}},CreatedWithLocalId:{propertyName:"CreatedWithLocalId"}};function h(e){return null===e?null:{DateTime:Object(j.qb)(e),TimeZone:e.tz}}function _(e,t){if(!e)return null;var r=Object.keys(e).map((function(r){return function(e,t,r){if(r&&null===t)return null;return function(e,t){var r=C[e];if(!r)return null;var n=r.getValue?r.getValue(t):t;return{key:r.propertyName,value:n}}(e,t)}(r,e[r],t)})).filter((function(e){return!!e}));if(0===r.length)return null;var n={};return r.forEach((function(e){n[e.key]=e.value})),n}function g(e,t){return _(e,t)}var k=r(25);function N(){var e=Object(k.a)().UserOptions.TimeZone;return{Prefer:Object(o.c)('outlook.timezone="{0}"',e)}}var E=r(0);function F(e){return Object(E.__assign)(Object(E.__assign)({},e),{CompletedDateTime:e.CompletedDateTime?Object(j.lc)(e.CompletedDateTime):void 0,OrderDateTime:e.OrderDateTime?Object(j.lc)(e.OrderDateTime):void 0})}function R(e,t,r){var n=Object(o.c)(D,e),u=g(t,!0);return u?Object(c.d)(n,u,null,!1,N()).then((function(e){return e?F(e):null})).catch((function(e){return l.d("[CreateSubtaskService] API returned error",e),null})):(Object(a.r)("CreateSubtaskServiceEmptyRequest",r,{isCore:!0}),null)}function w(e){var t=Object(I.h)(Object(E.__assign)(Object(E.__assign)({},e),{OrderDateTime:e.OrderDateTime?Object(j.lc)(e.OrderDateTime):null,FolderType:"Other"}));return e.FolderType&&"com.microsoft.outlook.email.commitment"===e.FolderType.toLowerCase()&&(t.FolderType="Commitments"),e.FolderType&&"com.microsoft.outlook.email.flagged"===e.FolderType.toLowerCase()&&(t.FolderType="FlaggedEmails"),t}function L(e){return Object(c.d)(p,{Name:e.Name},null,!1,N()).then((function(e){return e.Id?w(e):null})).catch((function(e){return null}))}function V(e,t){return _(e,t)}function q(e){var t,r,n,u,i=Object(E.__assign)(Object(E.__assign)({},e),{__type:"Todo",ReminderDateTime:e.ReminderDateTime?Object(j.lc)(e.ReminderDateTime.DateTime):void 0,CompletedDateTime:e.CompletedDateTime?Object(j.lc)(e.CompletedDateTime.DateTime):void 0,DueDateTime:e.DueDateTime?Object(j.lc)(e.DueDateTime.DateTime):void 0,OrderDateTime:e.OrderDateTime?Object(j.lc)(e.OrderDateTime):void 0,Status:e.Status,Subtasks:e.Subtasks?e.Subtasks.map(F):void 0,Importance:e.Importance,Note:(null===(t=e.Body)||void 0===t?void 0:t.Content)&&"Text"==e.Body.ContentType?e.Body.Content:void 0,LinkedEmail:x(e.LinkedEntities),CommittedDay:e.CommittedDay?(r=e.CommittedDay,n=Object(j.mc)(r),u=Object(j.lc)(Object(j.Cb)(n),Object(j.xb)(n),Object(j.lb)(n)),u):void 0,CommittedOrder:e.CommittedOrder?Object(j.lc)(e.CommittedOrder):void 0,CreatedWithLocalId:e.CreatedWithLocalId?e.CreatedWithLocalId:void 0});return e?i:null}function x(e){if(!e)return null;var t,r=e.filter((function(e){return e.EntityType==I.c}));return 0==r.length?null:(t=r[0],{Id:Object(v.b)(t.Id),EntitySubtype:t.EntitySubtype,DisplayName:t.DisplayName})}function P(e,t,r){void 0===t&&(t=null);var n=t||s,u=Object(o.c)(b,n);return V(e,!0)?Object(c.d)(u,V(e,!0),null,!1,N()).then((function(e){return e.Id?q(e):null})).catch((function(e){return l.d("[CreateTaskService] API returned error",e),null})):(Object(a.r)("CreateTaskServiceEmptyRequest",r,{isCore:!0}),null)}var W=r(218);function A(e,t){var r=Object(o.c)(y,e,t);return Object(c.a)(r,null,null,!0,N()).then((function(e){return Object(W.a)(e.status)})).catch((function(e){return!1}))}function B(e){var t=Object(o.c)(m,e);return Object(c.a)(t,null,null,!0,N()).then((function(e){return Object(W.a)(e.status)})).catch((function(e){return!1}))}function G(){return Object(c.b)(p,void 0,!1,N()).then((function(e){return(null==e?void 0:e.Value)?e.Value.map((function(e){return w(e)})):null})).catch((function(e){return null}))}function M(e){return e&&e.type===i.MyDay}function $(e){return e&&e.type===i.DueDate}function z(e){return e&&e.type===i.FolderId}var K=r(105);function Q(e){var t=e.filters,r=e.orderBy,u=e.expand,i=function(e){if(M(e))return"smartlists/myday";if($(e))return"smartlists/duedate";if(z(e)){var t=e.folderId;return"taskfolders/"+(t||"tasks")}return Object(K.a)(e)}(e),a=function(e){switch(e){case n.CompletedDateTime:return"CompletedDateTime/DateTime desc";case n.OrderDateTime:case n.CommittedOrder:return"OrderDateTime/DateTime desc";default:Object(K.a)(e)}}(r),o=[u].join(","),c=t.taskStatusFilters.length>0?"&$filter="+t.taskStatusFilters.map(U).join(" or "):"";return"/ows/todo/api/v1/"+i+"/tasks/?"+function(e){var t="",r=e.customQueryOptions.maxPageSize;r&&(t+="&maxpagesize="+r);if(M(e)){var n=e.customQueryOptions.date,u=Object(j.sb)(n);return t+"&date="+u}if($(e)){var i=e.customQueryOptions,a=i.startDate,o=i.endDate,c=Object(j.sb)(a),l=Object(j.sb)(o);return t+"&startDate="+c+"&endDate="+l}if(z(e))return t;return Object(K.a)(e)}(e)+c+"&$orderby="+a+"&$expand="+o}function U(e){return"Status "+e.equalityOperator+" '"+e.status+"'"}function H(e,t){var r=this;return Object(c.b)(e,null,!1,N(),!0,void 0,t).then((function(e){return Object(E.__awaiter)(r,void 0,void 0,(function(){return Object(E.__generator)(this,(function(t){if(function(e){return null==e?void 0:e.Value}(e))return[2,e];throw new Error(Object(o.c)("The service response {0} is not of the expected GetTaskResponse type",e))}))}))})).catch((function(e){var t=function(e){if(e instanceof Error)return e;var t=null;try{t=JSON.stringify(e)}catch(e){t="[getErrorFromObject]: Unable to parse Error Message"}return new Error(t)}(e);return l.g.warn(e),{errorResponse:t,Value:[]}}))}var Y="com.microsoft.teams.message";function Z(e){return!!e.Source&&e.Source.substring(0,Y.length)===Y}function J(e){return Object(E.__awaiter)(this,void 0,void 0,(function(){var t;return Object(E.__generator)(this,(function(r){switch(r.label){case 0:return"GET_TASKS_IN_FOLDER",[4,H(Q(e),"GET_TASKS_IN_FOLDER")];case 1:return(t=r.sent()).errorResponse&&z(e)?("GET_TASKS_IN_FOLDER_RETRY",function(e){var t;if(1===(null===(t=e.filters.taskStatusFilters)||void 0===t?void 0:t.length)){var r=e.filters.taskStatusFilters[0];if("Completed"===r.status&&"ne"===r.equalityOperator)return!0}return!1}(e)&&(e.filters.taskStatusFilters=[{status:"NotStarted",equalityOperator:"eq"},{status:"InProgress",equalityOperator:"eq"},{status:"Deferred",equalityOperator:"eq"},{status:"WaitingOnOthers",equalityOperator:"eq"}]),[4,H(Q(e),"GET_TASKS_IN_FOLDER_RETRY")]):[3,3];case 2:t=r.sent(),r.label=3;case 3:return t.Value=t.Value.filter((function(e){return!Z(e)})),[2,t]}}))}))}function X(e,t,r){var n=Object(o.c)(T,e,t);return Object(c.c)(n,r,null,!0,N()).then((function(e){return Object(W.a)(e.status)})).catch((function(e){return!1}))}function ee(e,t){var r=Object(o.c)(O,e);return Object(c.c)(r,t,null,!0,N()).then((function(e){return Object(W.a)(e.status)})).catch((function(e){return!1}))}function te(e,t){var r=Object(o.c)(f,t);return Object(c.c)(r,e,null,!0,N()).then((function(e){return Object(W.a)(e.status)})).catch((function(e){return!1}))}r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return R})),r.d(t,"e",(function(){return L})),r.d(t,"f",(function(){return P})),r.d(t,"g",(function(){return A})),r.d(t,"h",(function(){return B})),r.d(t,"k",(function(){return G})),r.d(t,"l",(function(){return J})),r.d(t,"p",(function(){return X})),r.d(t,"q",(function(){return ee})),r.d(t,"r",(function(){return te})),r.d(t,"i",(function(){return g})),r.d(t,"j",(function(){return V})),r.d(t,"m",(function(){return N})),r.d(t,"o",(function(){return q})),r.d(t,"n",(function(){return Z}))},383:function(e,t,r){"use strict";var n,u="dragged_email";!function(e){e.Normal="Normal",e.High="High",e.Low="Low"}(n||(n={}));var i=n;function a(e){return"Todo"===(null==e?void 0:e.__type)}var o=r(0),c=r(208);function l(e){return e=null!==e?e:{},Object(o.__assign)(Object(o.__assign)({},e),{CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,Id:e.Id?e.Id:Object(c.a)(),IsCompleted:!!e.IsCompleted&&e.IsCompleted,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Subject:e.Subject?e.Subject:null})}function d(e){var t=(e=null!==e?e:{}).Id?e.Id:Object(c.a)();return Object(o.__assign)(Object(o.__assign)({},e),{__type:"Todo",Id:t,ParentFolderId:e.ParentFolderId?e.ParentFolderId:null,Subject:e.Subject?e.Subject:null,ReminderDateTime:e.ReminderDateTime?e.ReminderDateTime:null,IsReminderOn:!!e.IsReminderOn&&e.IsReminderOn,CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,DueDateTime:e.DueDateTime?e.DueDateTime:null,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Status:e.Status?e.Status:"NotStarted",Subtasks:e.Subtasks?e.Subtasks:null,Importance:e.Importance?e.Importance:i.Normal,Note:e.Note?e.Note:null,LinkedEmail:e.LinkedEmail?e.LinkedEmail:null,CommittedDay:e.CommittedDay?e.CommittedDay:null,CommittedOrder:e.CommittedOrder?e.CommittedOrder:null,CreatedWithLocalId:t})}function s(e){return e=null!==e?e:{},Object(o.__assign)(Object(o.__assign)({},e),{Id:e.Id?e.Id:Object(c.a)(),Name:e.Name?e.Name:null,IsDefaultFolder:!!e.IsDefaultFolder&&e.IsDefaultFolder,IsSharedFolder:!!e.IsSharedFolder&&e.IsSharedFolder,IsOwner:!!e.IsOwner&&e.IsOwner,FolderType:e.FolderType?e.FolderType:"Other",SyncStatus:e.SyncStatus?e.SyncStatus:"Synced",OrderDateTime:e.OrderDateTime?e.OrderDateTime:null})}function m(e){return e&&e.subjects&&0!==e.subjects.length?e.subjects.map((function(t,r){return{Subject:t,LinkedEmail:{Id:e.latestItemIds[r],EntitySubtype:u,DisplayName:t}}})):[]}r.d(t,"c",(function(){return"message"})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return"highlight_from_email"})),r.d(t,"a",(function(){return"context_menu_email"})),r.d(t,"e",(function(){return i})),r.d(t,"j",(function(){return a})),r.d(t,"f",(function(){return l})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return s})),r.d(t,"i",(function(){return m}))}}]);
//# sourceMappingURL=owa.MailBoot~AgendaView~CalendarSublimity~CalendarSublimityOpx~MailFilterActions~MailFlaggedEmailLightni~92f35d5c.js.map
self.scriptsLoaded['owa.MailBoot~AgendaView~CalendarSublimity~CalendarSublimityOpx~MailFilterActions~MailFlaggedEmailLightni~92f35d5c.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AgendaView~CalendarSublimity~CalendarSublimityOpx~MailFilterActions~MailFlaggedEmailLightni~92f35d5c.js'] = (new Date()).getTime();